// @bun
var CV=Object.create;var{getPrototypeOf:ZV,defineProperty:W7,getOwnPropertyNames:DV}=Object;var kV=Object.prototype.hasOwnProperty;var h8=($,J,X)=>{X=$!=null?CV(ZV($)):{};let K=J||!$||!$.__esModule?W7(X,"default",{value:$,enumerable:!0}):X;for(let q of DV($))if(!kV.call(K,q))W7(K,q,{get:()=>$[q],enumerable:!0});return K};var L0=($,J)=>()=>(J||$((J={exports:{}}).exports,J),J.exports);var f4=($,J)=>{for(var X in J)W7($,X,{get:J[X],enumerable:!0,configurable:!0,set:(K)=>J[X]=()=>K})};var O6=import.meta.require;var I7=L0((EG)=>{function OG($,J,X,Y){var q=0,Y=Y===void 0?{}:Y,W=Y.loop===void 0?null:Y.loop,Q=Y.palette===void 0?null:Y.palette;if(J<=0||X<=0||J>65535||X>65535)throw Error("Width/Height invalid.");function N(E){var B=E.length;if(B<2||B>256||B&B-1)throw Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return B}$[q++]=71,$[q++]=73,$[q++]=70,$[q++]=56,$[q++]=57,$[q++]=97;var M=0,V=0;if(Q!==null){var G=N(Q);while(G>>=1)++M;if(G=1<<M,--M,Y.background!==void 0){if(V=Y.background,V>=G)throw Error("Background index out of range.");if(V===0)throw Error("Background index explicitly passed as 0.")}}if($[q++]=J&255,$[q++]=J>>8&255,$[q++]=X&255,$[q++]=X>>8&255,$[q++]=(Q!==null?128:0)|M,$[q++]=V,$[q++]=0,Q!==null)for(var H=0,O=Q.length;H<O;++H){var L=Q[H];$[q++]=L>>16&255,$[q++]=L>>8&255,$[q++]=L&255}if(W!==null){if(W<0||W>65535)throw Error("Loop count invalid.");$[q++]=33,$[q++]=255,$[q++]=11,$[q++]=78,$[q++]=69,$[q++]=84,$[q++]=83,$[q++]=67,$[q++]=65,$[q++]=80,$[q++]=69,$[q++]=50,$[q++]=46,$[q++]=48,$[q++]=3,$[q++]=1,$[q++]=W&255,$[q++]=W>>8&255,$[q++]=0}var j=!1;this.addFrame=function(E,B,S,A,z,P){if(j===!0)--q,j=!1;if(P=P===void 0?{}:P,E<0||B<0||E>65535||B>65535)throw Error("x/y invalid.");if(S<=0||A<=0||S>65535||A>65535)throw Error("Width/Height invalid.");if(z.length<S*A)throw Error("Not enough pixels for the frame size.");var R=!0,U=P.palette;if(U===void 0||U===null)R=!1,U=Q;if(U===void 0||U===null)throw Error("Must supply either a local or global palette.");var C=N(U),k=0;while(C>>=1)++k;C=1<<k;var h=P.delay===void 0?0:P.delay,F=P.disposal===void 0?0:P.disposal;if(F<0||F>3)throw Error("Disposal out of range.");var v=!1,D=0;if(P.transparent!==void 0&&P.transparent!==null){if(v=!0,D=P.transparent,D<0||D>=C)throw Error("Transparent color index.")}if(F!==0||v||h!==0)$[q++]=33,$[q++]=249,$[q++]=4,$[q++]=F<<2|(v===!0?1:0),$[q++]=h&255,$[q++]=h>>8&255,$[q++]=D,$[q++]=0;if($[q++]=44,$[q++]=E&255,$[q++]=E>>8&255,$[q++]=B&255,$[q++]=B>>8&255,$[q++]=S&255,$[q++]=S>>8&255,$[q++]=A&255,$[q++]=A>>8&255,$[q++]=R===!0?128|k-1:0,R===!0)for(var w=0,x=U.length;w<x;++w){var y=U[w];$[q++]=y>>16&255,$[q++]=y>>8&255,$[q++]=y&255}return q=UG($,q,k<2?2:k,z),q},this.end=function(){if(j===!1)$[q++]=59,j=!0;return q},this.getOutputBuffer=function(){return $},this.setOutputBuffer=function(E){$=E},this.getOutputBufferPosition=function(){return q},this.setOutputBufferPosition=function(E){q=E}}function UG($,J,X,K){$[J++]=X;var q=J++,Y=1<<X,W=Y-1,Q=Y+1,N=Q+1,M=X+1,V=0,G=0;function H(P){while(V>=P)if($[J++]=G&255,G>>=8,V-=8,J===q+256)$[q]=255,q=J++}function O(P){G|=P<<V,V+=M,H(8)}var L=K[0]&W,j={};O(Y);for(var E=1,B=K.length;E<B;++E){var S=K[E]&W,A=L<<8|S,z=j[A];if(z===void 0){G|=L<<V,V+=M;while(V>=8)if($[J++]=G&255,G>>=8,V-=8,J===q+256)$[q]=255,q=J++;if(N===4096)O(Y),N=Q+1,M=X+1,j={};else{if(N>=1<<M)++M;j[A]=N++}L=S}else L=z}if(O(L),O(Q),H(1),q+1===J)$[q]=0;else $[q]=J-q-1,$[J++]=0;return J}function LG($){var J=0;if($[J++]!==71||$[J++]!==73||$[J++]!==70||$[J++]!==56||($[J++]+1&253)!==56||$[J++]!==97)throw Error("Invalid GIF 87a/89a header.");var X=$[J++]|$[J++]<<8,K=$[J++]|$[J++]<<8,q=$[J++],Y=q>>7,W=q&7,Q=1<<W+1,N=$[J++];$[J++];var M=null,V=null;if(Y)M=J,V=Q,J+=Q*3;var G=!0,H=[],O=0,L=null,j=0,E=null;this.width=X,this.height=K;while(G&&J<$.length)switch($[J++]){case 33:switch($[J++]){case 255:if($[J]!==11||$[J+1]==78&&$[J+2]==69&&$[J+3]==84&&$[J+4]==83&&$[J+5]==67&&$[J+6]==65&&$[J+7]==80&&$[J+8]==69&&$[J+9]==50&&$[J+10]==46&&$[J+11]==48&&$[J+12]==3&&$[J+13]==1&&$[J+16]==0)J+=14,E=$[J++]|$[J++]<<8,J++;else{J+=12;while(!0){var B=$[J++];if(!(B>=0))throw Error("Invalid block size");if(B===0)break;J+=B}}break;case 249:if($[J++]!==4||$[J+4]!==0)throw Error("Invalid graphics extension block.");var S=$[J++];if(O=$[J++]|$[J++]<<8,L=$[J++],(S&1)===0)L=null;j=S>>2&7,J++;break;case 254:while(!0){var B=$[J++];if(!(B>=0))throw Error("Invalid block size");if(B===0)break;J+=B}break;default:throw Error("Unknown graphic control label: 0x"+$[J-1].toString(16))}break;case 44:var A=$[J++]|$[J++]<<8,z=$[J++]|$[J++]<<8,P=$[J++]|$[J++]<<8,R=$[J++]|$[J++]<<8,U=$[J++],C=U>>7,k=U>>6&1,h=U&7,F=1<<h+1,v=M,D=V,w=!1;if(C){var w=!0;v=J,D=F,J+=F*3}var x=J;J++;while(!0){var B=$[J++];if(!(B>=0))throw Error("Invalid block size");if(B===0)break;J+=B}H.push({x:A,y:z,width:P,height:R,has_local_palette:w,palette_offset:v,palette_size:D,data_offset:x,data_length:J-x,transparent_index:L,interlaced:!!k,delay:O,disposal:j});break;case 59:G=!1;break;default:throw Error("Unknown gif block: 0x"+$[J-1].toString(16))}this.numFrames=function(){return H.length},this.loopCount=function(){return E},this.frameInfo=function(y){if(y<0||y>=H.length)throw Error("Frame index out of range.");return H[y]},this.decodeAndBlitFrameBGRA=function(y,b){var _=this.frameInfo(y),m=_.width*_.height,t=new Uint8Array(m);xX($,_.data_offset,t,m);var{palette_offset:l,transparent_index:s}=_;if(s===null)s=256;var g=_.width,Z=X-g,T=g,c=(_.y*X+_.x)*4,o=((_.y+_.height)*X+_.x)*4,$0=c,a=Z*4;if(_.interlaced===!0)a+=X*4*7;var e=8;for(var r=0,p=t.length;r<p;++r){var i=t[r];if(T===0){if($0+=a,T=g,$0>=o)a=Z*4+X*4*(e-1),$0=c+(g+Z)*(e<<1),e>>=1}if(i===s)$0+=4;else{var X0=$[l+i*3],K0=$[l+i*3+1],U0=$[l+i*3+2];b[$0++]=U0,b[$0++]=K0,b[$0++]=X0,b[$0++]=255}--T}},this.decodeAndBlitFrameRGBA=function(y,b){var _=this.frameInfo(y),m=_.width*_.height,t=new Uint8Array(m);xX($,_.data_offset,t,m);var{palette_offset:l,transparent_index:s}=_;if(s===null)s=256;var g=_.width,Z=X-g,T=g,c=(_.y*X+_.x)*4,o=((_.y+_.height)*X+_.x)*4,$0=c,a=Z*4;if(_.interlaced===!0)a+=X*4*7;var e=8;for(var r=0,p=t.length;r<p;++r){var i=t[r];if(T===0){if($0+=a,T=g,$0>=o)a=Z*4+X*4*(e-1),$0=c+(g+Z)*(e<<1),e>>=1}if(i===s)$0+=4;else{var X0=$[l+i*3],K0=$[l+i*3+1],U0=$[l+i*3+2];b[$0++]=X0,b[$0++]=K0,b[$0++]=U0,b[$0++]=255}--T}}}function xX($,J,X,K){var q=$[J++],Y=1<<q,W=Y+1,Q=W+1,N=q+1,M=(1<<N)-1,V=0,G=0,H=0,O=$[J++],L=new Int32Array(4096),j=null;while(!0){while(V<16){if(O===0)break;if(G|=$[J++]<<V,V+=8,O===1)O=$[J++];else--O}if(V<N)break;var E=G&M;if(G>>=N,V-=N,E===Y){Q=W+1,N=q+1,M=(1<<N)-1,j=null;continue}else if(E===W)break;var B=E<Q?E:j,S=0,A=B;while(A>Y)A=L[A]>>8,++S;var z=A,P=H+S+(B!==E?1:0);if(P>K){console.log("Warning, gif stream longer than expected.");return}X[H++]=z,H+=S;var R=H;if(B!==E)X[H++]=z;A=B;while(S--)A=L[A],X[--R]=A&255,A>>=8;if(j!==null&&Q<4096){if(L[Q++]=j<<8|z,Q>=M+1&&N<12)++N,M=M<<1|1}j=E}if(H!==K)console.log("Warning, gif stream shorter than expected.");return X}try{EG.GifWriter=OG,EG.GifReader=LG}catch($){}});var X$=L0((IS,hX)=>{class t5{constructor(...$){if($.length===0)throw Error("constructor requires parameters");let J=$[0];if(J!==null&&typeof J==="object")if(J instanceof t5){let X=J.bitmap;this.bitmap={width:X.width,height:X.height,data:new Buffer(X.width*X.height*4)},X.data.copy(this.bitmap.data)}else if(J.width&&J.height&&J.data)this.bitmap=J;else throw Error("unrecognized constructor parameters");else if(typeof J==="number"&&typeof $[1]==="number"){let X=J,K=$[1],q=$[2];if(this.bitmap={width:X,height:K},Buffer.isBuffer(q))this.bitmap.data=q;else if(this.bitmap.data=new Buffer(X*K*4),typeof q==="number")this.fillRGBA(q)}else throw Error("unrecognized constructor parameters")}blit($,J,X,K,q,Y,W){if(K+Y>this.bitmap.width)throw Error("copy exceeds width of source bitmap");if(J+Y>$.bitmap.width)throw Error("copy exceeds width of target bitmap");if(q+W>this.bitmap.height)throw Error("copy exceeds height of source bitmap");if(X+W>$.bitmap.height)throw new Erro("copy exceeds height of target bitmap");let Q=this.bitmap.data,N=$.bitmap.data,M=this.bitmap.width*4,V=$.bitmap.width*4,G=Y*4,H=q*M+K*4,O=X*V+J*4;while(--W>=0)Q.copy(N,O,H,H+G),H+=M,O+=V;return this}fillRGBA($){let J=this.bitmap.data,X=this.bitmap.height*4,K=0;while(K<X)J.writeUInt32BE($,K),K+=4;while(K<J.length)J.copy(J,K,0,X),K+=X;return this}getRGBA($,J){let X=(J*this.bitmap.width+$)*4;return this.bitmap.data.readUInt32BE(X)}getRGBASet(){let $=new Set,J=this.bitmap.data;for(let X=0;X<J.length;X+=4)$.add(J.readUInt32BE(X,!0));return $}greyscale(){let $=this.bitmap.data;return this.scan(0,0,this.bitmap.width,this.bitmap.height,(J,X,K)=>{let q=Math.round(0.299*$[K]+0.587*$[K+1]+0.114*$[K+2]);$[K]=q,$[K+1]=q,$[K+2]=q}),this}reframe($,J,X,K,q){let Y=$<0?0:$,W=J<0?0:J,Q=X+Y>this.bitmap.width?this.bitmap.width-Y:X,N=K+W>this.bitmap.height?this.bitmap.height-W:K,M=$<0?-$:0,V=J<0?-J:0,G;if(q===void 0){if(Y!==$||W!=J||Q!==X||N!==K)throw new GifError("fillRGBA required for this reframing");G=new t5(X,K)}else G=new t5(X,K,q);return this.blit(G,M,V,Y,W,Q,N),this.bitmap=G.bitmap,this}scale($){if($===1)return;if(!Number.isInteger($)||$<1)throw Error("the scale must be an integer >= 1");let J=this.bitmap.width,X=this.bitmap.height,K=J*$*4,q=this.bitmap.data,Y=new Buffer(X*K*$),W=0,Q,N=0;for(let M=0;M<X;++M){Q=N;for(let V=0;V<J;++V){let G=q.readUInt32BE(W,!0);for(let H=0;H<$;++H)Y.writeUInt32BE(G,N),N+=4;W+=4}for(let V=1;V<$;++V)Y.copy(Y,N,Q,N),N+=K,Q+=K}return this.bitmap={width:J*$,height:X*$,data:Y},this}scanAllCoords($){let J=this.bitmap.width,X=this.bitmap.data.length,K=0,q=0;for(let Y=0;Y<X;Y+=4)if($(K,q,Y),++K===J)K=0,++q}scanAllIndexes($){let J=this.bitmap.data.length;for(let X=0;X<J;X+=4)$(X)}}hX.exports=t5});var $9=L0((jG)=>{class e5{constructor($,J,X){this.width=X.width,this.height=X.height,this.loops=X.loops,this.usesTransparency=X.usesTransparency,this.colorScope=X.colorScope,this.frames=J,this.buffer=$}}e5.GlobalColorsPreferred=0;e5.GlobalColorsOnly=1;e5.LocalColorsOnly=2;class gX extends Error{constructor($){super($);if($ instanceof Error)this.stack="Gif"+$.stack}}jG.Gif=e5;jG.GifError=gX});var CK=L0((yS,vK)=>{var{defineProperty:Y$,getOwnPropertyDescriptor:PG,getOwnPropertyNames:SG}=Object,AG=Object.prototype.hasOwnProperty,FG=($,J,X)=>(J in $)?Y$($,J,{enumerable:!0,configurable:!0,writable:!0,value:X}):$[J]=X,zG=($)=>Y$($,"__esModule",{value:!0}),F8=($,J)=>{for(var X in J)Y$($,X,{get:J[X],enumerable:!0})},vG=($,J,X,K)=>{if(J&&typeof J==="object"||typeof J==="function"){for(let q of SG(J))if(!AG.call($,q)&&(X||q!=="default"))Y$($,q,{get:()=>J[q],enumerable:!(K=PG(J,q))||K.enumerable})}return $},CG=(($)=>{return(J,X)=>{return $&&$.get(J)||(X=vG(zG({}),J,1),$&&$.set(J,X),X)}})(typeof WeakMap<"u"?new WeakMap:0),d=($,J,X)=>{return FG($,typeof J!=="symbol"?J+"":J,X),X},pX={};F8(pX,{applyPalette:()=>oG,applyPaletteSync:()=>nG,buildPalette:()=>dG,buildPaletteSync:()=>cG,constants:()=>uX,conversion:()=>oX,distance:()=>JK,image:()=>BK,palette:()=>OK,quality:()=>AK,utils:()=>UK});var uX={};F8(uX,{bt709:()=>lX});var lX={};F8(lX,{Y:()=>cX,x:()=>dX,y:()=>nX});var cX=(($)=>{return $[$.RED=0.2126]="RED",$[$.GREEN=0.7152]="GREEN",$[$.BLUE=0.0722]="BLUE",$[$.WHITE=1]="WHITE",$})(cX||{}),dX=(($)=>{return $[$.RED=0.64]="RED",$[$.GREEN=0.3]="GREEN",$[$.BLUE=0.15]="BLUE",$[$.WHITE=0.3127]="WHITE",$})(dX||{}),nX=(($)=>{return $[$.RED=0.33]="RED",$[$.GREEN=0.6]="GREEN",$[$.BLUE=0.06]="BLUE",$[$.WHITE=0.329]="WHITE",$})(nX||{}),oX={};F8(oX,{lab2rgb:()=>yG,lab2xyz:()=>eX,rgb2hsl:()=>K$,rgb2lab:()=>X9,rgb2xyz:()=>rX,xyz2lab:()=>tX,xyz2rgb:()=>$K});function _7($){return $>0.04045?(($+0.055)/1.055)**2.4:$/12.92}function rX($,J,X){return $=_7($/255),J=_7(J/255),X=_7(X/255),{x:$*0.4124+J*0.3576+X*0.1805,y:$*0.2126+J*0.7152+X*0.0722,z:$*0.0193+J*0.1192+X*0.9505}}var iX={};F8(iX,{degrees2radians:()=>X1,inRange0to255:()=>g6,inRange0to255Rounded:()=>r6,intInRange:()=>ZG,max3:()=>sX,min3:()=>aX,stableSort:()=>f7});function X1($){return $*(Math.PI/180)}function sX($,J,X){let K=$;if(K<J)K=J;if(K<X)K=X;return K}function aX($,J,X){let K=$;if(K>J)K=J;if(K>X)K=X;return K}function ZG($,J,X){if($>X)$=X;if($<J)$=J;return $|0}function r6($){if($=Math.round($),$>255)$=255;else if($<0)$=0;return $}function g6($){if($>255)$=255;else if($<0)$=0;return $}function f7($,J){let X=typeof $[0],K;if(X==="number"||X==="string"){let q=Object.create(null);for(let Y=0,W=$.length;Y<W;Y++){let Q=$[Y];if(q[Q]||q[Q]===0)continue;q[Q]=Y}K=$.sort((Y,W)=>J(Y,W)||q[Y]-q[W])}else{let q=$.slice(0);K=$.sort((Y,W)=>J(Y,W)||q.indexOf(Y)-q.indexOf(W))}return K}function K$($,J,X){let K=aX($,J,X),q=sX($,J,X),Y=q-K,W=(K+q)/510,Q=0;if(W>0&&W<1)Q=Y/(W<0.5?q+K:510-q-K);let N=0;if(Y>0){if(q===$)N=(J-X)/Y;else if(q===J)N=2+(X-$)/Y;else N=4+($-J)/Y;if(N*=60,N<0)N+=360}return{h:N,s:Q,l:W}}var DG=0.95047,kG=1,wG=1.08883;function y7($){return $>0.008856?$**0.3333333333333333:7.787*$+0.13793103448275862}function tX($,J,X){if($=y7($/DG),J=y7(J/kG),X=y7(X/wG),116*J-16<0)throw Error("xxx");return{L:Math.max(0,116*J-16),a:500*($-J),b:200*(J-X)}}function X9($,J,X){let K=rX($,J,X);return tX(K.x,K.y,K.z)}var TG=0.95047,IG=1,_G=1.08883;function x7($){return $>0.206893034?$**3:($-0.13793103448275862)/7.787}function eX($,J,X){let K=($+16)/116,q=J/500+K,Y=K-X/200;return{x:TG*x7(q),y:IG*x7(K),z:_G*x7(Y)}}function h7($){return $>0.0031308?1.055*$**0.4166666666666667-0.055:12.92*$}function $K($,J,X){let K=h7($*3.2406+J*-1.5372+X*-0.4986),q=h7($*-0.9689+J*1.8758+X*0.0415),Y=h7($*0.0557+J*-0.204+X*1.057);return{r:r6(K*255),g:r6(q*255),b:r6(Y*255)}}function yG($,J,X){let K=eX($,J,X);return $K(K.x,K.y,K.z)}var JK={};F8(JK,{AbstractDistanceCalculator:()=>w1,AbstractEuclidean:()=>W$,AbstractManhattan:()=>Q$,CIE94GraphicArts:()=>qK,CIE94Textiles:()=>KK,CIEDE2000:()=>Q8,CMetric:()=>YK,Euclidean:()=>WK,EuclideanBT709:()=>QK,EuclideanBT709NoAlpha:()=>NK,Manhattan:()=>MK,ManhattanBT709:()=>GK,ManhattanNommyde:()=>VK,PNGQuant:()=>HK});var w1=class{constructor(){d(this,"_maxDistance"),d(this,"_whitePoint"),this._setDefaults(),this.setWhitePoint(255,255,255,255)}setWhitePoint($,J,X,K){this._whitePoint={r:$>0?255/$:0,g:J>0?255/J:0,b:X>0?255/X:0,a:K>0?255/K:0},this._maxDistance=this.calculateRaw($,J,X,K,0,0,0,0)}calculateNormalized($,J){return this.calculateRaw($.r,$.g,$.b,$.a,J.r,J.g,J.b,J.a)/this._maxDistance}},XK=class extends w1{calculateRaw($,J,X,K,q,Y,W,Q){let N=X9(g6($*this._whitePoint.r),g6(J*this._whitePoint.g),g6(X*this._whitePoint.b)),M=X9(g6(q*this._whitePoint.r),g6(Y*this._whitePoint.g),g6(W*this._whitePoint.b)),V=N.L-M.L,G=N.a-M.a,H=N.b-M.b,O=Math.sqrt(N.a*N.a+N.b*N.b),L=Math.sqrt(M.a*M.a+M.b*M.b),j=O-L,E=G*G+H*H-j*j;E=E<0?0:Math.sqrt(E);let B=(Q-K)*this._whitePoint.a*this._kA;return Math.sqrt((V/this._Kl)**2+(j/(1+this._K1*O))**2+(E/(1+this._K2*O))**2+B**2)}},KK=class extends XK{_setDefaults(){this._Kl=2,this._K1=0.048,this._K2=0.014,this._kA=0.049019607843137254}},qK=class extends XK{_setDefaults(){this._Kl=1,this._K1=0.045,this._K2=0.015,this._kA=0.09803921568627451}},J6=class extends w1{_setDefaults(){}static _calculatehp($,J){let X=Math.atan2($,J);if(X>=0)return X;return X+J6._deg360InRad}static _calculateRT($,J){let X=J**7,K=2*Math.sqrt(X/(X+J6._pow25to7)),q=J6._deg30InRad*Math.exp(-((($-J6._deg275InRad)/J6._deg25InRad)**2));return-Math.sin(2*q)*K}static _calculateT($){return 1-0.17*Math.cos($-J6._deg30InRad)+0.24*Math.cos($*2)+0.32*Math.cos($*3+J6._deg6InRad)-0.2*Math.cos($*4-J6._deg63InRad)}static _calculate_ahp($,J,X,K){let q=X+K;if($===0)return q;if(J<=J6._deg180InRad)return q/2;if(q<J6._deg360InRad)return(q+J6._deg360InRad)/2;return(q-J6._deg360InRad)/2}static _calculate_dHp($,J,X,K){let q;if($===0)q=0;else if(J<=J6._deg180InRad)q=X-K;else if(X<=K)q=X-K+J6._deg360InRad;else q=X-K-J6._deg360InRad;return 2*Math.sqrt($)*Math.sin(q/2)}calculateRaw($,J,X,K,q,Y,W,Q){let N=X9(g6($*this._whitePoint.r),g6(J*this._whitePoint.g),g6(X*this._whitePoint.b)),M=X9(g6(q*this._whitePoint.r),g6(Y*this._whitePoint.g),g6(W*this._whitePoint.b)),V=(Q-K)*this._whitePoint.a*J6._kA,G=this.calculateRawInLab(N,M);return Math.sqrt(G+V*V)}calculateRawInLab($,J){let{L:X,a:K,b:q}=$,Y=J.L,W=J.a,Q=J.b,N=Math.sqrt(K*K+q*q),M=Math.sqrt(W*W+Q*Q),V=((N+M)/2)**7,G=0.5*(1-Math.sqrt(V/(V+J6._pow25to7))),H=(1+G)*K,O=(1+G)*W,L=Math.sqrt(H*H+q*q),j=Math.sqrt(O*O+Q*Q),E=L*j,B=J6._calculatehp(q,H),S=J6._calculatehp(Q,O),A=Math.abs(B-S),z=Y-X,P=j-L,R=J6._calculate_dHp(E,A,S,B),U=J6._calculate_ahp(E,A,B,S),C=J6._calculateT(U),k=(L+j)/2,h=((X+Y)/2-50)**2,F=1+0.015*h/Math.sqrt(20+h),v=1+0.045*k,D=1+0.015*C*k,w=J6._calculateRT(U,k),x=z/F,y=P/v,b=R/D;return x**2+y**2+b**2+w*y*b}},Q8=J6;d(Q8,"_kA",0.09803921568627451);d(Q8,"_pow25to7",6103515625);d(Q8,"_deg360InRad",X1(360));d(Q8,"_deg180InRad",X1(180));d(Q8,"_deg30InRad",X1(30));d(Q8,"_deg6InRad",X1(6));d(Q8,"_deg63InRad",X1(63));d(Q8,"_deg275InRad",X1(275));d(Q8,"_deg25InRad",X1(25));var YK=class extends w1{calculateRaw($,J,X,K,q,Y,W,Q){let N=($+q)/2*this._whitePoint.r,M=($-q)*this._whitePoint.r,V=(J-Y)*this._whitePoint.g,G=(X-W)*this._whitePoint.b,H=((512+N)*M*M>>8)+4*V*V+((767-N)*G*G>>8),O=(Q-K)*this._whitePoint.a;return Math.sqrt(H+O*O)}_setDefaults(){}},W$=class extends w1{calculateRaw($,J,X,K,q,Y,W,Q){let N=q-$,M=Y-J,V=W-X,G=Q-K;return Math.sqrt(this._kR*N*N+this._kG*M*M+this._kB*V*V+this._kA*G*G)}},WK=class extends W${_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},QK=class extends W${_setDefaults(){this._kR=0.2126,this._kG=0.7152,this._kB=0.0722,this._kA=1}},NK=class extends W${_setDefaults(){this._kR=0.2126,this._kG=0.7152,this._kB=0.0722,this._kA=0}},Q$=class extends w1{calculateRaw($,J,X,K,q,Y,W,Q){let N=q-$,M=Y-J,V=W-X,G=Q-K;if(N<0)N=0-N;if(M<0)M=0-M;if(V<0)V=0-V;if(G<0)G=0-G;return this._kR*N+this._kG*M+this._kB*V+this._kA*G}},MK=class extends Q${_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},VK=class extends Q${_setDefaults(){this._kR=0.4984,this._kG=0.8625,this._kB=0.2979,this._kA=1}},GK=class extends Q${_setDefaults(){this._kR=0.2126,this._kG=0.7152,this._kB=0.0722,this._kA=1}},HK=class extends w1{calculateRaw($,J,X,K,q,Y,W,Q){let N=(Q-K)*this._whitePoint.a;return this._colordifferenceCh($*this._whitePoint.r,q*this._whitePoint.r,N)+this._colordifferenceCh(J*this._whitePoint.g,Y*this._whitePoint.g,N)+this._colordifferenceCh(X*this._whitePoint.b,W*this._whitePoint.b,N)}_colordifferenceCh($,J,X){let K=$-J,q=K+X;return K*K+q*q}_setDefaults(){}},OK={};F8(OK,{AbstractPaletteQuantizer:()=>K9,ColorHistogram:()=>Y9,NeuQuant:()=>q6,NeuQuantFloat:()=>Y6,RGBQuant:()=>jK,WuColorCube:()=>RK,WuQuant:()=>$5});var K9=class{quantizeSync(){for(let $ of this.quantize())if($.palette)return $.palette;throw Error("unreachable")}},f6=class{constructor(){d(this,"r"),d(this,"g"),d(this,"b"),d(this,"a"),d(this,"uint32"),d(this,"rgba"),this.uint32=4294967295,this.r=this.g=this.b=this.a=0,this.rgba=[,,,,],this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}static createByQuadruplet($){let J=new f6;return J.r=$[0]|0,J.g=$[1]|0,J.b=$[2]|0,J.a=$[3]|0,J._loadUINT32(),J._loadQuadruplet(),J}static createByRGBA($,J,X,K){let q=new f6;return q.r=$|0,q.g=J|0,q.b=X|0,q.a=K|0,q._loadUINT32(),q._loadQuadruplet(),q}static createByUint32($){let J=new f6;return J.uint32=$>>>0,J._loadRGBA(),J._loadQuadruplet(),J}from($){this.r=$.r,this.g=$.g,this.b=$.b,this.a=$.a,this.uint32=$.uint32,this.rgba[0]=$.r,this.rgba[1]=$.g,this.rgba[2]=$.b,this.rgba[3]=$.a}getLuminosity($){let J=this.r,X=this.g,K=this.b;if($)J=Math.min(255,255-this.a+this.a*J/255),X=Math.min(255,255-this.a+this.a*X/255),K=Math.min(255,255-this.a+this.a*K/255);return J*0.2126+X*0.7152+K*0.0722}_loadUINT32(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0}_loadRGBA(){this.r=this.uint32&255,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255}_loadQuadruplet(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a}},p8=class{constructor(){d(this,"_pointArray"),d(this,"_width"),d(this,"_height"),this._width=0,this._height=0,this._pointArray=[]}getWidth(){return this._width}getHeight(){return this._height}setWidth($){this._width=$}setHeight($){this._height=$}getPointArray(){return this._pointArray}clone(){let $=new p8;$._width=this._width,$._height=this._height;for(let J=0,X=this._pointArray.length;J<X;J++)$._pointArray[J]=f6.createByUint32(this._pointArray[J].uint32|0);return $}toUint32Array(){let $=this._pointArray.length,J=new Uint32Array($);for(let X=0;X<$;X++)J[X]=this._pointArray[X].uint32;return J}toUint8Array(){return new Uint8Array(this.toUint32Array().buffer)}static fromHTMLImageElement($){let{naturalWidth:J,naturalHeight:X}=$,K=document.createElement("canvas");return K.width=J,K.height=X,K.getContext("2d").drawImage($,0,0,J,X,0,0,J,X),p8.fromHTMLCanvasElement(K)}static fromHTMLCanvasElement($){let{width:J,height:X}=$,q=$.getContext("2d").getImageData(0,0,J,X);return p8.fromImageData(q)}static fromImageData($){let{width:J,height:X}=$;return p8.fromUint8Array($.data,J,X)}static fromUint8Array($,J,X){switch(Object.prototype.toString.call($)){case"[object Uint8ClampedArray]":case"[object Uint8Array]":break;default:$=new Uint8Array($)}let K=new Uint32Array($.buffer);return p8.fromUint32Array(K,J,X)}static fromUint32Array($,J,X){let K=new p8;K._width=J,K._height=X;for(let q=0,Y=$.length;q<Y;q++)K._pointArray[q]=f6.createByUint32($[q]|0);return K}static fromBuffer($,J,X){let K=new Uint32Array($.buffer,$.byteOffset,$.byteLength/Uint32Array.BYTES_PER_ELEMENT);return p8.fromUint32Array(K,J,X)}},fX=10;function g7($,J){let K=360/J,q=K/2;for(let Y=1,W=K-q;Y<J;Y++,W+=K)if($>=W&&$<W+K)return Y;return 0}var q9=class{constructor(){d(this,"_pointContainer"),d(this,"_pointArray",[]),d(this,"_i32idx",{}),this._pointContainer=new p8,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}add($){this._pointArray.push($),this._pointContainer.setWidth(this._pointArray.length)}has($){for(let J=this._pointArray.length-1;J>=0;J--)if($.uint32===this._pointArray[J].uint32)return!0;return!1}getNearestColor($,J){return this._pointArray[this._getNearestIndex($,J)|0]}getPointContainer(){return this._pointContainer}_nearestPointFromCache($){return typeof this._i32idx[$]==="number"?this._i32idx[$]:-1}_getNearestIndex($,J){let X=this._nearestPointFromCache(""+J.uint32);if(X>=0)return X;let K=Number.MAX_VALUE;X=0;for(let q=0,Y=this._pointArray.length;q<Y;q++){let W=this._pointArray[q],Q=$.calculateRaw(J.r,J.g,J.b,J.a,W.r,W.g,W.b,W.a);if(Q<K)K=Q,X=q}return this._i32idx[J.uint32]=X,X}sort(){this._i32idx={},this._pointArray.sort(($,J)=>{let X=K$($.r,$.g,$.b),K=K$(J.r,J.g,J.b),q=$.r===$.g&&$.g===$.b?0:1+g7(X.h,fX),W=(J.r===J.g&&J.g===J.b?0:1+g7(K.h,fX))-q;if(W)return-W;let Q=$.getLuminosity(!0),N=J.getLuminosity(!0);if(N-Q!==0)return N-Q;let M=(K.s*100|0)-(X.s*100|0);if(M)return-M;return 0})}},UK={};F8(UK,{HueStatistics:()=>LK,Palette:()=>q9,Point:()=>f6,PointContainer:()=>p8,ProgressTracker:()=>u8,arithmetic:()=>iX});var xG=class{constructor(){d(this,"num",0),d(this,"cols",[])}},LK=class{constructor($,J){d(this,"_numGroups"),d(this,"_minCols"),d(this,"_stats"),d(this,"_groupsFull"),this._numGroups=$,this._minCols=J,this._stats=[];for(let X=0;X<=$;X++)this._stats[X]=new xG;this._groupsFull=0}check($){if(this._groupsFull===this._numGroups+1)this.check=()=>{};let J=$&255,X=$>>>8&255,K=$>>>16&255,q=J===X&&X===K?0:1+g7(K$(J,X,K).h,this._numGroups),Y=this._stats[q],W=this._minCols;if(Y.num++,Y.num>W)return;if(Y.num===W)this._groupsFull++;if(Y.num<=W)this._stats[q].cols.push($)}injectIntoDictionary($){for(let J=0;J<=this._numGroups;J++)if(this._stats[J].num<=this._minCols)this._stats[J].cols.forEach((X)=>{if(!$[X])$[X]=1;else $[X]++})}injectIntoArray($){for(let J=0;J<=this._numGroups;J++)if(this._stats[J].num<=this._minCols)this._stats[J].cols.forEach((X)=>{if($.indexOf(X)===-1)$.push(X)})}},EK=class{constructor($,J){d(this,"progress"),d(this,"_step"),d(this,"_range"),d(this,"_last"),d(this,"_progressRange"),this._range=$,this._progressRange=J,this._step=Math.max(1,this._range/(EK.steps+1)|0),this._last=-this._step,this.progress=0}shouldNotify($){if($-this._last>=this._step)return this._last=$,this.progress=Math.min(this._progressRange*this._last/this._range,this._progressRange),!0;return!1}},u8=EK;d(u8,"steps",100);var z6=3,hG=class{constructor($){d(this,"r"),d(this,"g"),d(this,"b"),d(this,"a"),this.r=this.g=this.b=this.a=$}toPoint(){return f6.createByRGBA(this.r>>z6,this.g>>z6,this.b>>z6,this.a>>z6)}subtract($,J,X,K){this.r-=$|0,this.g-=J|0,this.b-=X|0,this.a-=K|0}},b0=class extends K9{constructor($,J=256){super();d(this,"_pointArray"),d(this,"_networkSize"),d(this,"_network"),d(this,"_sampleFactor"),d(this,"_radPower"),d(this,"_freq"),d(this,"_bias"),d(this,"_distance"),this._distance=$,this._pointArray=[],this._sampleFactor=1,this._networkSize=J,this._distance.setWhitePoint(255<<z6,255<<z6,255<<z6,255<<z6)}sample($){this._pointArray=this._pointArray.concat($.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let $=0;$<this._networkSize;$++)this._network[$]=new hG(($<<z6+8)/this._networkSize|0),this._freq[$]=b0._initialBias/this._networkSize|0,this._bias[$]=0}*_learn(){let $=this._sampleFactor,J=this._pointArray.length;if(J<b0._minpicturebytes)$=1;let X=30+($-1)/3|0,K=J/$|0,q=K/b0._nCycles|0,Y=b0._initAlpha,W=(this._networkSize>>3)*b0._radiusBias,Q=W>>b0._radiusBiasShift;if(Q<=1)Q=0;for(let V=0;V<Q;V++)this._radPower[V]=Y*((Q*Q-V*V)*b0._radBias/(Q*Q))>>>0;let N;if(J<b0._minpicturebytes)N=1;else if(J%b0._prime1!==0)N=b0._prime1;else if(J%b0._prime2!==0)N=b0._prime2;else if(J%b0._prime3!==0)N=b0._prime3;else N=b0._prime4;let M=new u8(K,99);for(let V=0,G=0;V<K;){if(M.shouldNotify(V))yield{progress:M.progress};let H=this._pointArray[G],O=H.b<<z6,L=H.g<<z6,j=H.r<<z6,E=H.a<<z6,B=this._contest(O,L,j,E);if(this._alterSingle(Y,B,O,L,j,E),Q!==0)this._alterNeighbour(Q,B,O,L,j,E);if(G+=N,G>=J)G-=J;if(V++,q===0)q=1;if(V%q===0){if(Y-=Y/X|0,W-=W/b0._radiusDecrease|0,Q=W>>b0._radiusBiasShift,Q<=1)Q=0;for(let S=0;S<Q;S++)this._radPower[S]=Y*((Q*Q-S*S)*b0._radBias/(Q*Q))>>>0}}}_buildPalette(){let $=new q9;return this._network.forEach((J)=>{$.add(J.toPoint())}),$.sort(),$}_alterNeighbour($,J,X,K,q,Y){let W=J-$;if(W<-1)W=-1;let Q=J+$;if(Q>this._networkSize)Q=this._networkSize;let N=J+1,M=J-1,V=1;while(N<Q||M>W){let G=this._radPower[V++]/b0._alphaRadBias;if(N<Q){let H=this._network[N++];H.subtract(G*(H.r-q),G*(H.g-K),G*(H.b-X),G*(H.a-Y))}if(M>W){let H=this._network[M--];H.subtract(G*(H.r-q),G*(H.g-K),G*(H.b-X),G*(H.a-Y))}}}_alterSingle($,J,X,K,q,Y){$/=b0._initAlpha;let W=this._network[J];W.subtract($*(W.r-q),$*(W.g-K),$*(W.b-X),$*(W.a-Y))}_contest($,J,X,K){let q=1020<<z6,Y=2147483647,W=Y,Q=-1,N=Q;for(let M=0;M<this._networkSize;M++){let V=this._network[M],G=this._distance.calculateNormalized(V,{r:X,g:J,b:$,a:K})*q|0;if(G<Y)Y=G,Q=M;let H=G-(this._bias[M]>>b0._initialBiasShift-z6);if(H<W)W=H,N=M;let O=this._freq[M]>>b0._betaShift;this._freq[M]-=O,this._bias[M]+=O<<b0._gammaShift}return this._freq[Q]+=b0._beta,this._bias[Q]-=b0._betaGamma,N}},q6=b0;d(q6,"_prime1",499);d(q6,"_prime2",491);d(q6,"_prime3",487);d(q6,"_prime4",503);d(q6,"_minpicturebytes",b0._prime4);d(q6,"_nCycles",100);d(q6,"_initialBiasShift",16);d(q6,"_initialBias",1<<b0._initialBiasShift);d(q6,"_gammaShift",10);d(q6,"_betaShift",10);d(q6,"_beta",b0._initialBias>>b0._betaShift);d(q6,"_betaGamma",b0._initialBias<<b0._gammaShift-b0._betaShift);d(q6,"_radiusBiasShift",6);d(q6,"_radiusBias",1<<b0._radiusBiasShift);d(q6,"_radiusDecrease",30);d(q6,"_alphaBiasShift",10);d(q6,"_initAlpha",1<<b0._alphaBiasShift);d(q6,"_radBiasShift",8);d(q6,"_radBias",1<<b0._radBiasShift);d(q6,"_alphaRadBiasShift",b0._alphaBiasShift+b0._radBiasShift);d(q6,"_alphaRadBias",1<<b0._alphaRadBiasShift);var v6=3,gG=class{constructor($){d(this,"r"),d(this,"g"),d(this,"b"),d(this,"a"),this.r=this.g=this.b=this.a=$}toPoint(){return f6.createByRGBA(this.r>>v6,this.g>>v6,this.b>>v6,this.a>>v6)}subtract($,J,X,K){this.r-=$,this.g-=J,this.b-=X,this.a-=K}},m0=class extends K9{constructor($,J=256){super();d(this,"_pointArray"),d(this,"_networkSize"),d(this,"_network"),d(this,"_sampleFactor"),d(this,"_radPower"),d(this,"_freq"),d(this,"_bias"),d(this,"_distance"),this._distance=$,this._pointArray=[],this._sampleFactor=1,this._networkSize=J,this._distance.setWhitePoint(255<<v6,255<<v6,255<<v6,255<<v6)}sample($){this._pointArray=this._pointArray.concat($.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let $=0;$<this._networkSize;$++)this._network[$]=new gG(($<<v6+8)/this._networkSize),this._freq[$]=m0._initialBias/this._networkSize,this._bias[$]=0}*_learn(){let $=this._sampleFactor,J=this._pointArray.length;if(J<m0._minpicturebytes)$=1;let X=30+($-1)/3,K=J/$,q=K/m0._nCycles|0,Y=m0._initAlpha,W=(this._networkSize>>3)*m0._radiusBias,Q=W>>m0._radiusBiasShift;if(Q<=1)Q=0;for(let V=0;V<Q;V++)this._radPower[V]=Y*((Q*Q-V*V)*m0._radBias/(Q*Q));let N;if(J<m0._minpicturebytes)N=1;else if(J%m0._prime1!==0)N=m0._prime1;else if(J%m0._prime2!==0)N=m0._prime2;else if(J%m0._prime3!==0)N=m0._prime3;else N=m0._prime4;let M=new u8(K,99);for(let V=0,G=0;V<K;){if(M.shouldNotify(V))yield{progress:M.progress};let H=this._pointArray[G],O=H.b<<v6,L=H.g<<v6,j=H.r<<v6,E=H.a<<v6,B=this._contest(O,L,j,E);if(this._alterSingle(Y,B,O,L,j,E),Q!==0)this._alterNeighbour(Q,B,O,L,j,E);if(G+=N,G>=J)G-=J;if(V++,q===0)q=1;if(V%q===0){if(Y-=Y/X,W-=W/m0._radiusDecrease,Q=W>>m0._radiusBiasShift,Q<=1)Q=0;for(let S=0;S<Q;S++)this._radPower[S]=Y*((Q*Q-S*S)*m0._radBias/(Q*Q))}}}_buildPalette(){let $=new q9;return this._network.forEach((J)=>{$.add(J.toPoint())}),$.sort(),$}_alterNeighbour($,J,X,K,q,Y){let W=J-$;if(W<-1)W=-1;let Q=J+$;if(Q>this._networkSize)Q=this._networkSize;let N=J+1,M=J-1,V=1;while(N<Q||M>W){let G=this._radPower[V++]/m0._alphaRadBias;if(N<Q){let H=this._network[N++];H.subtract(G*(H.r-q),G*(H.g-K),G*(H.b-X),G*(H.a-Y))}if(M>W){let H=this._network[M--];H.subtract(G*(H.r-q),G*(H.g-K),G*(H.b-X),G*(H.a-Y))}}}_alterSingle($,J,X,K,q,Y){$/=m0._initAlpha;let W=this._network[J];W.subtract($*(W.r-q),$*(W.g-K),$*(W.b-X),$*(W.a-Y))}_contest($,J,X,K){let q=1020<<v6,Y=2147483647,W=Y,Q=-1,N=Q;for(let M=0;M<this._networkSize;M++){let V=this._network[M],G=this._distance.calculateNormalized(V,{r:X,g:J,b:$,a:K})*q;if(G<Y)Y=G,Q=M;let H=G-(this._bias[M]>>m0._initialBiasShift-v6);if(H<W)W=H,N=M;let O=this._freq[M]>>m0._betaShift;this._freq[M]-=O,this._bias[M]+=O<<m0._gammaShift}return this._freq[Q]+=m0._beta,this._bias[Q]-=m0._betaGamma,N}},Y6=m0;d(Y6,"_prime1",499);d(Y6,"_prime2",491);d(Y6,"_prime3",487);d(Y6,"_prime4",503);d(Y6,"_minpicturebytes",m0._prime4);d(Y6,"_nCycles",100);d(Y6,"_initialBiasShift",16);d(Y6,"_initialBias",1<<m0._initialBiasShift);d(Y6,"_gammaShift",10);d(Y6,"_betaShift",10);d(Y6,"_beta",m0._initialBias>>m0._betaShift);d(Y6,"_betaGamma",m0._initialBias<<m0._gammaShift-m0._betaShift);d(Y6,"_radiusBiasShift",6);d(Y6,"_radiusBias",1<<m0._radiusBiasShift);d(Y6,"_radiusDecrease",30);d(Y6,"_alphaBiasShift",10);d(Y6,"_initAlpha",1<<m0._alphaBiasShift);d(Y6,"_radBiasShift",8);d(Y6,"_radBias",1<<m0._radBiasShift);d(Y6,"_alphaRadBiasShift",m0._alphaBiasShift+m0._radBiasShift);d(Y6,"_alphaRadBias",1<<m0._alphaRadBiasShift);var J9=class{constructor($,J){d(this,"_method"),d(this,"_hueStats"),d(this,"_histogram"),d(this,"_initColors"),d(this,"_minHueCols"),this._method=$,this._minHueCols=J<<2,this._initColors=J<<2,this._hueStats=new LK(J9._hueGroups,this._minHueCols),this._histogram=Object.create(null)}sample($){switch(this._method){case 1:this._colorStats1D($);break;case 2:this._colorStats2D($);break}}getImportanceSortedColorsIDXI32(){let $=f7(Object.keys(this._histogram),(X,K)=>this._histogram[K]-this._histogram[X]);if($.length===0)return[];let J;switch(this._method){case 1:let X=Math.min($.length,this._initColors),K=$[X-1],q=this._histogram[K];J=$.slice(0,X);let Y=X,W=$.length;while(Y<W&&this._histogram[$[Y]]===q)J.push($[Y++]);this._hueStats.injectIntoArray(J);break;case 2:J=$;break;default:throw Error("Incorrect method")}return J.map((X)=>+X)}_colorStats1D($){let J=this._histogram,X=$.getPointArray(),K=X.length;for(let q=0;q<K;q++){let Y=X[q].uint32;if(this._hueStats.check(Y),Y in J)J[Y]++;else J[Y]=1}}_colorStats2D($){let J=$.getWidth(),X=$.getHeight(),K=$.getPointArray(),q=J9._boxSize[0],Y=J9._boxSize[1],W=q*Y,Q=this._makeBoxes(J,X,q,Y),N=this._histogram;Q.forEach((M)=>{let V=Math.round(M.w*M.h/W)*J9._boxPixels;if(V<2)V=2;let G={};this._iterateBox(M,J,(H)=>{let O=K[H].uint32;if(this._hueStats.check(O),O in N)N[O]++;else if(O in G){if(++G[O]>=V)N[O]=G[O]}else G[O]=1})}),this._hueStats.injectIntoDictionary(N)}_iterateBox($,J,X){let K=$,q=K.y*J+K.x,Y=(K.y+K.h-1)*J+(K.x+K.w-1),W=J-K.w+1,Q=0,N=q;do X.call(this,N),N+=++Q%K.w===0?W:1;while(N<=Y)}_makeBoxes($,J,X,K){let q=$%X,Y=J%K,W=$-q,Q=J-Y,N=[];for(let M=0;M<J;M+=K)for(let V=0;V<$;V+=X)N.push({x:V,y:M,w:V===W?q:X,h:M===Q?Y:K});return N}},Y9=J9;d(Y9,"_boxSize",[64,64]);d(Y9,"_boxPixels",2);d(Y9,"_hueGroups",10);var fG=class{constructor($,J,X){d(this,"index"),d(this,"color"),d(this,"distance"),this.index=$,this.color=J,this.distance=X}},jK=class extends K9{constructor($,J=256,X=2){super();d(this,"_colors"),d(this,"_initialDistance"),d(this,"_distanceIncrement"),d(this,"_histogram"),d(this,"_distance"),this._distance=$,this._colors=J,this._histogram=new Y9(X,J),this._initialDistance=0.01,this._distanceIncrement=0.005}sample($){this._histogram.sample($)}*quantize(){let $=this._histogram.getImportanceSortedColorsIDXI32();if($.length===0)throw Error("No colors in image");yield*this._buildPalette($)}*_buildPalette($){let J=new q9,X=J.getPointContainer().getPointArray(),K=Array($.length);for(let V=0;V<$.length;V++)X.push(f6.createByUint32($[V])),K[V]=1;let q=X.length,Y=[],W=q,Q=this._initialDistance,N=new u8(W-this._colors,99);while(W>this._colors){Y.length=0;for(let V=0;V<q;V++){if(N.shouldNotify(q-W))yield{progress:N.progress};if(K[V]===0)continue;let G=X[V];for(let H=V+1;H<q;H++){if(K[H]===0)continue;let O=X[H],L=this._distance.calculateNormalized(G,O);if(L<Q)Y.push(new fG(H,O,L)),K[H]=0,W--}}Q+=W>this._colors*3?this._initialDistance:this._distanceIncrement}if(W<this._colors){f7(Y,(G,H)=>H.distance-G.distance);let V=0;while(W<this._colors&&V<Y.length){let G=Y[V];K[G.index]=1,W++,V++}}let M=X.length;for(let V=M-1;V>=0;V--)if(K[V]===0){if(V!==M-1)X[V]=X[M-1];--M}X.length=M,J.sort(),yield{palette:J,progress:100}}};function i1($){let J=[];for(let X=0;X<$;X++)J[X]=0;return J}function s1($,J,X,K){let q=Array($);for(let Y=0;Y<$;Y++){q[Y]=Array(J);for(let W=0;W<J;W++){q[Y][W]=Array(X);for(let Q=0;Q<X;Q++){q[Y][W][Q]=Array(K);for(let N=0;N<K;N++)q[Y][W][Q][N]=0}}}return q}function a1($,J,X){let K=Array($);for(let q=0;q<$;q++){K[q]=Array(J);for(let Y=0;Y<J;Y++){K[q][Y]=Array(X);for(let W=0;W<X;W++)K[q][Y][W]=0}}return K}function t1($,J,X,K,q){for(let Y=0;Y<J;Y++){$[Y]=[];for(let W=0;W<X;W++){$[Y][W]=[];for(let Q=0;Q<K;Q++)$[Y][W][Q]=q}}}function e1($,J,X){for(let K=0;K<J;K++)$[K]=X}var RK=class{constructor(){d(this,"redMinimum"),d(this,"redMaximum"),d(this,"greenMinimum"),d(this,"greenMaximum"),d(this,"blueMinimum"),d(this,"blueMaximum"),d(this,"volume"),d(this,"alphaMinimum"),d(this,"alphaMaximum")}},k0=class extends K9{constructor($,J=256,X=5){super();d(this,"_reds"),d(this,"_greens"),d(this,"_blues"),d(this,"_alphas"),d(this,"_sums"),d(this,"_weights"),d(this,"_momentsRed"),d(this,"_momentsGreen"),d(this,"_momentsBlue"),d(this,"_momentsAlpha"),d(this,"_moments"),d(this,"_table"),d(this,"_pixels"),d(this,"_cubes"),d(this,"_colors"),d(this,"_significantBitsPerChannel"),d(this,"_maxSideIndex"),d(this,"_alphaMaxSideIndex"),d(this,"_sideSize"),d(this,"_alphaSideSize"),d(this,"_distance"),this._distance=$,this._setQuality(X),this._initialize(J)}sample($){let J=$.getPointArray();for(let X=0,K=J.length;X<K;X++)this._addColor(J[X]);this._pixels=this._pixels.concat(J)}*quantize(){yield*this._preparePalette();let $=new q9;for(let J=0;J<this._colors;J++)if(this._sums[J]>0){let X=this._sums[J],K=this._reds[J]/X,q=this._greens[J]/X,Y=this._blues[J]/X,W=this._alphas[J]/X,Q=f6.createByRGBA(K|0,q|0,Y|0,W|0);$.add(Q)}$.sort(),yield{palette:$,progress:100}}*_preparePalette(){yield*this._calculateMoments();let $=0,J=i1(this._colors);for(let W=1;W<this._colors;++W){if(this._cut(this._cubes[$],this._cubes[W]))J[$]=this._cubes[$].volume>1?this._calculateVariance(this._cubes[$]):0,J[W]=this._cubes[W].volume>1?this._calculateVariance(this._cubes[W]):0;else J[$]=0,W--;$=0;let Q=J[0];for(let N=1;N<=W;++N)if(J[N]>Q)Q=J[N],$=N;if(Q<=0){this._colors=W+1;break}}let X=[],K=[],q=[],Y=[];for(let W=0;W<this._colors;++W){let Q=k0._volume(this._cubes[W],this._weights);if(Q>0)X[W]=k0._volume(this._cubes[W],this._momentsRed)/Q|0,K[W]=k0._volume(this._cubes[W],this._momentsGreen)/Q|0,q[W]=k0._volume(this._cubes[W],this._momentsBlue)/Q|0,Y[W]=k0._volume(this._cubes[W],this._momentsAlpha)/Q|0;else X[W]=0,K[W]=0,q[W]=0,Y[W]=0}this._reds=i1(this._colors+1),this._greens=i1(this._colors+1),this._blues=i1(this._colors+1),this._alphas=i1(this._colors+1),this._sums=i1(this._colors+1);for(let W=0,Q=this._pixels.length;W<Q;W++){let N=this._pixels[W],M=-1,V=-1,G=Number.MAX_VALUE;for(let H=0;H<this._colors;H++){let O=X[H],L=K[H],j=q[H],E=Y[H],B=this._distance.calculateRaw(O,L,j,E,N.r,N.g,N.b,N.a);if(B<G)G=B,V=H}this._reds[V]+=N.r,this._greens[V]+=N.g,this._blues[V]+=N.b,this._alphas[V]+=N.a,this._sums[V]++}}_addColor($){let J=8-this._significantBitsPerChannel,X=($.r>>J)+1,K=($.g>>J)+1,q=($.b>>J)+1,Y=($.a>>J)+1;this._weights[Y][X][K][q]++,this._momentsRed[Y][X][K][q]+=$.r,this._momentsGreen[Y][X][K][q]+=$.g,this._momentsBlue[Y][X][K][q]+=$.b,this._momentsAlpha[Y][X][K][q]+=$.a,this._moments[Y][X][K][q]+=this._table[$.r]+this._table[$.g]+this._table[$.b]+this._table[$.a]}*_calculateMoments(){let $=[],J=[],X=[],K=[],q=[],Y=[],W=a1(this._sideSize,this._sideSize,this._sideSize),Q=a1(this._sideSize,this._sideSize,this._sideSize),N=a1(this._sideSize,this._sideSize,this._sideSize),M=a1(this._sideSize,this._sideSize,this._sideSize),V=a1(this._sideSize,this._sideSize,this._sideSize),G=a1(this._sideSize,this._sideSize,this._sideSize),H=0,O=new u8(this._alphaMaxSideIndex*this._maxSideIndex,99);for(let L=1;L<=this._alphaMaxSideIndex;++L){t1(W,this._sideSize,this._sideSize,this._sideSize,0),t1(Q,this._sideSize,this._sideSize,this._sideSize,0),t1(N,this._sideSize,this._sideSize,this._sideSize,0),t1(M,this._sideSize,this._sideSize,this._sideSize,0),t1(V,this._sideSize,this._sideSize,this._sideSize,0),t1(G,this._sideSize,this._sideSize,this._sideSize,0);for(let j=1;j<=this._maxSideIndex;++j,++H){if(O.shouldNotify(H))yield{progress:O.progress};e1($,this._sideSize,0),e1(J,this._sideSize,0),e1(X,this._sideSize,0),e1(K,this._sideSize,0),e1(q,this._sideSize,0),e1(Y,this._sideSize,0);for(let E=1;E<=this._maxSideIndex;++E){let B=0,S=0,A=0,z=0,P=0,R=0;for(let U=1;U<=this._maxSideIndex;++U)B+=this._weights[L][j][E][U],S+=this._momentsRed[L][j][E][U],A+=this._momentsGreen[L][j][E][U],z+=this._momentsBlue[L][j][E][U],P+=this._momentsAlpha[L][j][E][U],R+=this._moments[L][j][E][U],$[U]+=B,J[U]+=S,X[U]+=A,K[U]+=z,q[U]+=P,Y[U]+=R,W[j][E][U]=W[j-1][E][U]+$[U],Q[j][E][U]=Q[j-1][E][U]+J[U],N[j][E][U]=N[j-1][E][U]+X[U],M[j][E][U]=M[j-1][E][U]+K[U],V[j][E][U]=V[j-1][E][U]+q[U],G[j][E][U]=G[j-1][E][U]+Y[U],this._weights[L][j][E][U]=this._weights[L-1][j][E][U]+W[j][E][U],this._momentsRed[L][j][E][U]=this._momentsRed[L-1][j][E][U]+Q[j][E][U],this._momentsGreen[L][j][E][U]=this._momentsGreen[L-1][j][E][U]+N[j][E][U],this._momentsBlue[L][j][E][U]=this._momentsBlue[L-1][j][E][U]+M[j][E][U],this._momentsAlpha[L][j][E][U]=this._momentsAlpha[L-1][j][E][U]+V[j][E][U],this._moments[L][j][E][U]=this._moments[L-1][j][E][U]+G[j][E][U]}}}}static _volumeFloat($,J){return J[$.alphaMaximum][$.redMaximum][$.greenMaximum][$.blueMaximum]-J[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMaximum]-J[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMaximum]+J[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMaximum]-J[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMaximum]+J[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMaximum]+J[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMaximum]-J[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMaximum]-(J[$.alphaMaximum][$.redMaximum][$.greenMaximum][$.blueMinimum]-J[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMinimum]-J[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMinimum]+J[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMinimum]-J[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMinimum]+J[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMinimum]+J[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMinimum]-J[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum])}static _volume($,J){return k0._volumeFloat($,J)|0}static _top($,J,X,K){let q;switch(J){case k0._alpha:q=K[X][$.redMaximum][$.greenMaximum][$.blueMaximum]-K[X][$.redMaximum][$.greenMinimum][$.blueMaximum]-K[X][$.redMinimum][$.greenMaximum][$.blueMaximum]+K[X][$.redMinimum][$.greenMinimum][$.blueMaximum]-(K[X][$.redMaximum][$.greenMaximum][$.blueMinimum]-K[X][$.redMaximum][$.greenMinimum][$.blueMinimum]-K[X][$.redMinimum][$.greenMaximum][$.blueMinimum]+K[X][$.redMinimum][$.greenMinimum][$.blueMinimum]);break;case k0._red:q=K[$.alphaMaximum][X][$.greenMaximum][$.blueMaximum]-K[$.alphaMaximum][X][$.greenMinimum][$.blueMaximum]-K[$.alphaMinimum][X][$.greenMaximum][$.blueMaximum]+K[$.alphaMinimum][X][$.greenMinimum][$.blueMaximum]-(K[$.alphaMaximum][X][$.greenMaximum][$.blueMinimum]-K[$.alphaMaximum][X][$.greenMinimum][$.blueMinimum]-K[$.alphaMinimum][X][$.greenMaximum][$.blueMinimum]+K[$.alphaMinimum][X][$.greenMinimum][$.blueMinimum]);break;case k0._green:q=K[$.alphaMaximum][$.redMaximum][X][$.blueMaximum]-K[$.alphaMaximum][$.redMinimum][X][$.blueMaximum]-K[$.alphaMinimum][$.redMaximum][X][$.blueMaximum]+K[$.alphaMinimum][$.redMinimum][X][$.blueMaximum]-(K[$.alphaMaximum][$.redMaximum][X][$.blueMinimum]-K[$.alphaMaximum][$.redMinimum][X][$.blueMinimum]-K[$.alphaMinimum][$.redMaximum][X][$.blueMinimum]+K[$.alphaMinimum][$.redMinimum][X][$.blueMinimum]);break;case k0._blue:q=K[$.alphaMaximum][$.redMaximum][$.greenMaximum][X]-K[$.alphaMaximum][$.redMaximum][$.greenMinimum][X]-K[$.alphaMaximum][$.redMinimum][$.greenMaximum][X]+K[$.alphaMaximum][$.redMinimum][$.greenMinimum][X]-(K[$.alphaMinimum][$.redMaximum][$.greenMaximum][X]-K[$.alphaMinimum][$.redMaximum][$.greenMinimum][X]-K[$.alphaMinimum][$.redMinimum][$.greenMaximum][X]+K[$.alphaMinimum][$.redMinimum][$.greenMinimum][X]);break;default:throw Error("impossible")}return q|0}static _bottom($,J,X){switch(J){case k0._alpha:return-X[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMaximum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMaximum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMaximum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMaximum]-(-X[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMinimum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMinimum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMinimum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum]);case k0._red:return-X[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMaximum]+X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMaximum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMaximum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMaximum]-(-X[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMinimum]+X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMinimum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMinimum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum]);case k0._green:return-X[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMaximum]+X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMaximum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMaximum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMaximum]-(-X[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMinimum]+X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMinimum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMinimum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum]);case k0._blue:return-X[$.alphaMaximum][$.redMaximum][$.greenMaximum][$.blueMinimum]+X[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMinimum]+X[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMinimum]-X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMinimum]-(-X[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMinimum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMinimum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMinimum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum]);default:return 0}}_calculateVariance($){let J=k0._volume($,this._momentsRed),X=k0._volume($,this._momentsGreen),K=k0._volume($,this._momentsBlue),q=k0._volume($,this._momentsAlpha),Y=k0._volumeFloat($,this._moments),W=k0._volume($,this._weights),Q=J*J+X*X+K*K+q*q;return Y-Q/W}_maximize($,J,X,K,q,Y,W,Q,N){let M=k0._bottom($,J,this._momentsRed)|0,V=k0._bottom($,J,this._momentsGreen)|0,G=k0._bottom($,J,this._momentsBlue)|0,H=k0._bottom($,J,this._momentsAlpha)|0,O=k0._bottom($,J,this._weights)|0,L=0,j=-1;for(let E=X;E<K;++E){let B=M+k0._top($,J,E,this._momentsRed),S=V+k0._top($,J,E,this._momentsGreen),A=G+k0._top($,J,E,this._momentsBlue),z=H+k0._top($,J,E,this._momentsAlpha),P=O+k0._top($,J,E,this._weights);if(P!==0){let R=B*B+S*S+A*A+z*z,U=R/P;if(B=q-B,S=Y-S,A=W-A,z=Q-z,P=N-P,P!==0){if(R=B*B+S*S+A*A+z*z,U+=R/P,U>L)L=U,j=E}}}return{max:L,position:j}}_cut($,J){let X,K=k0._volume($,this._momentsRed),q=k0._volume($,this._momentsGreen),Y=k0._volume($,this._momentsBlue),W=k0._volume($,this._momentsAlpha),Q=k0._volume($,this._weights),N=this._maximize($,k0._red,$.redMinimum+1,$.redMaximum,K,q,Y,W,Q),M=this._maximize($,k0._green,$.greenMinimum+1,$.greenMaximum,K,q,Y,W,Q),V=this._maximize($,k0._blue,$.blueMinimum+1,$.blueMaximum,K,q,Y,W,Q),G=this._maximize($,k0._alpha,$.alphaMinimum+1,$.alphaMaximum,K,q,Y,W,Q);if(G.max>=N.max&&G.max>=M.max&&G.max>=V.max){if(X=k0._alpha,G.position<0)return!1}else if(N.max>=G.max&&N.max>=M.max&&N.max>=V.max)X=k0._red;else if(M.max>=G.max&&M.max>=N.max&&M.max>=V.max)X=k0._green;else X=k0._blue;switch(J.redMaximum=$.redMaximum,J.greenMaximum=$.greenMaximum,J.blueMaximum=$.blueMaximum,J.alphaMaximum=$.alphaMaximum,X){case k0._red:J.redMinimum=$.redMaximum=N.position,J.greenMinimum=$.greenMinimum,J.blueMinimum=$.blueMinimum,J.alphaMinimum=$.alphaMinimum;break;case k0._green:J.greenMinimum=$.greenMaximum=M.position,J.redMinimum=$.redMinimum,J.blueMinimum=$.blueMinimum,J.alphaMinimum=$.alphaMinimum;break;case k0._blue:J.blueMinimum=$.blueMaximum=V.position,J.redMinimum=$.redMinimum,J.greenMinimum=$.greenMinimum,J.alphaMinimum=$.alphaMinimum;break;case k0._alpha:J.alphaMinimum=$.alphaMaximum=G.position,J.blueMinimum=$.blueMinimum,J.redMinimum=$.redMinimum,J.greenMinimum=$.greenMinimum;break}return $.volume=($.redMaximum-$.redMinimum)*($.greenMaximum-$.greenMinimum)*($.blueMaximum-$.blueMinimum)*($.alphaMaximum-$.alphaMinimum),J.volume=(J.redMaximum-J.redMinimum)*(J.greenMaximum-J.greenMinimum)*(J.blueMaximum-J.blueMinimum)*(J.alphaMaximum-J.alphaMinimum),!0}_initialize($){this._colors=$,this._cubes=[];for(let J=0;J<$;J++)this._cubes[J]=new RK;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=s1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=s1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=s1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=s1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=s1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=s1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(let J=0;J<256;++J)this._table[J]=J*J;this._pixels=[]}_setQuality($=5){this._significantBitsPerChannel=$,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1}},$5=k0;d($5,"_alpha",3);d($5,"_red",2);d($5,"_green",1);d($5,"_blue",0);var BK={};F8(BK,{AbstractImageQuantizer:()=>N$,ErrorDiffusionArray:()=>A8,ErrorDiffusionArrayKernel:()=>SK,ErrorDiffusionRiemersma:()=>b7,NearestColor:()=>PK});var N$=class{quantizeSync($,J){for(let X of this.quantize($,J))if(X.pointContainer)return X.pointContainer;throw Error("unreachable")}},PK=class extends N${constructor($){super();d(this,"_distance"),this._distance=$}*quantize($,J){let X=$.getPointArray(),K=$.getWidth(),q=$.getHeight(),Y=new u8(q,99);for(let W=0;W<q;W++){if(Y.shouldNotify(W))yield{progress:Y.progress};for(let Q=0,N=W*K;Q<K;Q++,N++){let M=X[N];M.from(J.getNearestColor(this._distance,M))}}yield{pointContainer:$,progress:100}}},SK=(($)=>{return $[$.FloydSteinberg=0]="FloydSteinberg",$[$.FalseFloydSteinberg=1]="FalseFloydSteinberg",$[$.Stucki=2]="Stucki",$[$.Atkinson=3]="Atkinson",$[$.Jarvis=4]="Jarvis",$[$.Burkes=5]="Burkes",$[$.Sierra=6]="Sierra",$[$.TwoSierra=7]="TwoSierra",$[$.SierraLite=8]="SierraLite",$})(SK||{}),A8=class extends N${constructor($,J,X=!0,K=0,q=!1){super();d(this,"_minColorDistance"),d(this,"_serpentine"),d(this,"_kernel"),d(this,"_calculateErrorLikeGIMP"),d(this,"_distance"),this._setKernel(J),this._distance=$,this._minColorDistance=K,this._serpentine=X,this._calculateErrorLikeGIMP=q}*quantize($,J){let X=$.getPointArray(),K=new f6,q=$.getWidth(),Y=$.getHeight(),W=[],Q=1,N=1;for(let V of this._kernel){let G=V[2]+1;if(N<G)N=G}for(let V=0;V<N;V++)this._fillErrorLine(W[V]=[],q);let M=new u8(Y,99);for(let V=0;V<Y;V++){if(M.shouldNotify(V))yield{progress:M.progress};if(this._serpentine)Q*=-1;let G=V*q,H=Q===1?0:q-1,O=Q===1?q:-1;this._fillErrorLine(W[0],q),W.push(W.shift());let L=W[0];for(let j=H,E=G+H;j!==O;j+=Q,E+=Q){let B=X[E],S=L[j];K.from(B);let A=f6.createByRGBA(r6(B.r+S[0]),r6(B.g+S[1]),r6(B.b+S[2]),r6(B.a+S[3])),z=J.getNearestColor(this._distance,A);if(B.from(z),this._minColorDistance){if(this._distance.calculateNormalized(K,z)<this._minColorDistance)continue}let P,R,U,C;if(this._calculateErrorLikeGIMP)P=A.r-z.r,R=A.g-z.g,U=A.b-z.b,C=A.a-z.a;else P=K.r-z.r,R=K.g-z.g,U=K.b-z.b,C=K.a-z.a;let k=Q===1?0:this._kernel.length-1,h=Q===1?this._kernel.length:-1;for(let F=k;F!==h;F+=Q){let v=this._kernel[F][1]*Q,D=this._kernel[F][2];if(v+j>=0&&v+j<q&&D+V>=0&&D+V<Y){let w=this._kernel[F][0],x=W[D][v+j];x[0]+=P*w,x[1]+=R*w,x[2]+=U*w,x[3]+=C*w}}}}yield{pointContainer:$,progress:100}}_fillErrorLine($,J){if($.length>J)$.length=J;let X=$.length;for(let K=0;K<X;K++){let q=$[K];q[0]=q[1]=q[2]=q[3]=0}for(let K=X;K<J;K++)$[K]=[0,0,0,0]}_setKernel($){switch($){case 0:this._kernel=[[0.4375,1,0],[0.1875,-1,1],[0.3125,0,1],[0.0625,1,1]];break;case 1:this._kernel=[[0.375,1,0],[0.375,0,1],[0.25,1,1]];break;case 2:this._kernel=[[0.19047619047619047,1,0],[0.09523809523809523,2,0],[0.047619047619047616,-2,1],[0.09523809523809523,-1,1],[0.19047619047619047,0,1],[0.09523809523809523,1,1],[0.047619047619047616,2,1],[0.023809523809523808,-2,2],[0.047619047619047616,-1,2],[0.09523809523809523,0,2],[0.047619047619047616,1,2],[0.023809523809523808,2,2]];break;case 3:this._kernel=[[0.125,1,0],[0.125,2,0],[0.125,-1,1],[0.125,0,1],[0.125,1,1],[0.125,0,2]];break;case 4:this._kernel=[[0.14583333333333334,1,0],[0.10416666666666667,2,0],[0.0625,-2,1],[0.10416666666666667,-1,1],[0.14583333333333334,0,1],[0.10416666666666667,1,1],[0.0625,2,1],[0.020833333333333332,-2,2],[0.0625,-1,2],[0.10416666666666667,0,2],[0.0625,1,2],[0.020833333333333332,2,2]];break;case 5:this._kernel=[[0.25,1,0],[0.125,2,0],[0.0625,-2,1],[0.125,-1,1],[0.25,0,1],[0.125,1,1],[0.0625,2,1]];break;case 6:this._kernel=[[0.15625,1,0],[0.09375,2,0],[0.0625,-2,1],[0.125,-1,1],[0.15625,0,1],[0.125,1,1],[0.0625,2,1],[0.0625,-1,2],[0.09375,0,2],[0.0625,1,2]];break;case 7:this._kernel=[[0.25,1,0],[0.1875,2,0],[0.0625,-2,1],[0.125,-1,1],[0.1875,0,1],[0.125,1,1],[0.0625,2,1]];break;case 8:this._kernel=[[0.5,1,0],[0.25,-1,1],[0.25,0,1]];break;default:throw Error(`ErrorDiffusionArray: unknown kernel = ${$}`)}}};function*bG($,J,X){let K=Math.max($,J),q=Math.floor(Math.log(K)/Math.log(2)+1),Y=new u8($*J,99),W={width:$,height:J,level:q,callback:X,tracker:Y,index:0,x:0,y:0};yield*E6(W,1),h6(W,0)}function*E6($,J){if($.level<1)return;if($.tracker.shouldNotify($.index))yield{progress:$.tracker.progress};switch($.level--,J){case 2:yield*E6($,1),h6($,3),yield*E6($,2),h6($,4),yield*E6($,2),h6($,2),yield*E6($,4);break;case 3:yield*E6($,4),h6($,2),yield*E6($,3),h6($,1),yield*E6($,3),h6($,3),yield*E6($,1);break;case 1:yield*E6($,2),h6($,4),yield*E6($,1),h6($,3),yield*E6($,1),h6($,1),yield*E6($,3);break;case 4:yield*E6($,3),h6($,1),yield*E6($,4),h6($,2),yield*E6($,4),h6($,4),yield*E6($,2);break;default:break}$.level++}function h6($,J){if($.x>=0&&$.x<$.width&&$.y>=0&&$.y<$.height)$.callback($.x,$.y),$.index++;switch(J){case 2:$.x--;break;case 3:$.x++;break;case 1:$.y--;break;case 4:$.y++;break}}var b7=class extends N${constructor($,J=16,X=1){super();d(this,"_distance"),d(this,"_weights"),d(this,"_errorQueueSize"),this._distance=$,this._errorQueueSize=J,this._weights=b7._createWeights(X,J)}*quantize($,J){let X=$.getPointArray(),K=$.getWidth(),q=$.getHeight(),Y=[],W=0;for(let Q=0;Q<this._errorQueueSize;Q++)Y[Q]={r:0,g:0,b:0,a:0};yield*bG(K,q,(Q,N)=>{let M=X[Q+N*K],{r:V,g:G,b:H,a:O}=M;for(let B=0;B<this._errorQueueSize;B++){let S=this._weights[B],A=Y[(B+W)%this._errorQueueSize];V+=A.r*S,G+=A.g*S,H+=A.b*S,O+=A.a*S}let L=f6.createByRGBA(r6(V),r6(G),r6(H),r6(O)),j=J.getNearestColor(this._distance,L);W=(W+1)%this._errorQueueSize;let E=(W+this._errorQueueSize-1)%this._errorQueueSize;Y[E].r=M.r-j.r,Y[E].g=M.g-j.g,Y[E].b=M.b-j.b,Y[E].a=M.a-j.a,M.from(j)}),yield{pointContainer:$,progress:100}}static _createWeights($,J){let X=[],K=Math.exp(Math.log(J)/(J-1));for(let q=0,Y=1;q<J;q++)X[q]=(Y+0.5|0)/J*$,Y*=K;return X}},AK={};F8(AK,{ssim:()=>uG});var mG=0.01,pG=0.03;function uG($,J){if($.getHeight()!==J.getHeight()||$.getWidth()!==J.getWidth())throw Error("Images have different sizes!");let K=255,q=(mG*K)**2,Y=(pG*K)**2,W=0,Q=0;return lG($,J,(N,M,V,G)=>{let H=0,O=0,L=0;for(let A=0;A<N.length;A++)O+=(N[A]-V)**2,L+=(M[A]-G)**2,H+=(N[A]-V)*(M[A]-G);let j=N.length-1;O/=j,L/=j,H/=j;let E=(2*V*G+q)*(2*H+Y),B=(V**2+G**2+q)*(O+L+Y),S=E/B;Q+=S,W++}),Q/W}function lG($,J,X){let q=$.getWidth(),Y=$.getHeight();for(let W=0;W<Y;W+=8)for(let Q=0;Q<q;Q+=8){let N=Math.min(8,q-Q),M=Math.min(8,Y-W),V=bX($,Q,W,N,M),G=bX(J,Q,W,N,M),H=mX(V),O=mX(G);X(V,G,H,O)}}function bX($,J,X,K,q){let Y=$.getPointArray(),W=[],Q=0;for(let N=X;N<X+q;N++){let M=N*$.getWidth();for(let V=J;V<J+K;V++){let G=Y[M+V];W[Q]=G.r*0.2126+G.g*0.7152+G.b*0.0722,Q++}}return W}function mX($){let J=0;for(let X of $)J+=X;return J/$.length}var q$=typeof setImmediate==="function"?setImmediate:typeof process<"u"&&typeof(process==null?void 0:process.nextTick)==="function"?($)=>process.nextTick($):($)=>setTimeout($,0);function cG($,{colorDistanceFormula:J,paletteQuantization:X,colors:K}={}){let q=M$(J),Y=zK(q,X,K);return $.forEach((W)=>Y.sample(W)),Y.quantizeSync()}async function dG($,{colorDistanceFormula:J,paletteQuantization:X,colors:K,onProgress:q}={}){return new Promise((Y,W)=>{let Q=M$(J),N=zK(Q,X,K);$.forEach((H)=>N.sample(H));let M,V=N.quantize(),G=()=>{try{let H=V.next();if(H.done)Y(M);else{if(H.value.palette)M=H.value.palette;if(q)q(H.value.progress);q$(G)}}catch(H){W(H)}};q$(G)})}function nG($,J,{colorDistanceFormula:X,imageQuantization:K}={}){let q=M$(X);return FK(q,K).quantizeSync($,J)}async function oG($,J,{colorDistanceFormula:X,imageQuantization:K,onProgress:q}={}){return new Promise((Y,W)=>{let Q=M$(X),N=FK(Q,K),M,V=N.quantize($,J),G=()=>{try{let H=V.next();if(H.done)Y(M);else{if(H.value.pointContainer)M=H.value.pointContainer;if(q)q(H.value.progress);q$(G)}}catch(H){W(H)}};q$(G)})}function M$($="euclidean-bt709"){switch($){case"cie94-graphic-arts":return new qK;case"cie94-textiles":return new KK;case"ciede2000":return new Q8;case"color-metric":return new YK;case"euclidean":return new WK;case"euclidean-bt709":return new QK;case"euclidean-bt709-noalpha":return new NK;case"manhattan":return new MK;case"manhattan-bt709":return new GK;case"manhattan-nommyde":return new VK;case"pngquant":return new HK;default:throw Error(`Unknown colorDistanceFormula ${$}`)}}function FK($,J="floyd-steinberg"){switch(J){case"nearest":return new PK($);case"riemersma":return new b7($);case"floyd-steinberg":return new A8($,0);case"false-floyd-steinberg":return new A8($,1);case"stucki":return new A8($,2);case"atkinson":return new A8($,3);case"jarvis":return new A8($,4);case"burkes":return new A8($,5);case"sierra":return new A8($,6);case"two-sierra":return new A8($,7);case"sierra-lite":return new A8($,8);default:throw Error(`Unknown imageQuantization ${J}`)}}function zK($,J="wuquant",X=256){switch(J){case"neuquant":return new q6($,X);case"rgbquant":return new jK($,X);case"wuquant":return new $5($,X);case"neuquant-float":return new Y6($,X);default:throw Error(`Unknown paletteQuantization ${J}`)}}vK.exports=CG(pX)});var V$=L0((rG)=>{var ZK=X$(),{GifError:EA}=$9();class K1 extends ZK{constructor(...$){super(...$);if($[0]instanceof K1){let J=$[0];this.xOffset=J.xOffset,this.yOffset=J.yOffset,this.disposalMethod=J.disposalMethod,this.delayCentisecs=J.delayCentisecs,this.interlaced=J.interlaced}else{let J=$[$.length-1],X={};if(typeof J==="object"&&!(J instanceof ZK))X=J;this.xOffset=X.xOffset||0,this.yOffset=X.yOffset||0,this.disposalMethod=X.disposalMethod!==void 0?X.disposalMethod:K1.DisposeToBackgroundColor,this.delayCentisecs=X.delayCentisecs||8,this.interlaced=X.interlaced||!1}}getPalette(){let $=new Set,J=this.bitmap.data,X=0,K=!1;while(X<J.length){if(J[X+3]===0)K=!0;else{let Q=J.readUInt32BE(X,!0)>>8&16777215;$.add(Q)}X+=4}let q=Array($.size),Y=$.values();for(X=0;X<q.length;++X)q[X]=Y.next().value;q.sort((Q,N)=>Q-N);let W=q.length;if(K)++W;return{colors:q,usesTransparency:K,indexCount:W}}}K1.DisposeToAnything=0;K1.DisposeNothing=1;K1.DisposeToBackgroundColor=2;K1.DisposeToPrevious=3;rG.GifFrame=K1});var p7=L0((KH)=>{var DK=O6("fs"),J5=CK(),sG=X$(),{GifFrame:aG}=V$(),{GifError:tG}=$9(),{GifCodec:eG}=u7(),$H=[".jpg",".jpeg",".png",".bmp"],kK=new eG;KH.cloneFrames=function($){let J=[];return $.forEach((X)=>{J.push(new aG(X))}),J};KH.getColorInfo=function($,J){let X=!1,K=[];for(let N=0;N<$.length;++N){let M=$[N].getPalette();if(M.usesTransparency)X=!0;if(M.indexCount>256)throw new tG(`Frame ${N} uses more than 256 color indexes`);K.push(M)}if(J===0)return{usesTransparency:X,palettes:K};let q=new Set;K.forEach((N)=>{N.colors.forEach((M)=>{q.add(M)})});let Y=q.size;if(X)++Y;if(J&&Y>J)return{usesTransparency:X,palettes:K};let W=Array(q.size),Q=q.values();for(let N=0;N<W.length;++N)W[N]=Q.next().value;return W.sort((N,M)=>N-M),{colors:W,indexCount:Y,usesTransparency:X,palettes:K}};KH.copyAsJimp=function($,J){return KH.shareAsJimp($,new sG(J))};KH.getMaxDimensions=function($){let J=0,X=0;return $.forEach((K)=>{let q=K.xOffset+K.bitmap.width;if(q>J)J=q;let Y=K.yOffset+K.bitmap.height;if(Y>X)X=Y}),{maxWidth:J,maxHeight:X}};KH.quantizeDekker=function($,J,X){J=J||256,m7($,"NeuQuantFloat",J,0,X)};KH.quantizeSorokin=function($,J,X,K){J=J||256,X=X||"min-pop";let q;switch(X){case"min-pop":q=2;break;case"top-pop":q=1;break;default:throw Error(`Invalid quantizeSorokin histogram '${X}'`)}m7($,"RGBQuant",J,q,K)};KH.quantizeWu=function($,J,X,K){if(J=J||256,X=X||5,X<1||X>8)throw Error("Invalid quantization quality");m7($,"WuQuant",J,X,K)};KH.read=function($,J){if(J=J||kK,Buffer.isBuffer($))return J.decodeGif($);return JH($).then((X)=>{return J.decodeGif(X)})};KH.shareAsJimp=function($,J){let X=new $(J.bitmap.width,J.bitmap.height,0);return X.bitmap.data=J.bitmap.data,X};KH.write=function($,J,X,K){K=K||kK;let q=$.match(/\.[a-zA-Z]+$/);if(q!==null&&$H.includes(q[0].toLowerCase()))throw Error(`GIF '${$}' has an unexpected suffix`);return K.encodeGif(J,X).then((Y)=>{return XH($,Y.buffer).then(()=>{return Y})})};function m7($,J,X,K,q){let Y=Array.isArray($)?$:[$],W=["FloydSteinberg","FalseFloydSteinberg","Stucki","Atkinson","Jarvis","Burkes","Sierra","TwoSierra","SierraLite"];if(q){if(W.indexOf(q.ditherAlgorithm)<0)throw Error(`Invalid ditherAlgorithm '${q.ditherAlgorithm}'`);if(q.serpentine===void 0)q.serpentine=!0;if(q.minimumColorDistanceToDither===void 0)q.minimumColorDistanceToDither=0;if(q.calculateErrorLikeGIMP===void 0)q.calculateErrorLikeGIMP=!1}let Q=new J5.distance.Euclidean,N=new J5.palette[J](Q,X,K),M;if(q)M=new J5.image.ErrorDiffusionArray(Q,J5.image.ErrorDiffusionArrayKernel[q.ditherAlgorithm],q.serpentine,q.minimumColorDistanceToDither,q.calculateErrorLikeGIMP);else M=new J5.image.NearestColor(Q);let V=[];Y.forEach((H)=>{let O=H.bitmap.data,L=new ArrayBuffer(O.length),j=new Uint32Array(L);for(let B=0,S=0;B<O.length;B+=4,++S)j[S]=O.readUInt32LE(B,!0);let E=J5.utils.PointContainer.fromUint32Array(j,H.bitmap.width,H.bitmap.height);N.sample(E),V.push(E)});let G=N.quantizeSync();for(let H=0;H<Y.length;++H){let O=Y[H].bitmap.data,j=M.quantizeSync(V[H],G).toUint32Array();for(let E=0,B=0;E<O.length;E+=4,++B)O.writeUInt32LE(j[B],E)}}function JH($){return new Promise((J,X)=>{DK.readFile($,(K,q)=>{if(K)return X(K);return J(q)})})}function XH($,J){return new Promise((X,K)=>{DK.writeFile($,J,(q)=>{if(q)return K(q);return X()})})}});var u7=L0((SH)=>{var l7=I7(),{Gif:q1,GifError:l8}=$9();function G$(){let $=p7();return G$=function(){return $},$}var{GifFrame:UH}=V$(),wK=200,LH=100;class _K{constructor($={}){if(this._transparentRGB=null,typeof $.transparentRGB==="number"&&$.transparentRGB!==0)this._transparentRGBA=$.transparentRGB*256;this._testInitialBufferSize=0}decodeGif($){try{let J;try{J=new l7.GifReader($)}catch(Y){throw new l8(Y)}let X=J.numFrames(),K=[],q={width:J.width,height:J.height,loops:J.loopCount()};q.usesTransparency=!1;for(let Y=0;Y<X;++Y){let W=this._decodeFrame(J,Y,q.usesTransparency);if(K.push(W.frame),W.usesTransparency)q.usesTransparency=!0}return Promise.resolve(new q1($,K,q))}catch(J){return Promise.reject(J)}}encodeGif($,J={}){try{if($===null||$.length===0)throw new l8("there are no frames");let X=G$().getMaxDimensions($);if(J=Object.assign({},J),J.width=X.maxWidth,J.height=X.maxHeight,J.loops===void 0)J.loops=0;return J.colorScope=J.colorScope||q1.GlobalColorsPreferred,Promise.resolve(this._encodeGif($,J))}catch(X){return Promise.reject(X)}}_decodeFrame($,J,X){let K,q;try{if(K=$.frameInfo(J),q=new Buffer($.width*$.height*4),$.decodeAndBlitFrameRGBA(J,q),K.width!==$.width||K.height!==$.height){if(K.y)q=q.slice(K.y*$.width*4);if($.width>K.width)for(let Q=0;Q<K.height;++Q)q.copy(q,Q*K.width*4,(K.x+Q*$.width)*4,(K.x+Q*$.width)*4+K.width*4);q=q.slice(0,K.width*K.height*4)}}catch(Q){throw new l8(Q)}let Y=!1;if(this._transparentRGBA===null){if(!X){for(let Q=3;Q<q.length;Q+=4)if(q[Q]===0)Y=!0,Q=q.length}}else for(let Q=3;Q<q.length;Q+=4)if(q[Q]===0)q.writeUInt32BE(this._transparentRGBA,Q-3),Y=!0;return{frame:new UH(K.width,K.height,q,{xOffset:K.x,yOffset:K.y,disposalMethod:K.disposal,interlaced:K.interlaced,delayCentisecs:K.delay}),usesTransparency:Y}}_encodeGif($,J){let X;if(J.colorScope===q1.LocalColorsOnly)X=G$().getColorInfo($,0);else if(X=G$().getColorInfo($,256),!X.colors){if(J.colorScope===q1.GlobalColorsOnly)throw new l8("Too many color indexes for global color table");J.colorScope=q1.LocalColorsOnly}J.usesTransparency=X.usesTransparency;let K=X.palettes;if(J.colorScope===q1.LocalColorsOnly)return BH($,J,2000,K);return RH($,J,2000,X)}_getSizeEstimateGlobal($,J){if(this._testInitialBufferSize>0)return this._testInitialBufferSize;let X=wK+768,K=IK($);return J.forEach((q)=>{X+=TK(q,K)}),X}_getSizeEstimateLocal($,J){if(this._testInitialBufferSize>0)return this._testInitialBufferSize;let X=wK;for(let K=0;K<J.length;++K){let q=$[K],Y=IK(q);X+=TK(J[K],Y)}return X}}SH.GifCodec=_K;function EH($,J){let X=$.indexOf(J);return X===-1?null:X}function jH($,J){var X=0,K=$.length-1,q;while(X<=K)if(q=Math.floor((X+K)/2),$[q]>J)K=q-1;else if($[q]<J)X=q+1;else return q;return null}function RH($,J,X,K){let q={colors:K.colors.slice(),usesTransparency:K.usesTransparency};yK(q);let Y={palette:q.colors,loop:J.loops},W=new Buffer(X),Q;try{Q=new l7.GifWriter(W,J.width,J.height,Y)}catch(N){throw new l8(N)}for(let N=0;N<$.length;++N)W=xK(Q,N,$[N],K,!1);return new q1(W.slice(0,Q.end()),$,J)}function BH($,J,X,K){let q={loop:J.loops},Y=new Buffer(X),W;try{W=new l7.GifWriter(Y,J.width,J.height,q)}catch(Q){throw new l8(Q)}for(let Q=0;Q<$.length;++Q)Y=xK(W,Q,$[Q],K[Q],!0);return new q1(Y.slice(0,W.end()),$,J)}function yK($){let J=$.colors;if($.usesTransparency)J.push(0);let X=J.length,K=2;while(X>K)K<<=1;J.length=K,J.fill(0,X)}function TK($,J){let X=$.bitmap.width*$.bitmap.height;return X=Math.ceil(X*J/8),X+=Math.ceil(X/255),LH+X+768}function PH($,J,X){let K=X.colors,q=K.length<=8?EH:jH,Y=J.bitmap.data,W=new Buffer(Y.length/4),Q=K.length,N=0,M=0;while(N<Y.length){if(Y[N+3]!==0){let V=Y.readUInt32BE(N,!0)>>8&16777215;W[M]=q(K,V)}else W[M]=Q;N+=4,++M}if(X.usesTransparency){if(Q===256)throw new l8(`Frame ${$} already has 256 colorsand so can't use transparency`)}else Q=null;return{buffer:W,transparentIndex:Q}}function IK($){let J=$.indexCount,X=0;--J;while(J)++X,J>>=1;return X>0?X:1}function xK($,J,X,K,q){if(X.interlaced)throw new l8("writing interlaced GIFs is not supported");let Y=PH(J,X,K),W={delay:X.delayCentisecs,disposal:X.disposalMethod,transparent:Y.transparentIndex};if(q)yK(K),W.palette=K.colors;try{let Q=$.getOutputBuffer(),N=$.getOutputBufferPosition(),M,V=!0;while(V)if(M=$.addFrame(X.xOffset,X.yOffset,X.bitmap.width,X.bitmap.height,Y.buffer,W),V=!1,M>=Q.length-1){let G=new Buffer(Q.length*1.5);Q.copy(G),$.setOutputBuffer(G),$.setOutputBufferPosition(N),Q=G,V=!0}return Q}catch(Q){throw new l8(Q)}}});var gK=L0((PA,hK)=>{var FH=X$(),{Gif:zH,GifError:vH}=$9(),{GifCodec:CH}=u7(),{GifFrame:ZH}=V$(),DH=p7();hK.exports={BitmapImage:FH,Gif:zH,GifCodec:CH,GifFrame:ZH,GifUtil:DH,GifError:vH}});var pK=L0((AA,O$)=>{var mK=mK||function($){return Buffer.from($).toString("base64")};function kH($){var J=this,X=Math.round,K=Math.floor,q=Array(64),Y=Array(64),W=Array(64),Q=Array(64),N,M,V,G,H=Array(65535),O=Array(65535),L=Array(64),j=Array(64),E=[],B=0,S=7,A=Array(64),z=Array(64),P=Array(64),R=Array(256),U=Array(2048),C,k=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],h=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],F=[0,1,2,3,4,5,6,7,8,9,10,11],v=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],D=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],w=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],x=[0,1,2,3,4,5,6,7,8,9,10,11],y=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],b=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function _(u){var M0=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99];for(var q0=0;q0<64;q0++){var V0=K((M0[q0]*u+50)/100);if(V0<1)V0=1;else if(V0>255)V0=255;q[k[q0]]=V0}var O0=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99];for(var j0=0;j0<64;j0++){var F0=K((O0[j0]*u+50)/100);if(F0<1)F0=1;else if(F0>255)F0=255;Y[k[j0]]=F0}var v0=[1,1.387039845,1.306562965,1.175875602,1,0.785694958,0.5411961,0.275899379],A0=0;for(var T0=0;T0<8;T0++)for(var Y0=0;Y0<8;Y0++)W[A0]=1/(q[k[A0]]*v0[T0]*v0[Y0]*8),Q[A0]=1/(Y[k[A0]]*v0[T0]*v0[Y0]*8),A0++}function m(u,M0){var q0=0,V0=0,O0=[];for(var j0=1;j0<=16;j0++){for(var F0=1;F0<=u[j0];F0++)O0[M0[V0]]=[],O0[M0[V0]][0]=q0,O0[M0[V0]][1]=j0,V0++,q0++;q0*=2}return O0}function t(){N=m(h,F),M=m(w,x),V=m(v,D),G=m(y,b)}function l(){var u=1,M0=2;for(var q0=1;q0<=15;q0++){for(var V0=u;V0<M0;V0++)O[32767+V0]=q0,H[32767+V0]=[],H[32767+V0][1]=q0,H[32767+V0][0]=V0;for(var O0=-(M0-1);O0<=-u;O0++)O[32767+O0]=q0,H[32767+O0]=[],H[32767+O0][1]=q0,H[32767+O0][0]=M0-1+O0;u<<=1,M0<<=1}}function s(){for(var u=0;u<256;u++)U[u]=19595*u,U[u+256>>0]=38470*u,U[u+512>>0]=7471*u+32768,U[u+768>>0]=-11059*u,U[u+1024>>0]=-21709*u,U[u+1280>>0]=32768*u+8421375,U[u+1536>>0]=-27439*u,U[u+1792>>0]=-5329*u}function g(u){var M0=u[0],q0=u[1]-1;while(q0>=0){if(M0&1<<q0)B|=1<<S;if(q0--,S--,S<0){if(B==255)Z(255),Z(0);else Z(B);S=7,B=0}}}function Z(u){E.push(u)}function T(u){Z(u>>8&255),Z(u&255)}function c(u,M0){var q0,V0,O0,j0,F0,v0,A0,T0,Y0=0,J0,N0=8,g0=64;for(J0=0;J0<N0;++J0){q0=u[Y0],V0=u[Y0+1],O0=u[Y0+2],j0=u[Y0+3],F0=u[Y0+4],v0=u[Y0+5],A0=u[Y0+6],T0=u[Y0+7];var z0=q0+T0,I0=q0-T0,d0=V0+A0,W0=V0-A0,R0=O0+v0,Z0=O0-v0,_0=j0+F0,f0=j0-F0,s0=z0+_0,y0=z0-_0,i0=d0+R0,t0=d0-R0;u[Y0]=s0+i0,u[Y0+4]=s0-i0;var F6=(t0+y0)*0.707106781;u[Y0+2]=y0+F6,u[Y0+6]=y0-F6,s0=f0+Z0,i0=Z0+W0,t0=W0+I0;var L6=(s0-t0)*0.382683433,w6=0.5411961*s0+L6,X8=1.306562965*t0+L6,R8=i0*0.707106781,x8=I0+R8,B8=I0-R8;u[Y0+5]=B8+w6,u[Y0+3]=B8-w6,u[Y0+1]=x8+X8,u[Y0+7]=x8-X8,Y0+=8}Y0=0;for(J0=0;J0<N0;++J0){q0=u[Y0],V0=u[Y0+8],O0=u[Y0+16],j0=u[Y0+24],F0=u[Y0+32],v0=u[Y0+40],A0=u[Y0+48],T0=u[Y0+56];var l5=q0+T0,c5=q0-T0,p9=V0+A0,u9=V0-A0,l9=O0+v0,K8=O0-v0,F1=j0+F0,Y7=j0-F0,z1=l5+F1,n1=l5-F1,v1=p9+l9,C1=p9-l9;u[Y0]=z1+v1,u[Y0+32]=z1-v1;var d5=(C1+n1)*0.707106781;u[Y0+16]=n1+d5,u[Y0+48]=n1-d5,z1=Y7+K8,v1=K8+u9,C1=u9+c5;var n5=(z1-C1)*0.382683433,_4=0.5411961*z1+n5,y4=1.306562965*C1+n5,x4=v1*0.707106781,h4=c5+x4,g4=c5-x4;u[Y0+40]=g4+_4,u[Y0+24]=g4-_4,u[Y0+8]=h4+y4,u[Y0+56]=h4-y4,Y0++}var c9;for(J0=0;J0<g0;++J0)c9=u[J0]*M0[J0],L[J0]=c9>0?c9+0.5|0:c9-0.5|0;return L}function o(){T(65504),T(16),Z(74),Z(70),Z(73),Z(70),Z(0),Z(1),Z(1),Z(0),T(1),T(1),Z(0),Z(0)}function $0(u){if(!u)return;if(T(65505),u[0]===69&&u[1]===120&&u[2]===105&&u[3]===102)T(u.length+2);else T(u.length+5+2),Z(69),Z(120),Z(105),Z(102),Z(0);for(var M0=0;M0<u.length;M0++)Z(u[M0])}function a(u,M0){T(65472),T(17),Z(8),T(M0),T(u),Z(3),Z(1),Z(17),Z(0),Z(2),Z(17),Z(1),Z(3),Z(17),Z(1)}function e(){T(65499),T(132),Z(0);for(var u=0;u<64;u++)Z(q[u]);Z(1);for(var M0=0;M0<64;M0++)Z(Y[M0])}function r(){T(65476),T(418),Z(0);for(var u=0;u<16;u++)Z(h[u+1]);for(var M0=0;M0<=11;M0++)Z(F[M0]);Z(16);for(var q0=0;q0<16;q0++)Z(v[q0+1]);for(var V0=0;V0<=161;V0++)Z(D[V0]);Z(1);for(var O0=0;O0<16;O0++)Z(w[O0+1]);for(var j0=0;j0<=11;j0++)Z(x[j0]);Z(17);for(var F0=0;F0<16;F0++)Z(y[F0+1]);for(var v0=0;v0<=161;v0++)Z(b[v0])}function p(u){if(typeof u>"u"||u.constructor!==Array)return;u.forEach((M0)=>{if(typeof M0!=="string")return;T(65534);var q0=M0.length;T(q0+2);var V0;for(V0=0;V0<q0;V0++)Z(M0.charCodeAt(V0))})}function i(){T(65498),T(12),Z(3),Z(1),Z(0),Z(2),Z(17),Z(3),Z(17),Z(0),Z(63),Z(0)}function X0(u,M0,q0,V0,O0){var j0=O0[0],F0=O0[240],v0,A0=16,T0=63,Y0=64,J0=c(u,M0);for(var N0=0;N0<Y0;++N0)j[k[N0]]=J0[N0];var g0=j[0]-q0;if(q0=j[0],g0==0)g(V0[0]);else v0=32767+g0,g(V0[O[v0]]),g(H[v0]);var z0=63;for(;z0>0&&j[z0]==0;z0--);if(z0==0)return g(j0),q0;var I0=1,d0;while(I0<=z0){var W0=I0;for(;j[I0]==0&&I0<=z0;++I0);var R0=I0-W0;if(R0>=A0){d0=R0>>4;for(var Z0=1;Z0<=d0;++Z0)g(F0);R0=R0&15}v0=32767+j[I0],g(O0[(R0<<4)+O[v0]]),g(H[v0]),I0++}if(z0!=T0)g(j0);return q0}function K0(){var u=String.fromCharCode;for(var M0=0;M0<256;M0++)R[M0]=u(M0)}this.encode=function(u,M0){var q0=new Date().getTime();if(M0)U0(M0);E=[],B=0,S=7,T(65496),o(),p(u.comments),$0(u.exifBuffer),e(),a(u.width,u.height),r(),i();var V0=0,O0=0,j0=0;B=0,S=7,this.encode.displayName="_encode_";var{data:F0,width:v0,height:A0}=u,T0=v0*4,Y0=v0*3,J0,N0=0,g0,z0,I0,d0,W0,R0,Z0,_0;while(N0<A0){J0=0;while(J0<T0){d0=T0*N0+J0,W0=d0,R0=-1,Z0=0;for(_0=0;_0<64;_0++){if(Z0=_0>>3,R0=(_0&7)*4,W0=d0+Z0*T0+R0,N0+Z0>=A0)W0-=T0*(N0+1+Z0-A0);if(J0+R0>=T0)W0-=J0+R0-T0+4;g0=F0[W0++],z0=F0[W0++],I0=F0[W0++],A[_0]=(U[g0]+U[z0+256>>0]+U[I0+512>>0]>>16)-128,z[_0]=(U[g0+768>>0]+U[z0+1024>>0]+U[I0+1280>>0]>>16)-128,P[_0]=(U[g0+1280>>0]+U[z0+1536>>0]+U[I0+1792>>0]>>16)-128}V0=X0(A,W,V0,N,V),O0=X0(z,Q,O0,M,G),j0=X0(P,Q,j0,M,G),J0+=32}N0+=8}if(S>=0){var f0=[];f0[1]=S+1,f0[0]=(1<<S+1)-1,g(f0)}if(T(65497),typeof O$>"u")return new Uint8Array(E);return Buffer.from(E);var s0,y0};function U0(u){if(u<=0)u=1;if(u>100)u=100;if(C==u)return;var M0=0;if(u<50)M0=Math.floor(5000/u);else M0=Math.floor(200-u*2);_(M0),C=u}function S0(){var u=new Date().getTime();if(!$)$=50;K0(),t(),l(),s(),U0($);var M0=new Date().getTime()-u}S0()}if(typeof O$<"u")O$.exports=bK;else if(typeof window<"u")window["jpeg-js"]=window["jpeg-js"]||{},window["jpeg-js"].encode=bK;function bK($,J){if(typeof J>"u")J=50;var X=new kH(J),K=X.encode($,J);return{data:K,width:$.width,height:$.height}}});var lK=L0((FA,d7)=>{var c7=function(){var J=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),X=4017,K=799,q=3406,Y=2276,W=1567,Q=3784,N=5793,M=2896;function V(){}function G(S,A){var z=0,P=[],R,U,C=16;while(C>0&&!S[C-1])C--;P.push({children:[],index:0});var k=P[0],h;for(R=0;R<C;R++){for(U=0;U<S[R];U++){k=P.pop(),k.children[k.index]=A[z];while(k.index>0){if(P.length===0)throw Error("Could not recreate Huffman Table");k=P.pop()}k.index++,P.push(k);while(P.length<=R)P.push(h={children:[],index:0}),k.children[k.index]=h.children,k=h;z++}if(R+1<C)P.push(h={children:[],index:0}),k.children[k.index]=h.children,k=h}return P[0].children}function H(S,A,z,P,R,U,C,k,h,F){var{precision:v,samplesPerLine:D,scanLines:w,mcusPerLine:x,progressive:y,maxH:b,maxV:_}=z,m=A,t=0,l=0;function s(){if(l>0)return l--,t>>l&1;if(t=S[A++],t==255){var Y0=S[A++];if(Y0)throw Error("unexpected marker: "+(t<<8|Y0).toString(16))}return l=7,t>>>7}function g(Y0){var J0=Y0,N0;while((N0=s())!==null){if(J0=J0[N0],typeof J0==="number")return J0;if(typeof J0!=="object")throw Error("invalid huffman sequence")}return null}function Z(Y0){var J0=0;while(Y0>0){var N0=s();if(N0===null)return;J0=J0<<1|N0,Y0--}return J0}function T(Y0){var J0=Z(Y0);if(J0>=1<<Y0-1)return J0;return J0+(-1<<Y0)+1}function c(Y0,J0){var N0=g(Y0.huffmanTableDC),g0=N0===0?0:T(N0);J0[0]=Y0.pred+=g0;var z0=1;while(z0<64){var I0=g(Y0.huffmanTableAC),d0=I0&15,W0=I0>>4;if(d0===0){if(W0<15)break;z0+=16;continue}z0+=W0;var R0=J[z0];J0[R0]=T(d0),z0++}}function o(Y0,J0){var N0=g(Y0.huffmanTableDC),g0=N0===0?0:T(N0)<<h;J0[0]=Y0.pred+=g0}function $0(Y0,J0){J0[0]|=s()<<h}var a=0;function e(Y0,J0){if(a>0){a--;return}var N0=U,g0=C;while(N0<=g0){var z0=g(Y0.huffmanTableAC),I0=z0&15,d0=z0>>4;if(I0===0){if(d0<15){a=Z(d0)+(1<<d0)-1;break}N0+=16;continue}N0+=d0;var W0=J[N0];J0[W0]=T(I0)*(1<<h),N0++}}var r=0,p;function i(Y0,J0){var N0=U,g0=C,z0=0;while(N0<=g0){var I0=J[N0],d0=J0[I0]<0?-1:1;switch(r){case 0:var W0=g(Y0.huffmanTableAC),R0=W0&15,z0=W0>>4;if(R0===0)if(z0<15)a=Z(z0)+(1<<z0),r=4;else z0=16,r=1;else{if(R0!==1)throw Error("invalid ACn encoding");p=T(R0),r=z0?2:3}continue;case 1:case 2:if(J0[I0])J0[I0]+=(s()<<h)*d0;else if(z0--,z0===0)r=r==2?3:0;break;case 3:if(J0[I0])J0[I0]+=(s()<<h)*d0;else J0[I0]=p<<h,r=0;break;case 4:if(J0[I0])J0[I0]+=(s()<<h)*d0;break}N0++}if(r===4){if(a--,a===0)r=0}}function X0(Y0,J0,N0,g0,z0){var I0=N0/x|0,d0=N0%x,W0=I0*Y0.v+g0,R0=d0*Y0.h+z0;if(Y0.blocks[W0]===void 0&&F.tolerantDecoding)return;J0(Y0,Y0.blocks[W0][R0])}function K0(Y0,J0,N0){var g0=N0/Y0.blocksPerLine|0,z0=N0%Y0.blocksPerLine;if(Y0.blocks[g0]===void 0&&F.tolerantDecoding)return;J0(Y0,Y0.blocks[g0][z0])}var U0=P.length,S0,u,M0,q0,V0,O0;if(y)if(U===0)O0=k===0?o:$0;else O0=k===0?e:i;else O0=c;var j0=0,F0,v0;if(U0==1)v0=P[0].blocksPerLine*P[0].blocksPerColumn;else v0=x*z.mcusPerColumn;if(!R)R=v0;var A0,T0;while(j0<v0){for(u=0;u<U0;u++)P[u].pred=0;if(a=0,U0==1){S0=P[0];for(V0=0;V0<R;V0++)K0(S0,O0,j0),j0++}else for(V0=0;V0<R;V0++){for(u=0;u<U0;u++){S0=P[u],A0=S0.h,T0=S0.v;for(M0=0;M0<T0;M0++)for(q0=0;q0<A0;q0++)X0(S0,O0,j0,M0,q0)}if(j0++,j0===v0)break}if(j0===v0)do{if(S[A]===255){if(S[A+1]!==0)break}A+=1}while(A<S.length-2);if(l=0,F0=S[A]<<8|S[A+1],F0<65280)throw Error("marker was not found");if(F0>=65488&&F0<=65495)A+=2;else break}return A-m}function O(S,A){var z=[],P=A.blocksPerLine,R=A.blocksPerColumn,U=P<<3,C=new Int32Array(64),k=new Uint8Array(64);function h(m,t,l){var s=A.quantizationTable,g,Z,T,c,o,$0,a,e,r,p=l,i;for(i=0;i<64;i++)p[i]=m[i]*s[i];for(i=0;i<8;++i){var X0=8*i;if(p[1+X0]==0&&p[2+X0]==0&&p[3+X0]==0&&p[4+X0]==0&&p[5+X0]==0&&p[6+X0]==0&&p[7+X0]==0){r=N*p[0+X0]+512>>10,p[0+X0]=r,p[1+X0]=r,p[2+X0]=r,p[3+X0]=r,p[4+X0]=r,p[5+X0]=r,p[6+X0]=r,p[7+X0]=r;continue}g=N*p[0+X0]+128>>8,Z=N*p[4+X0]+128>>8,T=p[2+X0],c=p[6+X0],o=M*(p[1+X0]-p[7+X0])+128>>8,e=M*(p[1+X0]+p[7+X0])+128>>8,$0=p[3+X0]<<4,a=p[5+X0]<<4,r=g-Z+1>>1,g=g+Z+1>>1,Z=r,r=T*Q+c*W+128>>8,T=T*W-c*Q+128>>8,c=r,r=o-a+1>>1,o=o+a+1>>1,a=r,r=e+$0+1>>1,$0=e-$0+1>>1,e=r,r=g-c+1>>1,g=g+c+1>>1,c=r,r=Z-T+1>>1,Z=Z+T+1>>1,T=r,r=o*Y+e*q+2048>>12,o=o*q-e*Y+2048>>12,e=r,r=$0*K+a*X+2048>>12,$0=$0*X-a*K+2048>>12,a=r,p[0+X0]=g+e,p[7+X0]=g-e,p[1+X0]=Z+a,p[6+X0]=Z-a,p[2+X0]=T+$0,p[5+X0]=T-$0,p[3+X0]=c+o,p[4+X0]=c-o}for(i=0;i<8;++i){var K0=i;if(p[8+K0]==0&&p[16+K0]==0&&p[24+K0]==0&&p[32+K0]==0&&p[40+K0]==0&&p[48+K0]==0&&p[56+K0]==0){r=N*l[i+0]+8192>>14,p[0+K0]=r,p[8+K0]=r,p[16+K0]=r,p[24+K0]=r,p[32+K0]=r,p[40+K0]=r,p[48+K0]=r,p[56+K0]=r;continue}g=N*p[0+K0]+2048>>12,Z=N*p[32+K0]+2048>>12,T=p[16+K0],c=p[48+K0],o=M*(p[8+K0]-p[56+K0])+2048>>12,e=M*(p[8+K0]+p[56+K0])+2048>>12,$0=p[24+K0],a=p[40+K0],r=g-Z+1>>1,g=g+Z+1>>1,Z=r,r=T*Q+c*W+2048>>12,T=T*W-c*Q+2048>>12,c=r,r=o-a+1>>1,o=o+a+1>>1,a=r,r=e+$0+1>>1,$0=e-$0+1>>1,e=r,r=g-c+1>>1,g=g+c+1>>1,c=r,r=Z-T+1>>1,Z=Z+T+1>>1,T=r,r=o*Y+e*q+2048>>12,o=o*q-e*Y+2048>>12,e=r,r=$0*K+a*X+2048>>12,$0=$0*X-a*K+2048>>12,a=r,p[0+K0]=g+e,p[56+K0]=g-e,p[8+K0]=Z+a,p[48+K0]=Z-a,p[16+K0]=T+$0,p[40+K0]=T-$0,p[24+K0]=c+o,p[32+K0]=c-o}for(i=0;i<64;++i){var U0=128+(p[i]+8>>4);t[i]=U0<0?0:U0>255?255:U0}}B(U*R*8);var F,v;for(var D=0;D<R;D++){var w=D<<3;for(F=0;F<8;F++)z.push(new Uint8Array(U));for(var x=0;x<P;x++){h(A.blocks[D][x],k,C);var y=0,b=x<<3;for(v=0;v<8;v++){var _=z[w+v];for(F=0;F<8;F++)_[b+F]=k[y++]}}}return z}function L(S){return S<0?0:S>255?255:S}V.prototype={load:function(A){var z=new XMLHttpRequest;z.open("GET",A,!0),z.responseType="arraybuffer",z.onload=function(){var P=new Uint8Array(z.response||z.mozResponseArrayBuffer);if(this.parse(P),this.onload)this.onload()}.bind(this),z.send(null)},parse:function(A){var z=this.opts.maxResolutionInMP*1000*1000,P=0,R=A.length;function U(){var W0=A[P]<<8|A[P+1];return P+=2,W0}function C(){var W0=U(),R0=A.subarray(P,P+W0-2);return P+=R0.length,R0}function k(W0){var R0=1,Z0=1,_0,f0;for(f0 in W0.components)if(W0.components.hasOwnProperty(f0)){if(_0=W0.components[f0],R0<_0.h)R0=_0.h;if(Z0<_0.v)Z0=_0.v}var s0=Math.ceil(W0.samplesPerLine/8/R0),y0=Math.ceil(W0.scanLines/8/Z0);for(f0 in W0.components)if(W0.components.hasOwnProperty(f0)){_0=W0.components[f0];var i0=Math.ceil(Math.ceil(W0.samplesPerLine/8)*_0.h/R0),t0=Math.ceil(Math.ceil(W0.scanLines/8)*_0.v/Z0),F6=s0*_0.h,L6=y0*_0.v,w6=L6*F6,X8=[];B(w6*256);for(var R8=0;R8<L6;R8++){var x8=[];for(var B8=0;B8<F6;B8++)x8.push(new Int32Array(64));X8.push(x8)}_0.blocksPerLine=i0,_0.blocksPerColumn=t0,_0.blocks=X8}W0.maxH=R0,W0.maxV=Z0,W0.mcusPerLine=s0,W0.mcusPerColumn=y0}var h=null,F=null,v=null,D,w,x=[],y=[],b=[],_=[],m=U(),t=-1;if(this.comments=[],m!=65496)throw Error("SOI not found");m=U();while(m!=65497){var l,s,g;switch(m){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var Z=C();if(m===65534){var T=String.fromCharCode.apply(null,Z);this.comments.push(T)}if(m===65504){if(Z[0]===74&&Z[1]===70&&Z[2]===73&&Z[3]===70&&Z[4]===0)h={version:{major:Z[5],minor:Z[6]},densityUnits:Z[7],xDensity:Z[8]<<8|Z[9],yDensity:Z[10]<<8|Z[11],thumbWidth:Z[12],thumbHeight:Z[13],thumbData:Z.subarray(14,14+3*Z[12]*Z[13])}}if(m===65505){if(Z[0]===69&&Z[1]===120&&Z[2]===105&&Z[3]===102&&Z[4]===0)this.exifBuffer=Z.subarray(5,Z.length)}if(m===65518){if(Z[0]===65&&Z[1]===100&&Z[2]===111&&Z[3]===98&&Z[4]===101&&Z[5]===0)F={version:Z[6],flags0:Z[7]<<8|Z[8],flags1:Z[9]<<8|Z[10],transformCode:Z[11]}}break;case 65499:var c=U(),o=c+P-2;while(P<o){var $0=A[P++];B(256);var a=new Int32Array(64);if($0>>4===0)for(s=0;s<64;s++){var e=J[s];a[e]=A[P++]}else if($0>>4===1)for(s=0;s<64;s++){var e=J[s];a[e]=U()}else throw Error("DQT: invalid table spec");x[$0&15]=a}break;case 65472:case 65473:case 65474:U(),D={},D.extended=m===65473,D.progressive=m===65474,D.precision=A[P++],D.scanLines=U(),D.samplesPerLine=U(),D.components={},D.componentsOrder=[];var r=D.scanLines*D.samplesPerLine;if(r>z){var p=Math.ceil((r-z)/1e6);throw Error(`maxResolutionInMP limit exceeded by ${p}MP`)}var i=A[P++],X0,K0=0,U0=0;for(l=0;l<i;l++){X0=A[P];var S0=A[P+1]>>4,u=A[P+1]&15,M0=A[P+2];if(S0<=0||u<=0)throw Error("Invalid sampling factor, expected values above 0");D.componentsOrder.push(X0),D.components[X0]={h:S0,v:u,quantizationIdx:M0},P+=3}k(D),y.push(D);break;case 65476:var q0=U();for(l=2;l<q0;){var V0=A[P++],O0=new Uint8Array(16),j0=0;for(s=0;s<16;s++,P++)j0+=O0[s]=A[P];B(16+j0);var F0=new Uint8Array(j0);for(s=0;s<j0;s++,P++)F0[s]=A[P];l+=17+j0,(V0>>4===0?_:b)[V0&15]=G(O0,F0)}break;case 65501:U(),w=U();break;case 65500:U(),U();break;case 65498:var v0=U(),A0=A[P++],T0=[],Y0;for(l=0;l<A0;l++){Y0=D.components[A[P++]];var J0=A[P++];Y0.huffmanTableDC=_[J0>>4],Y0.huffmanTableAC=b[J0&15],T0.push(Y0)}var N0=A[P++],g0=A[P++],z0=A[P++],I0=H(A,P,D,T0,w,N0,g0,z0>>4,z0&15,this.opts);P+=I0;break;case 65535:if(A[P]!==255)P--;break;default:if(A[P-3]==255&&A[P-2]>=192&&A[P-2]<=254){P-=3;break}else if(m===224||m==225){if(t!==-1)throw Error(`first unknown JPEG marker at offset ${t.toString(16)}, second unknown JPEG marker ${m.toString(16)} at offset ${(P-1).toString(16)}`);t=P-1;let W0=U();if(A[P+W0-2]===255){P+=W0-2;break}}throw Error("unknown JPEG marker "+m.toString(16))}m=U()}if(y.length!=1)throw Error("only single frame JPEGs supported");for(var l=0;l<y.length;l++){var d0=y[l].components;for(var s in d0)d0[s].quantizationTable=x[d0[s].quantizationIdx],delete d0[s].quantizationIdx}this.width=D.samplesPerLine,this.height=D.scanLines,this.jfif=h,this.adobe=F,this.components=[];for(var l=0;l<D.componentsOrder.length;l++){var Y0=D.components[D.componentsOrder[l]];this.components.push({lines:O(D,Y0),scaleX:Y0.h/D.maxH,scaleY:Y0.v/D.maxV})}},getData:function(A,z){var P=this.width/A,R=this.height/z,U,C,k,h,F,v,D,w,x,y,b=0,_,m,t,l,s,g,Z,T,c,o,$0,a=A*z*this.components.length;B(a);var e=new Uint8Array(a);switch(this.components.length){case 1:U=this.components[0];for(y=0;y<z;y++){F=U.lines[0|y*U.scaleY*R];for(x=0;x<A;x++)_=F[0|x*U.scaleX*P],e[b++]=_}break;case 2:U=this.components[0],C=this.components[1];for(y=0;y<z;y++){F=U.lines[0|y*U.scaleY*R],v=C.lines[0|y*C.scaleY*R];for(x=0;x<A;x++)_=F[0|x*U.scaleX*P],e[b++]=_,_=v[0|x*C.scaleX*P],e[b++]=_}break;case 3:if($0=!0,this.adobe&&this.adobe.transformCode)$0=!0;else if(typeof this.opts.colorTransform<"u")$0=!!this.opts.colorTransform;U=this.components[0],C=this.components[1],k=this.components[2];for(y=0;y<z;y++){F=U.lines[0|y*U.scaleY*R],v=C.lines[0|y*C.scaleY*R],D=k.lines[0|y*k.scaleY*R];for(x=0;x<A;x++){if(!$0)T=F[0|x*U.scaleX*P],c=v[0|x*C.scaleX*P],o=D[0|x*k.scaleX*P];else _=F[0|x*U.scaleX*P],m=v[0|x*C.scaleX*P],t=D[0|x*k.scaleX*P],T=L(_+1.402*(t-128)),c=L(_-0.3441363*(m-128)-0.71413636*(t-128)),o=L(_+1.772*(m-128));e[b++]=T,e[b++]=c,e[b++]=o}}break;case 4:if(!this.adobe)throw Error("Unsupported color mode (4 components)");if($0=!1,this.adobe&&this.adobe.transformCode)$0=!0;else if(typeof this.opts.colorTransform<"u")$0=!!this.opts.colorTransform;U=this.components[0],C=this.components[1],k=this.components[2],h=this.components[3];for(y=0;y<z;y++){F=U.lines[0|y*U.scaleY*R],v=C.lines[0|y*C.scaleY*R],D=k.lines[0|y*k.scaleY*R],w=h.lines[0|y*h.scaleY*R];for(x=0;x<A;x++){if(!$0)s=F[0|x*U.scaleX*P],g=v[0|x*C.scaleX*P],Z=D[0|x*k.scaleX*P],l=w[0|x*h.scaleX*P];else _=F[0|x*U.scaleX*P],m=v[0|x*C.scaleX*P],t=D[0|x*k.scaleX*P],l=w[0|x*h.scaleX*P],s=255-L(_+1.402*(t-128)),g=255-L(_-0.3441363*(m-128)-0.71413636*(t-128)),Z=255-L(_+1.772*(m-128));e[b++]=255-s,e[b++]=255-g,e[b++]=255-Z,e[b++]=255-l}}break;default:throw Error("Unsupported color mode")}return e},copyToImageData:function(A,z){var{width:P,height:R,data:U}=A,C=this.getData(P,R),k=0,h=0,F,v,D,w,x,y,b,_,m;switch(this.components.length){case 1:for(v=0;v<R;v++)for(F=0;F<P;F++)if(D=C[k++],U[h++]=D,U[h++]=D,U[h++]=D,z)U[h++]=255;break;case 3:for(v=0;v<R;v++)for(F=0;F<P;F++)if(b=C[k++],_=C[k++],m=C[k++],U[h++]=b,U[h++]=_,U[h++]=m,z)U[h++]=255;break;case 4:for(v=0;v<R;v++)for(F=0;F<P;F++)if(x=C[k++],y=C[k++],D=C[k++],w=C[k++],b=255-L(x*(1-w/255)+w),_=255-L(y*(1-w/255)+w),m=255-L(D*(1-w/255)+w),U[h++]=b,U[h++]=_,U[h++]=m,z)U[h++]=255;break;default:throw Error("Unsupported color mode")}}};var j=0,E=0;function B(S=0){var A=j+S;if(A>E){var z=Math.ceil((A-E)/1024/1024);throw Error(`maxMemoryUsageInMB limit exceeded by at least ${z}MB`)}j=A}return V.resetMaxMemoryUsage=function(S){j=0,E=S},V.getBytesAllocated=function(){return j},V.requestMemoryAllocation=B,V}();if(typeof d7<"u")d7.exports=uK;else if(typeof window<"u")window["jpeg-js"]=window["jpeg-js"]||{},window["jpeg-js"].decode=uK;function uK($,J={}){var X={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512},K={...X,...J},q=new Uint8Array($),Y=new c7;Y.opts=K,c7.resetMaxMemoryUsage(K.maxMemoryUsageInMB*1024*1024),Y.parse(q);var W=K.formatAsRGBA?4:3,Q=Y.width*Y.height*W;try{c7.requestMemoryAllocation(Q);var N={width:Y.width,height:Y.height,exifBuffer:Y.exifBuffer,data:K.useTArray?new Uint8Array(Q):Buffer.alloc(Q)};if(Y.comments.length>0)N.comments=Y.comments}catch(M){if(M instanceof RangeError)throw Error("Could not allocate enough memory for the image. Required: "+Q);if(M instanceof ReferenceError){if(M.message==="Buffer is not defined")throw Error("Buffer is not globally defined in this environment. Consider setting useTArray to true")}throw M}return Y.copyToImageData(N,K.formatAsRGBA),N}});var dK=L0((zA,cK)=>{var wH=pK(),TH=lK();cK.exports={encode:wH,decode:TH}});var o7=L0((CA,oK)=>{var IH=O6("util"),nK=O6("stream"),N8=oK.exports=function(){nK.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};IH.inherits(N8,nK);N8.prototype.read=function($,J){this._reads.push({length:Math.abs($),allowLess:$<0,func:J}),process.nextTick(function(){if(this._process(),this._paused&&this._reads&&this._reads.length>0)this._paused=!1,this.emit("drain")}.bind(this))};N8.prototype.write=function($,J){if(!this.writable)return this.emit("error",Error("Stream not writable")),!1;let X;if(Buffer.isBuffer($))X=$;else X=Buffer.from($,J||this._encoding);if(this._buffers.push(X),this._buffered+=X.length,this._process(),this._reads&&this._reads.length===0)this._paused=!0;return this.writable&&!this._paused};N8.prototype.end=function($,J){if($)this.write($,J);if(this.writable=!1,!this._buffers)return;if(this._buffers.length===0)this._end();else this._buffers.push(null),this._process()};N8.prototype.destroySoon=N8.prototype.end;N8.prototype._end=function(){if(this._reads.length>0)this.emit("error",Error("Unexpected end of input"));this.destroy()};N8.prototype.destroy=function(){if(!this._buffers)return;this.writable=!1,this._reads=null,this._buffers=null,this.emit("close")};N8.prototype._processReadAllowingLess=function($){this._reads.shift();let J=this._buffers[0];if(J.length>$.length)this._buffered-=$.length,this._buffers[0]=J.slice($.length),$.func.call(this,J.slice(0,$.length));else this._buffered-=J.length,this._buffers.shift(),$.func.call(this,J)};N8.prototype._processRead=function($){this._reads.shift();let J=0,X=0,K=Buffer.alloc($.length);while(J<$.length){let q=this._buffers[X++],Y=Math.min(q.length,$.length-J);if(q.copy(K,J,0,Y),J+=Y,Y!==q.length)this._buffers[--X]=q.slice(Y)}if(X>0)this._buffers.splice(0,X);this._buffered-=$.length,$.func.call(this,K)};N8.prototype._process=function(){try{while(this._buffered>0&&this._reads&&this._reads.length>0){let $=this._reads[0];if($.allowLess)this._processReadAllowingLess($);else if(this._buffered>=$.length)this._processRead($);else break}if(this._buffers&&!this.writable)this._end()}catch($){this.emit("error",$)}}});var r7=L0((_H)=>{var W1=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];_H.getImagePasses=function($,J){let X=[],K=$%8,q=J%8,Y=($-K)/8,W=(J-q)/8;for(let Q=0;Q<W1.length;Q++){let N=W1[Q],M=Y*N.x.length,V=W*N.y.length;for(let G=0;G<N.x.length;G++)if(N.x[G]<K)M++;else break;for(let G=0;G<N.y.length;G++)if(N.y[G]<q)V++;else break;if(M>0&&V>0)X.push({width:M,height:V,index:Q})}return X};_H.getInterlaceIterator=function($){return function(J,X,K){let q=J%W1[K].x.length,Y=(J-q)/W1[K].x.length*8+W1[K].x[q],W=X%W1[K].y.length,Q=(X-W)/W1[K].y.length*8+W1[K].y[W];return Y*4+Q*$*4}}});var i7=L0((DA,rK)=>{rK.exports=function(J,X,K){let q=J+X-K,Y=Math.abs(q-J),W=Math.abs(q-X),Q=Math.abs(q-K);if(Y<=W&&Y<=Q)return J;if(W<=Q)return X;return K}});var s7=L0((kA,sK)=>{var hH=r7(),gH=i7();function iK($,J,X){let K=$*J;if(X!==8)K=Math.ceil(K/(8/X));return K}var X5=sK.exports=function($,J){let{width:X,height:K,interlace:q,bpp:Y,depth:W}=$;if(this.read=J.read,this.write=J.write,this.complete=J.complete,this._imageIndex=0,this._images=[],q){let Q=hH.getImagePasses(X,K);for(let N=0;N<Q.length;N++)this._images.push({byteWidth:iK(Q[N].width,Y,W),height:Q[N].height,lineIndex:0})}else this._images.push({byteWidth:iK(X,Y,W),height:K,lineIndex:0});if(W===8)this._xComparison=Y;else if(W===16)this._xComparison=Y*2;else this._xComparison=1};X5.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))};X5.prototype._unFilterType1=function($,J,X){let K=this._xComparison,q=K-1;for(let Y=0;Y<X;Y++){let W=$[1+Y],Q=Y>q?J[Y-K]:0;J[Y]=W+Q}};X5.prototype._unFilterType2=function($,J,X){let K=this._lastLine;for(let q=0;q<X;q++){let Y=$[1+q],W=K?K[q]:0;J[q]=Y+W}};X5.prototype._unFilterType3=function($,J,X){let K=this._xComparison,q=K-1,Y=this._lastLine;for(let W=0;W<X;W++){let Q=$[1+W],N=Y?Y[W]:0,M=W>q?J[W-K]:0,V=Math.floor((M+N)/2);J[W]=Q+V}};X5.prototype._unFilterType4=function($,J,X){let K=this._xComparison,q=K-1,Y=this._lastLine;for(let W=0;W<X;W++){let Q=$[1+W],N=Y?Y[W]:0,M=W>q?J[W-K]:0,V=W>q&&Y?Y[W-K]:0,G=gH(M,N,V);J[W]=Q+G}};X5.prototype._reverseFilterLine=function($){let J=$[0],X,K=this._images[this._imageIndex],q=K.byteWidth;if(J===0)X=$.slice(1,q+1);else switch(X=Buffer.alloc(q),J){case 1:this._unFilterType1($,X,q);break;case 2:this._unFilterType2($,X,q);break;case 3:this._unFilterType3($,X,q);break;case 4:this._unFilterType4($,X,q);break;default:throw Error("Unrecognised filter type - "+J)}if(this.write(X),K.lineIndex++,K.lineIndex>=K.height)this._lastLine=null,this._imageIndex++,K=this._images[this._imageIndex];else this._lastLine=X;if(K)this.read(K.byteWidth+1,this._reverseFilterLine.bind(this));else this._lastLine=null,this.complete()}});var eK=L0((wA,tK)=>{var fH=O6("util"),aK=o7(),bH=s7(),mH=tK.exports=function($){aK.call(this);let J=[],X=this;this._filter=new bH($,{read:this.read.bind(this),write:function(K){J.push(K)},complete:function(){X.emit("complete",Buffer.concat(J))}}),this._filter.start()};fH.inherits(mH,aK)});var K5=L0((TA,$q)=>{$q.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}});var e7=L0((IA,Jq)=>{var a7=[];(function(){for(let $=0;$<256;$++){let J=$;for(let X=0;X<8;X++)if(J&1)J=3988292384^J>>>1;else J=J>>>1;a7[$]=J}})();var t7=Jq.exports=function(){this._crc=-1};t7.prototype.write=function($){for(let J=0;J<$.length;J++)this._crc=a7[(this._crc^$[J])&255]^this._crc>>>8;return!0};t7.prototype.crc32=function(){return this._crc^-1};t7.crc32=function($){let J=-1;for(let X=0;X<$.length;X++)J=a7[(J^$[X])&255]^J>>>8;return J^-1}});var $J=L0((_A,Xq)=>{var G6=K5(),pH=e7(),U6=Xq.exports=function($,J){this._options=$,$.checkCRC=$.checkCRC!==!1,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[G6.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[G6.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[G6.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[G6.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[G6.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[G6.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=J.read,this.error=J.error,this.metadata=J.metadata,this.gamma=J.gamma,this.transColor=J.transColor,this.palette=J.palette,this.parsed=J.parsed,this.inflateData=J.inflateData,this.finished=J.finished,this.simpleTransparency=J.simpleTransparency,this.headersFinished=J.headersFinished||function(){}};U6.prototype.start=function(){this.read(G6.PNG_SIGNATURE.length,this._parseSignature.bind(this))};U6.prototype._parseSignature=function($){let J=G6.PNG_SIGNATURE;for(let X=0;X<J.length;X++)if($[X]!==J[X]){this.error(Error("Invalid file signature"));return}this.read(8,this._parseChunkBegin.bind(this))};U6.prototype._parseChunkBegin=function($){let J=$.readUInt32BE(0),X=$.readUInt32BE(4),K="";for(let Y=4;Y<8;Y++)K+=String.fromCharCode($[Y]);let q=Boolean($[4]&32);if(!this._hasIHDR&&X!==G6.TYPE_IHDR){this.error(Error("Expected IHDR on beggining"));return}if(this._crc=new pH,this._crc.write(Buffer.from(K)),this._chunks[X])return this._chunks[X](J);if(!q){this.error(Error("Unsupported critical chunk type "+K));return}this.read(J+4,this._skipChunk.bind(this))};U6.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))};U6.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))};U6.prototype._parseChunkEnd=function($){let J=$.readInt32BE(0),X=this._crc.crc32();if(this._options.checkCRC&&X!==J){this.error(Error("Crc error - "+J+" - "+X));return}if(!this._hasIEND)this.read(8,this._parseChunkBegin.bind(this))};U6.prototype._handleIHDR=function($){this.read($,this._parseIHDR.bind(this))};U6.prototype._parseIHDR=function($){this._crc.write($);let J=$.readUInt32BE(0),X=$.readUInt32BE(4),K=$[8],q=$[9],Y=$[10],W=$[11],Q=$[12];if(K!==8&&K!==4&&K!==2&&K!==1&&K!==16){this.error(Error("Unsupported bit depth "+K));return}if(!(q in G6.COLORTYPE_TO_BPP_MAP)){this.error(Error("Unsupported color type"));return}if(Y!==0){this.error(Error("Unsupported compression method"));return}if(W!==0){this.error(Error("Unsupported filter method"));return}if(Q!==0&&Q!==1){this.error(Error("Unsupported interlace method"));return}this._colorType=q;let N=G6.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:J,height:X,depth:K,interlace:Boolean(Q),palette:Boolean(q&G6.COLORTYPE_PALETTE),color:Boolean(q&G6.COLORTYPE_COLOR),alpha:Boolean(q&G6.COLORTYPE_ALPHA),bpp:N,colorType:q}),this._handleChunkEnd()};U6.prototype._handlePLTE=function($){this.read($,this._parsePLTE.bind(this))};U6.prototype._parsePLTE=function($){this._crc.write($);let J=Math.floor($.length/3);for(let X=0;X<J;X++)this._palette.push([$[X*3],$[X*3+1],$[X*3+2],255]);this.palette(this._palette),this._handleChunkEnd()};U6.prototype._handleTRNS=function($){this.simpleTransparency(),this.read($,this._parseTRNS.bind(this))};U6.prototype._parseTRNS=function($){if(this._crc.write($),this._colorType===G6.COLORTYPE_PALETTE_COLOR){if(this._palette.length===0){this.error(Error("Transparency chunk must be after palette"));return}if($.length>this._palette.length){this.error(Error("More transparent colors than palette size"));return}for(let J=0;J<$.length;J++)this._palette[J][3]=$[J];this.palette(this._palette)}if(this._colorType===G6.COLORTYPE_GRAYSCALE)this.transColor([$.readUInt16BE(0)]);if(this._colorType===G6.COLORTYPE_COLOR)this.transColor([$.readUInt16BE(0),$.readUInt16BE(2),$.readUInt16BE(4)]);this._handleChunkEnd()};U6.prototype._handleGAMA=function($){this.read($,this._parseGAMA.bind(this))};U6.prototype._parseGAMA=function($){this._crc.write($),this.gamma($.readUInt32BE(0)/G6.GAMMA_DIVISION),this._handleChunkEnd()};U6.prototype._handleIDAT=function($){if(!this._emittedHeadersFinished)this._emittedHeadersFinished=!0,this.headersFinished();this.read(-$,this._parseIDAT.bind(this,$))};U6.prototype._parseIDAT=function($,J){if(this._crc.write(J),this._colorType===G6.COLORTYPE_PALETTE_COLOR&&this._palette.length===0)throw Error("Expected palette not found");this.inflateData(J);let X=$-J.length;if(X>0)this._handleIDAT(X);else this._handleChunkEnd()};U6.prototype._handleIEND=function($){this.read($,this._parseIEND.bind(this))};U6.prototype._parseIEND=function($){if(this._crc.write($),this._hasIEND=!0,this._handleChunkEnd(),this.finished)this.finished()}});var JJ=L0((oH)=>{var Kq=r7(),uH=[function(){},function($,J,X,K){if(K===J.length)throw Error("Ran out of data");let q=J[K];$[X]=q,$[X+1]=q,$[X+2]=q,$[X+3]=255},function($,J,X,K){if(K+1>=J.length)throw Error("Ran out of data");let q=J[K];$[X]=q,$[X+1]=q,$[X+2]=q,$[X+3]=J[K+1]},function($,J,X,K){if(K+2>=J.length)throw Error("Ran out of data");$[X]=J[K],$[X+1]=J[K+1],$[X+2]=J[K+2],$[X+3]=255},function($,J,X,K){if(K+3>=J.length)throw Error("Ran out of data");$[X]=J[K],$[X+1]=J[K+1],$[X+2]=J[K+2],$[X+3]=J[K+3]}],lH=[function(){},function($,J,X,K){let q=J[0];$[X]=q,$[X+1]=q,$[X+2]=q,$[X+3]=K},function($,J,X){let K=J[0];$[X]=K,$[X+1]=K,$[X+2]=K,$[X+3]=J[1]},function($,J,X,K){$[X]=J[0],$[X+1]=J[1],$[X+2]=J[2],$[X+3]=K},function($,J,X){$[X]=J[0],$[X+1]=J[1],$[X+2]=J[2],$[X+3]=J[3]}];function cH($,J){let X=[],K=0;function q(){if(K===$.length)throw Error("Ran out of data");let Y=$[K];K++;let W,Q,N,M,V,G,H,O;switch(J){default:throw Error("unrecognised depth");case 16:H=$[K],K++,X.push((Y<<8)+H);break;case 4:H=Y&15,O=Y>>4,X.push(O,H);break;case 2:V=Y&3,G=Y>>2&3,H=Y>>4&3,O=Y>>6&3,X.push(O,H,G,V);break;case 1:W=Y&1,Q=Y>>1&1,N=Y>>2&1,M=Y>>3&1,V=Y>>4&1,G=Y>>5&1,H=Y>>6&1,O=Y>>7&1,X.push(O,H,G,V,M,N,Q,W);break}}return{get:function(Y){while(X.length<Y)q();let W=X.slice(0,Y);return X=X.slice(Y),W},resetAfterLine:function(){X.length=0},end:function(){if(K!==$.length)throw Error("extra data found")}}}function dH($,J,X,K,q,Y){let{width:W,height:Q,index:N}=$;for(let M=0;M<Q;M++)for(let V=0;V<W;V++){let G=X(V,M,N);uH[K](J,q,G,Y),Y+=K}return Y}function nH($,J,X,K,q,Y){let{width:W,height:Q,index:N}=$;for(let M=0;M<Q;M++){for(let V=0;V<W;V++){let G=q.get(K),H=X(V,M,N);lH[K](J,G,H,Y)}q.resetAfterLine()}}oH.dataToBitMap=function($,J){let{width:X,height:K,depth:q,bpp:Y,interlace:W}=J,Q;if(q!==8)Q=cH($,q);let N;if(q<=8)N=Buffer.alloc(X*K*4);else N=new Uint16Array(X*K*4);let M=Math.pow(2,q)-1,V=0,G,H;if(W)G=Kq.getImagePasses(X,K),H=Kq.getInterlaceIterator(X,K);else{let O=0;H=function(){let L=O;return O+=4,L},G=[{width:X,height:K}]}for(let O=0;O<G.length;O++)if(q===8)V=dH(G[O],N,H,Y,$,V);else nH(G[O],N,H,Y,Q,M);if(q===8){if(V!==$.length)throw Error("extra data found")}else Q.end();return N}});var XJ=L0((xA,qq)=>{function iH($,J,X,K,q){let Y=0;for(let W=0;W<K;W++)for(let Q=0;Q<X;Q++){let N=q[$[Y]];if(!N)throw Error("index "+$[Y]+" not in palette");for(let M=0;M<4;M++)J[Y+M]=N[M];Y+=4}}function sH($,J,X,K,q){let Y=0;for(let W=0;W<K;W++)for(let Q=0;Q<X;Q++){let N=!1;if(q.length===1){if(q[0]===$[Y])N=!0}else if(q[0]===$[Y]&&q[1]===$[Y+1]&&q[2]===$[Y+2])N=!0;if(N)for(let M=0;M<4;M++)J[Y+M]=0;Y+=4}}function aH($,J,X,K,q){let Y=255,W=Math.pow(2,q)-1,Q=0;for(let N=0;N<K;N++)for(let M=0;M<X;M++){for(let V=0;V<4;V++)J[Q+V]=Math.floor($[Q+V]*Y/W+0.5);Q+=4}}qq.exports=function($,J,X=!1){let{depth:K,width:q,height:Y,colorType:W,transColor:Q,palette:N}=J,M=$;if(W===3)iH($,M,q,Y,N);else{if(Q)sH($,M,q,Y,Q);if(K!==8&&!X){if(K===16)M=Buffer.alloc(q*Y*4);aH($,M,q,Y,K)}}return M}});var Qq=L0((hA,Wq)=>{var tH=O6("util"),KJ=O6("zlib"),Yq=o7(),eH=eK(),$2=$J(),J2=JJ(),X2=XJ(),z8=Wq.exports=function($){Yq.call(this),this._parser=new $2($,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=$,this.writable=!0,this._parser.start()};tH.inherits(z8,Yq);z8.prototype._handleError=function($){if(this.emit("error",$),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy)this._inflate.destroy();if(this._filter)this._filter.destroy(),this._filter.on("error",function(){});this.errord=!0};z8.prototype._inflateData=function($){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=KJ.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{let X=((this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3)+1)*this._bitmapInfo.height,K=Math.max(X,KJ.Z_MIN_CHUNK);this._inflate=KJ.createInflate({chunkSize:K});let q=X,Y=this.emit.bind(this,"error");this._inflate.on("error",function(Q){if(!q)return;Y(Q)}),this._filter.on("complete",this._complete.bind(this));let W=this._filter.write.bind(this._filter);this._inflate.on("data",function(Q){if(!q)return;if(Q.length>q)Q=Q.slice(0,q);q-=Q.length,W(Q)}),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write($)};z8.prototype._handleMetaData=function($){this._metaData=$,this._bitmapInfo=Object.create($),this._filter=new eH(this._bitmapInfo)};z8.prototype._handleTransColor=function($){this._bitmapInfo.transColor=$};z8.prototype._handlePalette=function($){this._bitmapInfo.palette=$};z8.prototype._simpleTransparency=function(){this._metaData.alpha=!0};z8.prototype._headersFinished=function(){this.emit("metadata",this._metaData)};z8.prototype._finished=function(){if(this.errord)return;if(!this._inflate)this.emit("error","No Inflate block");else this._inflate.end()};z8.prototype._complete=function($){if(this.errord)return;let J;try{let X=J2.dataToBitMap($,this._bitmapInfo);J=X2(X,this._bitmapInfo,this._options.skipRescale),X=null}catch(X){this._handleError(X);return}this.emit("parsed",J)}});var Mq=L0((gA,Nq)=>{var i6=K5();Nq.exports=function($,J,X,K){let q=[i6.COLORTYPE_COLOR_ALPHA,i6.COLORTYPE_ALPHA].indexOf(K.colorType)!==-1;if(K.colorType===K.inputColorType){let L=function(){let j=new ArrayBuffer(2);return new DataView(j).setInt16(0,256,!0),new Int16Array(j)[0]!==256}();if(K.bitDepth===8||K.bitDepth===16&&L)return $}let Y=K.bitDepth!==16?$:new Uint16Array($.buffer),W=255,Q=i6.COLORTYPE_TO_BPP_MAP[K.inputColorType];if(Q===4&&!K.inputHasAlpha)Q=3;let N=i6.COLORTYPE_TO_BPP_MAP[K.colorType];if(K.bitDepth===16)W=65535,N*=2;let M=Buffer.alloc(J*X*N),V=0,G=0,H=K.bgColor||{};if(H.red===void 0)H.red=W;if(H.green===void 0)H.green=W;if(H.blue===void 0)H.blue=W;function O(){let L,j,E,B=W;switch(K.inputColorType){case i6.COLORTYPE_COLOR_ALPHA:B=Y[V+3],L=Y[V],j=Y[V+1],E=Y[V+2];break;case i6.COLORTYPE_COLOR:L=Y[V],j=Y[V+1],E=Y[V+2];break;case i6.COLORTYPE_ALPHA:B=Y[V+1],L=Y[V],j=L,E=L;break;case i6.COLORTYPE_GRAYSCALE:L=Y[V],j=L,E=L;break;default:throw Error("input color type:"+K.inputColorType+" is not supported at present")}if(K.inputHasAlpha){if(!q)B/=W,L=Math.min(Math.max(Math.round((1-B)*H.red+B*L),0),W),j=Math.min(Math.max(Math.round((1-B)*H.green+B*j),0),W),E=Math.min(Math.max(Math.round((1-B)*H.blue+B*E),0),W)}return{red:L,green:j,blue:E,alpha:B}}for(let L=0;L<X;L++)for(let j=0;j<J;j++){let E=O(Y,V);switch(K.colorType){case i6.COLORTYPE_COLOR_ALPHA:case i6.COLORTYPE_COLOR:if(K.bitDepth===8){if(M[G]=E.red,M[G+1]=E.green,M[G+2]=E.blue,q)M[G+3]=E.alpha}else if(M.writeUInt16BE(E.red,G),M.writeUInt16BE(E.green,G+2),M.writeUInt16BE(E.blue,G+4),q)M.writeUInt16BE(E.alpha,G+6);break;case i6.COLORTYPE_ALPHA:case i6.COLORTYPE_GRAYSCALE:{let B=(E.red+E.green+E.blue)/3;if(K.bitDepth===8){if(M[G]=B,q)M[G+1]=E.alpha}else if(M.writeUInt16BE(B,G),q)M.writeUInt16BE(E.alpha,G+2);break}default:throw Error("unrecognised color Type "+K.colorType)}V+=Q,G+=N}return M}});var Hq=L0((fA,Gq)=>{var Vq=i7();function K2($,J,X,K,q){for(let Y=0;Y<X;Y++)K[q+Y]=$[J+Y]}function q2($,J,X){let K=0,q=J+X;for(let Y=J;Y<q;Y++)K+=Math.abs($[Y]);return K}function Y2($,J,X,K,q,Y){for(let W=0;W<X;W++){let Q=W>=Y?$[J+W-Y]:0,N=$[J+W]-Q;K[q+W]=N}}function W2($,J,X,K){let q=0;for(let Y=0;Y<X;Y++){let W=Y>=K?$[J+Y-K]:0,Q=$[J+Y]-W;q+=Math.abs(Q)}return q}function Q2($,J,X,K,q){for(let Y=0;Y<X;Y++){let W=J>0?$[J+Y-X]:0,Q=$[J+Y]-W;K[q+Y]=Q}}function N2($,J,X){let K=0,q=J+X;for(let Y=J;Y<q;Y++){let W=J>0?$[Y-X]:0,Q=$[Y]-W;K+=Math.abs(Q)}return K}function M2($,J,X,K,q,Y){for(let W=0;W<X;W++){let Q=W>=Y?$[J+W-Y]:0,N=J>0?$[J+W-X]:0,M=$[J+W]-(Q+N>>1);K[q+W]=M}}function V2($,J,X,K){let q=0;for(let Y=0;Y<X;Y++){let W=Y>=K?$[J+Y-K]:0,Q=J>0?$[J+Y-X]:0,N=$[J+Y]-(W+Q>>1);q+=Math.abs(N)}return q}function G2($,J,X,K,q,Y){for(let W=0;W<X;W++){let Q=W>=Y?$[J+W-Y]:0,N=J>0?$[J+W-X]:0,M=J>0&&W>=Y?$[J+W-(X+Y)]:0,V=$[J+W]-Vq(Q,N,M);K[q+W]=V}}function H2($,J,X,K){let q=0;for(let Y=0;Y<X;Y++){let W=Y>=K?$[J+Y-K]:0,Q=J>0?$[J+Y-X]:0,N=J>0&&Y>=K?$[J+Y-(X+K)]:0,M=$[J+Y]-Vq(W,Q,N);q+=Math.abs(M)}return q}var O2={0:K2,1:Y2,2:Q2,3:M2,4:G2},U2={0:q2,1:W2,2:N2,3:V2,4:H2};Gq.exports=function($,J,X,K,q){let Y;if(!("filterType"in K)||K.filterType===-1)Y=[0,1,2,3,4];else if(typeof K.filterType==="number")Y=[K.filterType];else throw Error("unrecognised filter types");if(K.bitDepth===16)q*=2;let W=J*q,Q=0,N=0,M=Buffer.alloc((W+1)*X),V=Y[0];for(let G=0;G<X;G++){if(Y.length>1){let H=1/0;for(let O=0;O<Y.length;O++){let L=U2[Y[O]]($,N,W,q);if(L<H)V=Y[O],H=L}}M[Q]=V,Q++,O2[V]($,N,W,M,Q,q),Q+=W,N+=W}return M}});var qJ=L0((bA,Oq)=>{var S6=K5(),L2=e7(),E2=Mq(),j2=Hq(),R2=O6("zlib"),Q1=Oq.exports=function($){if(this._options=$,$.deflateChunkSize=$.deflateChunkSize||32768,$.deflateLevel=$.deflateLevel!=null?$.deflateLevel:9,$.deflateStrategy=$.deflateStrategy!=null?$.deflateStrategy:3,$.inputHasAlpha=$.inputHasAlpha!=null?$.inputHasAlpha:!0,$.deflateFactory=$.deflateFactory||R2.createDeflate,$.bitDepth=$.bitDepth||8,$.colorType=typeof $.colorType==="number"?$.colorType:S6.COLORTYPE_COLOR_ALPHA,$.inputColorType=typeof $.inputColorType==="number"?$.inputColorType:S6.COLORTYPE_COLOR_ALPHA,[S6.COLORTYPE_GRAYSCALE,S6.COLORTYPE_COLOR,S6.COLORTYPE_COLOR_ALPHA,S6.COLORTYPE_ALPHA].indexOf($.colorType)===-1)throw Error("option color type:"+$.colorType+" is not supported at present");if([S6.COLORTYPE_GRAYSCALE,S6.COLORTYPE_COLOR,S6.COLORTYPE_COLOR_ALPHA,S6.COLORTYPE_ALPHA].indexOf($.inputColorType)===-1)throw Error("option input color type:"+$.inputColorType+" is not supported at present");if($.bitDepth!==8&&$.bitDepth!==16)throw Error("option bit depth:"+$.bitDepth+" is not supported at present")};Q1.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}};Q1.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())};Q1.prototype.filterData=function($,J,X){let K=E2($,J,X,this._options),q=S6.COLORTYPE_TO_BPP_MAP[this._options.colorType];return j2(K,J,X,this._options,q)};Q1.prototype._packChunk=function($,J){let X=J?J.length:0,K=Buffer.alloc(X+12);if(K.writeUInt32BE(X,0),K.writeUInt32BE($,4),J)J.copy(K,8);return K.writeInt32BE(L2.crc32(K.slice(4,K.length-4)),K.length-4),K};Q1.prototype.packGAMA=function($){let J=Buffer.alloc(4);return J.writeUInt32BE(Math.floor($*S6.GAMMA_DIVISION),0),this._packChunk(S6.TYPE_gAMA,J)};Q1.prototype.packIHDR=function($,J){let X=Buffer.alloc(13);return X.writeUInt32BE($,0),X.writeUInt32BE(J,4),X[8]=this._options.bitDepth,X[9]=this._options.colorType,X[10]=0,X[11]=0,X[12]=0,this._packChunk(S6.TYPE_IHDR,X)};Q1.prototype.packIDAT=function($){return this._packChunk(S6.TYPE_IDAT,$)};Q1.prototype.packIEND=function(){return this._packChunk(S6.TYPE_IEND,null)}});var jq=L0((mA,Eq)=>{var B2=O6("util"),Uq=O6("stream"),P2=K5(),S2=qJ(),Lq=Eq.exports=function($){Uq.call(this);let J=$||{};this._packer=new S2(J),this._deflate=this._packer.createDeflate(),this.readable=!0};B2.inherits(Lq,Uq);Lq.prototype.pack=function($,J,X,K){if(this.emit("data",Buffer.from(P2.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(J,X)),K)this.emit("data",this._packer.packGAMA(K));let q=this._packer.filterData($,J,X);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",function(Y){this.emit("data",this._packer.packIDAT(Y))}.bind(this)),this._deflate.on("end",function(){this.emit("data",this._packer.packIEND()),this.emit("end")}.bind(this)),this._deflate.end(q)}});var Fq=L0((W9,Aq)=>{var Rq=O6("assert").ok,q5=O6("zlib"),A2=O6("util"),Bq=O6("buffer").kMaxLength;function T1($){if(!(this instanceof T1))return new T1($);if($&&$.chunkSize<q5.Z_MIN_CHUNK)$.chunkSize=q5.Z_MIN_CHUNK;if(q5.Inflate.call(this,$),this._offset=this._offset===void 0?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,$&&$.maxLength!=null)this._maxLength=$.maxLength}function F2($){return new T1($)}function Pq($,J){if(J)process.nextTick(J);if(!$._handle)return;$._handle.close(),$._handle=null}T1.prototype._processChunk=function($,J,X){if(typeof X==="function")return q5.Inflate._processChunk.call(this,$,J,X);let K=this,q=$&&$.length,Y=this._chunkSize-this._offset,W=this._maxLength,Q=0,N=[],M=0,V;this.on("error",function(L){V=L});function G(L,j){if(K._hadError)return;let E=Y-j;if(Rq(E>=0,"have should not go down"),E>0){let B=K._buffer.slice(K._offset,K._offset+E);if(K._offset+=E,B.length>W)B=B.slice(0,W);if(N.push(B),M+=B.length,W-=B.length,W===0)return!1}if(j===0||K._offset>=K._chunkSize)Y=K._chunkSize,K._offset=0,K._buffer=Buffer.allocUnsafe(K._chunkSize);if(j===0)return Q+=q-L,q=L,!0;return!1}Rq(this._handle,"zlib binding closed");let H;do H=this._handle.writeSync(J,$,Q,q,this._buffer,this._offset,Y),H=H||this._writeState;while(!this._hadError&&G(H[0],H[1]));if(this._hadError)throw V;if(M>=Bq)throw Pq(this),RangeError("Cannot create final Buffer. It would be larger than 0x"+Bq.toString(16)+" bytes");let O=Buffer.concat(N,M);return Pq(this),O};A2.inherits(T1,q5.Inflate);function z2($,J){if(typeof J==="string")J=Buffer.from(J);if(!(J instanceof Buffer))throw TypeError("Not a string or buffer");let X=$._finishFlushFlag;if(X==null)X=q5.Z_FINISH;return $._processChunk(J,X)}function Sq($,J){return z2(new T1(J),$)}Aq.exports=W9=Sq;W9.Inflate=T1;W9.createInflate=F2;W9.inflateSync=Sq});var YJ=L0((pA,vq)=>{var zq=vq.exports=function($){this._buffer=$,this._reads=[]};zq.prototype.read=function($,J){this._reads.push({length:Math.abs($),allowLess:$<0,func:J})};zq.prototype.process=function(){while(this._reads.length>0&&this._buffer.length){let $=this._reads[0];if(this._buffer.length&&(this._buffer.length>=$.length||$.allowLess)){this._reads.shift();let J=this._buffer;this._buffer=J.slice($.length),$.func.call(this,J.slice(0,$.length))}else break}if(this._reads.length>0)throw Error("There are some read requests waitng on finished stream");if(this._buffer.length>0)throw Error("unrecognised content at end of stream")}});var Cq=L0((Z2)=>{var v2=YJ(),C2=s7();Z2.process=function($,J){let X=[],K=new v2($);return new C2(J,{read:K.read.bind(K),write:function(Y){X.push(Y)},complete:function(){}}).start(),K.process(),Buffer.concat(X)}});var wq=L0((lA,kq)=>{var Zq=!0,Dq=O6("zlib"),k2=Fq();if(!Dq.deflateSync)Zq=!1;var w2=YJ(),T2=Cq(),I2=$J(),_2=JJ(),y2=XJ();kq.exports=function($,J){if(!Zq)throw Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let X;function K(z){X=z}let q;function Y(z){q=z}function W(z){q.transColor=z}function Q(z){q.palette=z}function N(){q.alpha=!0}let M;function V(z){M=z}let G=[];function H(z){G.push(z)}let O=new w2($);if(new I2(J,{read:O.read.bind(O),error:K,metadata:Y,gamma:V,palette:Q,transColor:W,inflateData:H,simpleTransparency:N}).start(),O.process(),X)throw X;let j=Buffer.concat(G);G.length=0;let E;if(q.interlace)E=Dq.inflateSync(j);else{let P=((q.width*q.bpp*q.depth+7>>3)+1)*q.height;E=k2(j,{chunkSize:P,maxLength:P})}if(j=null,!E||!E.length)throw Error("bad png - invalid inflate data response");let B=T2.process(E,q);j=null;let S=_2.dataToBitMap(B,q);B=null;let A=y2(S,q,J.skipRescale);return q.data=A,q.gamma=M||0,q}});var yq=L0((cA,_q)=>{var Tq=!0,Iq=O6("zlib");if(!Iq.deflateSync)Tq=!1;var x2=K5(),h2=qJ();_q.exports=function($,J){if(!Tq)throw Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let K=new h2(J||{}),q=[];if(q.push(Buffer.from(x2.PNG_SIGNATURE)),q.push(K.packIHDR($.width,$.height)),$.gamma)q.push(K.packGAMA($.gamma));let Y=K.filterData($.data,$.width,$.height),W=Iq.deflateSync(Y,K.getDeflateOptions());if(Y=null,!W||!W.length)throw Error("bad png - invalid compressed data response");return q.push(K.packIDAT(W)),q.push(K.packIEND()),Buffer.concat(q)}});var xq=L0((b2)=>{var g2=wq(),f2=yq();b2.read=function($,J){return g2($,J||{})};b2.write=function($,J){return f2($,J)}});var gq=L0((n2)=>{var u2=O6("util"),hq=O6("stream"),l2=Qq(),c2=jq(),d2=xq(),C6=n2.PNG=function($){if(hq.call(this),$=$||{},this.width=$.width|0,this.height=$.height|0,this.data=this.width>0&&this.height>0?Buffer.alloc(4*this.width*this.height):null,$.fill&&this.data)this.data.fill(0);this.gamma=0,this.readable=this.writable=!0,this._parser=new l2($),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",function(J){this.data=J,this.emit("parsed",J)}.bind(this)),this._packer=new c2($),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};u2.inherits(C6,hq);C6.sync=d2;C6.prototype.pack=function(){if(!this.data||!this.data.length)return this.emit("error","No data provided"),this;return process.nextTick(function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}.bind(this)),this};C6.prototype.parse=function($,J){if(J){let X,K;X=function(q){this.removeListener("error",K),this.data=q,J(null,this)}.bind(this),K=function(q){this.removeListener("parsed",X),J(q,null)}.bind(this),this.once("parsed",X),this.once("error",K)}return this.end($),this};C6.prototype.write=function($){return this._parser.write($),!0};C6.prototype.end=function($){this._parser.end($)};C6.prototype._metadata=function($){this.width=$.width,this.height=$.height,this.emit("metadata",$)};C6.prototype._gamma=function($){this.gamma=$};C6.prototype._handleClose=function(){if(!this._parser.writable&&!this._packer.readable)this.emit("close")};C6.bitblt=function($,J,X,K,q,Y,W,Q){if(X|=0,K|=0,q|=0,Y|=0,W|=0,Q|=0,X>$.width||K>$.height||X+q>$.width||K+Y>$.height)throw Error("bitblt reading outside image");if(W>J.width||Q>J.height||W+q>J.width||Q+Y>J.height)throw Error("bitblt writing outside image");for(let N=0;N<Y;N++)$.data.copy(J.data,(Q+N)*J.width+W<<2,(K+N)*$.width+X<<2,(K+N)*$.width+X+q<<2)};C6.prototype.bitblt=function($,J,X,K,q,Y,W){return C6.bitblt(this,$,J,X,K,q,Y,W),this};C6.adjustGamma=function($){if($.gamma){for(let J=0;J<$.height;J++)for(let X=0;X<$.width;X++){let K=$.width*J+X<<2;for(let q=0;q<3;q++){let Y=$.data[K+q]/255;Y=Math.pow(Y,0.45454545454545453/$.gamma),$.data[K+q]=Math.round(Y*255)}}$.gamma=0}};C6.prototype.adjustGamma=function(){C6.adjustGamma(this)}});var c8=L0((WJ)=>{var s2=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function a2($,J){return Object.prototype.hasOwnProperty.call($,J)}WJ.assign=function($){var J=Array.prototype.slice.call(arguments,1);while(J.length){var X=J.shift();if(!X)continue;if(typeof X!=="object")throw TypeError(X+"must be non-object");for(var K in X)if(a2(X,K))$[K]=X[K]}return $};WJ.shrinkBuf=function($,J){if($.length===J)return $;if($.subarray)return $.subarray(0,J);return $.length=J,$};var t2={arraySet:function($,J,X,K,q){if(J.subarray&&$.subarray){$.set(J.subarray(X,X+K),q);return}for(var Y=0;Y<K;Y++)$[q+Y]=J[X+Y]},flattenChunks:function($){var J,X,K,q,Y,W;K=0;for(J=0,X=$.length;J<X;J++)K+=$[J].length;W=new Uint8Array(K),q=0;for(J=0,X=$.length;J<X;J++)Y=$[J],W.set(Y,q),q+=Y.length;return W}},e2={arraySet:function($,J,X,K,q){for(var Y=0;Y<K;Y++)$[q+Y]=J[X+Y]},flattenChunks:function($){return[].concat.apply([],$)}};WJ.setTyped=function($){if($)WJ.Buf8=Uint8Array,WJ.Buf16=Uint16Array,WJ.Buf32=Int32Array,WJ.assign(WJ,t2);else WJ.Buf8=Array,WJ.Buf16=Array,WJ.Buf32=Array,WJ.assign(WJ,e2)};WJ.setTyped(s2)});var QY=L0((AO)=>{var JO=c8(),XO=4,bq=0,mq=1,KO=2;function W5($){var J=$.length;while(--J>=0)$[J]=0}var qO=0,nq=1,YO=2,WO=3,QO=258,UJ=29,O9=256,M9=O9+1+UJ,Y5=30,LJ=19,oq=2*M9+1,I1=15,NJ=16,NO=7,EJ=256,rq=16,iq=17,sq=18,HJ=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],R$=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],MO=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],aq=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],VO=512,d8=Array((M9+2)*2);W5(d8);var N9=Array(Y5*2);W5(N9);var V9=Array(VO);W5(V9);var G9=Array(QO-WO+1);W5(G9);var jJ=Array(UJ);W5(jJ);var B$=Array(Y5);W5(B$);function MJ($,J,X,K,q){this.static_tree=$,this.extra_bits=J,this.extra_base=X,this.elems=K,this.max_length=q,this.has_stree=$&&$.length}var tq,eq,$Y;function VJ($,J){this.dyn_tree=$,this.max_code=0,this.stat_desc=J}function JY($){return $<256?V9[$]:V9[256+($>>>7)]}function H9($,J){$.pending_buf[$.pending++]=J&255,$.pending_buf[$.pending++]=J>>>8&255}function T6($,J,X){if($.bi_valid>NJ-X)$.bi_buf|=J<<$.bi_valid&65535,H9($,$.bi_buf),$.bi_buf=J>>NJ-$.bi_valid,$.bi_valid+=X-NJ;else $.bi_buf|=J<<$.bi_valid&65535,$.bi_valid+=X}function v8($,J,X){T6($,X[J*2],X[J*2+1])}function XY($,J){var X=0;do X|=$&1,$>>>=1,X<<=1;while(--J>0);return X>>>1}function GO($){if($.bi_valid===16)H9($,$.bi_buf),$.bi_buf=0,$.bi_valid=0;else if($.bi_valid>=8)$.pending_buf[$.pending++]=$.bi_buf&255,$.bi_buf>>=8,$.bi_valid-=8}function HO($,J){var{dyn_tree:X,max_code:K}=J,q=J.stat_desc.static_tree,Y=J.stat_desc.has_stree,W=J.stat_desc.extra_bits,Q=J.stat_desc.extra_base,N=J.stat_desc.max_length,M,V,G,H,O,L,j=0;for(H=0;H<=I1;H++)$.bl_count[H]=0;X[$.heap[$.heap_max]*2+1]=0;for(M=$.heap_max+1;M<oq;M++){if(V=$.heap[M],H=X[X[V*2+1]*2+1]+1,H>N)H=N,j++;if(X[V*2+1]=H,V>K)continue;if($.bl_count[H]++,O=0,V>=Q)O=W[V-Q];if(L=X[V*2],$.opt_len+=L*(H+O),Y)$.static_len+=L*(q[V*2+1]+O)}if(j===0)return;do{H=N-1;while($.bl_count[H]===0)H--;$.bl_count[H]--,$.bl_count[H+1]+=2,$.bl_count[N]--,j-=2}while(j>0);for(H=N;H!==0;H--){V=$.bl_count[H];while(V!==0){if(G=$.heap[--M],G>K)continue;if(X[G*2+1]!==H)$.opt_len+=(H-X[G*2+1])*X[G*2],X[G*2+1]=H;V--}}}function KY($,J,X){var K=Array(I1+1),q=0,Y,W;for(Y=1;Y<=I1;Y++)K[Y]=q=q+X[Y-1]<<1;for(W=0;W<=J;W++){var Q=$[W*2+1];if(Q===0)continue;$[W*2]=XY(K[Q]++,Q)}}function OO(){var $,J,X,K,q,Y=Array(I1+1);X=0;for(K=0;K<UJ-1;K++){jJ[K]=X;for($=0;$<1<<HJ[K];$++)G9[X++]=K}G9[X-1]=K,q=0;for(K=0;K<16;K++){B$[K]=q;for($=0;$<1<<R$[K];$++)V9[q++]=K}q>>=7;for(;K<Y5;K++){B$[K]=q<<7;for($=0;$<1<<R$[K]-7;$++)V9[256+q++]=K}for(J=0;J<=I1;J++)Y[J]=0;$=0;while($<=143)d8[$*2+1]=8,$++,Y[8]++;while($<=255)d8[$*2+1]=9,$++,Y[9]++;while($<=279)d8[$*2+1]=7,$++,Y[7]++;while($<=287)d8[$*2+1]=8,$++,Y[8]++;KY(d8,M9+1,Y);for($=0;$<Y5;$++)N9[$*2+1]=5,N9[$*2]=XY($,5);tq=new MJ(d8,HJ,O9+1,M9,I1),eq=new MJ(N9,R$,0,Y5,I1),$Y=new MJ([],MO,0,LJ,NO)}function qY($){var J;for(J=0;J<M9;J++)$.dyn_ltree[J*2]=0;for(J=0;J<Y5;J++)$.dyn_dtree[J*2]=0;for(J=0;J<LJ;J++)$.bl_tree[J*2]=0;$.dyn_ltree[EJ*2]=1,$.opt_len=$.static_len=0,$.last_lit=$.matches=0}function YY($){if($.bi_valid>8)H9($,$.bi_buf);else if($.bi_valid>0)$.pending_buf[$.pending++]=$.bi_buf;$.bi_buf=0,$.bi_valid=0}function UO($,J,X,K){if(YY($),K)H9($,X),H9($,~X);JO.arraySet($.pending_buf,$.window,J,X,$.pending),$.pending+=X}function pq($,J,X,K){var q=J*2,Y=X*2;return $[q]<$[Y]||$[q]===$[Y]&&K[J]<=K[X]}function GJ($,J,X){var K=$.heap[X],q=X<<1;while(q<=$.heap_len){if(q<$.heap_len&&pq(J,$.heap[q+1],$.heap[q],$.depth))q++;if(pq(J,K,$.heap[q],$.depth))break;$.heap[X]=$.heap[q],X=q,q<<=1}$.heap[X]=K}function uq($,J,X){var K,q,Y=0,W,Q;if($.last_lit!==0)do if(K=$.pending_buf[$.d_buf+Y*2]<<8|$.pending_buf[$.d_buf+Y*2+1],q=$.pending_buf[$.l_buf+Y],Y++,K===0)v8($,q,J);else{if(W=G9[q],v8($,W+O9+1,J),Q=HJ[W],Q!==0)q-=jJ[W],T6($,q,Q);if(K--,W=JY(K),v8($,W,X),Q=R$[W],Q!==0)K-=B$[W],T6($,K,Q)}while(Y<$.last_lit);v8($,EJ,J)}function OJ($,J){var X=J.dyn_tree,K=J.stat_desc.static_tree,q=J.stat_desc.has_stree,Y=J.stat_desc.elems,W,Q,N=-1,M;$.heap_len=0,$.heap_max=oq;for(W=0;W<Y;W++)if(X[W*2]!==0)$.heap[++$.heap_len]=N=W,$.depth[W]=0;else X[W*2+1]=0;while($.heap_len<2)if(M=$.heap[++$.heap_len]=N<2?++N:0,X[M*2]=1,$.depth[M]=0,$.opt_len--,q)$.static_len-=K[M*2+1];J.max_code=N;for(W=$.heap_len>>1;W>=1;W--)GJ($,X,W);M=Y;do W=$.heap[1],$.heap[1]=$.heap[$.heap_len--],GJ($,X,1),Q=$.heap[1],$.heap[--$.heap_max]=W,$.heap[--$.heap_max]=Q,X[M*2]=X[W*2]+X[Q*2],$.depth[M]=($.depth[W]>=$.depth[Q]?$.depth[W]:$.depth[Q])+1,X[W*2+1]=X[Q*2+1]=M,$.heap[1]=M++,GJ($,X,1);while($.heap_len>=2);$.heap[--$.heap_max]=$.heap[1],HO($,J),KY(X,N,$.bl_count)}function lq($,J,X){var K,q=-1,Y,W=J[1],Q=0,N=7,M=4;if(W===0)N=138,M=3;J[(X+1)*2+1]=65535;for(K=0;K<=X;K++){if(Y=W,W=J[(K+1)*2+1],++Q<N&&Y===W)continue;else if(Q<M)$.bl_tree[Y*2]+=Q;else if(Y!==0){if(Y!==q)$.bl_tree[Y*2]++;$.bl_tree[rq*2]++}else if(Q<=10)$.bl_tree[iq*2]++;else $.bl_tree[sq*2]++;if(Q=0,q=Y,W===0)N=138,M=3;else if(Y===W)N=6,M=3;else N=7,M=4}}function cq($,J,X){var K,q=-1,Y,W=J[1],Q=0,N=7,M=4;if(W===0)N=138,M=3;for(K=0;K<=X;K++){if(Y=W,W=J[(K+1)*2+1],++Q<N&&Y===W)continue;else if(Q<M)do v8($,Y,$.bl_tree);while(--Q!==0);else if(Y!==0){if(Y!==q)v8($,Y,$.bl_tree),Q--;v8($,rq,$.bl_tree),T6($,Q-3,2)}else if(Q<=10)v8($,iq,$.bl_tree),T6($,Q-3,3);else v8($,sq,$.bl_tree),T6($,Q-11,7);if(Q=0,q=Y,W===0)N=138,M=3;else if(Y===W)N=6,M=3;else N=7,M=4}}function LO($){var J;lq($,$.dyn_ltree,$.l_desc.max_code),lq($,$.dyn_dtree,$.d_desc.max_code),OJ($,$.bl_desc);for(J=LJ-1;J>=3;J--)if($.bl_tree[aq[J]*2+1]!==0)break;return $.opt_len+=3*(J+1)+5+5+4,J}function EO($,J,X,K){var q;T6($,J-257,5),T6($,X-1,5),T6($,K-4,4);for(q=0;q<K;q++)T6($,$.bl_tree[aq[q]*2+1],3);cq($,$.dyn_ltree,J-1),cq($,$.dyn_dtree,X-1)}function jO($){var J=4093624447,X;for(X=0;X<=31;X++,J>>>=1)if(J&1&&$.dyn_ltree[X*2]!==0)return bq;if($.dyn_ltree[18]!==0||$.dyn_ltree[20]!==0||$.dyn_ltree[26]!==0)return mq;for(X=32;X<O9;X++)if($.dyn_ltree[X*2]!==0)return mq;return bq}var dq=!1;function RO($){if(!dq)OO(),dq=!0;$.l_desc=new VJ($.dyn_ltree,tq),$.d_desc=new VJ($.dyn_dtree,eq),$.bl_desc=new VJ($.bl_tree,$Y),$.bi_buf=0,$.bi_valid=0,qY($)}function WY($,J,X,K){T6($,(qO<<1)+(K?1:0),3),UO($,J,X,!0)}function BO($){T6($,nq<<1,3),v8($,EJ,d8),GO($)}function PO($,J,X,K){var q,Y,W=0;if($.level>0){if($.strm.data_type===KO)$.strm.data_type=jO($);if(OJ($,$.l_desc),OJ($,$.d_desc),W=LO($),q=$.opt_len+3+7>>>3,Y=$.static_len+3+7>>>3,Y<=q)q=Y}else q=Y=X+5;if(X+4<=q&&J!==-1)WY($,J,X,K);else if($.strategy===XO||Y===q)T6($,(nq<<1)+(K?1:0),3),uq($,d8,N9);else T6($,(YO<<1)+(K?1:0),3),EO($,$.l_desc.max_code+1,$.d_desc.max_code+1,W+1),uq($,$.dyn_ltree,$.dyn_dtree);if(qY($),K)YY($)}function SO($,J,X){if($.pending_buf[$.d_buf+$.last_lit*2]=J>>>8&255,$.pending_buf[$.d_buf+$.last_lit*2+1]=J&255,$.pending_buf[$.l_buf+$.last_lit]=X&255,$.last_lit++,J===0)$.dyn_ltree[X*2]++;else $.matches++,J--,$.dyn_ltree[(G9[X]+O9+1)*2]++,$.dyn_dtree[JY(J)*2]++;return $.last_lit===$.lit_bufsize-1}AO._tr_init=RO;AO._tr_stored_block=WY;AO._tr_flush_block=PO;AO._tr_tally=SO;AO._tr_align=BO});var RJ=L0(($F,NY)=>{function DO($,J,X,K){var q=$&65535|0,Y=$>>>16&65535|0,W=0;while(X!==0){W=X>2000?2000:X,X-=W;do q=q+J[K++]|0,Y=Y+q|0;while(--W);q%=65521,Y%=65521}return q|Y<<16|0}NY.exports=DO});var BJ=L0((JF,MY)=>{function kO(){var $,J=[];for(var X=0;X<256;X++){$=X;for(var K=0;K<8;K++)$=$&1?3988292384^$>>>1:$>>>1;J[X]=$}return J}var wO=kO();function TO($,J,X,K){var q=wO,Y=K+X;$^=-1;for(var W=K;W<Y;W++)$=$>>>8^q[($^J[W])&255];return $^-1}MY.exports=TO});var P$=L0((XF,VY)=>{VY.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var BY=L0((VU)=>{var Z6=c8(),s6=QY(),UY=RJ(),N1=BJ(),IO=P$(),h1=0,_O=1,yO=3,O1=4,GY=5,Z8=0,HY=1,a6=-2,xO=-3,PJ=-5,hO=-1,gO=1,S$=2,fO=3,bO=4,mO=0,pO=2,v$=8,uO=9,lO=15,cO=8,dO=29,nO=256,AJ=nO+1+dO,oO=30,rO=19,iO=2*AJ+1,sO=15,n0=3,G1=258,M8=G1+n0+1,aO=32,C$=42,FJ=69,A$=73,F$=91,z$=103,_1=113,L9=666,H6=1,E9=2,y1=3,M5=4,tO=3;function H1($,J){return $.msg=IO[J],J}function OY($){return($<<1)-($>4?9:0)}function V1($){var J=$.length;while(--J>=0)$[J]=0}function M1($){var J=$.state,X=J.pending;if(X>$.avail_out)X=$.avail_out;if(X===0)return;if(Z6.arraySet($.output,J.pending_buf,J.pending_out,X,$.next_out),$.next_out+=X,J.pending_out+=X,$.total_out+=X,$.avail_out-=X,J.pending-=X,J.pending===0)J.pending_out=0}function j6($,J){s6._tr_flush_block($,$.block_start>=0?$.block_start:-1,$.strstart-$.block_start,J),$.block_start=$.strstart,M1($.strm)}function o0($,J){$.pending_buf[$.pending++]=J}function U9($,J){$.pending_buf[$.pending++]=J>>>8&255,$.pending_buf[$.pending++]=J&255}function eO($,J,X,K){var q=$.avail_in;if(q>K)q=K;if(q===0)return 0;if($.avail_in-=q,Z6.arraySet(J,$.input,$.next_in,q,X),$.state.wrap===1)$.adler=UY($.adler,J,q,X);else if($.state.wrap===2)$.adler=N1($.adler,J,q,X);return $.next_in+=q,$.total_in+=q,q}function LY($,J){var{max_chain_length:X,strstart:K}=$,q,Y,W=$.prev_length,Q=$.nice_match,N=$.strstart>$.w_size-M8?$.strstart-($.w_size-M8):0,M=$.window,V=$.w_mask,G=$.prev,H=$.strstart+G1,O=M[K+W-1],L=M[K+W];if($.prev_length>=$.good_match)X>>=2;if(Q>$.lookahead)Q=$.lookahead;do{if(q=J,M[q+W]!==L||M[q+W-1]!==O||M[q]!==M[K]||M[++q]!==M[K+1])continue;K+=2,q++;do;while(M[++K]===M[++q]&&M[++K]===M[++q]&&M[++K]===M[++q]&&M[++K]===M[++q]&&M[++K]===M[++q]&&M[++K]===M[++q]&&M[++K]===M[++q]&&M[++K]===M[++q]&&K<H);if(Y=G1-(H-K),K=H-G1,Y>W){if($.match_start=J,W=Y,Y>=Q)break;O=M[K+W-1],L=M[K+W]}}while((J=G[J&V])>N&&--X!==0);if(W<=$.lookahead)return W;return $.lookahead}function x1($){var J=$.w_size,X,K,q,Y,W;do{if(Y=$.window_size-$.lookahead-$.strstart,$.strstart>=J+(J-M8)){Z6.arraySet($.window,$.window,J,J,0),$.match_start-=J,$.strstart-=J,$.block_start-=J,K=$.hash_size,X=K;do q=$.head[--X],$.head[X]=q>=J?q-J:0;while(--K);K=J,X=K;do q=$.prev[--X],$.prev[X]=q>=J?q-J:0;while(--K);Y+=J}if($.strm.avail_in===0)break;if(K=eO($.strm,$.window,$.strstart+$.lookahead,Y),$.lookahead+=K,$.lookahead+$.insert>=n0){W=$.strstart-$.insert,$.ins_h=$.window[W],$.ins_h=($.ins_h<<$.hash_shift^$.window[W+1])&$.hash_mask;while($.insert)if($.ins_h=($.ins_h<<$.hash_shift^$.window[W+n0-1])&$.hash_mask,$.prev[W&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=W,W++,$.insert--,$.lookahead+$.insert<n0)break}}while($.lookahead<M8&&$.strm.avail_in!==0)}function $U($,J){var X=65535;if(X>$.pending_buf_size-5)X=$.pending_buf_size-5;for(;;){if($.lookahead<=1){if(x1($),$.lookahead===0&&J===h1)return H6;if($.lookahead===0)break}$.strstart+=$.lookahead,$.lookahead=0;var K=$.block_start+X;if($.strstart===0||$.strstart>=K){if($.lookahead=$.strstart-K,$.strstart=K,j6($,!1),$.strm.avail_out===0)return H6}if($.strstart-$.block_start>=$.w_size-M8){if(j6($,!1),$.strm.avail_out===0)return H6}}if($.insert=0,J===O1){if(j6($,!0),$.strm.avail_out===0)return y1;return M5}if($.strstart>$.block_start){if(j6($,!1),$.strm.avail_out===0)return H6}return H6}function SJ($,J){var X,K;for(;;){if($.lookahead<M8){if(x1($),$.lookahead<M8&&J===h1)return H6;if($.lookahead===0)break}if(X=0,$.lookahead>=n0)$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+n0-1])&$.hash_mask,X=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart;if(X!==0&&$.strstart-X<=$.w_size-M8)$.match_length=LY($,X);if($.match_length>=n0)if(K=s6._tr_tally($,$.strstart-$.match_start,$.match_length-n0),$.lookahead-=$.match_length,$.match_length<=$.max_lazy_match&&$.lookahead>=n0){$.match_length--;do $.strstart++,$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+n0-1])&$.hash_mask,X=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart;while(--$.match_length!==0);$.strstart++}else $.strstart+=$.match_length,$.match_length=0,$.ins_h=$.window[$.strstart],$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+1])&$.hash_mask;else K=s6._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++;if(K){if(j6($,!1),$.strm.avail_out===0)return H6}}if($.insert=$.strstart<n0-1?$.strstart:n0-1,J===O1){if(j6($,!0),$.strm.avail_out===0)return y1;return M5}if($.last_lit){if(j6($,!1),$.strm.avail_out===0)return H6}return E9}function Q5($,J){var X,K,q;for(;;){if($.lookahead<M8){if(x1($),$.lookahead<M8&&J===h1)return H6;if($.lookahead===0)break}if(X=0,$.lookahead>=n0)$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+n0-1])&$.hash_mask,X=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart;if($.prev_length=$.match_length,$.prev_match=$.match_start,$.match_length=n0-1,X!==0&&$.prev_length<$.max_lazy_match&&$.strstart-X<=$.w_size-M8){if($.match_length=LY($,X),$.match_length<=5&&($.strategy===gO||$.match_length===n0&&$.strstart-$.match_start>4096))$.match_length=n0-1}if($.prev_length>=n0&&$.match_length<=$.prev_length){q=$.strstart+$.lookahead-n0,K=s6._tr_tally($,$.strstart-1-$.prev_match,$.prev_length-n0),$.lookahead-=$.prev_length-1,$.prev_length-=2;do if(++$.strstart<=q)$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+n0-1])&$.hash_mask,X=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart;while(--$.prev_length!==0);if($.match_available=0,$.match_length=n0-1,$.strstart++,K){if(j6($,!1),$.strm.avail_out===0)return H6}}else if($.match_available){if(K=s6._tr_tally($,0,$.window[$.strstart-1]),K)j6($,!1);if($.strstart++,$.lookahead--,$.strm.avail_out===0)return H6}else $.match_available=1,$.strstart++,$.lookahead--}if($.match_available)K=s6._tr_tally($,0,$.window[$.strstart-1]),$.match_available=0;if($.insert=$.strstart<n0-1?$.strstart:n0-1,J===O1){if(j6($,!0),$.strm.avail_out===0)return y1;return M5}if($.last_lit){if(j6($,!1),$.strm.avail_out===0)return H6}return E9}function JU($,J){var X,K,q,Y,W=$.window;for(;;){if($.lookahead<=G1){if(x1($),$.lookahead<=G1&&J===h1)return H6;if($.lookahead===0)break}if($.match_length=0,$.lookahead>=n0&&$.strstart>0){if(q=$.strstart-1,K=W[q],K===W[++q]&&K===W[++q]&&K===W[++q]){Y=$.strstart+G1;do;while(K===W[++q]&&K===W[++q]&&K===W[++q]&&K===W[++q]&&K===W[++q]&&K===W[++q]&&K===W[++q]&&K===W[++q]&&q<Y);if($.match_length=G1-(Y-q),$.match_length>$.lookahead)$.match_length=$.lookahead}}if($.match_length>=n0)X=s6._tr_tally($,1,$.match_length-n0),$.lookahead-=$.match_length,$.strstart+=$.match_length,$.match_length=0;else X=s6._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++;if(X){if(j6($,!1),$.strm.avail_out===0)return H6}}if($.insert=0,J===O1){if(j6($,!0),$.strm.avail_out===0)return y1;return M5}if($.last_lit){if(j6($,!1),$.strm.avail_out===0)return H6}return E9}function XU($,J){var X;for(;;){if($.lookahead===0){if(x1($),$.lookahead===0){if(J===h1)return H6;break}}if($.match_length=0,X=s6._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++,X){if(j6($,!1),$.strm.avail_out===0)return H6}}if($.insert=0,J===O1){if(j6($,!0),$.strm.avail_out===0)return y1;return M5}if($.last_lit){if(j6($,!1),$.strm.avail_out===0)return H6}return E9}function C8($,J,X,K,q){this.good_length=$,this.max_lazy=J,this.nice_length=X,this.max_chain=K,this.func=q}var N5;N5=[new C8(0,0,0,0,$U),new C8(4,4,8,4,SJ),new C8(4,5,16,8,SJ),new C8(4,6,32,32,SJ),new C8(4,4,16,16,Q5),new C8(8,16,32,32,Q5),new C8(8,16,128,128,Q5),new C8(8,32,128,256,Q5),new C8(32,128,258,1024,Q5),new C8(32,258,258,4096,Q5)];function KU($){$.window_size=2*$.w_size,V1($.head),$.max_lazy_match=N5[$.level].max_lazy,$.good_match=N5[$.level].good_length,$.nice_match=N5[$.level].nice_length,$.max_chain_length=N5[$.level].max_chain,$.strstart=0,$.block_start=0,$.lookahead=0,$.insert=0,$.match_length=$.prev_length=n0-1,$.match_available=0,$.ins_h=0}function qU(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v$,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Z6.Buf16(iO*2),this.dyn_dtree=new Z6.Buf16((2*oO+1)*2),this.bl_tree=new Z6.Buf16((2*rO+1)*2),V1(this.dyn_ltree),V1(this.dyn_dtree),V1(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Z6.Buf16(sO+1),this.heap=new Z6.Buf16(2*AJ+1),V1(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Z6.Buf16(2*AJ+1),V1(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function EY($){var J;if(!$||!$.state)return H1($,a6);if($.total_in=$.total_out=0,$.data_type=pO,J=$.state,J.pending=0,J.pending_out=0,J.wrap<0)J.wrap=-J.wrap;return J.status=J.wrap?C$:_1,$.adler=J.wrap===2?0:1,J.last_flush=h1,s6._tr_init(J),Z8}function jY($){var J=EY($);if(J===Z8)KU($.state);return J}function YU($,J){if(!$||!$.state)return a6;if($.state.wrap!==2)return a6;return $.state.gzhead=J,Z8}function RY($,J,X,K,q,Y){if(!$)return a6;var W=1;if(J===hO)J=6;if(K<0)W=0,K=-K;else if(K>15)W=2,K-=16;if(q<1||q>uO||X!==v$||K<8||K>15||J<0||J>9||Y<0||Y>bO)return H1($,a6);if(K===8)K=9;var Q=new qU;return $.state=Q,Q.strm=$,Q.wrap=W,Q.gzhead=null,Q.w_bits=K,Q.w_size=1<<Q.w_bits,Q.w_mask=Q.w_size-1,Q.hash_bits=q+7,Q.hash_size=1<<Q.hash_bits,Q.hash_mask=Q.hash_size-1,Q.hash_shift=~~((Q.hash_bits+n0-1)/n0),Q.window=new Z6.Buf8(Q.w_size*2),Q.head=new Z6.Buf16(Q.hash_size),Q.prev=new Z6.Buf16(Q.w_size),Q.lit_bufsize=1<<q+6,Q.pending_buf_size=Q.lit_bufsize*4,Q.pending_buf=new Z6.Buf8(Q.pending_buf_size),Q.d_buf=1*Q.lit_bufsize,Q.l_buf=3*Q.lit_bufsize,Q.level=J,Q.strategy=Y,Q.method=X,jY($)}function WU($,J){return RY($,J,v$,lO,cO,mO)}function QU($,J){var X,K,q,Y;if(!$||!$.state||J>GY||J<0)return $?H1($,a6):a6;if(K=$.state,!$.output||!$.input&&$.avail_in!==0||K.status===L9&&J!==O1)return H1($,$.avail_out===0?PJ:a6);if(K.strm=$,X=K.last_flush,K.last_flush=J,K.status===C$)if(K.wrap===2)if($.adler=0,o0(K,31),o0(K,139),o0(K,8),!K.gzhead)o0(K,0),o0(K,0),o0(K,0),o0(K,0),o0(K,0),o0(K,K.level===9?2:K.strategy>=S$||K.level<2?4:0),o0(K,tO),K.status=_1;else{if(o0(K,(K.gzhead.text?1:0)+(K.gzhead.hcrc?2:0)+(!K.gzhead.extra?0:4)+(!K.gzhead.name?0:8)+(!K.gzhead.comment?0:16)),o0(K,K.gzhead.time&255),o0(K,K.gzhead.time>>8&255),o0(K,K.gzhead.time>>16&255),o0(K,K.gzhead.time>>24&255),o0(K,K.level===9?2:K.strategy>=S$||K.level<2?4:0),o0(K,K.gzhead.os&255),K.gzhead.extra&&K.gzhead.extra.length)o0(K,K.gzhead.extra.length&255),o0(K,K.gzhead.extra.length>>8&255);if(K.gzhead.hcrc)$.adler=N1($.adler,K.pending_buf,K.pending,0);K.gzindex=0,K.status=FJ}else{var W=v$+(K.w_bits-8<<4)<<8,Q=-1;if(K.strategy>=S$||K.level<2)Q=0;else if(K.level<6)Q=1;else if(K.level===6)Q=2;else Q=3;if(W|=Q<<6,K.strstart!==0)W|=aO;if(W+=31-W%31,K.status=_1,U9(K,W),K.strstart!==0)U9(K,$.adler>>>16),U9(K,$.adler&65535);$.adler=1}if(K.status===FJ)if(K.gzhead.extra){q=K.pending;while(K.gzindex<(K.gzhead.extra.length&65535)){if(K.pending===K.pending_buf_size){if(K.gzhead.hcrc&&K.pending>q)$.adler=N1($.adler,K.pending_buf,K.pending-q,q);if(M1($),q=K.pending,K.pending===K.pending_buf_size)break}o0(K,K.gzhead.extra[K.gzindex]&255),K.gzindex++}if(K.gzhead.hcrc&&K.pending>q)$.adler=N1($.adler,K.pending_buf,K.pending-q,q);if(K.gzindex===K.gzhead.extra.length)K.gzindex=0,K.status=A$}else K.status=A$;if(K.status===A$)if(K.gzhead.name){q=K.pending;do{if(K.pending===K.pending_buf_size){if(K.gzhead.hcrc&&K.pending>q)$.adler=N1($.adler,K.pending_buf,K.pending-q,q);if(M1($),q=K.pending,K.pending===K.pending_buf_size){Y=1;break}}if(K.gzindex<K.gzhead.name.length)Y=K.gzhead.name.charCodeAt(K.gzindex++)&255;else Y=0;o0(K,Y)}while(Y!==0);if(K.gzhead.hcrc&&K.pending>q)$.adler=N1($.adler,K.pending_buf,K.pending-q,q);if(Y===0)K.gzindex=0,K.status=F$}else K.status=F$;if(K.status===F$)if(K.gzhead.comment){q=K.pending;do{if(K.pending===K.pending_buf_size){if(K.gzhead.hcrc&&K.pending>q)$.adler=N1($.adler,K.pending_buf,K.pending-q,q);if(M1($),q=K.pending,K.pending===K.pending_buf_size){Y=1;break}}if(K.gzindex<K.gzhead.comment.length)Y=K.gzhead.comment.charCodeAt(K.gzindex++)&255;else Y=0;o0(K,Y)}while(Y!==0);if(K.gzhead.hcrc&&K.pending>q)$.adler=N1($.adler,K.pending_buf,K.pending-q,q);if(Y===0)K.status=z$}else K.status=z$;if(K.status===z$)if(K.gzhead.hcrc){if(K.pending+2>K.pending_buf_size)M1($);if(K.pending+2<=K.pending_buf_size)o0(K,$.adler&255),o0(K,$.adler>>8&255),$.adler=0,K.status=_1}else K.status=_1;if(K.pending!==0){if(M1($),$.avail_out===0)return K.last_flush=-1,Z8}else if($.avail_in===0&&OY(J)<=OY(X)&&J!==O1)return H1($,PJ);if(K.status===L9&&$.avail_in!==0)return H1($,PJ);if($.avail_in!==0||K.lookahead!==0||J!==h1&&K.status!==L9){var N=K.strategy===S$?XU(K,J):K.strategy===fO?JU(K,J):N5[K.level].func(K,J);if(N===y1||N===M5)K.status=L9;if(N===H6||N===y1){if($.avail_out===0)K.last_flush=-1;return Z8}if(N===E9){if(J===_O)s6._tr_align(K);else if(J!==GY){if(s6._tr_stored_block(K,0,0,!1),J===yO){if(V1(K.head),K.lookahead===0)K.strstart=0,K.block_start=0,K.insert=0}}if(M1($),$.avail_out===0)return K.last_flush=-1,Z8}}if(J!==O1)return Z8;if(K.wrap<=0)return HY;if(K.wrap===2)o0(K,$.adler&255),o0(K,$.adler>>8&255),o0(K,$.adler>>16&255),o0(K,$.adler>>24&255),o0(K,$.total_in&255),o0(K,$.total_in>>8&255),o0(K,$.total_in>>16&255),o0(K,$.total_in>>24&255);else U9(K,$.adler>>>16),U9(K,$.adler&65535);if(M1($),K.wrap>0)K.wrap=-K.wrap;return K.pending!==0?Z8:HY}function NU($){var J;if(!$||!$.state)return a6;if(J=$.state.status,J!==C$&&J!==FJ&&J!==A$&&J!==F$&&J!==z$&&J!==_1&&J!==L9)return H1($,a6);return $.state=null,J===_1?H1($,xO):Z8}function MU($,J){var X=J.length,K,q,Y,W,Q,N,M,V;if(!$||!$.state)return a6;if(K=$.state,W=K.wrap,W===2||W===1&&K.status!==C$||K.lookahead)return a6;if(W===1)$.adler=UY($.adler,J,X,0);if(K.wrap=0,X>=K.w_size){if(W===0)V1(K.head),K.strstart=0,K.block_start=0,K.insert=0;V=new Z6.Buf8(K.w_size),Z6.arraySet(V,J,X-K.w_size,K.w_size,0),J=V,X=K.w_size}Q=$.avail_in,N=$.next_in,M=$.input,$.avail_in=X,$.next_in=0,$.input=J,x1(K);while(K.lookahead>=n0){q=K.strstart,Y=K.lookahead-(n0-1);do K.ins_h=(K.ins_h<<K.hash_shift^K.window[q+n0-1])&K.hash_mask,K.prev[q&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=q,q++;while(--Y);K.strstart=q,K.lookahead=n0-1,x1(K)}return K.strstart+=K.lookahead,K.block_start=K.strstart,K.insert=K.lookahead,K.lookahead=0,K.match_length=K.prev_length=n0-1,K.match_available=0,$.next_in=N,$.input=M,$.avail_in=Q,K.wrap=W,Z8}VU.deflateInit=WU;VU.deflateInit2=RY;VU.deflateReset=jY;VU.deflateResetKeep=EY;VU.deflateSetHeader=YU;VU.deflate=QU;VU.deflateEnd=NU;VU.deflateSetDictionary=MU;VU.deflateInfo="pako deflate (from Nodeca project)"});var zJ=L0((PU)=>{var Z$=c8(),PY=!0,SY=!0;try{String.fromCharCode.apply(null,[0])}catch($){PY=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch($){SY=!1}var j9=new Z$.Buf8(256);for(D8=0;D8<256;D8++)j9[D8]=D8>=252?6:D8>=248?5:D8>=240?4:D8>=224?3:D8>=192?2:1;var D8;j9[254]=j9[254]=1;PU.string2buf=function($){var J,X,K,q,Y,W=$.length,Q=0;for(q=0;q<W;q++){if(X=$.charCodeAt(q),(X&64512)===55296&&q+1<W){if(K=$.charCodeAt(q+1),(K&64512)===56320)X=65536+(X-55296<<10)+(K-56320),q++}Q+=X<128?1:X<2048?2:X<65536?3:4}J=new Z$.Buf8(Q);for(Y=0,q=0;Y<Q;q++){if(X=$.charCodeAt(q),(X&64512)===55296&&q+1<W){if(K=$.charCodeAt(q+1),(K&64512)===56320)X=65536+(X-55296<<10)+(K-56320),q++}if(X<128)J[Y++]=X;else if(X<2048)J[Y++]=192|X>>>6,J[Y++]=128|X&63;else if(X<65536)J[Y++]=224|X>>>12,J[Y++]=128|X>>>6&63,J[Y++]=128|X&63;else J[Y++]=240|X>>>18,J[Y++]=128|X>>>12&63,J[Y++]=128|X>>>6&63,J[Y++]=128|X&63}return J};function AY($,J){if(J<65534){if($.subarray&&SY||!$.subarray&&PY)return String.fromCharCode.apply(null,Z$.shrinkBuf($,J))}var X="";for(var K=0;K<J;K++)X+=String.fromCharCode($[K]);return X}PU.buf2binstring=function($){return AY($,$.length)};PU.binstring2buf=function($){var J=new Z$.Buf8($.length);for(var X=0,K=J.length;X<K;X++)J[X]=$.charCodeAt(X);return J};PU.buf2string=function($,J){var X,K,q,Y,W=J||$.length,Q=Array(W*2);for(K=0,X=0;X<W;){if(q=$[X++],q<128){Q[K++]=q;continue}if(Y=j9[q],Y>4){Q[K++]=65533,X+=Y-1;continue}q&=Y===2?31:Y===3?15:7;while(Y>1&&X<W)q=q<<6|$[X++]&63,Y--;if(Y>1){Q[K++]=65533;continue}if(q<65536)Q[K++]=q;else q-=65536,Q[K++]=55296|q>>10&1023,Q[K++]=56320|q&1023}return AY(Q,K)};PU.utf8border=function($,J){var X;if(J=J||$.length,J>$.length)J=$.length;X=J-1;while(X>=0&&($[X]&192)===128)X--;if(X<0)return J;if(X===0)return J;return X+j9[$[X]]>J?X:J}});var vJ=L0((YF,FY)=>{function CU(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}FY.exports=CU});var ZY=L0((yU)=>{var R9=BY(),B9=c8(),ZJ=zJ(),DJ=P$(),ZU=vJ(),CY=Object.prototype.toString,DU=0,CJ=4,V5=0,zY=1,vY=2,kU=-1,wU=0,TU=8;function g1($){if(!(this instanceof g1))return new g1($);this.options=B9.assign({level:kU,method:TU,chunkSize:16384,windowBits:15,memLevel:8,strategy:wU,to:""},$||{});var J=this.options;if(J.raw&&J.windowBits>0)J.windowBits=-J.windowBits;else if(J.gzip&&J.windowBits>0&&J.windowBits<16)J.windowBits+=16;this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZU,this.strm.avail_out=0;var X=R9.deflateInit2(this.strm,J.level,J.method,J.windowBits,J.memLevel,J.strategy);if(X!==V5)throw Error(DJ[X]);if(J.header)R9.deflateSetHeader(this.strm,J.header);if(J.dictionary){var K;if(typeof J.dictionary==="string")K=ZJ.string2buf(J.dictionary);else if(CY.call(J.dictionary)==="[object ArrayBuffer]")K=new Uint8Array(J.dictionary);else K=J.dictionary;if(X=R9.deflateSetDictionary(this.strm,K),X!==V5)throw Error(DJ[X]);this._dict_set=!0}}g1.prototype.push=function($,J){var X=this.strm,K=this.options.chunkSize,q,Y;if(this.ended)return!1;if(Y=J===~~J?J:J===!0?CJ:DU,typeof $==="string")X.input=ZJ.string2buf($);else if(CY.call($)==="[object ArrayBuffer]")X.input=new Uint8Array($);else X.input=$;X.next_in=0,X.avail_in=X.input.length;do{if(X.avail_out===0)X.output=new B9.Buf8(K),X.next_out=0,X.avail_out=K;if(q=R9.deflate(X,Y),q!==zY&&q!==V5)return this.onEnd(q),this.ended=!0,!1;if(X.avail_out===0||X.avail_in===0&&(Y===CJ||Y===vY))if(this.options.to==="string")this.onData(ZJ.buf2binstring(B9.shrinkBuf(X.output,X.next_out)));else this.onData(B9.shrinkBuf(X.output,X.next_out))}while((X.avail_in>0||X.avail_out===0)&&q!==zY);if(Y===CJ)return q=R9.deflateEnd(this.strm),this.onEnd(q),this.ended=!0,q===V5;if(Y===vY)return this.onEnd(V5),X.avail_out=0,!0;return!0};g1.prototype.onData=function($){this.chunks.push($)};g1.prototype.onEnd=function($){if($===V5)if(this.options.to==="string")this.result=this.chunks.join("");else this.result=B9.flattenChunks(this.chunks);this.chunks=[],this.err=$,this.msg=this.strm.msg};function kJ($,J){var X=new g1(J);if(X.push($,!0),X.err)throw X.msg||DJ[X.err];return X.result}function IU($,J){return J=J||{},J.raw=!0,kJ($,J)}function _U($,J){return J=J||{},J.gzip=!0,kJ($,J)}yU.Deflate=g1;yU.deflate=kJ;yU.deflateRaw=IU;yU.gzip=_U});var kY=L0((QF,DY)=>{var D$=30,bU=12;DY.exports=function(J,X){var K,q,Y,W,Q,N,M,V,G,H,O,L,j,E,B,S,A,z,P,R,U,C,k,h,F;K=J.state,q=J.next_in,h=J.input,Y=q+(J.avail_in-5),W=J.next_out,F=J.output,Q=W-(X-J.avail_out),N=W+(J.avail_out-257),M=K.dmax,V=K.wsize,G=K.whave,H=K.wnext,O=K.window,L=K.hold,j=K.bits,E=K.lencode,B=K.distcode,S=(1<<K.lenbits)-1,A=(1<<K.distbits)-1;$:do{if(j<15)L+=h[q++]<<j,j+=8,L+=h[q++]<<j,j+=8;z=E[L&S];J:for(;;){if(P=z>>>24,L>>>=P,j-=P,P=z>>>16&255,P===0)F[W++]=z&65535;else if(P&16){if(R=z&65535,P&=15,P){if(j<P)L+=h[q++]<<j,j+=8;R+=L&(1<<P)-1,L>>>=P,j-=P}if(j<15)L+=h[q++]<<j,j+=8,L+=h[q++]<<j,j+=8;z=B[L&A];X:for(;;){if(P=z>>>24,L>>>=P,j-=P,P=z>>>16&255,P&16){if(U=z&65535,P&=15,j<P){if(L+=h[q++]<<j,j+=8,j<P)L+=h[q++]<<j,j+=8}if(U+=L&(1<<P)-1,U>M){J.msg="invalid distance too far back",K.mode=D$;break $}if(L>>>=P,j-=P,P=W-Q,U>P){if(P=U-P,P>G){if(K.sane){J.msg="invalid distance too far back",K.mode=D$;break $}}if(C=0,k=O,H===0){if(C+=V-P,P<R){R-=P;do F[W++]=O[C++];while(--P);C=W-U,k=F}}else if(H<P){if(C+=V+H-P,P-=H,P<R){R-=P;do F[W++]=O[C++];while(--P);if(C=0,H<R){P=H,R-=P;do F[W++]=O[C++];while(--P);C=W-U,k=F}}}else if(C+=H-P,P<R){R-=P;do F[W++]=O[C++];while(--P);C=W-U,k=F}while(R>2)F[W++]=k[C++],F[W++]=k[C++],F[W++]=k[C++],R-=3;if(R){if(F[W++]=k[C++],R>1)F[W++]=k[C++]}}else{C=W-U;do F[W++]=F[C++],F[W++]=F[C++],F[W++]=F[C++],R-=3;while(R>2);if(R){if(F[W++]=F[C++],R>1)F[W++]=F[C++]}}}else if((P&64)===0){z=B[(z&65535)+(L&(1<<P)-1)];continue X}else{J.msg="invalid distance code",K.mode=D$;break $}break}}else if((P&64)===0){z=E[(z&65535)+(L&(1<<P)-1)];continue J}else if(P&32){K.mode=bU;break $}else{J.msg="invalid literal/length code",K.mode=D$;break $}break}}while(q<Y&&W<N);R=j>>3,q-=R,j-=R<<3,L&=(1<<j)-1,J.next_in=q,J.next_out=W,J.avail_in=q<Y?5+(Y-q):5-(q-Y),J.avail_out=W<N?257+(N-W):257-(W-N),K.hold=L,K.bits=j;return}});var hY=L0((NF,xY)=>{var wY=c8(),G5=15,TY=852,IY=592,_Y=0,wJ=1,yY=2,mU=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],pU=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],uU=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],lU=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];xY.exports=function(J,X,K,q,Y,W,Q,N){var M=N.bits,V=0,G=0,H=0,O=0,L=0,j=0,E=0,B=0,S=0,A=0,z,P,R,U,C,k=null,h=0,F,v=new wY.Buf16(G5+1),D=new wY.Buf16(G5+1),w=null,x=0,y,b,_;for(V=0;V<=G5;V++)v[V]=0;for(G=0;G<q;G++)v[X[K+G]]++;L=M;for(O=G5;O>=1;O--)if(v[O]!==0)break;if(L>O)L=O;if(O===0)return Y[W++]=20971520,Y[W++]=20971520,N.bits=1,0;for(H=1;H<O;H++)if(v[H]!==0)break;if(L<H)L=H;B=1;for(V=1;V<=G5;V++)if(B<<=1,B-=v[V],B<0)return-1;if(B>0&&(J===_Y||O!==1))return-1;D[1]=0;for(V=1;V<G5;V++)D[V+1]=D[V]+v[V];for(G=0;G<q;G++)if(X[K+G]!==0)Q[D[X[K+G]]++]=G;if(J===_Y)k=w=Q,F=19;else if(J===wJ)k=mU,h-=257,w=pU,x-=257,F=256;else k=uU,w=lU,F=-1;if(A=0,G=0,V=H,C=W,j=L,E=0,R=-1,S=1<<L,U=S-1,J===wJ&&S>TY||J===yY&&S>IY)return 1;for(;;){if(y=V-E,Q[G]<F)b=0,_=Q[G];else if(Q[G]>F)b=w[x+Q[G]],_=k[h+Q[G]];else b=96,_=0;z=1<<V-E,P=1<<j,H=P;do P-=z,Y[C+(A>>E)+P]=y<<24|b<<16|_|0;while(P!==0);z=1<<V-1;while(A&z)z>>=1;if(z!==0)A&=z-1,A+=z;else A=0;if(G++,--v[V]===0){if(V===O)break;V=X[K+Q[G]]}if(V>L&&(A&U)!==R){if(E===0)E=L;C+=H,j=V-E,B=1<<j;while(j+E<O){if(B-=v[j+E],B<=0)break;j++,B<<=1}if(S+=1<<j,J===wJ&&S>TY||J===yY&&S>IY)return 1;R=A&U,Y[R]=L<<24|j<<16|C-W|0}}if(A!==0)Y[C+A]=V-E<<24|4194304|0;return N.bits=L,0}});var jW=L0((NL)=>{var b6=c8(),hJ=RJ(),k8=BJ(),cU=kY(),P9=hY(),dU=0,NW=1,MW=2,gY=4,nU=5,k$=6,f1=0,oU=1,rU=2,t6=-2,VW=-3,gJ=-4,iU=-5,fY=8,GW=1,bY=2,mY=3,pY=4,uY=5,lY=6,cY=7,dY=8,nY=9,oY=10,I$=11,n8=12,TJ=13,rY=14,IJ=15,iY=16,sY=17,aY=18,tY=19,w$=20,T$=21,eY=22,$W=23,JW=24,XW=25,KW=26,_J=27,qW=28,YW=29,X6=30,fJ=31,sU=32,aU=852,tU=592,eU=15,$L=eU;function WW($){return($>>>24&255)+($>>>8&65280)+(($&65280)<<8)+(($&255)<<24)}function JL(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new b6.Buf16(320),this.work=new b6.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function HW($){var J;if(!$||!$.state)return t6;if(J=$.state,$.total_in=$.total_out=J.total=0,$.msg="",J.wrap)$.adler=J.wrap&1;return J.mode=GW,J.last=0,J.havedict=0,J.dmax=32768,J.head=null,J.hold=0,J.bits=0,J.lencode=J.lendyn=new b6.Buf32(aU),J.distcode=J.distdyn=new b6.Buf32(tU),J.sane=1,J.back=-1,f1}function OW($){var J;if(!$||!$.state)return t6;return J=$.state,J.wsize=0,J.whave=0,J.wnext=0,HW($)}function UW($,J){var X,K;if(!$||!$.state)return t6;if(K=$.state,J<0)X=0,J=-J;else if(X=(J>>4)+1,J<48)J&=15;if(J&&(J<8||J>15))return t6;if(K.window!==null&&K.wbits!==J)K.window=null;return K.wrap=X,K.wbits=J,OW($)}function LW($,J){var X,K;if(!$)return t6;if(K=new JL,$.state=K,K.window=null,X=UW($,J),X!==f1)$.state=null;return X}function XL($){return LW($,$L)}var QW=!0,yJ,xJ;function KL($){if(QW){var J;yJ=new b6.Buf32(512),xJ=new b6.Buf32(32),J=0;while(J<144)$.lens[J++]=8;while(J<256)$.lens[J++]=9;while(J<280)$.lens[J++]=7;while(J<288)$.lens[J++]=8;P9(NW,$.lens,0,288,yJ,0,$.work,{bits:9}),J=0;while(J<32)$.lens[J++]=5;P9(MW,$.lens,0,32,xJ,0,$.work,{bits:5}),QW=!1}$.lencode=yJ,$.lenbits=9,$.distcode=xJ,$.distbits=5}function EW($,J,X,K){var q,Y=$.state;if(Y.window===null)Y.wsize=1<<Y.wbits,Y.wnext=0,Y.whave=0,Y.window=new b6.Buf8(Y.wsize);if(K>=Y.wsize)b6.arraySet(Y.window,J,X-Y.wsize,Y.wsize,0),Y.wnext=0,Y.whave=Y.wsize;else{if(q=Y.wsize-Y.wnext,q>K)q=K;if(b6.arraySet(Y.window,J,X-K,q,Y.wnext),K-=q,K)b6.arraySet(Y.window,J,X-K,K,0),Y.wnext=K,Y.whave=Y.wsize;else{if(Y.wnext+=q,Y.wnext===Y.wsize)Y.wnext=0;if(Y.whave<Y.wsize)Y.whave+=q}}return 0}function qL($,J){var X,K,q,Y,W,Q,N,M,V,G,H,O,L,j,E=0,B,S,A,z,P,R,U,C,k=new b6.Buf8(4),h,F,v=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!$||!$.state||!$.output||!$.input&&$.avail_in!==0)return t6;if(X=$.state,X.mode===n8)X.mode=TJ;W=$.next_out,q=$.output,N=$.avail_out,Y=$.next_in,K=$.input,Q=$.avail_in,M=X.hold,V=X.bits,G=Q,H=N,C=f1;$:for(;;)switch(X.mode){case GW:if(X.wrap===0){X.mode=TJ;break}while(V<16){if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}if(X.wrap&2&&M===35615){X.check=0,k[0]=M&255,k[1]=M>>>8&255,X.check=k8(X.check,k,2,0),M=0,V=0,X.mode=bY;break}if(X.flags=0,X.head)X.head.done=!1;if(!(X.wrap&1)||(((M&255)<<8)+(M>>8))%31){$.msg="incorrect header check",X.mode=X6;break}if((M&15)!==fY){$.msg="unknown compression method",X.mode=X6;break}if(M>>>=4,V-=4,U=(M&15)+8,X.wbits===0)X.wbits=U;else if(U>X.wbits){$.msg="invalid window size",X.mode=X6;break}X.dmax=1<<U,$.adler=X.check=1,X.mode=M&512?oY:n8,M=0,V=0;break;case bY:while(V<16){if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}if(X.flags=M,(X.flags&255)!==fY){$.msg="unknown compression method",X.mode=X6;break}if(X.flags&57344){$.msg="unknown header flags set",X.mode=X6;break}if(X.head)X.head.text=M>>8&1;if(X.flags&512)k[0]=M&255,k[1]=M>>>8&255,X.check=k8(X.check,k,2,0);M=0,V=0,X.mode=mY;case mY:while(V<32){if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}if(X.head)X.head.time=M;if(X.flags&512)k[0]=M&255,k[1]=M>>>8&255,k[2]=M>>>16&255,k[3]=M>>>24&255,X.check=k8(X.check,k,4,0);M=0,V=0,X.mode=pY;case pY:while(V<16){if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}if(X.head)X.head.xflags=M&255,X.head.os=M>>8;if(X.flags&512)k[0]=M&255,k[1]=M>>>8&255,X.check=k8(X.check,k,2,0);M=0,V=0,X.mode=uY;case uY:if(X.flags&1024){while(V<16){if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}if(X.length=M,X.head)X.head.extra_len=M;if(X.flags&512)k[0]=M&255,k[1]=M>>>8&255,X.check=k8(X.check,k,2,0);M=0,V=0}else if(X.head)X.head.extra=null;X.mode=lY;case lY:if(X.flags&1024){if(O=X.length,O>Q)O=Q;if(O){if(X.head){if(U=X.head.extra_len-X.length,!X.head.extra)X.head.extra=Array(X.head.extra_len);b6.arraySet(X.head.extra,K,Y,O,U)}if(X.flags&512)X.check=k8(X.check,K,O,Y);Q-=O,Y+=O,X.length-=O}if(X.length)break $}X.length=0,X.mode=cY;case cY:if(X.flags&2048){if(Q===0)break $;O=0;do if(U=K[Y+O++],X.head&&U&&X.length<65536)X.head.name+=String.fromCharCode(U);while(U&&O<Q);if(X.flags&512)X.check=k8(X.check,K,O,Y);if(Q-=O,Y+=O,U)break $}else if(X.head)X.head.name=null;X.length=0,X.mode=dY;case dY:if(X.flags&4096){if(Q===0)break $;O=0;do if(U=K[Y+O++],X.head&&U&&X.length<65536)X.head.comment+=String.fromCharCode(U);while(U&&O<Q);if(X.flags&512)X.check=k8(X.check,K,O,Y);if(Q-=O,Y+=O,U)break $}else if(X.head)X.head.comment=null;X.mode=nY;case nY:if(X.flags&512){while(V<16){if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}if(M!==(X.check&65535)){$.msg="header crc mismatch",X.mode=X6;break}M=0,V=0}if(X.head)X.head.hcrc=X.flags>>9&1,X.head.done=!0;$.adler=X.check=0,X.mode=n8;break;case oY:while(V<32){if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}$.adler=X.check=WW(M),M=0,V=0,X.mode=I$;case I$:if(X.havedict===0)return $.next_out=W,$.avail_out=N,$.next_in=Y,$.avail_in=Q,X.hold=M,X.bits=V,rU;$.adler=X.check=1,X.mode=n8;case n8:if(J===nU||J===k$)break $;case TJ:if(X.last){M>>>=V&7,V-=V&7,X.mode=_J;break}while(V<3){if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}switch(X.last=M&1,M>>>=1,V-=1,M&3){case 0:X.mode=rY;break;case 1:if(KL(X),X.mode=w$,J===k$){M>>>=2,V-=2;break $}break;case 2:X.mode=sY;break;case 3:$.msg="invalid block type",X.mode=X6}M>>>=2,V-=2;break;case rY:M>>>=V&7,V-=V&7;while(V<32){if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}if((M&65535)!==(M>>>16^65535)){$.msg="invalid stored block lengths",X.mode=X6;break}if(X.length=M&65535,M=0,V=0,X.mode=IJ,J===k$)break $;case IJ:X.mode=iY;case iY:if(O=X.length,O){if(O>Q)O=Q;if(O>N)O=N;if(O===0)break $;b6.arraySet(q,K,Y,O,W),Q-=O,Y+=O,N-=O,W+=O,X.length-=O;break}X.mode=n8;break;case sY:while(V<14){if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}if(X.nlen=(M&31)+257,M>>>=5,V-=5,X.ndist=(M&31)+1,M>>>=5,V-=5,X.ncode=(M&15)+4,M>>>=4,V-=4,X.nlen>286||X.ndist>30){$.msg="too many length or distance symbols",X.mode=X6;break}X.have=0,X.mode=aY;case aY:while(X.have<X.ncode){while(V<3){if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}X.lens[v[X.have++]]=M&7,M>>>=3,V-=3}while(X.have<19)X.lens[v[X.have++]]=0;if(X.lencode=X.lendyn,X.lenbits=7,h={bits:X.lenbits},C=P9(dU,X.lens,0,19,X.lencode,0,X.work,h),X.lenbits=h.bits,C){$.msg="invalid code lengths set",X.mode=X6;break}X.have=0,X.mode=tY;case tY:while(X.have<X.nlen+X.ndist){for(;;){if(E=X.lencode[M&(1<<X.lenbits)-1],B=E>>>24,S=E>>>16&255,A=E&65535,B<=V)break;if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}if(A<16)M>>>=B,V-=B,X.lens[X.have++]=A;else{if(A===16){F=B+2;while(V<F){if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}if(M>>>=B,V-=B,X.have===0){$.msg="invalid bit length repeat",X.mode=X6;break}U=X.lens[X.have-1],O=3+(M&3),M>>>=2,V-=2}else if(A===17){F=B+3;while(V<F){if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}M>>>=B,V-=B,U=0,O=3+(M&7),M>>>=3,V-=3}else{F=B+7;while(V<F){if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}M>>>=B,V-=B,U=0,O=11+(M&127),M>>>=7,V-=7}if(X.have+O>X.nlen+X.ndist){$.msg="invalid bit length repeat",X.mode=X6;break}while(O--)X.lens[X.have++]=U}}if(X.mode===X6)break;if(X.lens[256]===0){$.msg="invalid code -- missing end-of-block",X.mode=X6;break}if(X.lenbits=9,h={bits:X.lenbits},C=P9(NW,X.lens,0,X.nlen,X.lencode,0,X.work,h),X.lenbits=h.bits,C){$.msg="invalid literal/lengths set",X.mode=X6;break}if(X.distbits=6,X.distcode=X.distdyn,h={bits:X.distbits},C=P9(MW,X.lens,X.nlen,X.ndist,X.distcode,0,X.work,h),X.distbits=h.bits,C){$.msg="invalid distances set",X.mode=X6;break}if(X.mode=w$,J===k$)break $;case w$:X.mode=T$;case T$:if(Q>=6&&N>=258){if($.next_out=W,$.avail_out=N,$.next_in=Y,$.avail_in=Q,X.hold=M,X.bits=V,cU($,H),W=$.next_out,q=$.output,N=$.avail_out,Y=$.next_in,K=$.input,Q=$.avail_in,M=X.hold,V=X.bits,X.mode===n8)X.back=-1;break}X.back=0;for(;;){if(E=X.lencode[M&(1<<X.lenbits)-1],B=E>>>24,S=E>>>16&255,A=E&65535,B<=V)break;if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}if(S&&(S&240)===0){z=B,P=S,R=A;for(;;){if(E=X.lencode[R+((M&(1<<z+P)-1)>>z)],B=E>>>24,S=E>>>16&255,A=E&65535,z+B<=V)break;if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}M>>>=z,V-=z,X.back+=z}if(M>>>=B,V-=B,X.back+=B,X.length=A,S===0){X.mode=KW;break}if(S&32){X.back=-1,X.mode=n8;break}if(S&64){$.msg="invalid literal/length code",X.mode=X6;break}X.extra=S&15,X.mode=eY;case eY:if(X.extra){F=X.extra;while(V<F){if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}X.length+=M&(1<<X.extra)-1,M>>>=X.extra,V-=X.extra,X.back+=X.extra}X.was=X.length,X.mode=$W;case $W:for(;;){if(E=X.distcode[M&(1<<X.distbits)-1],B=E>>>24,S=E>>>16&255,A=E&65535,B<=V)break;if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}if((S&240)===0){z=B,P=S,R=A;for(;;){if(E=X.distcode[R+((M&(1<<z+P)-1)>>z)],B=E>>>24,S=E>>>16&255,A=E&65535,z+B<=V)break;if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}M>>>=z,V-=z,X.back+=z}if(M>>>=B,V-=B,X.back+=B,S&64){$.msg="invalid distance code",X.mode=X6;break}X.offset=A,X.extra=S&15,X.mode=JW;case JW:if(X.extra){F=X.extra;while(V<F){if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}X.offset+=M&(1<<X.extra)-1,M>>>=X.extra,V-=X.extra,X.back+=X.extra}if(X.offset>X.dmax){$.msg="invalid distance too far back",X.mode=X6;break}X.mode=XW;case XW:if(N===0)break $;if(O=H-N,X.offset>O){if(O=X.offset-O,O>X.whave){if(X.sane){$.msg="invalid distance too far back",X.mode=X6;break}}if(O>X.wnext)O-=X.wnext,L=X.wsize-O;else L=X.wnext-O;if(O>X.length)O=X.length;j=X.window}else j=q,L=W-X.offset,O=X.length;if(O>N)O=N;N-=O,X.length-=O;do q[W++]=j[L++];while(--O);if(X.length===0)X.mode=T$;break;case KW:if(N===0)break $;q[W++]=X.length,N--,X.mode=T$;break;case _J:if(X.wrap){while(V<32){if(Q===0)break $;Q--,M|=K[Y++]<<V,V+=8}if(H-=N,$.total_out+=H,X.total+=H,H)$.adler=X.check=X.flags?k8(X.check,q,H,W-H):hJ(X.check,q,H,W-H);if(H=N,(X.flags?M:WW(M))!==X.check){$.msg="incorrect data check",X.mode=X6;break}M=0,V=0}X.mode=qW;case qW:if(X.wrap&&X.flags){while(V<32){if(Q===0)break $;Q--,M+=K[Y++]<<V,V+=8}if(M!==(X.total&4294967295)){$.msg="incorrect length check",X.mode=X6;break}M=0,V=0}X.mode=YW;case YW:C=oU;break $;case X6:C=VW;break $;case fJ:return gJ;case sU:default:return t6}if($.next_out=W,$.avail_out=N,$.next_in=Y,$.avail_in=Q,X.hold=M,X.bits=V,X.wsize||H!==$.avail_out&&X.mode<X6&&(X.mode<_J||J!==gY)){if(EW($,$.output,$.next_out,H-$.avail_out))return X.mode=fJ,gJ}if(G-=$.avail_in,H-=$.avail_out,$.total_in+=G,$.total_out+=H,X.total+=H,X.wrap&&H)$.adler=X.check=X.flags?k8(X.check,q,H,$.next_out-H):hJ(X.check,q,H,$.next_out-H);if($.data_type=X.bits+(X.last?64:0)+(X.mode===n8?128:0)+(X.mode===w$||X.mode===IJ?256:0),(G===0&&H===0||J===gY)&&C===f1)C=iU;return C}function YL($){if(!$||!$.state)return t6;var J=$.state;if(J.window)J.window=null;return $.state=null,f1}function WL($,J){var X;if(!$||!$.state)return t6;if(X=$.state,(X.wrap&2)===0)return t6;return X.head=J,J.done=!1,f1}function QL($,J){var X=J.length,K,q,Y;if(!$||!$.state)return t6;if(K=$.state,K.wrap!==0&&K.mode!==I$)return t6;if(K.mode===I$){if(q=1,q=hJ(q,J,X,0),q!==K.check)return VW}if(Y=EW($,J,X,X),Y)return K.mode=fJ,gJ;return K.havedict=1,f1}NL.inflateReset=OW;NL.inflateReset2=UW;NL.inflateResetKeep=HW;NL.inflateInit=XL;NL.inflateInit2=LW;NL.inflate=qL;NL.inflateEnd=YL;NL.inflateGetHeader=WL;NL.inflateSetDictionary=QL;NL.inflateInfo="pako inflate (from Nodeca project)"});var bJ=L0((VF,RW)=>{RW.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var PW=L0((GF,BW)=>{function BL(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}BW.exports=BL});var AW=L0((FL)=>{var H5=jW(),S9=c8(),_$=zJ(),M6=bJ(),mJ=P$(),PL=vJ(),SL=PW(),SW=Object.prototype.toString;function b1($){if(!(this instanceof b1))return new b1($);this.options=S9.assign({chunkSize:16384,windowBits:0,to:""},$||{});var J=this.options;if(J.raw&&J.windowBits>=0&&J.windowBits<16){if(J.windowBits=-J.windowBits,J.windowBits===0)J.windowBits=-15}if(J.windowBits>=0&&J.windowBits<16&&!($&&$.windowBits))J.windowBits+=32;if(J.windowBits>15&&J.windowBits<48){if((J.windowBits&15)===0)J.windowBits|=15}this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new PL,this.strm.avail_out=0;var X=H5.inflateInit2(this.strm,J.windowBits);if(X!==M6.Z_OK)throw Error(mJ[X]);if(this.header=new SL,H5.inflateGetHeader(this.strm,this.header),J.dictionary){if(typeof J.dictionary==="string")J.dictionary=_$.string2buf(J.dictionary);else if(SW.call(J.dictionary)==="[object ArrayBuffer]")J.dictionary=new Uint8Array(J.dictionary);if(J.raw){if(X=H5.inflateSetDictionary(this.strm,J.dictionary),X!==M6.Z_OK)throw Error(mJ[X])}}}b1.prototype.push=function($,J){var X=this.strm,K=this.options.chunkSize,q=this.options.dictionary,Y,W,Q,N,M,V=!1;if(this.ended)return!1;if(W=J===~~J?J:J===!0?M6.Z_FINISH:M6.Z_NO_FLUSH,typeof $==="string")X.input=_$.binstring2buf($);else if(SW.call($)==="[object ArrayBuffer]")X.input=new Uint8Array($);else X.input=$;X.next_in=0,X.avail_in=X.input.length;do{if(X.avail_out===0)X.output=new S9.Buf8(K),X.next_out=0,X.avail_out=K;if(Y=H5.inflate(X,M6.Z_NO_FLUSH),Y===M6.Z_NEED_DICT&&q)Y=H5.inflateSetDictionary(this.strm,q);if(Y===M6.Z_BUF_ERROR&&V===!0)Y=M6.Z_OK,V=!1;if(Y!==M6.Z_STREAM_END&&Y!==M6.Z_OK)return this.onEnd(Y),this.ended=!0,!1;if(X.next_out){if(X.avail_out===0||Y===M6.Z_STREAM_END||X.avail_in===0&&(W===M6.Z_FINISH||W===M6.Z_SYNC_FLUSH))if(this.options.to==="string"){if(Q=_$.utf8border(X.output,X.next_out),N=X.next_out-Q,M=_$.buf2string(X.output,Q),X.next_out=N,X.avail_out=K-N,N)S9.arraySet(X.output,X.output,Q,N,0);this.onData(M)}else this.onData(S9.shrinkBuf(X.output,X.next_out))}if(X.avail_in===0&&X.avail_out===0)V=!0}while((X.avail_in>0||X.avail_out===0)&&Y!==M6.Z_STREAM_END);if(Y===M6.Z_STREAM_END)W=M6.Z_FINISH;if(W===M6.Z_FINISH)return Y=H5.inflateEnd(this.strm),this.onEnd(Y),this.ended=!0,Y===M6.Z_OK;if(W===M6.Z_SYNC_FLUSH)return this.onEnd(M6.Z_OK),X.avail_out=0,!0;return!0};b1.prototype.onData=function($){this.chunks.push($)};b1.prototype.onEnd=function($){if($===M6.Z_OK)if(this.options.to==="string")this.result=this.chunks.join("");else this.result=S9.flattenChunks(this.chunks);this.chunks=[],this.err=$,this.msg=this.strm.msg};function pJ($,J){var X=new b1(J);if(X.push($,!0),X.err)throw X.msg||mJ[X.err];return X.result}function AL($,J){return J=J||{},J.raw=!0,pJ($,J)}FL.Inflate=b1;FL.inflate=pJ;FL.inflateRaw=AL;FL.ungzip=pJ});var vW=L0((OF,zW)=>{var DL=c8().assign,kL=ZY(),wL=AW(),TL=bJ(),FW={};DL(FW,kL,wL,TL);zW.exports=FW});var CW=L0((UF,uJ)=>{(function(){var $={};if(typeof uJ=="object")uJ.exports=$;else self.UTIF=$;var J=vW();function X(){console.log.apply(console,arguments)}(function(K,q){(function(){var Y=function(){function G(H){this.message="JPEG error: "+H}return G.prototype=Error(),G.prototype.name="JpegError",G.constructor=G,G}(),W=function(){var G=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),H=4017,O=799,L=3406,j=2276,E=1567,B=3784,S=5793,A=2896;function z(F){if(F==null)F={};if(F.w==null)F.w=-1;this.V=F.n,this.N=F.w}function P(F,v){var D=0,w=[],x,y,b=16,_;while(b>0&&!F[b-1])b--;w.push({children:[],index:0});var m=w[0];for(x=0;x<b;x++){for(y=0;y<F[x];y++){m=w.pop(),m.children[m.index]=v[D];while(m.index>0)m=w.pop();m.index++,w.push(m);while(w.length<=x)w.push(_={children:[],index:0}),m.children[m.index]=_.children,m=_;D++}if(x+1<b)w.push(_={children:[],index:0}),m.children[m.index]=_.children,m=_}return w[0].children}function R(F,v,D){return 64*((F.P+1)*v+D)}function U(F,v,D,w,x,y,b,_,m,t){if(t==null)t=!1;var{m:l,Z:s}=D,g=v,Z=0,T=0,c=0,o=0,$0,a=0,e,r,p,i,X0,K0,U0=0,S0,u,M0,q0;function V0(){if(T>0)return T--,Z>>T&1;if(Z=F[v++],Z===255){var W0=F[v++];if(W0){if(W0===220&&t){v+=2;var R0=N(F,v);if(v+=2,R0>0&&R0!==D.s)throw new DNLMarkerError("Found DNL marker (0xFFDC) while parsing scan data",R0)}else if(W0===217){if(t){var Z0=a*8;if(Z0>0&&Z0<D.s/10)throw new DNLMarkerError("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",Z0)}throw new EOIMarkerError("Found EOI marker (0xFFD9) while parsing scan data")}throw new Y("unexpected marker")}}return T=7,Z>>>7}function O0(W0){var R0=W0;while(!0){switch(R0=R0[V0()],typeof R0){case"number":return R0;case"object":continue}throw new Y("invalid huffman sequence")}}function j0(W0){var R0=0;while(W0>0)R0=R0<<1|V0(),W0--;return R0}function F0(W0){if(W0===1)return V0()===1?1:-1;var R0=j0(W0);if(R0>=1<<W0-1)return R0;return R0+(-1<<W0)+1}function v0(W0,R0){var Z0=O0(W0.J),_0=Z0===0?0:F0(Z0),f0=1;W0.D[R0]=W0.Q+=_0;while(f0<64){var s0=O0(W0.i),y0=s0&15,i0=s0>>4;if(y0===0){if(i0<15)break;f0+=16;continue}f0+=i0;var t0=G[f0];W0.D[R0+t0]=F0(y0),f0++}}function A0(W0,R0){var Z0=O0(W0.J),_0=Z0===0?0:F0(Z0)<<m;W0.D[R0]=W0.Q+=_0}function T0(W0,R0){W0.D[R0]|=V0()<<m}function Y0(W0,R0){if(c>0){c--;return}var Z0=y,_0=b;while(Z0<=_0){var f0=O0(W0.i),s0=f0&15,y0=f0>>4;if(s0===0){if(y0<15){c=j0(y0)+(1<<y0)-1;break}Z0+=16;continue}Z0+=y0;var i0=G[Z0];W0.D[R0+i0]=F0(s0)*(1<<m),Z0++}}function J0(W0,R0){var Z0=y,_0=b,f0=0,s0,y0;while(Z0<=_0){var i0=R0+G[Z0],t0=W0.D[i0]<0?-1:1;switch(o){case 0:if(y0=O0(W0.i),s0=y0&15,f0=y0>>4,s0===0)if(f0<15)c=j0(f0)+(1<<f0),o=4;else f0=16,o=1;else{if(s0!==1)throw new Y("invalid ACn encoding");$0=F0(s0),o=f0?2:3}continue;case 1:case 2:if(W0.D[i0])W0.D[i0]+=t0*(V0()<<m);else if(f0--,f0===0)o=o===2?3:0;break;case 3:if(W0.D[i0])W0.D[i0]+=t0*(V0()<<m);else W0.D[i0]=$0<<m,o=0;break;case 4:if(W0.D[i0])W0.D[i0]+=t0*(V0()<<m);break}Z0++}if(o===4){if(c--,c===0)o=0}}function N0(W0,R0,Z0,_0,f0){var s0=Z0/l|0,y0=Z0%l;a=s0*W0.A+_0;var i0=y0*W0.h+f0,t0=R(W0,a,i0);R0(W0,t0)}function g0(W0,R0,Z0){a=Z0/W0.P|0;var _0=Z0%W0.P,f0=R(W0,a,_0);R0(W0,f0)}var z0=w.length;if(s)if(y===0)K0=_===0?A0:T0;else K0=_===0?Y0:J0;else K0=v0;if(z0===1)u=w[0].P*w[0].c;else u=l*D.R;while(U0<=u){var I0=x?Math.min(u-U0,x):u;if(I0>0){for(r=0;r<z0;r++)w[r].Q=0;if(c=0,z0===1){e=w[0];for(X0=0;X0<I0;X0++)g0(e,K0,U0),U0++}else for(X0=0;X0<I0;X0++){for(r=0;r<z0;r++){e=w[r],M0=e.h,q0=e.A;for(p=0;p<q0;p++)for(i=0;i<M0;i++)N0(e,K0,U0,p,i)}U0++}}if(T=0,S0=h(F,v),!S0)break;if(S0.u){var d0=I0>0?"unexpected":"excessive";v=S0.offset}if(S0.M>=65488&&S0.M<=65495)v+=2;else break}return v-g}function C(F,v,D){var{$:w,D:x}=F,y,b,_,m,t,l,s,g,Z,T,c,o,$0,a,e,r,p;if(!w)throw new Y("missing required Quantization Table.");for(var i=0;i<64;i+=8){if(Z=x[v+i],T=x[v+i+1],c=x[v+i+2],o=x[v+i+3],$0=x[v+i+4],a=x[v+i+5],e=x[v+i+6],r=x[v+i+7],Z*=w[i],(T|c|o|$0|a|e|r)===0){p=S*Z+512>>10,D[i]=p,D[i+1]=p,D[i+2]=p,D[i+3]=p,D[i+4]=p,D[i+5]=p,D[i+6]=p,D[i+7]=p;continue}T*=w[i+1],c*=w[i+2],o*=w[i+3],$0*=w[i+4],a*=w[i+5],e*=w[i+6],r*=w[i+7],y=S*Z+128>>8,b=S*$0+128>>8,_=c,m=e,t=A*(T-r)+128>>8,g=A*(T+r)+128>>8,l=o<<4,s=a<<4,y=y+b+1>>1,b=y-b,p=_*B+m*E+128>>8,_=_*E-m*B+128>>8,m=p,t=t+s+1>>1,s=t-s,g=g+l+1>>1,l=g-l,y=y+m+1>>1,m=y-m,b=b+_+1>>1,_=b-_,p=t*j+g*L+2048>>12,t=t*L-g*j+2048>>12,g=p,p=l*O+s*H+2048>>12,l=l*H-s*O+2048>>12,s=p,D[i]=y+g,D[i+7]=y-g,D[i+1]=b+s,D[i+6]=b-s,D[i+2]=_+l,D[i+5]=_-l,D[i+3]=m+t,D[i+4]=m-t}for(var X0=0;X0<8;++X0){if(Z=D[X0],T=D[X0+8],c=D[X0+16],o=D[X0+24],$0=D[X0+32],a=D[X0+40],e=D[X0+48],r=D[X0+56],(T|c|o|$0|a|e|r)===0){if(p=S*Z+8192>>14,p<-2040)p=0;else if(p>=2024)p=255;else p=p+2056>>4;x[v+X0]=p,x[v+X0+8]=p,x[v+X0+16]=p,x[v+X0+24]=p,x[v+X0+32]=p,x[v+X0+40]=p,x[v+X0+48]=p,x[v+X0+56]=p;continue}if(y=S*Z+2048>>12,b=S*$0+2048>>12,_=c,m=e,t=A*(T-r)+2048>>12,g=A*(T+r)+2048>>12,l=o,s=a,y=(y+b+1>>1)+4112,b=y-b,p=_*B+m*E+2048>>12,_=_*E-m*B+2048>>12,m=p,t=t+s+1>>1,s=t-s,g=g+l+1>>1,l=g-l,y=y+m+1>>1,m=y-m,b=b+_+1>>1,_=b-_,p=t*j+g*L+2048>>12,t=t*L-g*j+2048>>12,g=p,p=l*O+s*H+2048>>12,l=l*H-s*O+2048>>12,s=p,Z=y+g,r=y-g,T=b+s,e=b-s,c=_+l,a=_-l,o=m+t,$0=m-t,Z<16)Z=0;else if(Z>=4080)Z=255;else Z>>=4;if(T<16)T=0;else if(T>=4080)T=255;else T>>=4;if(c<16)c=0;else if(c>=4080)c=255;else c>>=4;if(o<16)o=0;else if(o>=4080)o=255;else o>>=4;if($0<16)$0=0;else if($0>=4080)$0=255;else $0>>=4;if(a<16)a=0;else if(a>=4080)a=255;else a>>=4;if(e<16)e=0;else if(e>=4080)e=255;else e>>=4;if(r<16)r=0;else if(r>=4080)r=255;else r>>=4;x[v+X0]=Z,x[v+X0+8]=T,x[v+X0+16]=c,x[v+X0+24]=o,x[v+X0+32]=$0,x[v+X0+40]=a,x[v+X0+48]=e,x[v+X0+56]=r}}function k(F,v){var{P:D,c:w}=v,x=new Int16Array(64);for(var y=0;y<w;y++)for(var b=0;b<D;b++){var _=R(v,y,b);C(v,_,x)}return v.D}function h(F,v,D){if(D==null)D=v;var w=F.length-1,x=D<v?D:v;if(v>=w)return null;var y=N(F,v);if(y>=65472&&y<=65534)return{u:null,M:y,offset:v};var b=N(F,x);while(!(b>=65472&&b<=65534)){if(++x>=w)return null;b=N(F,x)}return{u:y.toString(16),M:b,offset:x}}return z.prototype={parse(F,v){if(v==null)v={};var D=v.F,w=0,x=null,y=null,b,_,m=0;function t(){var y0=N(F,w);w+=2;var i0=w+y0-2,t0=h(F,i0,w);if(t0&&t0.u)i0=t0.offset;var F6=F.subarray(w,i0);return w+=F6.length,F6}function l(y0){var i0=Math.ceil(y0.o/8/y0.X),t0=Math.ceil(y0.s/8/y0.B);for(var F6=0;F6<y0.W.length;F6++){J0=y0.W[F6];var L6=Math.ceil(Math.ceil(y0.o/8)*J0.h/y0.X),w6=Math.ceil(Math.ceil(y0.s/8)*J0.A/y0.B),X8=i0*J0.h,R8=t0*J0.A,x8=64*R8*(X8+1);J0.D=new Int16Array(x8),J0.P=L6,J0.c=w6}y0.m=i0,y0.R=t0}var s=[],g=[],Z=[],T=N(F,w);if(w+=2,T!==65496)throw new Y("SOI not found");T=N(F,w),w+=2;$:while(T!==65497){var c,o,$0;switch(T){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var a=t();if(T===65504){if(a[0]===74&&a[1]===70&&a[2]===73&&a[3]===70&&a[4]===0)x={version:{d:a[5],T:a[6]},K:a[7],j:a[8]<<8|a[9],H:a[10]<<8|a[11],S:a[12],I:a[13],C:a.subarray(14,14+3*a[12]*a[13])}}if(T===65518){if(a[0]===65&&a[1]===100&&a[2]===111&&a[3]===98&&a[4]===101)y={version:a[5]<<8|a[6],k:a[7]<<8|a[8],q:a[9]<<8|a[10],a:a[11]}}break;case 65499:var e=N(F,w),r;w+=2;var p=e+w-2;while(w<p){var i=F[w++],X0=new Uint16Array(64);if(i>>4===0)for(o=0;o<64;o++)r=G[o],X0[r]=F[w++];else if(i>>4===1)for(o=0;o<64;o++)r=G[o],X0[r]=N(F,w),w+=2;else throw new Y("DQT - invalid table spec");s[i&15]=X0}break;case 65472:case 65473:case 65474:if(b)throw new Y("Only single frame JPEGs supported");w+=2,b={},b.G=T===65473,b.Z=T===65474,b.precision=F[w++];var K0=N(F,w),U0,S0=0,u=0;w+=2,b.s=D||K0,b.o=N(F,w),w+=2,b.W=[],b._={};var M0=F[w++];for(c=0;c<M0;c++){U0=F[w];var q0=F[w+1]>>4,V0=F[w+1]&15;if(S0<q0)S0=q0;if(u<V0)u=V0;var O0=F[w+2];$0=b.W.push({h:q0,A:V0,L:O0,$:null}),b._[U0]=$0-1,w+=3}b.X=S0,b.B=u,l(b);break;case 65476:var j0=N(F,w);w+=2;for(c=2;c<j0;){var F0=F[w++],v0=new Uint8Array(16),A0=0;for(o=0;o<16;o++,w++)A0+=v0[o]=F[w];var T0=new Uint8Array(A0);for(o=0;o<A0;o++,w++)T0[o]=F[w];c+=17+A0,(F0>>4===0?Z:g)[F0&15]=P(v0,T0)}break;case 65501:w+=2,_=N(F,w),w+=2;break;case 65498:var Y0=++m===1&&!D,J0;w+=2;var N0=F[w++],g0=[];for(c=0;c<N0;c++){var z0=F[w++],I0=b._[z0];J0=b.W[I0],J0.index=z0;var d0=F[w++];J0.J=Z[d0>>4],J0.i=g[d0&15],g0.push(J0)}var W0=F[w++],R0=F[w++],Z0=F[w++];try{var _0=U(F,w,b,g0,_,W0,R0,Z0>>4,Z0&15,Y0);w+=_0}catch(y0){if(y0 instanceof DNLMarkerError)return this.parse(F,{F:y0.s});else if(y0 instanceof EOIMarkerError)break $;throw y0}break;case 65500:w+=4;break;case 65535:if(F[w]!==255)w--;break;default:var f0=h(F,w-2,w-3);if(f0&&f0.u){w=f0.offset;break}if(w>=F.length-1)break $;throw new Y("JpegImage.parse - unknown marker: "+T.toString(16))}T=N(F,w),w+=2}this.width=b.o,this.height=b.s,this.g=x,this.b=y,this.W=[];for(c=0;c<b.W.length;c++){J0=b.W[c];var s0=s[J0.L];if(s0)J0.$=s0;this.W.push({index:J0.index,e:k(b,J0),l:J0.h/b.X,t:J0.A/b.B,P:J0.P,c:J0.c})}this.p=this.W.length;return},Y(F,v,D){if(D==null)D=!1;var w=this.width/F,x=this.height/v,y,b,_,m,t,l,s,g,Z,T,c=0,o,$0=this.W.length,a=F*v*$0,e=new Uint8ClampedArray(a),r=new Uint32Array(F),p=4294967288,i;for(s=0;s<$0;s++){if(y=this.W[s],b=y.l*w,_=y.t*x,c=s,o=y.e,m=y.P+1<<3,b!==i){for(t=0;t<F;t++)g=0|t*b,r[t]=(g&p)<<3|g&7;i=b}for(l=0;l<v;l++){g=0|l*_,T=m*(g&p)|(g&7)<<3;for(t=0;t<F;t++)e[c]=o[T+r[t]],c+=$0}}var X0=this.V;if(!D&&$0===4&&!X0)X0=new Int32Array([-256,255,-256,255,-256,255,-256,255]);if(X0)for(s=0;s<a;)for(g=0,Z=0;g<$0;g++,s++,Z+=2)e[s]=(e[s]*X0[Z]>>8)+X0[Z+1];return e},get f(){if(this.b)return!!this.b.a;if(this.p===3){if(this.N===0)return!1;else if(this.W[0].index===82&&this.W[1].index===71&&this.W[2].index===66)return!1;return!0}if(this.N===1)return!0;return!1},z:function(v){var D,w,x;for(var y=0,b=v.length;y<b;y+=3)D=v[y],w=v[y+1],x=v[y+2],v[y]=D-179.456+1.402*x,v[y+1]=D+135.459-0.344*w-0.714*x,v[y+2]=D-226.816+1.772*w;return v},O:function(v){var D,w,x,y,b=0;for(var _=0,m=v.length;_<m;_+=4)D=v[_],w=v[_+1],x=v[_+2],y=v[_+3],v[b++]=-122.67195406894+w*(-0.0000660635669420364*w+0.000437130475926232*x-0.000054080610064599*D+0.00048449797120281*y-0.154362151871126)+x*(-0.000957964378445773*x+0.000817076911346625*D-0.00477271405408747*y+1.53380253221734)+D*(0.000961250184130688*D-0.00266257332283933*y+0.48357088451265)+y*(-0.000336197177618394*y+0.484791561490776),v[b++]=107.268039397724+w*(0.0000219927104525741*w-0.000640992018297945*x+0.000659397001245577*D+0.000426105652938837*y-0.176491792462875)+x*(-0.000778269941513683*x+0.00130872261408275*D+0.000770482631801132*y-0.151051492775562)+D*(0.00126935368114843*D-0.00265090189010898*y+0.25802910206845)+y*(-0.000318913117588328*y-0.213742400323665),v[b++]=-20.810012546947+w*(-0.000570115196973677*w-0.0000263409051004589*x+0.0020741088115012*D-0.00288260236853442*y+0.814272968359295)+x*(-0.0000153496057440975*x-0.000132689043961446*D+0.000560833691242812*y-0.195152027534049)+D*(0.00174418132927582*D-0.00255243321439347*y+0.116935020465145)+y*(-0.000343531996510555*y+0.24165260232407);return v.subarray(0,b)},r:function(v){var D,w,x;for(var y=0,b=v.length;y<b;y+=4)D=v[y],w=v[y+1],x=v[y+2],v[y]=434.456-D-1.402*x,v[y+1]=119.541-D+0.344*w+0.714*x,v[y+2]=481.816-D-1.772*w;return v},U:function(v){var D,w,x,y,b=0;for(var _=0,m=v.length;_<m;_+=4)D=v[_],w=v[_+1],x=v[_+2],y=v[_+3],v[b++]=255+D*(-0.00006747147073602441*D+0.0008379262121013727*w+0.0002894718188643294*x+0.003264231057537806*y-1.1185611867203937)+w*(0.000026374107616089405*w-0.00008626949158638572*x-0.0002748769067499491*y-0.02155688794978967)+x*(-0.00003878099212869363*x-0.0003267808279485286*y+0.0686742238595345)-y*(0.0003361971776183937*y+0.7430659151342254),v[b++]=255+D*(0.00013596372813588848*D+0.000924537132573585*w+0.00010567359618683593*x+0.0004791864687436512*y-0.3109689587515875)+w*(-0.00023545346108370344*w+0.0002702845253534714*x+0.0020200308977307156*y-0.7488052167015494)+x*(0.00006834815998235662*x+0.00015168452363460973*y-0.09751927774728933)-y*(0.0003189131175883281*y+0.7364883807733168),v[b++]=255+D*(0.000013598650411385307*D+0.00012423956175490851*w+0.0004751985097583589*x-0.0000036729317476630422*y-0.05562186980264034)+w*(0.00016141380598724676*w+0.0009692239130725186*x+0.0007782692450036253*y-0.44015232367526463)+x*(0.0000005068882914068769*x+0.0017778369011375071*y-0.7591454649749609)-y*(0.0003435319965105553*y+0.7063770186160144);return v.subarray(0,b)},getData:function(F){var{width:v,height:D,forceRGB:w,isSourcePDF:x}=F;if(this.p>4)throw new Y("Unsupported color mode");var y=this.Y(v,D,x);if(this.p===1&&w){var b=y.length,_=new Uint8ClampedArray(b*3),m=0;for(var t=0;t<b;t++){var l=y[t];_[m++]=l,_[m++]=l,_[m++]=l}return _}else if(this.p===3&&this.f)return this.z(y);else if(this.p===4){if(this.f){if(w)return this.O(y);return this.r(y)}else if(w)return this.U(y)}return y}},z}();function Q(V,G){return V[G]<<24>>24}function N(V,G){return V[G]<<8|V[G+1]}function M(V,G){return(V[G]<<24|V[G+1]<<16|V[G+2]<<8|V[G+3])>>>0}K.JpegDecoder=W})(),K.encodeImage=function(Y,W,Q,N){var M={t256:[W],t257:[Q],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1000],t277:[4],t278:[Q],t279:[W*Q*4],t282:[[72,1]],t283:[[72,1]],t284:[1],t286:[[0,1]],t287:[[0,1]],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(N)for(var V in N)M[V]=N[V];var G=new Uint8Array(K.encode([M])),H=new Uint8Array(Y),O=new Uint8Array(1000+W*Q*4);for(var V=0;V<G.length;V++)O[V]=G[V];for(var V=0;V<H.length;V++)O[1000+V]=H[V];return O.buffer},K.encode=function(Y){var W=!1,Q=new Uint8Array(20000),N=4,M=W?K._binLE:K._binBE;Q[0]=Q[1]=W?73:77,M.writeUshort(Q,2,42);var V=8;M.writeUint(Q,N,V),N+=4;for(var G=0;G<Y.length;G++){var H=K._writeIFD(M,K._types.basic,Q,V,Y[G]);if(V=H[1],G<Y.length-1){if((V&3)!=0)V+=4-(V&3);M.writeUint(Q,H[0],V)}}return Q.slice(0,V).buffer},K.decode=function(Y,W){if(W==null)W={parseMN:!0,debug:!1};var Q=new Uint8Array(Y),N=0,M=K._binBE.readASCII(Q,N,2);N+=2;var V=M=="II"?K._binLE:K._binBE,G=V.readUshort(Q,N);N+=2;var H=V.readUint(Q,N);N+=4;var O=[];while(!0){var L=V.readUshort(Q,H),j=V.readUshort(Q,H+4);if(L!=0){if(j<1||13<j){X("error in TIFF");break}}if(K._readIFD(V,Q,H,O,0,W),H=V.readUint(Q,H+2+L*12),H==0)break}return O},K.decodeImage=function(Y,W,Q){if(W.data)return;var N=new Uint8Array(Y),M=K._binBE.readASCII(N,0,2);if(W.t256==null)return;W.isLE=M=="II",W.width=W.t256[0],W.height=W.t257[0];var V=W.t259?W.t259[0]:1,G=W.t266?W.t266[0]:1;if(W.t284&&W.t284[0]==2)X("PlanarConfiguration 2 should not be used!");if(V==7&&W.t258&&W.t258.length>3)W.t258=W.t258.slice(0,3);var H=W.t277?W.t277[0]:1,O=W.t258?W.t258[0]:1,L=O*H;if(V==1&&W.t279!=null&&W.t278&&W.t262[0]==32803)L=Math.round(W.t279[0]*8/(W.width*W.t278[0]));if(W.t50885&&W.t50885[0]==4)L=W.t258[0]*3;var j=Math.ceil(W.width*L/8)*8,E=W.t273;if(E==null||W.t322)E=W.t324;var B=W.t279;if(V==1&&E.length==1)B=[W.height*(j>>>3)];if(B==null||W.t322)B=W.t325;var S=new Uint8Array(W.height*(j>>>3)),A=0;if(W.t322!=null){var z=W.t322[0],P=W.t323[0],R=Math.floor((W.width+z-1)/z),U=Math.floor((W.height+P-1)/P),C=new Uint8Array(Math.ceil(z*P*L/8)|0);console.log("====",R,U);for(var k=0;k<U;k++)for(var h=0;h<R;h++){var F=k*R+h;if(C.fill(0),K.decode._decompress(W,Q,N,E[F],B[F],V,C,0,G,z,P),V==6)S=C;else K._copyTile(C,Math.ceil(z*L/8)|0,P,S,Math.ceil(W.width*L/8)|0,W.height,Math.ceil(h*z*L/8)|0,k*P)}A=S.length*8}else{if(E==null)return;var v=W.t278?W.t278[0]:W.height;v=Math.min(v,W.height);for(var F=0;F<E.length;F++)K.decode._decompress(W,Q,N,E[F],B[F],V,S,Math.ceil(A/8)|0,G,W.width,v),A+=j*v;A=Math.min(A,S.length*8)}W.data=new Uint8Array(S.buffer,0,Math.ceil(A/8)|0)},K.decode._decompress=function(Y,W,Q,N,M,V,G,H,O,L,j){if(Y.t271&&Y.t271[0]=="Panasonic"&&Y.t45&&Y.t45[0]==6)V=34316;if(V==1)for(var E=0;E<M;E++)G[H+E]=Q[N+E];else if(V==2)K.decode._decodeG2(Q,N,M,G,H,L,O);else if(V==3)K.decode._decodeG3(Q,N,M,G,H,L,O,Y.t292?(Y.t292[0]&1)==1:!1);else if(V==4)K.decode._decodeG4(Q,N,M,G,H,L,O);else if(V==5)K.decode._decodeLZW(Q,N,M,G,H,8);else if(V==6)K.decode._decodeOldJPEG(Y,Q,N,M,G,H);else if(V==7||V==34892)K.decode._decodeNewJPEG(Y,Q,N,M,G,H);else if(V==8||V==32946){var B=new Uint8Array(Q.buffer,N+2,M-6),S=q.inflateRaw(B);if(H+S.length<=G.length)G.set(S,H)}else if(V==9)K.decode._decodeVC5(Q,N,M,G,H,Y.t33422);else if(V==32767)K.decode._decodeARW(Y,Q,N,M,G,H);else if(V==32773)K.decode._decodePackBits(Q,N,M,G,H);else if(V==32809)K.decode._decodeThunder(Q,N,M,G,H);else if(V==34316)K.decode._decodePanasonic(Y,Q,N,M,G,H);else if(V==34713)K.decode._decodeNikon(Y,W,Q,N,M,G,H);else if(V==34676)K.decode._decodeLogLuv32(Y,Q,N,M,G,H);else X("Unknown compression",V);var A=Y.t258?Math.min(32,Y.t258[0]):1,z=Y.t277?Y.t277[0]:1,P=A*z>>>3,R=Math.ceil(A*z*L/8);if(A==16&&!Y.isLE&&Y.t33422==null)for(var U=0;U<j;U++){var C=H+U*R;for(var k=1;k<R;k+=2){var h=G[C+k];G[C+k]=G[C+k-1],G[C+k-1]=h}}if(Y.t317&&Y.t317[0]==2)for(var U=0;U<j;U++){var F=H+U*R;if(A==16)for(var E=P;E<R;E+=2){var v=(G[F+E+1]<<8|G[F+E])+(G[F+E-P+1]<<8|G[F+E-P]);G[F+E]=v&255,G[F+E+1]=v>>>8&255}else if(z==3)for(var E=3;E<R;E+=3)G[F+E]=G[F+E]+G[F+E-3]&255,G[F+E+1]=G[F+E+1]+G[F+E-2]&255,G[F+E+2]=G[F+E+2]+G[F+E-1]&255;else for(var E=P;E<R;E++)G[F+E]=G[F+E]+G[F+E-P]&255}},K.decode._decodePanasonic=function(Y,W,Q,N,M,V){var G=W.buffer,H=Y.t2[0],O=Y.t3[0],L=Y.t10[0],j=Y.t45[0],E=0,B=0,S=0,A=0,z,P,R=j==6?new Uint32Array(18):new Uint8Array(16),U,C,k,h=[0,0],F=[0,0],v,D=0,w,x,y,b,_=new Uint8Array(16384),m=new Uint16Array(M.buffer);function t(V0){if(S==0){var O0=new Uint8Array(G,Q+B+8184,8200),j0=new Uint8Array(G,Q+B,8184);_.set(O0),_.set(j0,O0.length),B+=16384}if(j==5)for(U=0;U<16;U++)R[U]=_[S++],S&=16383;else return S=S-V0&131071,A=S>>3^16368,(_[A]|_[A+1]<<8)>>(S&7)&~(-1<<V0)}function l(V0){return _[S+15-V0]}function s(){R[0]=l(0)<<6|l(1)>>2,R[1]=((l(1)&3)<<12|l(2)<<4|l(3)>>4)&16383,R[2]=l(3)>>2&3,R[3]=(l(3)&3)<<8|l(4),R[4]=l(5)<<2|l(6)>>6,R[5]=(l(6)&63)<<4|l(7)>>4,R[6]=l(7)>>2&3,R[7]=(l(7)&3)<<8|l(8),R[8]=l(9)<<2&1020|l(10)>>6,R[9]=(l(10)<<4|l(11)>>4)&1023,R[10]=l(11)>>2&3,R[11]=(l(11)&3)<<8|l(12),R[12]=(l(13)<<2&1020|l(14)>>6)&1023,R[13]=(l(14)<<4|l(15)>>4)&1023,S+=16,A=0}function g(){R[0]=l(0)<<4|l(1)>>4,R[1]=((l(1)&15)<<8|l(2))&4095,R[2]=l(3)>>6&3,R[3]=(l(3)&63)<<2|l(4)>>6,R[4]=(l(4)&63)<<2|l(5)>>6,R[5]=(l(5)&63)<<2|l(6)>>6,R[6]=l(6)>>4&3,R[7]=(l(6)&15)<<4|l(7)>>4,R[8]=(l(7)&15)<<4|l(8)>>4,R[9]=(l(8)&15)<<4|l(9)>>4,R[10]=l(9)>>2&3,R[11]=(l(9)&3)<<6|l(10)>>2,R[12]=(l(10)&3)<<6|l(11)>>2,R[13]=(l(11)&3)<<6|l(12)>>2,R[14]=l(12)&3,R[15]=l(13),R[16]=l(14),R[17]=l(15),S+=16,A=0}function Z(){h[0]=0,h[1]=0,F[0]=0,F[1]=0}if(j==7)throw j;else if(j==6){var T=L==12,c=T?g:s,o=T?14:11,$0=T?128:512,a=T?2048:8192,e=T?16383:65535,r=T?4095:16383,p=H/o,i=p*16,X0=T?18:14;for(x=0;x<O-15;x+=16){var K0=Math.min(16,O-x),U0=i*K0;_=new Uint8Array(G,Q+E,U0),S=0,E+=U0;for(b=0,y=0;b<K0;b++,y=0){D=(x+b)*H;for(var S0=0;S0<p;S0++){c(),Z(),k=0,w=0;for(U=0;U<o;U++){if(v=U&1,U%3==2){var u=A<X0?R[A++]:0;if(u==3)u=4;w=$0<<u,k=1<<u}var M0=A<X0?R[A++]:0;if(h[v]){if(M0*=k,w<a&&F[v]>w)M0+=F[v]-w;F[v]=M0}else if(h[v]=M0,M0)F[v]=M0;else M0=F[v];m[D+y++]=M0-15<=e?M0-15&e:M0+2147483633>>31&r}}}}}else if(j==5){var q0=L==12?10:9;for(x=0;x<O;x++)for(y=0;y<H;y+=q0)if(t(0),L==12)m[D++]=((R[1]&15)<<8)+R[0],m[D++]=16*R[2]+(R[1]>>4),m[D++]=((R[4]&15)<<8)+R[3],m[D++]=16*R[5]+(R[4]>>4),m[D++]=((R[7]&15)<<8)+R[6],m[D++]=16*R[8]+(R[7]>>4),m[D++]=((R[10]&15)<<8)+R[9],m[D++]=16*R[11]+(R[10]>>4),m[D++]=((R[13]&15)<<8)+R[12],m[D++]=16*R[14]+(R[13]>>4);else if(L==14)m[D++]=R[0]+((R[1]&63)<<8),m[D++]=(R[1]>>6)+4*R[2]+((R[3]&15)<<10),m[D++]=(R[3]>>4)+16*R[4]+((R[5]&3)<<12),m[D++]=((R[5]&252)>>2)+(R[6]<<6),m[D++]=R[7]+((R[8]&63)<<8),m[D++]=(R[8]>>6)+4*R[9]+((R[10]&15)<<10),m[D++]=(R[10]>>4)+16*R[11]+((R[12]&3)<<12),m[D++]=((R[12]&252)>>2)+(R[13]<<6),m[D++]=R[14]+((R[15]&63)<<8)}else if(j==4)for(x=0;x<O;x++)for(y=0;y<H;y++){if(U=y%14,v=U&1,U==0)Z();if(U%3==2)k=4>>3-t(2);if(F[v]){if(C=t(8),C!=0){if(h[v]-=128<<k,h[v]<0||k==4)h[v]&=~(-1<<k);h[v]+=C<<k}}else if(F[v]=t(8),F[v]||U>11)h[v]=F[v]<<4|t(4);m[D++]=h[y&1]}else throw j},K.decode._decodeVC5=function(){var Y=[1,0,1,0,2,2,1,1,3,7,1,2,5,25,1,3,6,48,1,4,6,54,1,5,7,111,1,8,7,99,1,6,7,105,12,0,7,107,1,7,8,209,20,0,8,212,1,9,8,220,1,10,9,393,1,11,9,394,32,0,9,416,1,12,9,427,1,13,10,887,1,18,10,784,1,14,10,790,1,15,10,835,60,0,10,852,1,16,10,885,1,17,11,1571,1,19,11,1668,1,20,11,1669,100,0,11,1707,1,21,11,1772,1,22,12,3547,1,29,12,3164,1,24,12,3166,1,25,12,3140,1,23,12,3413,1,26,12,3537,1,27,12,3539,1,28,13,7093,1,35,13,6283,1,30,13,6331,1,31,13,6335,180,0,13,6824,1,32,13,7072,1,33,13,7077,320,0,13,7076,1,34,14,12565,1,36,14,12661,1,37,14,12669,1,38,14,13651,1,39,14,14184,1,40,15,28295,1,46,15,28371,1,47,15,25320,1,42,15,25336,1,43,15,25128,1,41,15,27300,1,44,15,28293,1,45,16,50259,1,48,16,50643,1,49,16,50675,1,50,16,56740,1,53,16,56584,1,51,16,56588,1,52,17,113483,1,61,17,113482,1,60,17,101285,1,55,17,101349,1,56,17,109205,1,57,17,109207,1,58,17,100516,1,54,17,113171,1,59,18,202568,1,62,18,202696,1,63,18,218408,1,64,18,218412,1,65,18,226340,1,66,18,226356,1,67,18,226358,1,68,19,402068,1,69,19,405138,1,70,19,405394,1,71,19,436818,1,72,19,436826,1,73,19,452714,1,75,19,452718,1,76,19,452682,1,74,20,804138,1,77,20,810279,1,78,20,810790,1,79,20,873638,1,80,20,873654,1,81,20,905366,1,82,20,905430,1,83,20,905438,1,84,21,1608278,1,85,21,1620557,1,86,21,1621582,1,87,21,1621583,1,88,21,1747310,1,89,21,1810734,1,90,21,1810735,1,91,21,1810863,1,92,21,1810879,1,93,22,3621725,1,99,22,3621757,1,100,22,3241112,1,94,22,3494556,1,95,22,3494557,1,96,22,3494622,1,97,22,3494623,1,98,23,6482227,1,102,23,6433117,1,101,23,6989117,1,103,23,6989119,1,105,23,6989118,1,104,23,7243449,1,106,23,7243512,1,107,24,13978233,1,111,24,12964453,1,109,24,12866232,1,108,24,14486897,1,113,24,13978232,1,110,24,14486896,1,112,24,14487026,1,114,24,14487027,1,115,25,25732598,1,225,25,25732597,1,189,25,25732596,1,188,25,25732595,1,203,25,25732594,1,202,25,25732593,1,197,25,25732592,1,207,25,25732591,1,169,25,25732590,1,223,25,25732589,1,159,25,25732522,1,235,25,25732579,1,152,25,25732575,1,192,25,25732489,1,179,25,25732573,1,201,25,25732472,1,172,25,25732576,1,149,25,25732488,1,178,25,25732566,1,120,25,25732571,1,219,25,25732577,1,150,25,25732487,1,127,25,25732506,1,211,25,25732548,1,125,25,25732588,1,158,25,25732486,1,247,25,25732467,1,238,25,25732508,1,163,25,25732552,1,228,25,25732603,1,183,25,25732513,1,217,25,25732587,1,168,25,25732520,1,122,25,25732484,1,128,25,25732562,1,249,25,25732505,1,187,25,25732504,1,186,25,25732483,1,136,25,25928905,1,181,25,25732560,1,255,25,25732500,1,230,25,25732482,1,135,25,25732555,1,233,25,25732568,1,222,25,25732583,1,145,25,25732481,1,134,25,25732586,1,167,25,25732521,1,248,25,25732518,1,209,25,25732480,1,243,25,25732512,1,216,25,25732509,1,164,25,25732547,1,140,25,25732479,1,157,25,25732544,1,239,25,25732574,1,191,25,25732564,1,251,25,25732478,1,156,25,25732546,1,139,25,25732498,1,242,25,25732557,1,133,25,25732477,1,162,25,25732515,1,213,25,25732584,1,165,25,25732514,1,212,25,25732476,1,227,25,25732494,1,198,25,25732531,1,236,25,25732530,1,234,25,25732529,1,117,25,25732528,1,215,25,25732527,1,124,25,25732526,1,123,25,25732525,1,254,25,25732524,1,253,25,25732523,1,148,25,25732570,1,218,25,25732580,1,146,25,25732581,1,147,25,25732569,1,224,25,25732533,1,143,25,25732540,1,184,25,25732541,1,185,25,25732585,1,166,25,25732556,1,132,25,25732485,1,129,25,25732563,1,250,25,25732578,1,151,25,25732501,1,119,25,25732502,1,193,25,25732536,1,176,25,25732496,1,245,25,25732553,1,229,25,25732516,1,206,25,25732582,1,144,25,25732517,1,208,25,25732558,1,137,25,25732543,1,241,25,25732466,1,237,25,25732507,1,190,25,25732542,1,240,25,25732551,1,131,25,25732554,1,232,25,25732565,1,252,25,25732475,1,171,25,25732493,1,205,25,25732492,1,204,25,25732491,1,118,25,25732490,1,214,25,25928904,1,180,25,25732549,1,126,25,25732602,1,182,25,25732539,1,175,25,25732545,1,141,25,25732559,1,138,25,25732537,1,177,25,25732534,1,153,25,25732503,1,194,25,25732606,1,160,25,25732567,1,121,25,25732538,1,174,25,25732497,1,246,25,25732550,1,130,25,25732572,1,200,25,25732474,1,170,25,25732511,1,221,25,25732601,1,196,25,25732532,1,142,25,25732519,1,210,25,25732495,1,199,25,25732605,1,155,25,25732535,1,154,25,25732499,1,244,25,25732510,1,220,25,25732600,1,195,25,25732607,1,161,25,25732604,1,231,25,25732473,1,173,25,25732599,1,226,26,51465122,1,116,26,51465123,0,1],W,Q,N,M=[3,3,3,3,2,2,2,1,1,1],V=24576,G=16384,H=8192,O=G|H;function L(U){var C=U[1],k=U[0][C>>>3]>>>7-(C&7)&1;return U[1]++,k}function j(U,C){if(W==null){W={};for(var k=0;k<Y.length;k+=4)W[Y[k+1]]=Y.slice(k,k+4)}var h=L(U),F=W[h];while(F==null)h=h<<1|L(U),F=W[h];var v=F[3];if(v!=0)v=L(U)==0?v:-v;C[0]=F[2],C[1]=v}function E(U,C){for(var k=0;k<C;k++){if((U&1)==1)U++;U=U>>>1}return U}function B(U,C){return U>>C}function S(U,C,k,h,F,v){C[k]=B(B(11*U[F]-4*U[F+v]+U[F+v+v]+4,3)+U[h],1),C[k+v]=B(B(5*U[F]+4*U[F+v]-U[F+v+v]+4,3)-U[h],1)}function A(U,C,k,h,F,v){var D=U[F-v]-U[F+v],w=U[F],x=U[h];C[k]=B(B(D+4,3)+w+x,1),C[k+v]=B(B(-D+4,3)+w-x,1)}function z(U,C,k,h,F,v){C[k]=B(B(5*U[F]+4*U[F-v]-U[F-v-v]+4,3)+U[h],1),C[k+v]=B(B(11*U[F]-4*U[F-v]+U[F-v-v]+4,3)-U[h],1)}function P(U){return U=U<0?0:U>4095?4095:U,U=N[U]>>>2,U}function R(U,C,k,h,F,v){h=new Uint16Array(h.buffer);var D=Date.now(),w=K._binBE,x=C+k,y,b,_,m,t,l,s,g,Z,T,c,o,$0,a,e,r,p,i;C+=4;var X0=v[0]==1;while(C<x){var K0=w.readShort(U,C),U0=w.readUshort(U,C+2);if(C+=4,K0==12)y=U0;else if(K0==20)b=U0;else if(K0==21)_=U0;else if(K0==48)m=U0;else if(K0==53)t=U0;else if(K0==35)l=U0;else if(K0==62)s=U0;else if(K0==101)g=U0;else if(K0==109)Z=U0;else if(K0==84)T=U0;else if(K0==106)c=U0;else if(K0==107)o=U0;else if(K0==108)$0=U0;else if(K0==102)a=U0;else if(K0==104)e=U0;else if(K0==105)r=U0;else{var S0=K0<0?-K0:K0,u=S0&65280,M0=0;if(S0&O)if(S0&H)M0=U0&65535,M0+=(S0&255)<<16;else M0=U0&65535;if((S0&V)==V){if(p==null){p=[];for(var q0=0;q0<4;q0++)p[q0]=new Int16Array((b>>>1)*(_>>>1));i=new Int16Array((b>>>1)*(_>>>1)),Q=new Int16Array(1024);for(var q0=0;q0<1024;q0++){var V0=q0-512,O0=Math.abs(V0),y=Math.floor(768*O0*O0*O0/16581375)+O0;Q[q0]=Math.sign(V0)*y}N=new Uint16Array(4096);var j0=65535;for(var q0=0;q0<4096;q0++){var F0=q0,v0=j0*(Math.pow(113,F0/4095)-1)/112;N[q0]=Math.min(v0,j0)}}var A0=p[s],T0=E(b,1+M[m]),Y0=E(_,1+M[m]);if(m==0)for(var J0=0;J0<Y0;J0++)for(var N0=0;N0<T0;N0++){var g0=C+(J0*T0+N0)*2;A0[J0*(b>>>1)+N0]=U[g0]<<8|U[g0+1]}else{var z0=[U,C*8],I0=[],d0=0,W0=T0*Y0,R0=[0,0],Z0=0,U0=0;while(d0<W0){j(z0,R0),Z0=R0[0],U0=R0[1];while(Z0>0)I0[d0++]=U0,Z0--}var _0=(m-1)%3,f0=_0!=1?T0:0,s0=_0!=0?Y0:0;for(var J0=0;J0<Y0;J0++){var y0=(J0+s0)*(b>>>1)+f0,i0=J0*T0;for(var N0=0;N0<T0;N0++)A0[y0+N0]=Q[I0[i0+N0]+512]*t}if(_0==2){var e=b>>>1,t0=T0*2,F6=Y0*2;for(var J0=0;J0<Y0;J0++)for(var N0=0;N0<t0;N0++){var q0=J0*2*e+N0,L6=J0*e+N0,w6=Y0*e+L6;if(J0==0)S(A0,i,q0,w6,L6,e);else if(J0==Y0-1)z(A0,i,q0,w6,L6,e);else A(A0,i,q0,w6,L6,e)}var X8=A0;A0=i,i=X8;for(var J0=0;J0<F6;J0++)for(var N0=0;N0<T0;N0++){var q0=J0*e+2*N0,L6=J0*e+N0,w6=T0+L6;if(N0==0)S(A0,i,q0,w6,L6,1);else if(N0==T0-1)z(A0,i,q0,w6,L6,1);else A(A0,i,q0,w6,L6,1)}var X8=A0;A0=i,i=X8;var R8=[],x8=2-~~((m-1)/3);for(var B8=0;B8<3;B8++)R8[B8]=Z>>14-B8*2&3;var l5=R8[x8];if(l5!=0)for(var J0=0;J0<F6;J0++)for(var N0=0;N0<t0;N0++){var q0=J0*e+N0;A0[q0]=A0[q0]<<l5}}}if(m==9&&s==3){var c5=p[0],p9=p[1],u9=p[2],l9=p[3];for(var J0=0;J0<_;J0+=2)for(var N0=0;N0<b;N0+=2){var K8=J0*b+N0,g0=(J0>>>1)*(b>>>1)+(N0>>>1),F1=c5[g0],Y7=p9[g0]-2048,z1=u9[g0]-2048,n1=l9[g0]-2048,v1=(Y7<<1)+F1,C1=(z1<<1)+F1,d5=F1+n1,n5=F1-n1;if(X0)h[K8]=P(d5),h[K8+1]=P(C1),h[K8+b]=P(v1),h[K8+b+1]=P(n5);else h[K8]=P(v1),h[K8+1]=P(d5),h[K8+b]=P(n5),h[K8+b+1]=P(C1)}}C+=M0*4}else if(S0==16388)C+=M0*4;else if(u==8192||u==8448||u==9216);else throw S0.toString(16)}}console.log(Date.now()-D)}return R}(),K.decode._decodeLogLuv32=function(Y,W,Q,N,M,V){var G=Y.width,H=G*4,O=0,L=new Uint8Array(H);while(O<N){var j=0;while(j<H){var E=W[Q+O];if(O++,E<128){for(var B=0;B<E;B++)L[j+B]=W[Q+O+B];j+=E,O+=E}else{E=E-126;for(var B=0;B<E;B++)L[j+B]=W[Q+O];j+=E,O++}}for(var S=0;S<G;S++)M[V+0]=L[S],M[V+1]=L[S+G],M[V+2]=L[S+G*2],M[V+4]=L[S+G*3],V+=6}},K.decode._ljpeg_diff=function(Y,W,Q){var N=K.decode._getbithuff,M,V;if(M=N(Y,W,Q[0],Q),V=N(Y,W,M,0),(V&1<<M-1)==0)V-=(1<<M)-1;return V},K.decode._decodeARW=function(Y,W,Q,N,M,V){var G=Y.t256[0],H=Y.t257[0],O=Y.t258[0],L=Y.isLE?K._binLE:K._binBE,j=G*H==N||G*H*1.5==N;if(!j){H+=8;var E=[Q,0,0,0],B=new Uint16Array(32770),S=[3857,3856,3599,3342,3085,2828,2571,2314,2057,1800,1543,1286,1029,772,771,768,514,513],s,A,z,w,D,P=0,R=K.decode._ljpeg_diff;B[0]=15;for(z=s=0;s<18;s++){var U=32768>>>(S[s]>>>8);for(var A=0;A<U;A++)B[++z]=S[s]}for(w=G;w--;)for(D=0;D<H+1;D+=2){if(D==H)D=1;if(P+=R(W,E,B),D<H){var C=P&4095;K.decode._putsF(M,(D*G+w)*O,C<<16-O)}}return}if(G*H*1.5==N){for(var s=0;s<N;s+=3){var k=W[Q+s+0],h=W[Q+s+1],F=W[Q+s+2];M[V+s]=h<<4|k>>>4,M[V+s+1]=k<<4|F>>>4,M[V+s+2]=F<<4|h>>>4}return}var v=new Uint16Array(16),D,w,x,y,b,_,m,t,l,s,g,Z=new Uint8Array(G+1);for(D=0;D<H;D++){for(var T=0;T<G;T++)Z[T]=W[Q++];for(g=0,w=0;w<G-30;g+=16){y=2047&(x=L.readUint(Z,g)),b=2047&x>>>11,_=15&x>>>22,m=15&x>>>26;for(t=0;t<4&&128<<t<=y-b;t++);for(l=30,s=0;s<16;s++)if(s==_)v[s]=y;else if(s==m)v[s]=b;else{if(v[s]=((L.readUshort(Z,g+(l>>3))>>>(l&7)&127)<<t)+b,v[s]>2047)v[s]=2047;l+=7}for(s=0;s<16;s++,w+=2){var C=v[s]<<1;K.decode._putsF(M,(D*G+w)*O,C<<16-O)}w-=w&1?1:31}}},K.decode._decodeNikon=function(Y,W,Q,N,M,V,G){var H=[[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,5,4,3,6,2,7,1,0,8,9,11,10,12],[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,57,90,56,39,22,5,4,3,2,1,0,11,12,12],[0,0,1,4,2,3,1,2,0,0,0,0,0,0,0,0,0,5,4,6,3,7,2,8,1,9,0,10,11,12],[0,0,1,4,3,1,1,1,1,1,2,0,0,0,0,0,0,5,6,4,7,8,3,9,2,1,0,10,11,12,13,14],[0,0,1,5,1,1,1,1,1,1,1,2,0,0,0,0,0,8,92,75,58,41,7,6,5,4,3,2,1,0,13,14],[0,0,1,4,2,2,3,1,2,0,0,0,0,0,0,0,0,7,6,8,5,9,4,10,3,11,12,2,0,1,13,14]],O=Y.t256[0],L=Y.t257[0],j=Y.t258[0],E=0,B=0,S=K.decode._make_decoder,A=K.decode._getbithuff,z=W[0].exifIFD.makerNote,P=z.t150?z.t150:z.t140,R=0,U=P[R++],C=P[R++];if(U==73||C==88)R+=2110;if(U==70)E=2;if(j==14)E+=3;var k=[[0,0],[0,0]],h=Y.isLE?K._binLE:K._binBE;for(var x=0;x<2;x++)for(var F=0;F<2;F++)k[x][F]=h.readShort(P,R),R+=2;var v=1<<j&32767,D=0,w=h.readShort(P,R);if(R+=2,w>1)D=Math.floor(v/(w-1));if(U==68&&C==32&&D>0)B=h.readShort(P,562);var x,y,b,_,m,t,l=0,s=[0,0],g=S(H[E]),Z=[N,0,0,0];for(l=y=0;y<L;y++){if(B&&y==B)g=S(H[E+1]);for(b=0;b<O;b++){if(x=A(Q,Z,g[0],g),_=x&15,m=x>>>4,t=(A(Q,Z,_-m,0)<<1)+1<<m>>>1,(t&1<<_-1)==0)t-=(1<<_)-(m==0?1:0);if(b<2)s[b]=k[y&1][b]+=t;else s[b&1]+=t;var T=Math.min(Math.max(s[b&1],0),(1<<j)-1),c=(y*O+b)*j;K.decode._putsF(V,c,T<<16-j)}}},K.decode._putsF=function(Y,W,Q){Q=Q<<8-(W&7);var N=W>>>3;Y[N]|=Q>>>16,Y[N+1]|=Q>>>8,Y[N+2]|=Q},K.decode._getbithuff=function(Y,W,Q,N){var M=0,V=K.decode._get_byte,G,H=W[0],O=W[1],L=W[2],j=W[3];if(Q==0||L<0)return 0;while(!j&&L<Q&&(G=Y[H++])!=-1&&!(j=M&&G==255&&Y[H++]))O=(O<<8)+G,L+=8;if(G=O<<32-L>>>32-Q,N)L-=N[G+1]>>>8,G=N[G+1]&255;else L-=Q;if(L<0)throw"e";return W[0]=H,W[1]=O,W[2]=L,W[3]=j,G},K.decode._make_decoder=function(Y){var W,Q,N,M,V,G=[];for(W=16;W!=0&&!Y[W];W--);var H=17;G[0]=W;for(N=Q=1;Q<=W;Q++)for(M=0;M<Y[Q];M++,++H)for(V=0;V<1<<W-Q;V++)if(N<=1<<W)G[N++]=Q<<8|Y[H];return G},K.decode._decodeNewJPEG=function(Y,W,Q,N,M,V){N=Math.min(N,W.length-Q);var G=Y.t347,H=G?G.length:0,O=new Uint8Array(H+N);if(G){var L=216,j=217,E=0;for(var B=0;B<H-1;B++){if(G[B]==255&&G[B+1]==j)break;O[E++]=G[B]}var S=W[Q],A=W[Q+1];if(S!=255||A!=L)O[E++]=S,O[E++]=A;for(var B=2;B<N;B++)O[E++]=W[Q+B]}else for(var B=0;B<N;B++)O[B]=W[Q+B];if(Y.t262[0]==32803||Y.t259[0]==7&&Y.t262[0]==34892){var z=Y.t258[0],P=K.LosslessJpegDecode(O),R=P.length;if(z==16)if(Y.isLE)for(var B=0;B<R;B++)M[V+(B<<1)]=P[B]&255,M[V+(B<<1)+1]=P[B]>>>8;else for(var B=0;B<R;B++)M[V+(B<<1)]=P[B]>>>8,M[V+(B<<1)+1]=P[B]&255;else if(z==14||z==12||z==10){var U=16-z;for(var B=0;B<R;B++)K.decode._putsF(M,B*z,P[B]<<U)}else if(z==8)for(var B=0;B<R;B++)M[V+B]=P[B];else throw Error("unsupported bit depth "+z)}else{var C=new K.JpegDecoder;C.parse(O);var k=C.getData({width:C.width,height:C.height,forceRGB:!0,isSourcePDF:!1});for(var B=0;B<k.length;B++)M[V+B]=k[B]}if(Y.t262[0]==6)Y.t262[0]=2},K.decode._decodeOldJPEGInit=function(Y,W,Q,N){var M=216,V=217,G=219,H=196,O=221,L=192,j=218,E=0,B=0,S,A,z=!1,P,R,U,C=Y.t513,k=C?C[0]:0,h=Y.t514,F=h?h[0]:0,v=Y.t324||Y.t273||C,D=Y.t530,w=0,x=0,y=Y.t277?Y.t277[0]:1,b=Y.t515;if(v)B=v[0],z=v.length>1;if(!z){if(W[Q]==255&&W[Q+1]==M)return{jpegOffset:Q};if(C!=null){if(W[Q+k]==255&&W[Q+k+1]==M)E=Q+k;else X("JPEGInterchangeFormat does not point to SOI");if(h==null)X("JPEGInterchangeFormatLength field is missing");else if(k>=B||k+F<=B)X("JPEGInterchangeFormatLength field value is invalid");if(E!=null)return{jpegOffset:E}}}if(D!=null)w=D[0],x=D[1];if(C!=null){if(h!=null)if(F>=2&&k+F<=B){if(W[Q+k+F-2]==255&&W[Q+k+F-1]==M)S=new Uint8Array(F-2);else S=new Uint8Array(F);for(P=0;P<S.length;P++)S[P]=W[Q+k+P];X("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else X("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile")}if(S==null){var _=0,m=[];m[_++]=255,m[_++]=M;var t=Y.t519;if(t==null)throw Error("JPEGQTables tag is missing");for(P=0;P<t.length;P++){m[_++]=255,m[_++]=G,m[_++]=0,m[_++]=67,m[_++]=P;for(R=0;R<64;R++)m[_++]=W[Q+t[P]+R]}for(U=0;U<2;U++){var l=Y[U==0?"t520":"t521"];if(l==null)throw Error((U==0?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(P=0;P<l.length;P++){m[_++]=255,m[_++]=H;var s=19;for(R=0;R<16;R++)s+=W[Q+l[P]+R];m[_++]=s>>>8,m[_++]=s&255,m[_++]=P|U<<4;for(R=0;R<16;R++)m[_++]=W[Q+l[P]+R];for(R=0;R<s;R++)m[_++]=W[Q+l[P]+16+R]}}if(m[_++]=255,m[_++]=L,m[_++]=0,m[_++]=8+3*y,m[_++]=8,m[_++]=Y.height>>>8&255,m[_++]=Y.height&255,m[_++]=Y.width>>>8&255,m[_++]=Y.width&255,m[_++]=y,y==1)m[_++]=1,m[_++]=17,m[_++]=0;else for(P=0;P<3;P++)m[_++]=P+1,m[_++]=P!=0?17:(w&15)<<4|x&15,m[_++]=P;if(b!=null&&b[0]!=0)m[_++]=255,m[_++]=O,m[_++]=0,m[_++]=4,m[_++]=b[0]>>>8&255,m[_++]=b[0]&255;S=new Uint8Array(m)}var g=-1;P=0;while(P<S.length-1){if(S[P]==255&&S[P+1]==L){g=P;break}P++}if(g==-1){var Z=new Uint8Array(S.length+10+3*y);Z.set(S);var T=S.length;if(g=S.length,S=Z,S[T++]=255,S[T++]=L,S[T++]=0,S[T++]=8+3*y,S[T++]=8,S[T++]=Y.height>>>8&255,S[T++]=Y.height&255,S[T++]=Y.width>>>8&255,S[T++]=Y.width&255,S[T++]=y,y==1)S[T++]=1,S[T++]=17,S[T++]=0;else for(P=0;P<3;P++)S[T++]=P+1,S[T++]=P!=0?17:(w&15)<<4|x&15,S[T++]=P}if(W[B]==255&&W[B+1]==j){var c=W[B+2]<<8|W[B+3];A=new Uint8Array(c+2),A[0]=W[B],A[1]=W[B+1],A[2]=W[B+2],A[3]=W[B+3];for(P=0;P<c-2;P++)A[P+4]=W[B+P+4]}else{A=new Uint8Array(8+2*y);var o=0;if(A[o++]=255,A[o++]=j,A[o++]=0,A[o++]=6+2*y,A[o++]=y,y==1)A[o++]=1,A[o++]=0;else for(P=0;P<3;P++)A[o++]=P+1,A[o++]=P<<4|P;A[o++]=0,A[o++]=63,A[o++]=0}return{jpegOffset:Q,tables:S,sosMarker:A,sofPosition:g}},K.decode._decodeOldJPEG=function(Y,W,Q,N,M,V){var G,H,O,L,j,E=K.decode._decodeOldJPEGInit(Y,W,Q,N);if(E.jpegOffset!=null){H=Q+N-E.jpegOffset,L=new Uint8Array(H);for(G=0;G<H;G++)L[G]=W[E.jpegOffset+G]}else{if(O=E.tables.length,L=new Uint8Array(O+E.sosMarker.length+N+2),L.set(E.tables),j=O,L[E.sofPosition+5]=Y.height>>>8&255,L[E.sofPosition+6]=Y.height&255,L[E.sofPosition+7]=Y.width>>>8&255,L[E.sofPosition+8]=Y.width&255,W[Q]!=255||W[Q+1]!=SOS)L.set(E.sosMarker,j),j+=sosMarker.length;for(G=0;G<N;G++)L[j++]=W[Q+G];L[j++]=255,L[j++]=EOI}var B=new K.JpegDecoder;B.parse(L);var S=B.getData({width:B.width,height:B.height,forceRGB:!0,isSourcePDF:!1});for(var G=0;G<S.length;G++)M[V+G]=S[G];if(Y.t262&&Y.t262[0]==6)Y.t262[0]=2},K.decode._decodePackBits=function(Y,W,Q,N,M){var V=new Int8Array(Y.buffer),G=new Int8Array(N.buffer),H=W+Q;while(W<H){var O=V[W];if(W++,O>=0&&O<128)for(var L=0;L<O+1;L++)G[M]=V[W],M++,W++;if(O>=-127&&O<0){for(var L=0;L<-O+1;L++)G[M]=V[W],M++;W++}}return M},K.decode._decodeThunder=function(Y,W,Q,N,M){var V=[0,1,0,-1],G=[0,1,2,3,0,-3,-2,-1],H=W+Q,O=M*2,L=0;while(W<H){var j=Y[W],E=j>>>6,B=j&63;if(W++,E==3)L=B&15,N[O>>>1]|=L<<4*(1-O&1),O++;if(E==0)for(var S=0;S<B;S++)N[O>>>1]|=L<<4*(1-O&1),O++;if(E==2)for(var S=0;S<2;S++){var A=B>>>3*(1-S)&7;if(A!=4)L+=G[A],N[O>>>1]|=L<<4*(1-O&1),O++}if(E==1)for(var S=0;S<3;S++){var A=B>>>2*(2-S)&3;if(A!=2)L+=V[A],N[O>>>1]|=L<<4*(1-O&1),O++}}},K.decode._dmap={"1":0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},K.decode._lens=function(){var Y=function(O,L,j,E){for(var B=0;B<L.length;B++)O[L[B]]=j+B*E},W="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",Q="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",N="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",M="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",V="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";W=W.split(","),Q=Q.split(","),N=N.split(","),M=M.split(","),V=V.split(",");var G={},H={};return Y(G,W,0,1),Y(G,N,64,64),Y(G,V,1792,64),Y(H,Q,0,1),Y(H,M,64,64),Y(H,V,1792,64),[G,H]}(),K.decode._decodeG4=function(Y,W,Q,N,M,V,G){var H=K.decode,O=W<<3,L=0,j="",E=[],B=[];for(var S=0;S<V;S++)B.push(0);B=H._makeDiff(B);var A=0,z=0,P=0,R=0,U=0,C=0,k=0,h="",F=0,v=Math.ceil(V/8)*8;while(O>>>3<W+Q){R=H._findDiff(B,A+(A==0?0:1),1-C),U=H._findDiff(B,R,C);var D=0;if(G==1)D=Y[O>>>3]>>>7-(O&7)&1;if(G==2)D=Y[O>>>3]>>>(O&7)&1;if(O++,j+=D,h=="H"){if(H._lens[C][j]!=null){var w=H._lens[C][j];if(j="",L+=w,w<64){if(H._addNtimes(E,L,C),A+=L,C=1-C,L=0,F--,F==0)h=""}}}else{if(j=="0001")j="",H._addNtimes(E,U-A,C),A=U;if(j=="001")j="",h="H",F=2;if(H._dmap[j]!=null)z=R+H._dmap[j],H._addNtimes(E,z-A,C),A=z,j="",C=1-C}if(E.length==V&&h=="")H._writeBits(E,N,M*8+k*v),C=0,k++,A=0,B=H._makeDiff(E),E=[]}},K.decode._findDiff=function(Y,W,Q){for(var N=0;N<Y.length;N+=2)if(Y[N]>=W&&Y[N+1]==Q)return Y[N]},K.decode._makeDiff=function(Y){var W=[];if(Y[0]==1)W.push(0,1);for(var Q=1;Q<Y.length;Q++)if(Y[Q-1]!=Y[Q])W.push(Q,Y[Q]);return W.push(Y.length,0,Y.length,1),W},K.decode._decodeG2=function(Y,W,Q,N,M,V,G){var H=K.decode,O=W<<3,L=0,j="",E=[],B=0,S=0,A=Math.ceil(V/8)*8;while(O>>>3<W+Q){var z=0;if(G==1)z=Y[O>>>3]>>>7-(O&7)&1;if(G==2)z=Y[O>>>3]>>>(O&7)&1;if(O++,j+=z,L=H._lens[B][j],L!=null){if(H._addNtimes(E,L,B),j="",L<64)B=1-B;if(E.length==V){if(H._writeBits(E,N,M*8+S*A),E=[],S++,B=0,(O&7)!=0)O+=8-(O&7);if(L>=64)O+=8}}}},K.decode._decodeG3=function(Y,W,Q,N,M,V,G,H){var O=K.decode,L=W<<3,j=0,E="",B=[],S=[];for(var A=0;A<V;A++)B.push(0);var z=0,P=0,R=0,U=0,C=0,k=0,h=-1,F="",v=0,D=!0,w=Math.ceil(V/8)*8;while(L>>>3<W+Q){U=O._findDiff(S,z+(z==0?0:1),1-k),C=O._findDiff(S,U,k);var x=0;if(G==1)x=Y[L>>>3]>>>7-(L&7)&1;if(G==2)x=Y[L>>>3]>>>(L&7)&1;if(L++,E+=x,D){if(O._lens[k][E]!=null){var y=O._lens[k][E];if(E="",j+=y,y<64)O._addNtimes(B,j,k),k=1-k,j=0}}else if(F=="H"){if(O._lens[k][E]!=null){var y=O._lens[k][E];if(E="",j+=y,y<64){if(O._addNtimes(B,j,k),z+=j,k=1-k,j=0,v--,v==0)F=""}}}else{if(E=="0001")E="",O._addNtimes(B,C-z,k),z=C;if(E=="001")E="",F="H",v=2;if(O._dmap[E]!=null)P=U+O._dmap[E],O._addNtimes(B,P-z,k),z=P,E="",k=1-k}if(E.endsWith("000000000001")){if(h>=0)O._writeBits(B,N,M*8+h*w);if(H){if(G==1)D=(Y[L>>>3]>>>7-(L&7)&1)==1;if(G==2)D=(Y[L>>>3]>>>(L&7)&1)==1;L++}E="",k=0,h++,z=0,S=O._makeDiff(B),B=[]}}if(B.length==V)O._writeBits(B,N,M*8+h*w)},K.decode._addNtimes=function(Y,W,Q){for(var N=0;N<W;N++)Y.push(Q)},K.decode._writeBits=function(Y,W,Q){for(var N=0;N<Y.length;N++)W[Q+N>>>3]|=Y[N]<<7-(Q+N&7)},K.decode._decodeLZW=K.decode._decodeLZW=function(){var Y,W,Q,N,M=0,V=0,G=0,H=0,O=function(){var P=Y>>>3,R=W[P]<<16|W[P+1]<<8|W[P+2],U=R>>>24-(Y&7)-V&(1<<V)-1;return Y+=V,U},L=new Uint32Array(16384),j=0,E=function(P){if(P==j)return;j=P,G=1<<P,H=G+1;for(var R=0;R<H+1;R++)L[4*R]=L[4*R+3]=R,L[4*R+1]=65535,L[4*R+2]=1},B=function(P){V=P+1,M=H+1},S=function(P){var R=P<<2,U=L[R+2],C=N+U-1;while(R!=65535)Q[C--]=L[R],R=L[R+1];N+=U},A=function(P,R){var U=M<<2,C=P<<2;if(L[U]=L[(R<<2)+3],L[U+1]=C,L[U+2]=L[C+2]+1,L[U+3]=L[C+3],M++,M+1==1<<V&&V!=12)V++},z=function(P,R,U,C,k,h){Y=R<<3,W=P,Q=C,N=k;var F=R+U<<3,v=0,D=0;E(h),B(h);while(Y<F&&(v=O())!=H){if(v==G){if(B(h),v=O(),v==H)break;S(v)}else if(v<M)S(v),A(D,v);else A(D,D),S(M-1);D=v}return N};return z}(),K.tags={},K._types=function(){var Y=Array(250);Y.fill(0),Y=Y.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);var W={33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7};return{basic:{main:Y,rest:W},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}}(),K._readIFD=function(Y,W,Q,N,M,V){var G=Y.readUshort(W,Q);Q+=2;var H={};if(V.debug)X("   ".repeat(M),N.length-1,">>>----------------");for(var O=0;O<G;O++){var L=Y.readUshort(W,Q);Q+=2;var j=Y.readUshort(W,Q);Q+=2;var E=Y.readUint(W,Q);Q+=4;var B=Y.readUint(W,Q);Q+=4;var S=[];if(j==1||j==7){var A=E<5?Q-4:B;if(A+E>W.buffer.byteLength)E=W.buffer.byteLength-A;S=new Uint8Array(W.buffer,A,E)}if(j==2){var z=E<5?Q-4:B,P=W[z],R=Math.max(0,Math.min(E-1,W.length-z));if(P<128||R==0)S.push(Y.readASCII(W,z,R));else S=new Uint8Array(W.buffer,z,R)}if(j==3)for(var U=0;U<E;U++)S.push(Y.readUshort(W,(E<3?Q-4:B)+2*U));if(j==4||j==13)for(var U=0;U<E;U++)S.push(Y.readUint(W,(E<2?Q-4:B)+4*U));if(j==5||j==10){var C=j==5?Y.readUint:Y.readInt;for(var U=0;U<E;U++)S.push([C(W,B+U*8),C(W,B+U*8+4)])}if(j==8)for(var U=0;U<E;U++)S.push(Y.readShort(W,(E<3?Q-4:B)+2*U));if(j==9)for(var U=0;U<E;U++)S.push(Y.readInt(W,(E<2?Q-4:B)+4*U));if(j==11)for(var U=0;U<E;U++)S.push(Y.readFloat(W,B+U*4));if(j==12)for(var U=0;U<E;U++)S.push(Y.readDouble(W,B+U*8));if(E!=0&&S.length==0){if(X(L,"unknown TIFF tag type: ",j,"num:",E),O==0)return;continue}if(V.debug)X("   ".repeat(M),L,j,K.tags[L],S);if(H["t"+L]=S,L==330&&H.t272&&H.t272[0]=="DSLR-A100");else if(L==330||L==34665||L==34853||L==50740&&Y.readUshort(W,Y.readUint(S,0))<300||L==61440){var k=L==50740?[Y.readUint(S,0)]:S,h=[];for(var U=0;U<k.length;U++)K._readIFD(Y,W,k[U],h,M+1,V);if(L==330)H.subIFD=h;if(L==34665)H.exifIFD=h[0];if(L==34853)H.gpsiIFD=h[0];if(L==50740)H.dngPrvt=h[0];if(L==61440)H.fujiIFD=h[0]}if(L==37500&&V.parseMN){var F=S;if(Y.readASCII(F,0,5)=="Nikon")H.makerNote=K.decode(F.slice(10).buffer)[0];else if(Y.readASCII(F,0,5)=="OLYMP"||Y.readASCII(F,0,9)=="OM SYSTEM"){var v=[8208,8224,8240,8256,8272],D=[];K._readIFD(Y,F,F[1]==77?16:F[5]==85?12:8,D,M+1,V);var w=H.makerNote=D.pop();for(var U=0;U<v.length;U++){var x="t"+v[U];if(w[x]==null)continue;K._readIFD(Y,F,w[x][0],D,M+1,V),w[x]=D.pop()}if(w.t12288)K._readIFD(Y,w.t12288,0,D,M+1,V),w.t12288=D.pop()}else if(Y.readUshort(W,B)<300&&Y.readUshort(W,B+4)<=12){var D=[];K._readIFD(Y,W,B,D,M+1,V),H.makerNote=D[0]}}}if(N.push(H),V.debug)X("   ".repeat(M),"<<<---------------");return Q},K._writeIFD=function(Y,W,Q,N,M){var V=Object.keys(M),G=V.length;if(M.exifIFD)G--;if(M.gpsiIFD)G--;Y.writeUshort(Q,N,G),N+=2;var H=N+G*12+4;for(var O=0;O<V.length;O++){var L=V[O];if(L=="t34665"||L=="t34853")continue;if(L=="exifIFD")L="t34665";if(L=="gpsiIFD")L="t34853";var j=parseInt(L.slice(1)),E=W.main[j];if(E==null)E=W.rest[j];if(E==null||E==0)throw Error("unknown type of tag: "+j);var B=M[L];if(j==34665){var S=K._writeIFD(Y,W,Q,H,M.exifIFD);B=[H],H=S[1]}if(j==34853){var S=K._writeIFD(Y,K._types.gps,Q,H,M.gpsiIFD);B=[H],H=S[1]}if(E==2)B=B[0]+"\x00";var A=B.length;Y.writeUshort(Q,N,j),N+=2,Y.writeUshort(Q,N,E),N+=2,Y.writeUint(Q,N,A),N+=4;var z=[-1,1,1,2,4,8,0,1,0,4,8,0,8][E]*A,P=N;if(z>4)Y.writeUint(Q,N,H),P=H;if(E==1||E==7)for(var R=0;R<A;R++)Q[P+R]=B[R];else if(E==2)Y.writeASCII(Q,P,B);else if(E==3)for(var R=0;R<A;R++)Y.writeUshort(Q,P+2*R,B[R]);else if(E==4)for(var R=0;R<A;R++)Y.writeUint(Q,P+4*R,B[R]);else if(E==5||E==10){var U=E==5?Y.writeUint:Y.writeInt;for(var R=0;R<A;R++){var C=B[R],k=C[0],h=C[1];if(k==null)throw"e";U(Q,P+8*R,k),U(Q,P+8*R+4,h)}}else if(E==9)for(var R=0;R<A;R++)Y.writeInt(Q,P+4*R,B[R]);else if(E==12)for(var R=0;R<A;R++)Y.writeDouble(Q,P+8*R,B[R]);else throw E;if(z>4)z+=z&1,H+=z;N+=4}return[N,H]},K.toRGBA8=function(Y,W){function Q(A0){return A0<0.0031308?12.92*A0:1.055*Math.pow(A0,0.4166666666666667)-0.055}var{width:N,height:M}=Y,V=N*M,G=V*4,H=Y.data,O=new Uint8Array(V*4),L=Y.t262?Y.t262[0]:2,j=Y.t258?Math.min(32,Y.t258[0]):1;if(Y.t262==null&&j==1)L=0;var E=Y.t277?Y.t277[0]:Y.t258?Y.t258.length:[1,1,3,1,1,4,3][L],B=Y.t339?Y.t339[0]:null;if(L==1&&j==32&&B!=3)throw"e";var S=Math.ceil(E*j*N/8);if(L==0){W=0.00390625;for(var A=0;A<M;A++){var z=A*S,P=A*N;if(j==1)for(var R=0;R<N;R++){var U=P+R<<2,C=H[z+(R>>3)]>>7-(R&7)&1;O[U]=O[U+1]=O[U+2]=(1-C)*255,O[U+3]=255}if(j==4)for(var R=0;R<N;R++){var U=P+R<<2,C=H[z+(R>>1)]>>4-4*(R&1)&15;O[U]=O[U+1]=O[U+2]=(15-C)*17,O[U+3]=255}if(j==8)for(var R=0;R<N;R++){var U=P+R<<2,C=H[z+R];O[U]=O[U+1]=O[U+2]=255-C,O[U+3]=255}if(j==16)for(var R=0;R<N;R++){var U=P+R<<2,k=z+2*R,C=H[k+1]<<8|H[k];O[U]=O[U+1]=O[U+2]=Math.min(255,255-~~(C*W)),O[U+3]=255}}}else if(L==1){if(W==null)W=0.00390625;var h=(H.length&3)==0?new Float32Array(H.buffer):null;for(var A=0;A<M;A++){var z=A*S,P=A*N;if(j==1)for(var R=0;R<N;R++){var U=P+R<<2,C=H[z+(R>>3)]>>7-(R&7)&1;O[U]=O[U+1]=O[U+2]=C*255,O[U+3]=255}if(j==2)for(var R=0;R<N;R++){var U=P+R<<2,C=H[z+(R>>2)]>>6-2*(R&3)&3;O[U]=O[U+1]=O[U+2]=C*85,O[U+3]=255}if(j==8)for(var R=0;R<N;R++){var U=P+R<<2,C=H[z+R*E];O[U]=O[U+1]=O[U+2]=C,O[U+3]=255}if(j==16)for(var R=0;R<N;R++){var U=P+R<<2,k=z+2*R,C=H[k+1]<<8|H[k];O[U]=O[U+1]=O[U+2]=Math.min(255,~~(C*W)),O[U+3]=255}if(j==32)for(var R=0;R<N;R++){var U=P+R<<2,k=(z>>>2)+R,C=h[k];O[U]=O[U+1]=O[U+2]=~~(0.5+255*C),O[U+3]=255}}}else if(L==2)if(j==8){if(E==1)for(var R=0;R<V;R++)O[4*R]=O[4*R+1]=O[4*R+2]=H[R],O[4*R+3]=255;if(E==3)for(var R=0;R<V;R++){var U=R<<2,F=R*3;O[U]=H[F],O[U+1]=H[F+1],O[U+2]=H[F+2],O[U+3]=255}if(E>=4)for(var R=0;R<V;R++){var U=R<<2,F=R*E;O[U]=H[F],O[U+1]=H[F+1],O[U+2]=H[F+2],O[U+3]=H[F+3]}}else if(j==16){if(E==4)for(var R=0;R<V;R++){var U=R<<2,F=R*8+1;O[U]=H[F],O[U+1]=H[F+2],O[U+2]=H[F+4],O[U+3]=H[F+6]}if(E==3)for(var R=0;R<V;R++){var U=R<<2,F=R*6+1;O[U]=H[F],O[U+1]=H[F+2],O[U+2]=H[F+4],O[U+3]=255}}else if(j==32){var v=new Float32Array(H.buffer),D=0;for(var R=0;R<v.length;R++)D=Math.min(D,v[R]);if(D<0)for(var R=0;R<H.length;R+=4){var w=H[R];H[R]=H[R+3],H[R+3]=w,w=H[R+1],H[R+1]=H[R+2],H[R+2]=w}var x=[];for(var R=0;R<65536;R++)x.push(Q(R/65535));for(var R=0;R<v.length;R++){var y=Math.max(0,Math.min(1,v[R]));v[R]=x[~~(0.5+y*65535)]}if(E==3)for(var R=0;R<V;R++){var U=R<<2,F=R*3;O[U]=~~(0.5+v[F]*255),O[U+1]=~~(0.5+v[F+1]*255),O[U+2]=~~(0.5+v[F+2]*255),O[U+3]=255}else if(E==4)for(var R=0;R<V;R++){var U=R<<2,F=R*4;O[U]=~~(0.5+v[F]*255),O[U+1]=~~(0.5+v[F+1]*255),O[U+2]=~~(0.5+v[F+2]*255),O[U+3]=~~(0.5+v[F+3]*255)}else throw E}else throw j;else if(L==3){var b=Y.t320,_=1<<j,m=j==8&&E>1&&Y.t338&&Y.t338[0]!=0;for(var A=0;A<M;A++)for(var t=0;t<N;t++){var R=A*N+t,U=R<<2,l=0,s=A*S;if(j==1)l=H[s+(t>>>3)]>>>7-(t&7)&1;else if(j==2)l=H[s+(t>>>2)]>>>6-2*(t&3)&3;else if(j==4)l=H[s+(t>>>1)]>>>4-4*(t&1)&15;else if(j==8)l=H[s+t*E];else throw j;O[U]=b[l]>>8,O[U+1]=b[_+l]>>8,O[U+2]=b[_+_+l]>>8,O[U+3]=m?H[s+t*E+1]:255}}else if(L==5){var g=E>4?1:0;for(var R=0;R<V;R++){var U=R<<2,Z=R*E;if(window.UDOC){var T=H[Z],c=H[Z+1],o=H[Z+2],$0=H[Z+3],a=UDOC.C.cmykToRgb([T*0.00392156862745098,c*0.00392156862745098,o*0.00392156862745098,$0*0.00392156862745098]);O[U]=~~(0.5+255*a[0]),O[U+1]=~~(0.5+255*a[1]),O[U+2]=~~(0.5+255*a[2])}else{var T=255-H[Z],c=255-H[Z+1],o=255-H[Z+2],$0=(255-H[Z+3])*0.00392156862745098;O[U]=~~(T*$0+0.5),O[U+1]=~~(c*$0+0.5),O[U+2]=~~(o*$0+0.5)}O[U+3]=255*(1-g)+H[Z+4]*g}}else if(L==6&&Y.t278){var e=Y.t278[0];for(var A=0;A<M;A+=e){var R=A*N,r=e*N;for(var p=0;p<r;p++){var U=4*(R+p),Z=3*R+4*(p>>>1),o=H[Z+(p&1)],i=H[Z+2]-128,X0=H[Z+3]-128,K0=o+((X0>>2)+(X0>>3)+(X0>>5)),U0=o-((i>>2)+(i>>4)+(i>>5))-((X0>>1)+(X0>>3)+(X0>>4)+(X0>>5)),S0=o+(i+(i>>1)+(i>>2)+(i>>6));O[U]=Math.max(0,Math.min(255,K0)),O[U+1]=Math.max(0,Math.min(255,U0)),O[U+2]=Math.max(0,Math.min(255,S0)),O[U+3]=255}}}else if(L==32845)for(var A=0;A<M;A++)for(var t=0;t<N;t++){var Z=(A*N+t)*6,U=(A*N+t)*4,u=H[Z+1]<<8|H[Z],u=Math.pow(2,(u+0.5)/256-64),M0=(H[Z+3]+0.5)/410,q0=(H[Z+5]+0.5)/410,V0=9*M0/(6*M0-16*q0+12),O0=4*q0/(6*M0-16*q0+12),j0=u,F0=V0*j0/O0,o=j0,v0=(1-V0-O0)*j0/O0,K0=2.69*F0-1.276*o-0.414*v0,U0=-1.022*F0+1.978*o+0.044*v0,S0=0.061*F0-0.224*o+1.163*v0;O[U]=Q(Math.min(K0,1))*255,O[U+1]=Q(Math.min(U0,1))*255,O[U+2]=Q(Math.min(S0,1))*255,O[U+3]=255}else X("Unknown Photometric interpretation: "+L);return O},K.replaceIMG=function(Y){if(Y==null)Y=document.getElementsByTagName("img");var W=["tif","tiff","dng","cr2","nef"];for(var Q=0;Q<Y.length;Q++){var N=Y[Q],M=N.getAttribute("src");if(M==null)continue;var V=M.split(".").pop().toLowerCase();if(W.indexOf(V)==-1)continue;var G=new XMLHttpRequest;K._xhrs.push(G),K._imgs.push(N),G.open("GET",M),G.responseType="arraybuffer",G.onload=K._imgLoaded,G.send()}},K._xhrs=[],K._imgs=[],K._imgLoaded=function(Y){var W=K._xhrs.indexOf(Y.target),Q=K._imgs[W];K._xhrs.splice(W,1),K._imgs.splice(W,1),Q.setAttribute("src",K.bufferToURI(Y.target.response))},K.bufferToURI=function(Y){var W=K.decode(Y),Q=W,N=0,M=Q[0];if(W[0].subIFD)Q=Q.concat(W[0].subIFD);for(var V=0;V<Q.length;V++){var G=Q[V];if(G.t258==null||G.t258.length<3)continue;var H=G.t256*G.t257;if(H>N)N=H,M=G}K.decodeImage(Y,M,W);var O=K.toRGBA8(M),L=M.width,j=M.height,E=document.createElement("canvas");E.width=L,E.height=j;var B=E.getContext("2d"),S=new ImageData(new Uint8ClampedArray(O.buffer),L,j);return B.putImageData(S,0,0),E.toDataURL()},K._binBE={nextZero:function(Y,W){while(Y[W]!=0)W++;return W},readUshort:function(Y,W){return Y[W]<<8|Y[W+1]},readShort:function(Y,W){var Q=K._binBE.ui8;return Q[0]=Y[W+1],Q[1]=Y[W+0],K._binBE.i16[0]},readInt:function(Y,W){var Q=K._binBE.ui8;return Q[0]=Y[W+3],Q[1]=Y[W+2],Q[2]=Y[W+1],Q[3]=Y[W+0],K._binBE.i32[0]},readUint:function(Y,W){var Q=K._binBE.ui8;return Q[0]=Y[W+3],Q[1]=Y[W+2],Q[2]=Y[W+1],Q[3]=Y[W+0],K._binBE.ui32[0]},readASCII:function(Y,W,Q){var N="";for(var M=0;M<Q;M++)N+=String.fromCharCode(Y[W+M]);return N},readFloat:function(Y,W){var Q=K._binBE.ui8;for(var N=0;N<4;N++)Q[N]=Y[W+3-N];return K._binBE.fl32[0]},readDouble:function(Y,W){var Q=K._binBE.ui8;for(var N=0;N<8;N++)Q[N]=Y[W+7-N];return K._binBE.fl64[0]},writeUshort:function(Y,W,Q){Y[W]=Q>>8&255,Y[W+1]=Q&255},writeInt:function(Y,W,Q){var N=K._binBE.ui8;K._binBE.i32[0]=Q,Y[W+3]=N[0],Y[W+2]=N[1],Y[W+1]=N[2],Y[W+0]=N[3]},writeUint:function(Y,W,Q){Y[W]=Q>>24&255,Y[W+1]=Q>>16&255,Y[W+2]=Q>>8&255,Y[W+3]=Q>>0&255},writeASCII:function(Y,W,Q){for(var N=0;N<Q.length;N++)Y[W+N]=Q.charCodeAt(N)},writeDouble:function(Y,W,Q){K._binBE.fl64[0]=Q;for(var N=0;N<8;N++)Y[W+N]=K._binBE.ui8[7-N]}},K._binBE.ui8=new Uint8Array(8),K._binBE.i16=new Int16Array(K._binBE.ui8.buffer),K._binBE.i32=new Int32Array(K._binBE.ui8.buffer),K._binBE.ui32=new Uint32Array(K._binBE.ui8.buffer),K._binBE.fl32=new Float32Array(K._binBE.ui8.buffer),K._binBE.fl64=new Float64Array(K._binBE.ui8.buffer),K._binLE={nextZero:K._binBE.nextZero,readUshort:function(Y,W){return Y[W+1]<<8|Y[W]},readShort:function(Y,W){var Q=K._binBE.ui8;return Q[0]=Y[W+0],Q[1]=Y[W+1],K._binBE.i16[0]},readInt:function(Y,W){var Q=K._binBE.ui8;return Q[0]=Y[W+0],Q[1]=Y[W+1],Q[2]=Y[W+2],Q[3]=Y[W+3],K._binBE.i32[0]},readUint:function(Y,W){var Q=K._binBE.ui8;return Q[0]=Y[W+0],Q[1]=Y[W+1],Q[2]=Y[W+2],Q[3]=Y[W+3],K._binBE.ui32[0]},readASCII:K._binBE.readASCII,readFloat:function(Y,W){var Q=K._binBE.ui8;for(var N=0;N<4;N++)Q[N]=Y[W+N];return K._binBE.fl32[0]},readDouble:function(Y,W){var Q=K._binBE.ui8;for(var N=0;N<8;N++)Q[N]=Y[W+N];return K._binBE.fl64[0]},writeUshort:function(Y,W,Q){Y[W]=Q&255,Y[W+1]=Q>>8&255},writeInt:function(Y,W,Q){var N=K._binBE.ui8;K._binBE.i32[0]=Q,Y[W+0]=N[0],Y[W+1]=N[1],Y[W+2]=N[2],Y[W+3]=N[3]},writeUint:function(Y,W,Q){Y[W]=Q>>>0&255,Y[W+1]=Q>>>8&255,Y[W+2]=Q>>>16&255,Y[W+3]=Q>>>24&255},writeASCII:K._binBE.writeASCII},K._copyTile=function(Y,W,Q,N,M,V,G,H){var O=Math.min(W,M-G),L=Math.min(Q,V-H);for(var j=0;j<L;j++){var E=(H+j)*M+G,B=j*W;for(var S=0;S<O;S++)N[E+S]=Y[B+S]}},K.LosslessJpegDecode=function(){var Y,W;function Q(){return Y[W++]}function N(){return Y[W++]<<8|Y[W++]}function M(P){var R=Q(),U=[0,0,0,255],C=[],k=8;for(var h=0;h<16;h++)C[h]=Q();for(var h=0;h<16;h++)for(var F=0;F<C[h];F++){var v=V(U,0,h+1,1);U[v+3]=Q()}var D=new Uint8Array(1<<k);P[R]=[new Uint8Array(U),D];for(var h=0;h<1<<k;h++){var w=k,x=h,y=0,b=0;while(U[y+3]==255&&w!=0)b=x>>--w&1,y=U[y+b];D[h]=y}}function V(P,R,U,C){if(P[R+3]!=255)return 0;if(U==0)return R;for(var k=0;k<2;k++){if(P[R+k]==0)P[R+k]=P.length,P.push(0,0,C,255);var h=V(P,P[R+k],U-1,C+1);if(h!=0)return h}return 0}function G(P){var{b:R,f:U}=P;while(R<25&&P.a<P.d){var C=P.data[P.a++];if(C==255&&!P.c)P.a++;U=U<<8|C,R+=8}if(R<0)throw"e";P.b=R,P.f=U}function H(P,R){if(R.b<P)G(R);return R.f>>(R.b-=P)&65535>>16-P}function O(P,R){var U=P[0],C=0,k=255,h=0;if(R.b<16)G(R);var F=R.f>>R.b-8&255;C=P[1][F],k=U[C+3],R.b-=U[C+2];while(k==255)h=R.f>>--R.b&1,C=U[C+h],k=U[C+3];return k}function L(P,R){if(P<32768>>16-R)P+=-(1<<R)+1;return P}function j(P,R){var U=O(P,R);if(U==0)return 0;if(U==16)return-32768;var C=H(U,R);return L(C,U)}function E(P,R,U,C,k,h){var F=0;for(var v=0;v<h;v++){var D=v*R;for(var w=0;w<R;w+=k){F++;for(var x=0;x<k;x++)P[D+w+x]=j(C[x],U)}if(U.e!=0&&F%U.e==0&&v!=0){var{a:y,data:b}=U;while(b[y]!=255||!(208<=b[y+1]&&b[y+1]<=215))y--;U.a=y+2,U.f=0,U.b=0}}}function B(P,R){return L(H(P,R),P)}function S(P,R,U,C,k){var h=Y.length-W;for(var F=0;F<h;F+=4){var v=Y[W+F];Y[W+F]=Y[W+F+3],Y[W+F+3]=v;var v=Y[W+F+1];Y[W+F+1]=Y[W+F+2],Y[W+F+2]=v}for(var D=0;D<k;D++){var w=32768,x=32768;for(var y=0;y<R;y+=2){var b=O(C,U),_=O(C,U);if(b!=0)w+=B(b,U);if(_!=0)x+=B(_,U);P[D*R+y]=w&65535,P[D*R+y+1]=x&65535}}}function A(P){if(Y=P,W=0,N()!=65496)throw"e";var R=[],U=0,C=0,k=0,h=[],F=[],v=[],D=0,w=0,x=0;while(!0){var y=N();if(y==65535){W--;continue}var b=N();if(y==65475){C=Q(),w=N(),x=N(),D=Q();for(var _=0;_<D;_++){var m=Q(),t=Q(),l=Q();if(l!=0)throw"e";R[m]=[_,t>>4,t&15]}}else if(y==65476){var s=W+b-2;while(W<s)M(F)}else if(y==65498){W++;for(var _=0;_<D;_++){var g=Q(),Z=R[g];v[Z[0]]=F[Q()>>>4],h[Z[0]]=Z.slice(1)}U=Q(),W+=2;break}else if(y==65501)k=N();else W+=b-2}var T=C>8?Uint16Array:Uint8Array,c=new T(w*x*D),o={b:0,f:0,c:U==8,a:W,data:Y,d:Y.length,e:k};if(o.c)S(c,x*D,o,v[0],w);else{var $0=[],a=0,e=0;for(var _=0;_<D;_++){var r=h[_],p=r[0],i=r[1];if(p>a)a=p;if(i>e)e=i;$0.push(p*i)}if(a!=1||e!=1){if(D!=3||$0[1]!=1||$0[2]!=1)throw"e";if(a!=2||e!=1&&e!=2)throw"e";var X0=[],K0=0;for(var _=0;_<D;_++){for(var U0=0;U0<$0[_];U0++)X0.push(v[_]);K0+=$0[_]}var S0=x/a,u=w/e,M0=S0*u;E(c,S0*K0,o,X0,K0,u),z(c,U,S0,u,K0-2,K0,K0,C);var q0=new Uint16Array(M0*$0[0]);if(a==2&&e==2){for(var _=0;_<M0;_++)q0[4*_]=c[6*_],q0[4*_+1]=c[6*_+1],q0[4*_+2]=c[6*_+2],q0[4*_+3]=c[6*_+3];z(q0,U,S0*4,u,0,1,1,C);for(var _=0;_<M0;_++)c[6*_]=q0[4*_],c[6*_+1]=q0[4*_+1],c[6*_+2]=q0[4*_+2],c[6*_+3]=q0[4*_+3]}if(a==2&&e==1){for(var _=0;_<M0;_++)q0[2*_]=c[4*_],q0[2*_+1]=c[4*_+1];z(q0,U,S0*2,u,0,1,1,C);for(var _=0;_<M0;_++)c[4*_]=q0[2*_],c[4*_+1]=q0[2*_+1]}var V0=c.slice(0);for(var i=0;i<w;i++)if(e==2)for(var p=0;p<x;p++){var O0=(i*x+p)*D,j0=((i>>>1)*S0+(p>>>1))*K0,F0=(i&1)*2+(p&1);c[O0]=V0[j0+F0],c[O0+1]=V0[j0+4],c[O0+2]=V0[j0+5]}else for(var p=0;p<x;p++){var O0=(i*x+p)*D,j0=(i*S0+(p>>>1))*K0,F0=p&1;c[O0]=V0[j0+F0],c[O0+1]=V0[j0+2],c[O0+2]=V0[j0+3]}}else if(E(c,x*D,o,v,D,w),k==0)z(c,U,x,w,0,D,D,C);else{var v0=Math.floor(k/x);for(var i=0;i<w;i+=v0){var A0=c.slice(i*x*D,(i+v0)*x*D);z(A0,U,x,v0,0,D,D,C),c.set(A0,i*x*D)}}}return c}function z(P,R,U,C,k,h,F,v){var D=U*F;for(var w=k;w<h;w++)P[w]+=1<<v-1;for(var x=F;x<D;x+=F)for(var w=k;w<h;w++)P[x+w]+=P[x+w-F];for(var y=1;y<C;y++){var b=y*D;for(var w=k;w<h;w++)P[b+w]+=P[b+w-D];for(var x=F;x<D;x+=F)for(var w=k;w<h;w++){var _=b+x+w,m=_-D,t=P[_-F],l=0;if(R==0)l=0;else if(R==1)l=t;else if(R==2)l=P[m];else if(R==3)l=P[m-F];else if(R==4)l=t+(P[m]-P[m-F]);else if(R==5)l=t+(P[m]-P[m-F]>>>1);else if(R==6)l=P[m]+(t-P[m-F]>>>1);else if(R==7)l=t+P[m]>>>1;else throw R;P[_]+=l}}}return A}(),function(){var Y=0,W=1,Q=2,N=3,M=4,V=5,G=6,H=7,O=8,L=9,j=10,E=11,B=12,S=13,A=14,z=15,P=16,R=17,U=18;function C(g){var Z=K._binBE.readUshort,T={b:Z(g,0),i:g[2],C:g[3],u:g[4],q:Z(g,5),k:Z(g,7),e:Z(g,9),l:Z(g,11),s:g[13],d:Z(g,14)};if(T.b!=18771||T.i>1||T.q<6||T.q%6||T.e<768||T.e%24||T.l!=768||T.k<T.l||T.k%T.l||T.k-T.e>=T.l||T.s>16||T.s!=T.k/T.l||T.s!=Math.ceil(T.e/T.l)||T.d!=T.q/6||T.u!=12&&T.u!=14&&T.u!=16||T.C!=16&&T.C!=0)throw"Invalid data";if(T.i==0)throw"Not implemented. We need this file!";return T.h=T.C==16,T.m=(T.h?T.l*2/3:T.l>>>1)|0,T.A=T.m+2,T.f=64,T.g=(1<<T.u)-1,T.n=4*T.u,T}function k(g,Z){var T=Array(Z.s),c=4*Z.s,o=16+c;if(c&12)o+=16-(c&12);for(var $0=0,a=16;$0<Z.s;a+=4){var e=K._binBE.readUint(g,a);T[$0]=g.slice(o,o+e),T[$0].j=0,T[$0].a=0,o+=e,$0++}if(o!=g.length)throw"Invalid data";return T}function h(g,Z){for(var T=-Z[4],c=0;T<=Z[4];c++,T++)g[c]=T<=-Z[3]?-4:T<=-Z[2]?-3:T<=-Z[1]?-2:T<-Z[0]?-1:T<=Z[0]?0:T<Z[1]?1:T<Z[2]?2:T<Z[3]?3:4}function F(g,Z,T){var c=[Z,3*Z+18,5*Z+67,7*Z+276,T];g.o=Z,g.w=(c[4]+2*Z)/(2*Z+1)+1|0,g.v=Math.ceil(Math.log2(g.w)),g.t=9,h(g.c,c)}function v(g){var Z={c:new Int8Array(2<<g.u)};return F(Z,0,g.g),Z}function D(g){var Z=[[],[],[]],T=Math.max(2,g.w+32>>>6);for(var c=0;c<3;c++)for(var o=0;o<41;o++)Z[c][o]=[T,1];return Z}function w(g){for(var Z=-1,T=0;!T;Z++)if(T=g[g.j]>>>7-g.a&1,g.a++,g.a&=7,!g.a)g.j++;return Z}function x(g,Z){var T=0,c=8-g.a,o=g.j,$0=g.a;if(Z){if(Z>=c)do T<<=c,Z-=c,T|=g[g.j]&(1<<c)-1,g.j++,c=8;while(Z>=8);if(Z)T<<=Z,c-=Z,T|=g[g.j]>>>c&(1<<Z)-1;g.a=8-c}return T}function y(g,Z){var T=0;if(Z<g)while(T<=14&&Z<<++T<g);return T}function b(g,Z,T,c,o,$0,a,e){if(e==null)e=0;var r=$0+1,p=r%2,i=0,X0=0,K0=0,U0,S0,u=c[o],M0=c[o-1],q0=c[o-2][r],V0=M0[r-1],O0=M0[r],j0=M0[r+1],F0=u[r-1],v0=u[r+1],A0=Math.abs,T0,Y0,J0,N0;if(p)T0=A0(j0-O0),Y0=A0(q0-O0),J0=A0(V0-O0);if(p){if(N0=T0>J0&&Y0<T0?q0+V0:T0<J0&&Y0<J0?q0+j0:j0+V0,N0=N0+2*O0>>>2,e){u[r]=N0;return}U0=Z.t*Z.c[g.g+O0-q0]+Z.c[g.g+V0-O0]}else N0=O0>V0&&O0>j0||O0<V0&&O0<j0?v0+F0+2*O0>>>2:F0+v0>>>1,U0=Z.t*Z.c[g.g+O0-V0]+Z.c[g.g+V0-F0];S0=A0(U0);var g0=w(T);if(g0<g.n-Z.v-1){var z0=y(a[S0][0],a[S0][1]);K0=x(T,z0)+(g0<<z0)}else K0=x(T,Z.v)+1;if(K0=K0&1?-1-(K0>>>1):K0>>>1,a[S0][0]+=A0(K0),a[S0][1]==g.f)a[S0][0]>>>=1,a[S0][1]>>>=1;if(a[S0][1]++,N0=U0<0?N0-K0:N0+K0,g.i){if(N0<0)N0+=Z.w;else if(N0>g.g)N0-=Z.w}u[r]=N0>=0?Math.min(N0,g.g):0}function _(g,Z,T){var c=g[0].length;for(var o=Z;o<=T;o++)g[o][0]=g[o-1][1],g[o][c-1]=g[o-1][c-2]}function m(g){_(g,H,B),_(g,Q,M),_(g,z,R)}function t(g,Z,T,c,o,$0,a,e,r,p,i,X0,K0){var U0=0,S0=1,u=o<S&&o>M;while(S0<g.m){if(U0<g.m)b(g,Z,T,c,o,U0,a[r],g.h&&(u&&p||!u&&(i||(U0&X0)==K0))),b(g,Z,T,c,$0,U0,a[r],g.h&&(!u&&p||u&&(i||(U0&X0)==K0))),U0+=2;if(U0>8)b(g,Z,T,c,o,S0,e[r]),b(g,Z,T,c,$0,S0,e[r]),S0+=2}m(c)}function l(g,Z,T,c,o,$0){t(g,Z,T,c,Q,H,o,$0,0,0,1,0,8),t(g,Z,T,c,O,z,o,$0,1,0,1,0,8),t(g,Z,T,c,N,L,o,$0,2,1,0,3,0),t(g,Z,T,c,j,P,o,$0,0,0,0,3,2),t(g,Z,T,c,M,E,o,$0,1,0,0,3,2),t(g,Z,T,c,B,R,o,$0,2,1,0,3,0)}function s(g,Z,T,c,o,$0){var a=$0.length,e=g.l;if(o+1==g.s)e=g.e-o*g.l;var r=6*g.e*c+o*g.l;for(var p=0;p<6;p++){for(var i=0;i<e;i++){var X0=$0[p%a][i%a],K0;if(X0==0)K0=Q+(p>>>1);else if(X0==2)K0=z+(p>>>1);else K0=H+p;var U0=g.h?(i*2/3&2147483646|i%3&1)+(i%3>>>1):i>>>1;Z[r+i]=T[K0][U0+1]}r+=g.e}}K._decompressRAF=function(g,Z){var T=C(g),c=k(g,T),o=v(T),$0=new Int16Array(T.e*T.q);if(Z==null)Z=T.h?[[1,1,0,1,1,2],[1,1,2,1,1,0],[2,0,1,0,2,1],[1,1,2,1,1,0],[1,1,0,1,1,2],[0,2,1,2,0,1]]:[[0,1],[3,2]];var a=[[Y,N],[W,M],[V,E],[G,B],[S,P],[A,R]],e=[];for(var r=0;r<U;r++)e[r]=new Uint16Array(T.A);for(var p=0;p<T.s;p++){var i=D(o),X0=D(o);for(var r=0;r<U;r++)for(var K0=0;K0<T.A;K0++)e[r][K0]=0;for(var U0=0;U0<T.d;U0++){l(T,o,c[p],e,i,X0);for(var r=0;r<6;r++)for(var K0=0;K0<T.A;K0++)e[a[r][0]][K0]=e[a[r][1]][K0];s(T,$0,e,U0,p,Z);for(var r=Q;r<U;r++)if([V,G,S,A].indexOf(r)==-1)for(var K0=0;K0<T.A;K0++)e[r][K0]=0;m(e)}}return $0}}()})($,J)})()});var dW=L0((Rj)=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Rj.read=function($,J,X,K,q){var Y,W,Q=q*8-K-1,N=(1<<Q)-1,M=N>>1,V=-7,G=X?q-1:0,H=X?-1:1,O=$[J+G];G+=H,Y=O&(1<<-V)-1,O>>=-V,V+=Q;for(;V>0;Y=Y*256+$[J+G],G+=H,V-=8);W=Y&(1<<-V)-1,Y>>=-V,V+=K;for(;V>0;W=W*256+$[J+G],G+=H,V-=8);if(Y===0)Y=1-M;else if(Y===N)return W?NaN:(O?-1:1)*(1/0);else W=W+Math.pow(2,K),Y=Y-M;return(O?-1:1)*W*Math.pow(2,Y-K)};Rj.write=function($,J,X,K,q,Y){var W,Q,N,M=Y*8-q-1,V=(1<<M)-1,G=V>>1,H=q===23?Math.pow(2,-24)-Math.pow(2,-77):0,O=K?0:Y-1,L=K?1:-1,j=J<0||J===0&&1/J<0?1:0;if(J=Math.abs(J),isNaN(J)||J===1/0)Q=isNaN(J)?1:0,W=V;else{if(W=Math.floor(Math.log(J)/Math.LN2),J*(N=Math.pow(2,-W))<1)W--,N*=2;if(W+G>=1)J+=H/N;else J+=H*Math.pow(2,1-G);if(J*N>=2)W++,N/=2;if(W+G>=V)Q=0,W=V;else if(W+G>=1)Q=(J*N-1)*Math.pow(2,q),W=W+G;else Q=J*Math.pow(2,G-1)*Math.pow(2,q),W=0}for(;q>=8;$[X+O]=Q&255,O+=L,Q/=256,q-=8);W=W<<q|Q,M+=q;for(;M>0;$[X+O]=W&255,O+=L,W/=256,M-=8);$[X+O-L]|=j*128}});var $Q=L0((sW)=>{Object.defineProperty(sW,"__esModule",{value:!0});sW.AnsiStringType=sW.StringType=sW.BufferType=sW.Uint8ArrayType=sW.IgnoreType=sW.Float80_LE=sW.Float80_BE=sW.Float64_LE=sW.Float64_BE=sW.Float32_LE=sW.Float32_BE=sW.Float16_LE=sW.Float16_BE=sW.INT64_BE=sW.UINT64_BE=sW.INT64_LE=sW.UINT64_LE=sW.INT32_LE=sW.INT32_BE=sW.INT24_BE=sW.INT24_LE=sW.INT16_LE=sW.INT16_BE=sW.INT8=sW.UINT32_BE=sW.UINT32_LE=sW.UINT24_BE=sW.UINT24_LE=sW.UINT16_BE=sW.UINT16_LE=sW.UINT8=void 0;var S1=dW();function h0($){return new DataView($.buffer,$.byteOffset)}sW.UINT8={len:1,get($,J){return h0($).getUint8(J)},put($,J,X){return h0($).setUint8(J,X),J+1}};sW.UINT16_LE={len:2,get($,J){return h0($).getUint16(J,!0)},put($,J,X){return h0($).setUint16(J,X,!0),J+2}};sW.UINT16_BE={len:2,get($,J){return h0($).getUint16(J)},put($,J,X){return h0($).setUint16(J,X),J+2}};sW.UINT24_LE={len:3,get($,J){let X=h0($);return X.getUint8(J)+(X.getUint16(J+1,!0)<<8)},put($,J,X){let K=h0($);return K.setUint8(J,X&255),K.setUint16(J+1,X>>8,!0),J+3}};sW.UINT24_BE={len:3,get($,J){let X=h0($);return(X.getUint16(J)<<8)+X.getUint8(J+2)},put($,J,X){let K=h0($);return K.setUint16(J,X>>8),K.setUint8(J+2,X&255),J+3}};sW.UINT32_LE={len:4,get($,J){return h0($).getUint32(J,!0)},put($,J,X){return h0($).setUint32(J,X,!0),J+4}};sW.UINT32_BE={len:4,get($,J){return h0($).getUint32(J)},put($,J,X){return h0($).setUint32(J,X),J+4}};sW.INT8={len:1,get($,J){return h0($).getInt8(J)},put($,J,X){return h0($).setInt8(J,X),J+1}};sW.INT16_BE={len:2,get($,J){return h0($).getInt16(J)},put($,J,X){return h0($).setInt16(J,X),J+2}};sW.INT16_LE={len:2,get($,J){return h0($).getInt16(J,!0)},put($,J,X){return h0($).setInt16(J,X,!0),J+2}};sW.INT24_LE={len:3,get($,J){let X=sW.UINT24_LE.get($,J);return X>8388607?X-16777216:X},put($,J,X){let K=h0($);return K.setUint8(J,X&255),K.setUint16(J+1,X>>8,!0),J+3}};sW.INT24_BE={len:3,get($,J){let X=sW.UINT24_BE.get($,J);return X>8388607?X-16777216:X},put($,J,X){let K=h0($);return K.setUint16(J,X>>8),K.setUint8(J+2,X&255),J+3}};sW.INT32_BE={len:4,get($,J){return h0($).getInt32(J)},put($,J,X){return h0($).setInt32(J,X),J+4}};sW.INT32_LE={len:4,get($,J){return h0($).getInt32(J,!0)},put($,J,X){return h0($).setInt32(J,X,!0),J+4}};sW.UINT64_LE={len:8,get($,J){return h0($).getBigUint64(J,!0)},put($,J,X){return h0($).setBigUint64(J,X,!0),J+8}};sW.INT64_LE={len:8,get($,J){return h0($).getBigInt64(J,!0)},put($,J,X){return h0($).setBigInt64(J,X,!0),J+8}};sW.UINT64_BE={len:8,get($,J){return h0($).getBigUint64(J)},put($,J,X){return h0($).setBigUint64(J,X),J+8}};sW.INT64_BE={len:8,get($,J){return h0($).getBigInt64(J)},put($,J,X){return h0($).setBigInt64(J,X),J+8}};sW.Float16_BE={len:2,get($,J){return S1.read($,J,!1,10,this.len)},put($,J,X){return S1.write($,X,J,!1,10,this.len),J+this.len}};sW.Float16_LE={len:2,get($,J){return S1.read($,J,!0,10,this.len)},put($,J,X){return S1.write($,X,J,!0,10,this.len),J+this.len}};sW.Float32_BE={len:4,get($,J){return h0($).getFloat32(J)},put($,J,X){return h0($).setFloat32(J,X),J+4}};sW.Float32_LE={len:4,get($,J){return h0($).getFloat32(J,!0)},put($,J,X){return h0($).setFloat32(J,X,!0),J+4}};sW.Float64_BE={len:8,get($,J){return h0($).getFloat64(J)},put($,J,X){return h0($).setFloat64(J,X),J+8}};sW.Float64_LE={len:8,get($,J){return h0($).getFloat64(J,!0)},put($,J,X){return h0($).setFloat64(J,X,!0),J+8}};sW.Float80_BE={len:10,get($,J){return S1.read($,J,!1,63,this.len)},put($,J,X){return S1.write($,X,J,!1,63,this.len),J+this.len}};sW.Float80_LE={len:10,get($,J){return S1.read($,J,!0,63,this.len)},put($,J,X){return S1.write($,X,J,!0,63,this.len),J+this.len}};class nW{constructor($){this.len=$}get($,J){}}sW.IgnoreType=nW;class oW{constructor($){this.len=$}get($,J){return $.subarray(J,J+this.len)}}sW.Uint8ArrayType=oW;class rW{constructor($){this.len=$}get($,J){return Buffer.from($.subarray(J,J+this.len))}}sW.BufferType=rW;class iW{constructor($,J){this.len=$,this.encoding=J}get($,J){return Buffer.from($).toString(this.encoding,J,J+this.len)}}sW.StringType=iW;class P1{constructor($){this.len=$}static decode($,J,X){let K="";for(let q=J;q<X;++q)K+=P1.codePointToString(P1.singleByteDecoder($[q]));return K}static inRange($,J,X){return J<=$&&$<=X}static codePointToString($){if($<=65535)return String.fromCharCode($);else return $-=65536,String.fromCharCode(($>>10)+55296,($&1023)+56320)}static singleByteDecoder($){if(P1.inRange($,0,127))return $;let J=P1.windows1252[$-128];if(J===null)throw Error("invaliding encoding");return J}get($,J=0){return P1.decode($,J,J+this.len)}}sW.AnsiStringType=P1;P1.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]});var m$=L0((XQ)=>{Object.defineProperty(XQ,"__esModule",{value:!0});XQ.EndOfStreamError=XQ.defaultMessages=void 0;XQ.defaultMessages="End-Of-Stream";class JQ extends Error{constructor(){super(XQ.defaultMessages)}}XQ.EndOfStreamError=JQ});var NQ=L0((WQ)=>{Object.defineProperty(WQ,"__esModule",{value:!0});WQ.Deferred=void 0;class YQ{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise(($,J)=>{this.reject=J,this.resolve=$})}}WQ.Deferred=YQ});var HQ=L0((sJ)=>{Object.defineProperty(sJ,"__esModule",{value:!0});sJ.StreamReader=sJ.EndOfStreamError=void 0;var MQ=m$(),ij=NQ(),sj=m$();Object.defineProperty(sJ,"EndOfStreamError",{enumerable:!0,get:function(){return sj.EndOfStreamError}});var aj=1048576;class VQ{constructor($){if(this.s=$,this.deferred=null,this.endOfStream=!1,this.peekQueue=[],!$.read||!$.once)throw Error("Expected an instance of stream.Readable");this.s.once("end",()=>this.reject(new MQ.EndOfStreamError)),this.s.once("error",(J)=>this.reject(J)),this.s.once("close",()=>this.reject(Error("Stream closed")))}async peek($,J,X){let K=await this.read($,J,X);return this.peekQueue.push($.subarray(J,J+K)),K}async read($,J,X){if(X===0)return 0;if(this.peekQueue.length===0&&this.endOfStream)throw new MQ.EndOfStreamError;let K=X,q=0;while(this.peekQueue.length>0&&K>0){let Y=this.peekQueue.pop();if(!Y)throw Error("peekData should be defined");let W=Math.min(Y.length,K);if($.set(Y.subarray(0,W),J+q),q+=W,K-=W,W<Y.length)this.peekQueue.push(Y.subarray(W))}while(K>0&&!this.endOfStream){let Y=Math.min(K,aj),W=await this.readFromStream($,J+q,Y);if(q+=W,W<Y)break;K-=W}return q}async readFromStream($,J,X){let K=this.s.read(X);if(K)return $.set(K,J),K.length;else{let q={buffer:$,offset:J,length:X,deferred:new ij.Deferred};return this.deferred=q.deferred,this.s.once("readable",()=>{this.readDeferred(q)}),q.deferred.promise}}readDeferred($){let J=this.s.read($.length);if(J)$.buffer.set(J,$.offset),$.deferred.resolve(J.length),this.deferred=null;else this.s.once("readable",()=>{this.readDeferred($)})}reject($){if(this.endOfStream=!0,this.deferred)this.deferred.reject($),this.deferred=null}}sJ.StreamReader=VQ});var w9=L0((p$)=>{Object.defineProperty(p$,"__esModule",{value:!0});p$.StreamReader=p$.EndOfStreamError=void 0;var tj=m$();Object.defineProperty(p$,"EndOfStreamError",{enumerable:!0,get:function(){return tj.EndOfStreamError}});var ej=HQ();Object.defineProperty(p$,"StreamReader",{enumerable:!0,get:function(){return ej.StreamReader}})});var aJ=L0((UQ)=>{Object.defineProperty(UQ,"__esModule",{value:!0});UQ.AbstractTokenizer=void 0;var u$=w9();class OQ{constructor($){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=$?$:{}}async readToken($,J=this.position){let X=Buffer.alloc($.len);if(await this.readBuffer(X,{position:J})<$.len)throw new u$.EndOfStreamError;return $.get(X,0)}async peekToken($,J=this.position){let X=Buffer.alloc($.len);if(await this.peekBuffer(X,{position:J})<$.len)throw new u$.EndOfStreamError;return $.get(X,0)}async readNumber($){if(await this.readBuffer(this.numBuffer,{length:$.len})<$.len)throw new u$.EndOfStreamError;return $.get(this.numBuffer,0)}async peekNumber($){if(await this.peekBuffer(this.numBuffer,{length:$.len})<$.len)throw new u$.EndOfStreamError;return $.get(this.numBuffer,0)}async ignore($){if(this.fileInfo.size!==void 0){let J=this.fileInfo.size-this.position;if($>J)return this.position+=J,J}return this.position+=$,$}async close(){}normalizeOptions($,J){if(J&&J.position!==void 0&&J.position<this.position)throw Error("`options.position` must be equal or greater than `tokenizer.position`");if(J)return{mayBeLess:J.mayBeLess===!0,offset:J.offset?J.offset:0,length:J.length?J.length:$.length-(J.offset?J.offset:0),position:J.position?J.position:this.position};return{mayBeLess:!1,offset:0,length:$.length,position:this.position}}}UQ.AbstractTokenizer=OQ});var BQ=L0((jQ)=>{Object.defineProperty(jQ,"__esModule",{value:!0});jQ.ReadStreamTokenizer=void 0;var JR=aJ(),l$=w9(),XR=256000;class EQ extends JR.AbstractTokenizer{constructor($,J){super(J);this.streamReader=new l$.StreamReader($)}async getFileInfo(){return this.fileInfo}async readBuffer($,J){let X=this.normalizeOptions($,J),K=X.position-this.position;if(K>0)return await this.ignore(K),this.readBuffer($,J);else if(K<0)throw Error("`options.position` must be equal or greater than `tokenizer.position`");if(X.length===0)return 0;let q=await this.streamReader.read($,X.offset,X.length);if(this.position+=q,(!J||!J.mayBeLess)&&q<X.length)throw new l$.EndOfStreamError;return q}async peekBuffer($,J){let X=this.normalizeOptions($,J),K=0;if(X.position){let q=X.position-this.position;if(q>0){let Y=new Uint8Array(X.length+q);return K=await this.peekBuffer(Y,{mayBeLess:X.mayBeLess}),$.set(Y.subarray(q),X.offset),K-q}else if(q<0)throw Error("Cannot peek from a negative offset in a stream")}if(X.length>0){try{K=await this.streamReader.peek($,X.offset,X.length)}catch(q){if(J&&J.mayBeLess&&q instanceof l$.EndOfStreamError)return 0;throw q}if(!X.mayBeLess&&K<X.length)throw new l$.EndOfStreamError}return K}async ignore($){let J=Math.min(XR,$),X=new Uint8Array(J),K=0;while(K<$){let q=$-K,Y=await this.readBuffer(X,{length:Math.min(J,q)});if(Y<0)return Y;K+=Y}return K}}jQ.ReadStreamTokenizer=EQ});var FQ=L0((SQ)=>{Object.defineProperty(SQ,"__esModule",{value:!0});SQ.BufferTokenizer=void 0;var KR=w9(),qR=aJ();class PQ extends qR.AbstractTokenizer{constructor($,J){super(J);this.uint8Array=$,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:$.length}async readBuffer($,J){if(J&&J.position){if(J.position<this.position)throw Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=J.position}let X=await this.peekBuffer($,J);return this.position+=X,X}async peekBuffer($,J){let X=this.normalizeOptions($,J),K=Math.min(this.uint8Array.length-X.position,X.length);if(!X.mayBeLess&&K<X.length)throw new KR.EndOfStreamError;else return $.set(this.uint8Array.subarray(X.position,X.position+K),X.offset),K}async close(){}}SQ.BufferTokenizer=PQ});var vQ=L0((tJ)=>{Object.defineProperty(tJ,"__esModule",{value:!0});tJ.fromBuffer=tJ.fromStream=tJ.EndOfStreamError=void 0;var YR=BQ(),WR=FQ(),QR=w9();Object.defineProperty(tJ,"EndOfStreamError",{enumerable:!0,get:function(){return QR.EndOfStreamError}});function NR($,J){return J=J?J:{},new YR.ReadStreamTokenizer($,J)}tJ.fromStream=NR;function MR($,J){return new WR.BufferTokenizer($,J)}tJ.fromBuffer=MR});var CQ=L0((GR)=>{GR.stringToBytes=($)=>[...$].map((J)=>J.charCodeAt(0));GR.tarHeaderChecksumMatches=($,J=0)=>{let X=parseInt($.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(X))return!1;let K=256;for(let q=J;q<J+148;q++)K+=$[q];for(let q=J+156;q<J+512;q++)K+=$[q];return X===K};GR.uint32SyncSafeToken={get:($,J)=>{return $[J+3]&127|$[J+2]<<7|$[J+1]<<14|$[J]<<21},len:4}});var DQ=L0((jz,ZQ)=>{ZQ.exports={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]}});var IQ=L0((TQ,$4)=>{var s8=$Q(),c$=vQ(),{stringToBytes:LR,tarHeaderChecksumMatches:ER,uint32SyncSafeToken:jR}=CQ(),kQ=DQ(),Rz=4100;async function RR($){let J=await c$.fromStream($);try{return await d$(J)}finally{await J.close()}}async function wQ($){if(!($ instanceof Uint8Array||$ instanceof ArrayBuffer||Buffer.isBuffer($)))throw TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof $}\``);let J=$ instanceof Buffer?$:Buffer.from($);if(!(J&&J.length>1))return;let X=c$.fromBuffer(J);return d$(X)}function _8($,J,X){X={offset:0,...X};for(let[K,q]of J.entries())if(X.mask){if(q!==(X.mask[K]&$[K+X.offset]))return!1}else if(q!==$[K+X.offset])return!1;return!0}async function d$($){try{return BR($)}catch(J){if(!(J instanceof c$.EndOfStreamError))throw J}}async function BR($){let J=Buffer.alloc(4100),X=12,K=(Y,W)=>_8(J,Y,W),q=(Y,W)=>K(LR(Y),W);if(!$.fileInfo.size)$.fileInfo.size=Number.MAX_SAFE_INTEGER;if(await $.peekBuffer(J,{length:X,mayBeLess:!0}),K([66,77]))return{ext:"bmp",mime:"image/bmp"};if(K([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(K([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(K([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(K([37,33])){if(await $.peekBuffer(J,{length:24,mayBeLess:!0}),q("PS-Adobe-",{offset:2})&&q(" EPSF-",{offset:14}))return{ext:"eps",mime:"application/eps"};return{ext:"ps",mime:"application/postscript"}}if(K([31,160])||K([31,157]))return{ext:"Z",mime:"application/x-compress"};if(K([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(K([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(K([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(K([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(q("ID3")){await $.ignore(6);let Y=await $.readToken(jR);if($.position+Y>$.fileInfo.size)return{ext:"mp3",mime:"audio/mpeg"};return await $.ignore(Y),d$($)}if(q("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((J[0]===67||J[0]===70)&&K([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(K([71,73,70]))return{ext:"gif",mime:"image/gif"};if(q("FLIF"))return{ext:"flif",mime:"image/flif"};if(q("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(q("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(q("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(q("FORM"))return{ext:"aif",mime:"audio/aiff"};if(q("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(K([80,75,3,4])){try{while($.position+30<$.fileInfo.size){await $.readBuffer(J,{length:30});let Y={compressedSize:J.readUInt32LE(18),uncompressedSize:J.readUInt32LE(22),filenameLength:J.readUInt16LE(26),extraFieldLength:J.readUInt16LE(28)};if(Y.filename=await $.readToken(new s8.StringType(Y.filenameLength,"utf-8")),await $.ignore(Y.extraFieldLength),Y.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(Y.filename.endsWith(".rels")||Y.filename.endsWith(".xml"))switch(Y.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};default:break}if(Y.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(Y.filename.startsWith("3D/")&&Y.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(Y.filename==="mimetype"&&Y.compressedSize===Y.uncompressedSize)switch(await $.readToken(new s8.StringType(Y.compressedSize,"utf-8"))){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};default:}if(Y.compressedSize===0){let W=-1;while(W<0&&$.position<$.fileInfo.size)await $.peekBuffer(J,{mayBeLess:!0}),W=J.indexOf("504B0304",0,"hex"),await $.ignore(W>=0?W:J.length)}else await $.ignore(Y.compressedSize)}}catch(Y){if(!(Y instanceof c$.EndOfStreamError))throw Y}return{ext:"zip",mime:"application/zip"}}if(q("OggS")){await $.ignore(28);let Y=Buffer.alloc(8);if(await $.readBuffer(Y),_8(Y,[79,112,117,115,72,101,97,100]))return{ext:"opus",mime:"audio/opus"};if(_8(Y,[128,116,104,101,111,114,97]))return{ext:"ogv",mime:"video/ogg"};if(_8(Y,[1,118,105,100,101,111,0]))return{ext:"ogm",mime:"video/ogg"};if(_8(Y,[127,70,76,65,67]))return{ext:"oga",mime:"audio/ogg"};if(_8(Y,[83,112,101,101,120,32,32]))return{ext:"spx",mime:"audio/ogg"};if(_8(Y,[1,118,111,114,98,105,115]))return{ext:"ogg",mime:"audio/ogg"};return{ext:"ogx",mime:"application/ogg"}}if(K([80,75])&&(J[2]===3||J[2]===5||J[2]===7)&&(J[3]===4||J[3]===6||J[3]===8))return{ext:"zip",mime:"application/zip"};if(q("ftyp",{offset:4})&&(J[8]&96)!==0){let Y=J.toString("binary",8,12).replace("\x00"," ").trim();switch(Y){case"avif":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:if(Y.startsWith("3g")){if(Y.startsWith("3g2"))return{ext:"3g2",mime:"video/3gpp2"};return{ext:"3gp",mime:"video/3gpp"}}return{ext:"mp4",mime:"video/mp4"}}}if(q("MThd"))return{ext:"mid",mime:"audio/midi"};if(q("wOFF")&&(K([0,1,0,0],{offset:4})||q("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(q("wOF2")&&(K([0,1,0,0],{offset:4})||q("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(K([212,195,178,161])||K([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(q("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(q("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(q("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(K([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(q("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(q("%PDF")){await $.ignore(1350);let Y=10485760,W=Buffer.alloc(Math.min(Y,$.fileInfo.size));if(await $.readBuffer(W,{mayBeLess:!0}),W.includes(Buffer.from("AIPrivateData")))return{ext:"ai",mime:"application/postscript"};return{ext:"pdf",mime:"application/pdf"}}if(K([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(K([73,73,42,0])){if(q("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(K([28,0,254,0],{offset:8})||K([31,0,11,0],{offset:8}))return{ext:"nef",mime:"image/x-nikon-nef"};if(K([8,0,0,0],{offset:4})&&(K([45,0,254,0],{offset:8})||K([39,0,254,0],{offset:8})))return{ext:"dng",mime:"image/x-adobe-dng"};if(J=Buffer.alloc(24),await $.peekBuffer(J),(K([16,251,134,1],{offset:4})||K([8,0,0,0],{offset:4}))&&K([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9}))return{ext:"arw",mime:"image/x-sony-arw"};return{ext:"tif",mime:"image/tiff"}}if(K([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(q("MAC "))return{ext:"ape",mime:"audio/ape"};if(K([26,69,223,163])){async function Y(){let V=await $.peekNumber(s8.UINT8),G=128,H=0;while((V&G)===0&&G!==0)++H,G>>=1;let O=Buffer.alloc(H+1);return await $.readBuffer(O),O}async function W(){let V=await Y(),G=await Y();G[0]^=128>>G.length-1;let H=Math.min(6,G.length);return{id:V.readUIntBE(0,V.length),len:G.readUIntBE(G.length-H,H)}}async function Q(V,G){while(G>0){let H=await W();if(H.id===17026)return $.readToken(new s8.StringType(H.len,"utf-8"));await $.ignore(H.len),--G}}let N=await W();switch(await Q(1,N.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(K([82,73,70,70])){if(K([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(K([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(K([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(q("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(K([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(q("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(q("MSCF")||q("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(K([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(K([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(K([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(K([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(q("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(q("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(K([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(q("IMPM"))return{ext:"it",mime:"audio/x-it"};if(q("-lh0-",{offset:2})||q("-lh1-",{offset:2})||q("-lh2-",{offset:2})||q("-lh3-",{offset:2})||q("-lh4-",{offset:2})||q("-lh5-",{offset:2})||q("-lh6-",{offset:2})||q("-lh7-",{offset:2})||q("-lzs-",{offset:2})||q("-lz4-",{offset:2})||q("-lz5-",{offset:2})||q("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(K([0,0,1,186])){if(K([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(K([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(q("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(K([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(q("<?xml "))return{ext:"xml",mime:"application/xml"};if(K([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(K([82,97,114,33,26,7])&&(J[6]===0||J[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(q("solid "))return{ext:"stl",mime:"model/stl"};if(q("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(q("!<arch>")){if(await $.ignore(8),await $.readToken(new s8.StringType(13,"ascii"))==="debian-binary")return{ext:"deb",mime:"application/x-deb"};return{ext:"ar",mime:"application/x-unix-archive"}}if(K([137,80,78,71,13,10,26,10])){await $.ignore(8);async function Y(){return{length:await $.readToken(s8.INT32_BE),type:await $.readToken(new s8.StringType(4,"binary"))}}do{let W=await Y();if(W.length<0)return;switch(W.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await $.ignore(W.length+4)}}while($.position+8<$.fileInfo.size);return{ext:"png",mime:"image/png"}}if(K([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(K([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(K([102,114,101,101],{offset:4})||K([109,100,97,116],{offset:4})||K([109,111,111,118],{offset:4})||K([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(K([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(q("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(K([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(K([48,38,178,117,142,102,207,17,166,217])){async function Y(){let W=Buffer.alloc(16);return await $.readBuffer(W),{id:W,size:Number(await $.readToken(s8.UINT64_LE))}}await $.ignore(30);while($.position+24<$.fileInfo.size){let W=await Y(),Q=W.size-24;if(_8(W.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){let N=Buffer.alloc(16);if(Q-=await $.readBuffer(N),_8(N,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_8(N,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await $.ignore(Q)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(K([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((K([126,16,4])||K([126,24,4]))&&K([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(K([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(K([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await $.ignore(20),await $.readToken(new s8.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(K([255,10])||K([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(K([0,0,1,186])||K([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(K([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(K([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(K([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(K([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await $.peekBuffer(J,{length:Math.min(256,$.fileInfo.size),mayBeLess:!0}),q("BEGIN:")){if(q("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(q("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(q("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(q("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(q("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(K([4,0,0,0])&&J.length>=16){let Y=J.readUInt32LE(12);if(Y>12&&J.length>=Y+16)try{let W=J.slice(16,Y+16).toString();if(JSON.parse(W).files)return{ext:"asar",mime:"application/x-asar"}}catch(W){}}if(K([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(q("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(K([71],{offset:4})&&(K([71],{offset:192})||K([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(K([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(K([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(K([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(K([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(K([76,80],{offset:34})&&(K([0,0,1],{offset:8})||K([1,0,2],{offset:8})||K([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(K([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await $.peekBuffer(J,{length:Math.min(512,$.fileInfo.size),mayBeLess:!0}),ER(J))return{ext:"tar",mime:"application/x-tar"};if(K([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(q("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(J.length>=2&&K([255,224],{offset:0,mask:[255,224]})){if(K([16],{offset:1,mask:[22]})){if(K([8],{offset:1,mask:[8]}))return{ext:"aac",mime:"audio/aac"};return{ext:"aac",mime:"audio/aac"}}if(K([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(K([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(K([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}var PR=(readableStream)=>new Promise((resolve,reject)=>{let stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",async()=>{let $=new stream.PassThrough,J;if(stream.pipeline)J=stream.pipeline(readableStream,$,()=>{});else J=readableStream.pipe($);let X=readableStream.read(4100)||readableStream.read()||Buffer.alloc(0);try{let K=await wQ(X);$.fileType=K}catch(K){reject(K)}resolve(J)})}),eJ={fromStream:RR,fromTokenizer:d$,fromBuffer:wQ,stream:PR};Object.defineProperty(eJ,"extensions",{get(){return new Set(kQ.extensions)}});Object.defineProperty(eJ,"mimeTypes",{get(){return new Set(kQ.mimeTypes)}});$4.exports=eJ});var fQ=L0((Fz,gQ)=>{function n$(){this._types=Object.create(null),this._extensions=Object.create(null);for(let $=0;$<arguments.length;$++)this.define(arguments[$]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}n$.prototype.define=function($,J){for(let X in $){let K=$[X].map(function(q){return q.toLowerCase()});X=X.toLowerCase();for(let q=0;q<K.length;q++){let Y=K[q];if(Y[0]==="*")continue;if(!J&&Y in this._types)throw Error('Attempt to change mapping for "'+Y+'" extension from "'+this._types[Y]+'" to "'+X+'". Pass `force=true` to allow this, otherwise remove "'+Y+'" from the list of extensions for "'+X+'".');this._types[Y]=X}if(J||!this._extensions[X]){let q=K[0];this._extensions[X]=q[0]!=="*"?q:q.substr(1)}}};n$.prototype.getType=function($){$=String($);let J=$.replace(/^.*[/\\]/,"").toLowerCase(),X=J.replace(/^.*\./,"").toLowerCase(),K=J.length<$.length;return(X.length<J.length-1||!K)&&this._types[X]||null};n$.prototype.getExtension=function($){return $=/^\s*([^;\s]*)/.test($)&&RegExp.$1,$&&this._extensions[$.toLowerCase()]||null};gQ.exports=n$});var mQ=L0((zz,bQ)=>{bQ.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}});var uQ=L0((vz,pQ)=>{var SR=fQ();pQ.exports=new SR(mQ())});var JN=L0((Tz,$N)=>{$N.exports={parseSections:function($,J){var X,K;$.setBigEndian(!0);while($.remainingLength()>0&&K!==218){if($.nextUInt8()!==255)throw Error("Invalid JPEG section offset");if(K=$.nextUInt8(),K>=208&&K<=217||K===218)X=0;else X=$.nextUInt16()-2;J(K,$.branch(0,X)),$.skip(X)}},getSizeFromSOFSection:function($){return $.skip(1),{height:$.nextUInt16(),width:$.nextUInt16()}},getSectionName:function($){var J,X;switch($){case 216:J="SOI";break;case 196:J="DHT";break;case 219:J="DQT";break;case 221:J="DRI";break;case 218:J="SOS";break;case 254:J="COM";break;case 217:J="EOI";break;default:if($>=224&&$<=239)J="APP",X=$-224;else if($>=192&&$<=207&&$!==196&&$!==200&&$!==204)J="SOF",X=$-192;else if($>=208&&$<=215)J="RST",X=$-208;break}var K={name:J};if(typeof X==="number")K.index=X;return K}}});var K4=L0((Iz,XN)=>{function FR($,J){switch($){case 1:return J.nextUInt8();case 3:return J.nextUInt16();case 4:return J.nextUInt32();case 5:return[J.nextUInt32(),J.nextUInt32()];case 6:return J.nextInt8();case 8:return J.nextUInt16();case 9:return J.nextUInt32();case 10:return[J.nextInt32(),J.nextInt32()];case 11:return J.nextFloat();case 12:return J.nextDouble();default:throw Error("Invalid format while decoding: "+$)}}function zR($){switch($){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}}function vR($,J){var X=J.nextUInt16(),K=J.nextUInt16(),q=zR(K),Y=J.nextUInt32(),W=q*Y,Q,N,M;if(W>4)J=$.openWithOffset(J.nextUInt32());if(K===2){Q=J.nextString(Y);var V=Q.indexOf("\x00");if(V!==-1)Q=Q.substr(0,V)}else if(K===7)Q=J.nextBuffer(Y);else if(K!==0){Q=[];for(M=0;M<Y;++M)Q.push(FR(K,J))}if(W<4)J.skip(4-W);return[X,Q,K]}function T9($,J,X){var K=J.nextUInt16(),q,Y;for(Y=0;Y<K;++Y)q=vR($,J),X(q[0],q[1],q[2])}function CR($){var J=$.nextString(6);if(J!=="Exif\x00\x00")throw Error("Invalid EXIF header");var X=$.mark(),K=$.nextUInt16();if(K===18761)$.setBigEndian(!1);else if(K===19789)$.setBigEndian(!0);else throw Error("Invalid TIFF header");if($.nextUInt16()!==42)throw Error("Invalid TIFF data");return X}XN.exports={IFD0:1,IFD1:2,GPSIFD:3,SubIFD:4,InteropIFD:5,parseTags:function($,J){var X;try{X=CR($)}catch(L){return!1}var K,q,Y,W=X.openWithOffset($.nextUInt32()),Q=this.IFD0;T9(X,W,function(L,j,E){switch(L){case 34853:q=j[0];break;case 34665:K=j[0];break;default:J(Q,L,j,E);break}});var N=W.nextUInt32();if(N!==0){var M=X.openWithOffset(N);T9(X,M,J.bind(null,this.IFD1))}if(q){var V=X.openWithOffset(q);T9(X,V,J.bind(null,this.GPSIFD))}if(K){var G=X.openWithOffset(K),H=this.InteropIFD;T9(X,G,function(L,j,E){if(L===40965)Y=j[0];else J(H,L,j,E)})}if(Y){var O=X.openWithOffset(Y);T9(X,O,J.bind(null,this.InteropIFD))}return!0}}});var QN=L0((_z,WN)=>{function q4($){return parseInt($,10)}var ZR=3600,DR=60;function KN($,J){$=$.map(q4),J=J.map(q4);var X=$[0],K=$[1]-1,q=$[2],Y=J[0],W=J[1],Q=J[2],N=Date.UTC(X,K,q,Y,W,Q,0),M=N/1000;return M}function qN($){var J=$.substr(0,10).split("-"),X=$.substr(11,8).split(":"),K=$.substr(19,6),q=K.split(":").map(q4),Y=q[0]*ZR+q[1]*DR,W=KN(J,X);if(W-=Y,typeof W==="number"&&!isNaN(W))return W}function YN($){var J=$.split(" "),X=J[0].split(":"),K=J[1].split(":"),q=KN(X,K);if(typeof q==="number"&&!isNaN(q))return q}function kR($){var J=$.length===19&&$.charAt(4)===":",X=$.length===25&&$.charAt(10)==="T",K;if(X)return qN($);else if(J)return YN($)}WN.exports={parseDateWithSpecFormat:YN,parseDateWithTimezoneFormat:qN,parseExifDate:kR}});var MN=L0((yz,NN)=>{var T5=K4(),wR=QN(),TR=[{section:T5.GPSIFD,type:2,name:"GPSLatitude",refType:1,refName:"GPSLatitudeRef",posVal:"N"},{section:T5.GPSIFD,type:4,name:"GPSLongitude",refType:3,refName:"GPSLongitudeRef",posVal:"E"}],IR=[{section:T5.SubIFD,type:306,name:"ModifyDate"},{section:T5.SubIFD,type:36867,name:"DateTimeOriginal"},{section:T5.SubIFD,type:36868,name:"CreateDate"},{section:T5.SubIFD,type:306,name:"ModifyDate"}];NN.exports={castDegreeValues:function($,J){TR.forEach(function(X){var K=$(X);if(K){var q=$({section:X.section,type:X.refType,name:X.refName}),Y=q===X.posVal?1:-1,W=(K[0]+K[1]/60+K[2]/3600)*Y;J(X,W)}})},castDateValues:function($,J){IR.forEach(function(X){var K=$(X);if(K){var q=wR.parseExifDate(K);if(typeof q<"u")J(X,q)}})},simplifyValue:function($,J){if(Array.isArray($)){if($=$.map(function(X){if(J===10||J===5)return X[0]/X[1];return X}),$.length===1)$=$[0]}return $}}});var GN=L0((xz,VN)=>{VN.exports={exif:{1:"InteropIndex",2:"InteropVersion",11:"ProcessingSoftware",254:"SubfileType",255:"OldSubfileType",256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Thresholding",264:"CellWidth",265:"CellLength",266:"FillOrder",269:"DocumentName",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",285:"PageName",286:"XPosition",287:"YPosition",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",292:"T4Options",293:"T6Options",296:"ResolutionUnit",297:"PageNumber",300:"ColorResponseUnit",301:"TransferFunction",305:"Software",306:"ModifyDate",315:"Artist",316:"HostComputer",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",320:"ColorMap",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFD",332:"InkSet",333:"InkNames",334:"NumberofInks",336:"DotRange",337:"TargetPrinter",338:"ExtraSamples",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",435:"T82Options",437:"JPEGTables",512:"JPEGProc",513:"ThumbnailOffset",514:"ThumbnailLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"ApplicationNotes",999:"USPTOMiscellaneous",4096:"RelatedImageFileFormat",4097:"RelatedImageWidth",4098:"RelatedImageHeight",18246:"Rating",18247:"XP_DIP_XML",18248:"StitchInfo",18249:"RatingPercent",32781:"ImageID",32931:"WangTag1",32932:"WangAnnotation",32933:"WangTag3",32934:"WangTag4",32995:"Matteing",32996:"DataType",32997:"ImageDepth",32998:"TileDepth",33405:"Model2",33421:"CFARepeatPatternDim",33422:"CFAPattern2",33423:"BatteryLevel",33424:"KodakIFD",33432:"Copyright",33434:"ExposureTime",33437:"FNumber",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"PixelScale",33589:"AdventScale",33590:"AdventRevision",33628:"UIC1Tag",33629:"UIC2Tag",33630:"UIC3Tag",33631:"UIC4Tag",33723:"IPTC-NAA",33918:"IntergraphPacketData",33919:"IntergraphFlagRegisters",33920:"IntergraphMatrix",33921:"INGRReserved",33922:"ModelTiePoint",34016:"Site",34017:"ColorSequence",34018:"IT8Header",34019:"RasterPadding",34020:"BitsPerRunLength",34021:"BitsPerExtendedRunLength",34022:"ColorTable",34023:"ImageColorIndicator",34024:"BackgroundColorIndicator",34025:"ImageColorValue",34026:"BackgroundColorValue",34027:"PixelIntensityRange",34028:"TransparencyIndicator",34029:"ColorCharacterization",34030:"HCUsage",34031:"TrapIndicator",34032:"CMYKEquivalent",34118:"SEMInfo",34152:"AFCP_IPTC",34232:"PixelMagicJBIGOptions",34264:"ModelTransform",34306:"WB_GRGBLevels",34310:"LeafData",34377:"PhotoshopSettings",34665:"ExifOffset",34675:"ICC_Profile",34687:"TIFF_FXExtensions",34688:"MultiProfiles",34689:"SharedData",34690:"T88Options",34732:"ImageLayer",34735:"GeoTiffDirectory",34736:"GeoTiffDoubleParams",34737:"GeoTiffAsciiParams",34850:"ExposureProgram",34852:"SpectralSensitivity",34853:"GPSInfo",34855:"ISO",34856:"Opto-ElectricConvFactor",34857:"Interlace",34858:"TimeZoneOffset",34859:"SelfTimerMode",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",34908:"FaxRecvParams",34909:"FaxSubAddress",34910:"FaxRecvTime",34954:"LeafSubIFD",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"CreateDate",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureCompensation",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37387:"FlashEnergy",37388:"SpatialFrequencyResponse",37389:"Noise",37390:"FocalPlaneXResolution",37391:"FocalPlaneYResolution",37392:"FocalPlaneResolutionUnit",37393:"ImageNumber",37394:"SecurityClassification",37395:"ImageHistory",37396:"SubjectArea",37397:"ExposureIndex",37398:"TIFF-EPStandardID",37399:"SensingMethod",37434:"CIP3DataFile",37435:"CIP3Sheet",37436:"CIP3Side",37439:"StoNits",37500:"MakerNote",37510:"UserComment",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",37679:"MSDocumentText",37680:"MSPropertySetStorage",37681:"MSDocumentTextPosition",37724:"ImageSourceData",40091:"XPTitle",40092:"XPComment",40093:"XPAuthor",40094:"XPKeywords",40095:"XPSubject",40960:"FlashpixVersion",40961:"ColorSpace",40962:"ExifImageWidth",40963:"ExifImageHeight",40964:"RelatedSoundFile",40965:"InteropOffset",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41485:"Noise",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41489:"ImageNumber",41490:"SecurityClassification",41491:"ImageHistory",41492:"SubjectLocation",41493:"ExposureIndex",41494:"TIFF-EPStandardID",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFormat",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"OwnerName",42033:"SerialNumber",42034:"LensInfo",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42112:"GDALMetadata",42113:"GDALNoData",42240:"Gamma",44992:"ExpandSoftware",44993:"ExpandLens",44994:"ExpandFilm",44995:"ExpandFilterLens",44996:"ExpandScanner",44997:"ExpandFlashLamp",48129:"PixelFormat",48130:"Transformation",48131:"Uncompressed",48132:"ImageType",48256:"ImageWidth",48257:"ImageHeight",48258:"WidthResolution",48259:"HeightResolution",48320:"ImageOffset",48321:"ImageByteCount",48322:"AlphaOffset",48323:"AlphaByteCount",48324:"ImageDataDiscard",48325:"AlphaDataDiscard",50215:"OceScanjobDesc",50216:"OceApplicationSelector",50217:"OceIDNumber",50218:"OceImageLogic",50255:"Annotations",50341:"PrintIM",50560:"USPTOOriginalContentType",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"DNGLensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50739:"ShadowScale",50740:"DNGPrivateData",50741:"MakerNoteSafety",50752:"RawImageSegmentation",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50781:"RawDataUniqueID",50784:"AliasLayerMetadata",50827:"OriginalRawFileName",50828:"OriginalRawFileData",50829:"ActiveArea",50830:"MaskedAreas",50831:"AsShotICCProfile",50832:"AsShotPreProfileMatrix",50833:"CurrentICCProfile",50834:"CurrentPreProfileMatrix",50879:"ColorimetricReference",50898:"PanasonicTitle",50899:"PanasonicTitle2",50931:"CameraCalibrationSig",50932:"ProfileCalibrationSig",50933:"ProfileIFD",50934:"AsShotProfileName",50935:"NoiseReductionApplied",50936:"ProfileName",50937:"ProfileHueSatMapDims",50938:"ProfileHueSatMapData1",50939:"ProfileHueSatMapData2",50940:"ProfileToneCurve",50941:"ProfileEmbedPolicy",50942:"ProfileCopyright",50964:"ForwardMatrix1",50965:"ForwardMatrix2",50966:"PreviewApplicationName",50967:"PreviewApplicationVersion",50968:"PreviewSettingsName",50969:"PreviewSettingsDigest",50970:"PreviewColorSpace",50971:"PreviewDateTime",50972:"RawImageDigest",50973:"OriginalRawFileDigest",50974:"SubTileBlockSize",50975:"RowInterleaveFactor",50981:"ProfileLookTableDims",50982:"ProfileLookTableData",51008:"OpcodeList1",51009:"OpcodeList2",51022:"OpcodeList3",51041:"NoiseProfile",51043:"TimeCodes",51044:"FrameRate",51058:"TStop",51081:"ReelName",51089:"OriginalDefaultFinalSize",51090:"OriginalBestQualitySize",51091:"OriginalDefaultCropSize",51105:"CameraLabel",51107:"ProfileHueSatMapEncoding",51108:"ProfileLookTableEncoding",51109:"BaselineExposureOffset",51110:"DefaultBlackRender",51111:"NewRawImageDigest",51112:"RawToPreviewGain",51125:"DefaultUserCrop",59932:"Padding",59933:"OffsetSchema",65000:"OwnerName",65001:"SerialNumber",65002:"Lens",65024:"KDC_IFD",65100:"RawFile",65101:"Converter",65102:"WhiteBalance",65105:"Exposure",65106:"Shadows",65107:"Brightness",65108:"Contrast",65109:"Saturation",65110:"Sharpness",65111:"Smoothness",65112:"MoireFilter"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"}}});var EN=L0((hz,LN)=>{var I5=JN(),HN=K4(),Y4=MN();function ON($,J,X,K,q,Y,W){this.startMarker=$,this.tags=J,this.imageSize=X,this.thumbnailOffset=K,this.thumbnailLength=q,this.thumbnailType=Y,this.app1Offset=W}ON.prototype={hasThumbnail:function($){if(!this.thumbnailOffset||!this.thumbnailLength)return!1;if(typeof $!=="string")return!0;if($.toLowerCase().trim()==="image/jpeg")return this.thumbnailType===6;if($.toLowerCase().trim()==="image/tiff")return this.thumbnailType===1;return!1},getThumbnailOffset:function(){return this.app1Offset+6+this.thumbnailOffset},getThumbnailLength:function(){return this.thumbnailLength},getThumbnailBuffer:function(){return this._getThumbnailStream().nextBuffer(this.thumbnailLength)},_getThumbnailStream:function(){return this.startMarker.openWithOffset(this.getThumbnailOffset())},getImageSize:function(){return this.imageSize},getThumbnailSize:function(){var $=this._getThumbnailStream(),J;return I5.parseSections($,function(X,K){if(I5.getSectionName(X).name==="SOF")J=I5.getSizeFromSOFSection(K)}),J}};function UN($){this.stream=$,this.flags={readBinaryTags:!1,resolveTagNames:!0,simplifyValues:!0,imageSize:!0,hidePointers:!0,returnTags:!0}}UN.prototype={enableBinaryFields:function($){return this.flags.readBinaryTags=!!$,this},enablePointers:function($){return this.flags.hidePointers=!$,this},enableTagNames:function($){return this.flags.resolveTagNames=!!$,this},enableImageSize:function($){return this.flags.imageSize=!!$,this},enableReturnTags:function($){return this.flags.returnTags=!!$,this},enableSimpleValues:function($){return this.flags.simplifyValues=!!$,this},parse:function(){var $=this.stream.mark(),J=$.openWithOffset(0),X=this.flags,K,q,Y,W,Q,N,M,V,G;if(X.resolveTagNames)M=GN();if(X.resolveTagNames)K={},V=function(H){return K[H.name]},G=function(H,O){K[H.name]=O};else K=[],V=function(H){var O;for(O=0;O<K.length;++O)if(K[O].type===H.type&&K[O].section===H.section)return K.value},G=function(H,O){var L;for(L=0;L<K.length;++L)if(K[L].type===H.type&&K[L].section===H.section){K.value=O;return}};if(I5.parseSections(J,function(H,O){var L,j=O.offsetFrom($);if(H===225){if(L=HN.parseTags(O,function(E,B,S,A){if(!X.readBinaryTags&&A===7)return;if(B===513){if(Y=S[0],X.hidePointers)return}else if(B===514){if(W=S[0],X.hidePointers)return}else if(B===259){if(Q=S[0],X.hidePointers)return}if(!X.returnTags)return;if(X.simplifyValues)S=Y4.simplifyValue(S,A);if(X.resolveTagNames){var z=E===HN.GPSIFD?M.gps:M.exif,P=z[B];if(!P)P=M.exif[B];if(!K.hasOwnProperty(P))K[P]=S}else K.push({section:E,type:B,value:S})}),L)N=j}else if(X.imageSize&&I5.getSectionName(H).name==="SOF")q=I5.getSizeFromSOFSection(O)}),X.simplifyValues)Y4.castDegreeValues(V,G),Y4.castDateValues(V,G);return new ON($,K,q,Y,W,Q,N)}};LN.exports=UN});var RN=L0((gz,jN)=>{function r$($,J,X,K,q,Y){this.global=q,J=J||0,X=X||$.byteLength-J,this.arrayBuffer=$.slice(J,J+X),this.view=new q.DataView(this.arrayBuffer,0,this.arrayBuffer.byteLength),this.setBigEndian(K),this.offset=0,this.parentOffset=(Y||0)+J}r$.prototype={setBigEndian:function($){this.littleEndian=!$},nextUInt8:function(){var $=this.view.getUint8(this.offset);return this.offset+=1,$},nextInt8:function(){var $=this.view.getInt8(this.offset);return this.offset+=1,$},nextUInt16:function(){var $=this.view.getUint16(this.offset,this.littleEndian);return this.offset+=2,$},nextUInt32:function(){var $=this.view.getUint32(this.offset,this.littleEndian);return this.offset+=4,$},nextInt16:function(){var $=this.view.getInt16(this.offset,this.littleEndian);return this.offset+=2,$},nextInt32:function(){var $=this.view.getInt32(this.offset,this.littleEndian);return this.offset+=4,$},nextFloat:function(){var $=this.view.getFloat32(this.offset,this.littleEndian);return this.offset+=4,$},nextDouble:function(){var $=this.view.getFloat64(this.offset,this.littleEndian);return this.offset+=8,$},nextBuffer:function($){var J=this.arrayBuffer.slice(this.offset,this.offset+$);return this.offset+=$,J},remainingLength:function(){return this.arrayBuffer.byteLength-this.offset},nextString:function($){var J=this.arrayBuffer.slice(this.offset,this.offset+$);return J=String.fromCharCode.apply(null,new this.global.Uint8Array(J)),this.offset+=$,J},mark:function(){var $=this;return{openWithOffset:function(J){return J=(J||0)+this.offset,new r$($.arrayBuffer,J,$.arrayBuffer.byteLength-J,!$.littleEndian,$.global,$.parentOffset)},offset:this.offset,getParentOffset:function(){return $.parentOffset}}},offsetFrom:function($){return this.parentOffset+this.offset-($.offset+$.getParentOffset())},skip:function($){this.offset+=$},branch:function($,J){return J=typeof J==="number"?J:this.arrayBuffer.byteLength-(this.offset+$),new r$(this.arrayBuffer,this.offset+$,J,!this.littleEndian,this.global,this.parentOffset)}};jN.exports=r$});var PN=L0((fz,BN)=>{function i$($,J,X,K){this.buffer=$,this.offset=J||0,X=typeof X==="number"?X:$.length,this.endPosition=this.offset+X,this.setBigEndian(K)}i$.prototype={setBigEndian:function($){this.bigEndian=!!$},nextUInt8:function(){var $=this.buffer.readUInt8(this.offset);return this.offset+=1,$},nextInt8:function(){var $=this.buffer.readInt8(this.offset);return this.offset+=1,$},nextUInt16:function(){var $=this.bigEndian?this.buffer.readUInt16BE(this.offset):this.buffer.readUInt16LE(this.offset);return this.offset+=2,$},nextUInt32:function(){var $=this.bigEndian?this.buffer.readUInt32BE(this.offset):this.buffer.readUInt32LE(this.offset);return this.offset+=4,$},nextInt16:function(){var $=this.bigEndian?this.buffer.readInt16BE(this.offset):this.buffer.readInt16LE(this.offset);return this.offset+=2,$},nextInt32:function(){var $=this.bigEndian?this.buffer.readInt32BE(this.offset):this.buffer.readInt32LE(this.offset);return this.offset+=4,$},nextFloat:function(){var $=this.bigEndian?this.buffer.readFloatBE(this.offset):this.buffer.readFloatLE(this.offset);return this.offset+=4,$},nextDouble:function(){var $=this.bigEndian?this.buffer.readDoubleBE(this.offset):this.buffer.readDoubleLE(this.offset);return this.offset+=8,$},nextBuffer:function($){var J=this.buffer.slice(this.offset,this.offset+$);return this.offset+=$,J},remainingLength:function(){return this.endPosition-this.offset},nextString:function($){var J=this.buffer.toString("utf8",this.offset,this.offset+$);return this.offset+=$,J},mark:function(){var $=this;return{openWithOffset:function(J){return J=(J||0)+this.offset,new i$($.buffer,J,$.endPosition-J,$.bigEndian)},offset:this.offset}},offsetFrom:function($){return this.offset-$.offset},skip:function($){this.offset+=$},branch:function($,J){return J=typeof J==="number"?J:this.endPosition-(this.offset+$),new i$(this.buffer,this.offset+$,J,this.bigEndian)}};BN.exports=i$});var FN=L0((bz,AN)=>{var SN=EN();function _R(){return(0,eval)("this")}AN.exports={create:function($,J){if(J=J||_R(),$ instanceof J.ArrayBuffer){var X=RN();return new SN(new X($,0,$.byteLength,!0,J))}else{var K=PN();return new SN(new K($,0,$.length,!0))}}}});var fN=L0((Sv,gN)=>{function M4($,J){if(!$||!J||!$.length||!J.length)throw Error("Bad alphabet");this.srcAlphabet=$,this.dstAlphabet=J}M4.prototype.convert=function($){var J,X,K,q={},Y=this.srcAlphabet.length,W=this.dstAlphabet.length,Q=$.length,N=typeof $==="string"?"":[];if(!this.isValid($))throw Error('Number "'+$+'" contains of non-alphabetic digits ('+this.srcAlphabet+")");if(this.srcAlphabet===this.dstAlphabet)return $;for(J=0;J<Q;J++)q[J]=this.srcAlphabet.indexOf($[J]);do{X=0,K=0;for(J=0;J<Q;J++)if(X=X*Y+q[J],X>=W)q[K++]=parseInt(X/W,10),X=X%W;else if(K>0)q[K++]=0;Q=K,N=this.dstAlphabet.slice(X,X+1).concat(N)}while(K!==0);return N};M4.prototype.isValid=function($){var J=0;for(;J<$.length;++J)if(this.srcAlphabet.indexOf($[J])===-1)return!1;return!0};gN.exports=M4});var mN=L0((Av,bN)=>{var JB=fN();function I9($,J){var X=new JB($,J);return function(K){return X.convert(K)}}I9.BIN="01";I9.OCT="01234567";I9.DEC="0123456789";I9.HEX="0123456789abcdef";bN.exports=I9});var a0={FAILSAFE:!1,FAILSAFE_POINTS:[[0,0]],PAUSE:!0,PAUSE_DELAY:0};import{dlopen as Q7,FFIType as I,suffix as b4}from"bun:ffi";var G0=Q7(`user32.${b4}`,{SendInput:{args:[I.u32,I.ptr,I.i32],returns:I.u32},MapVirtualKeyW:{args:[I.u32,I.u32],returns:I.u32},GetCursorPos:{args:[I.ptr],returns:I.bool},GetKeyState:{args:[I.i32],returns:I.i16},GetAsyncKeyState:{args:[I.i32],returns:I.i16},SetWindowsHookExW:{args:[I.i32,I.ptr,I.ptr,I.u32],returns:I.ptr},UnhookWindowsHookEx:{args:[I.ptr],returns:I.bool},CallNextHookEx:{args:[I.ptr,I.i32,I.ptr,I.ptr],returns:I.ptr},GetDC:{args:[I.ptr],returns:I.u64},ReleaseDC:{args:[I.u64,I.u64],returns:I.int},GetDesktopWindow:{args:[],returns:I.ptr},GetForegroundWindow:{args:[],returns:I.u64},GetWindowTextW:{args:[I.u64,I.ptr,I.int],returns:I.int},GetWindowRect:{args:[I.u64,I.ptr],returns:I.bool},GetSystemMetrics:{args:[I.int],returns:I.int},SetLayeredWindowAttributes:{args:[I.u64,I.uint32_t,I.int8_t,I.uint32_t],returns:I.bool},UpdateLayeredWindow:{args:[I.ptr,I.ptr,I.ptr,I.ptr,I.ptr,I.ptr,I.uint32_t,I.ptr,I.uint32_t],returns:I.bool},GetWindowLongW:{args:[I.u64,I.int],returns:I.int},SetWindowLongW:{args:[I.u64,I.int,I.int],returns:I.int},CreateWindowExW:{args:[I.uint32_t,I.ptr,I.ptr,I.uint32_t,I.int,I.int,I.int,I.int,I.ptr,I.ptr,I.ptr,I.ptr],returns:I.ptr},ShowWindow:{args:[I.u64,I.int],returns:I.bool},UpdateWindow:{args:[I.u64],returns:I.bool},SetWindowPos:{args:[I.u64,I.u64,I.int,I.int,I.int,I.int,I.uint32_t],returns:I.bool},FindWindowA:{args:[I.ptr,I.ptr],returns:I.u64},FillRect:{args:[I.ptr,I.ptr,I.ptr],returns:I.int},IsWindow:{args:[I.u64],returns:I.bool},SetForegroundWindow:{args:[I.u64],returns:I.bool},IsWindowVisible:{args:[I.u64],returns:I.bool},GetWindowThreadProcessId:{args:[I.u64,I.ptr],returns:I.u32},MoveWindow:{args:[I.u64,I.int,I.int,I.int,I.int,I.bool],returns:I.bool},GetClientRect:{args:[I.u64,I.ptr],returns:I.bool},PostMessageA:{args:[I.u64,I.u32,I.u64,I.u64],returns:I.bool},GetClassNameA:{args:[I.u64,I.ptr,I.int],returns:I.int},SetWindowTextW:{args:[I.u64,I.ptr],returns:I.bool},EnableWindow:{args:[I.u64,I.bool],returns:I.bool},RedrawWindow:{args:[I.u64,I.ptr,I.u64,I.u32],returns:I.bool},ClientToScreen:{args:[I.u64,I.ptr],returns:I.bool},ScreenToClient:{args:[I.u64,I.ptr],returns:I.bool},SendMessageA:{args:[I.u64,I.u32,I.u64,I.u64],returns:I.ptr},IsIconic:{args:[I.u64],returns:I.bool},IsZoomed:{args:[I.u64],returns:I.bool},EnumWindows:{args:[I.function,I.i64],returns:I.bool},EnumChildWindows:{args:[I.u64,I.function,I.i64],returns:I.bool},FlashWindow:{args:[I.u64,I.bool],returns:I.bool},PrintWindow:{args:[I.u64,I.u64,I.u32],returns:I.bool},GetWindowDC:{args:[I.u64],returns:I.u64},LoadImageW:{args:[I.u64,I.ptr,I.uint32_t,I.int,I.int,I.uint32_t],returns:I.u64}}),c6=Q7("gdi32.dll",{GetPixel:{args:[I.u64,I.int,I.int],returns:I.uint32_t},CreatePen:{args:[I.int,I.int,I.uint32_t],returns:I.u64},SelectObject:{args:[I.u64,I.u64],returns:I.u64},MoveToEx:{args:[I.u64,I.int,I.int,I.ptr],returns:I.bool},LineTo:{args:[I.u64,I.int,I.int],returns:I.bool},DeleteObject:{args:[I.u64],returns:I.bool},CreateCompatibleDC:{args:[I.u64],returns:I.u64},CreateDIBSection:{args:[I.ptr,I.ptr,I.uint32_t,I.ptr,I.ptr,I.uint32_t],returns:I.ptr},DeleteDC:{args:[I.u64],returns:I.bool},CreateSolidBrush:{args:[I.uint32_t],returns:I.u64},CreateCompatibleBitmap:{args:[I.u64,I.int,I.int],returns:I.u64},BitBlt:{args:[I.u64,I.int,I.int,I.int,I.int,I.u64,I.int,I.int,I.uint32_t],returns:I.bool},GetDIBits:{args:[I.u64,I.u64,I.u32,I.u32,I.ptr,I.ptr,I.u32],returns:I.int},GetObjectA:{args:[I.ptr,I.int,I.ptr],returns:I.int}}),d9=Q7(`kernel32.${b4}`,{GetLastError:{args:[],returns:I.u32},OpenProcess:{args:[I.u32,I.bool,I.u32],returns:I.u64},CloseHandle:{args:[I.u64],returns:I.bool},QueryFullProcessImageNameW:{args:[I.u64,I.u32,I.ptr,I.ptr],returns:I.bool}});var o5=process.arch==="x64"||process.arch==="arm64";class N7 extends Error{constructor($){super($);this.name="FailSafeException"}}var m4=o5?8:4;function p4($=0,J=0,X=0,K=0,q=0,Y=0n){let W=20+m4,Q=Buffer.alloc(W);if(Q.writeInt32LE($,0),Q.writeInt32LE(J,4),Q.writeUInt32LE(X>>>0,8),Q.writeUInt32LE(K>>>0,12),Q.writeUInt32LE(q>>>0,16),o5)Q.writeBigUInt64LE(BigInt(Y),20);else Q.writeUInt32LE(Number(Y)>>>0,20);return Q}function u4($=0,J=0,X=0,K=0,q=0n){let Y=12+m4,W=Buffer.alloc(Y);if(W.writeUInt16LE($&65535,0),W.writeUInt16LE(J&65535,2),W.writeUInt32LE(X>>>0,4),W.writeUInt32LE(K>>>0,8),o5)W.writeBigUInt64LE(BigInt(q),12);else W.writeUInt32LE(Number(q)>>>0,12);return o5?Buffer.concat([W,Buffer.alloc(32-W.length)]):W}function n9($,J){let X=o5?40:36,K=Buffer.alloc(X);return K.writeUInt32LE($>>>0,0),J.copy(K,8,0,Math.min(32,J.length)),K}import{ptr as wV}from"bun:ffi";function g8(){if(a0.FAILSAFE){let $=P8();for(let J of a0.FAILSAFE_POINTS)if($[0]===J[0]&&$[1]===J[1])throw new N7("fail-safe triggered from mouse moving to a corner of the screen. To disable this fail-safe, set config.FAILSAFE to false. DISABLING FAIL-SAFE IS NOT RECOMMENDED.")}}function _6($){if($&&a0.PAUSE_DELAY>0)Bun.sleepSync(a0.PAUSE_DELAY)}function l4($=0,J=0){let[X,K]=[G0.symbols.GetSystemMetrics(0),G0.symbols.GetSystemMetrics(1)],q=Math.round($*65535/(X-1)),Y=Math.round(J*65535/(K-1)),W=Math.max(0,Math.min(65535,q)),Q=Math.max(0,Math.min(65535,Y));return[W,Q]}function P8($,J){let X=new ArrayBuffer(8),K=new DataView(X);G0.symbols.GetCursorPos(wV(X));let q=K.getInt32(0,!0),Y=K.getInt32(4,!0);return[$??q,J??Y]}var Z1={a:{scan:30},b:{scan:48},c:{scan:46},d:{scan:32},e:{scan:18},f:{scan:33},g:{scan:34},h:{scan:35},i:{scan:23},j:{scan:36},k:{scan:37},l:{scan:38},m:{scan:50},n:{scan:49},o:{scan:24},p:{scan:25},q:{scan:16},r:{scan:19},s:{scan:31},t:{scan:20},u:{scan:22},v:{scan:47},w:{scan:17},x:{scan:45},y:{scan:21},z:{scan:44},"0":{scan:11},"1":{scan:2},"2":{scan:3},"3":{scan:4},"4":{scan:5},"5":{scan:6},"6":{scan:7},"7":{scan:8},"8":{scan:9},"9":{scan:10},f1:{scan:59},f2:{scan:60},f3:{scan:61},f4:{scan:62},f5:{scan:63},f6:{scan:64},f7:{scan:65},f8:{scan:66},f9:{scan:67},f10:{scan:68},f11:{scan:87},f12:{scan:88},f13:{scan:100},f14:{scan:101},f15:{scan:102},f16:{scan:103},f17:{scan:104},f18:{scan:105},f19:{scan:106},f20:{scan:107},f21:{scan:108},f22:{scan:109},f23:{scan:110},f24:{scan:118},"-":{scan:12},minus:{scan:12},"=":{scan:13},equal:{scan:13},equals:{scan:13},"[":{scan:26},bracketleft:{scan:26},"]":{scan:27},bracketright:{scan:27},"\\":{scan:43},backslash:{scan:43},";":{scan:39},semicolon:{scan:39},"'":{scan:40},quote:{scan:40},apostrophe:{scan:40},"`":{scan:41},grave:{scan:41},backtick:{scan:41},",":{scan:51},comma:{scan:51},".":{scan:52},period:{scan:52},dot:{scan:52},"/":{scan:53},slash:{scan:53},forwardslash:{scan:53},space:{scan:57},enter:{scan:28},return:{scan:28},tab:{scan:15},backspace:{scan:14},escape:{scan:1},esc:{scan:1},shift:{scan:42},shiftleft:{scan:42},shiftright:{scan:54},ctrl:{scan:29},control:{scan:29},ctrlleft:{scan:29},controlleft:{scan:29},ctrlright:{scan:29,extended:!0},controlright:{scan:29,extended:!0},rctrl:{scan:29,extended:!0},alt:{scan:56},altleft:{scan:56},altright:{scan:56,extended:!0},ralt:{scan:56,extended:!0},altgr:{scan:56,extended:!0},win:{scan:91,extended:!0},winleft:{scan:91,extended:!0},windows:{scan:91,extended:!0},winright:{scan:92,extended:!0},windowsright:{scan:92,extended:!0},apps:{scan:93,extended:!0},menu:{scan:93,extended:!0},contextmenu:{scan:93,extended:!0},capslock:{scan:58},numlock:{scan:69},scrolllock:{scan:70},up:{scan:72,extended:!0},down:{scan:80,extended:!0},left:{scan:75,extended:!0},right:{scan:77,extended:!0},home:{scan:71,extended:!0},end:{scan:79,extended:!0},pageup:{scan:73,extended:!0},pagedown:{scan:81,extended:!0},insert:{scan:82,extended:!0},delete:{scan:83,extended:!0},del:{scan:83,extended:!0},numpad0:{scan:82},numpad1:{scan:79},numpad2:{scan:80},numpad3:{scan:81},numpad4:{scan:75},numpad5:{scan:76},numpad6:{scan:77},numpad7:{scan:71},numpad8:{scan:72},numpad9:{scan:73},numpaddecimal:{scan:83},numpadperiod:{scan:83},numpaddivide:{scan:53,extended:!0},numpadmultiply:{scan:55},numpadsubtract:{scan:74},numpadadd:{scan:78},numpadenter:{scan:28,extended:!0},volumeup:{scan:48,extended:!0},volumedown:{scan:46,extended:!0},volumemute:{scan:32,extended:!0},mute:{scan:32,extended:!0},playpause:{scan:34,extended:!0},stop:{scan:36,extended:!0},nexttrack:{scan:25,extended:!0},previoustrack:{scan:16,extended:!0},medianext:{scan:25,extended:!0},mediaprevious:{scan:16,extended:!0},mediaplaypause:{scan:34,extended:!0},mediastop:{scan:36,extended:!0},browserhome:{scan:50,extended:!0},browserback:{scan:106,extended:!0},browserforward:{scan:105,extended:!0},browserrefresh:{scan:103,extended:!0},browserstop:{scan:104,extended:!0},browsersearch:{scan:101,extended:!0},browserfavorites:{scan:102,extended:!0},mail:{scan:108,extended:!0},calculator:{scan:33,extended:!0},mycomputer:{scan:107,extended:!0},computer:{scan:107,extended:!0},printscreen:{scan:55,extended:!0},prtsc:{scan:55,extended:!0},pause:{scan:69,extended:!0},break:{scan:70},intl1:{scan:115},intl2:{scan:112},intl3:{scan:125},intl4:{scan:121},intl5:{scan:123},intl6:{scan:92},lang1:{scan:114},lang2:{scan:113},power:{scan:94,extended:!0},sleep:{scan:95,extended:!0},wake:{scan:99,extended:!0},help:{scan:59,extended:!0},undo:{scan:8,extended:!0},redo:{scan:7,extended:!0},cut:{scan:45,extended:!0},copy:{scan:46,extended:!0},paste:{scan:47,extended:!0},find:{scan:33,extended:!0},select:{scan:41,extended:!0},clear:{scan:76},num0:{scan:82},num1:{scan:79},num2:{scan:80},num3:{scan:81},num4:{scan:75},num5:{scan:76},num6:{scan:77},num7:{scan:71},num8:{scan:72},num9:{scan:73}},M7=new Map([["!","1"],["@","2"],["#","3"],["$","4"],["%","5"],["^","6"],["&","7"],["*","8"],["(","9"],[")","0"],["_","-"],["+","="],["{","["],["}","]"],["|","\\"],[":",";"],['"',"'"],["<",","],[">","."],["?","/"],["~","`"]]);var V7=1,c4=32768,G7=2,H7=4;var O7=8,U7=16;var L7=32,E7=64;var j7=128,R7=256,d4=1,n4=2,o4=1,r4=2,B7=8;function i4($,J,X,K=0){let q=X|(J?o4:0),Y=u4(0,$,q,K,0n),W=n9(1,Y);G0.symbols.SendInput(1,W,40)}function $1($,J=a0.PAUSE){let{scan:X,extended:K}=Z1[$];if(i4(X,!!K,B7),J)_6(J);return S8}function f8($,J=a0.PAUSE){let{scan:X,extended:K}=Z1[$],q=B7|r4;if(i4(X,!!K,q),J)_6(J);return S8}function o1($,J=a0.PAUSE){return $1($,J),f8($,J),S8}function s4($,J=1,X=0,K=a0.PAUSE){for(let q=0;q<J;q++)if($1($,K),f8($,K),X>0)Bun.sleepSync(X);return S8}function a4($,J=0,X=a0.PAUSE){for(let K of $){if(K>="A"&&K<="Z"){let q=K.toLowerCase();$1("shift",X),o1(q,X),f8("shift",X)}else if(M7.has(K)){let q=M7.get(K);$1("shift",X),o1(q,X),f8("shift",X)}else o1(K,X);if(J>0)Bun.sleepSync(J)}return S8}function D1($){let{scan:J}=Z1[$],X;if(J>1024){let q=J-1024;X=G0.symbols.MapVirtualKeyW(q,1)}else X=G0.symbols.MapVirtualKeyW(J,1);return(G0.symbols.GetAsyncKeyState(X)&32768)!==0}function t4($){return $.some((J)=>D1(J))}function e4($){return $.every((J)=>D1(J))}function $X($,J=a0.PAUSE){for(let X of $)$1(X,J);for(let X=$.length-1;X>=0;X--)f8($[X],J);return S8}function JX($,J,X=a0.PAUSE){if($1($,!1),Bun.sleepSync(J),f8($,!1),X)_6(X);return S8}function XX($,J){return new Promise((X)=>{let q=0,Y=setInterval(()=>{if(D1($)){clearInterval(Y),X(!0);return}if(J){if(q+=8,q>=J)clearInterval(Y),X(!1)}},8)})}function KX($,J){return new Promise((X)=>{let q=0,Y=setInterval(()=>{if(!D1($)){clearInterval(Y),X(!0);return}if(J){if(q+=8,q>=J)clearInterval(Y),X(!1)}},8)})}function qX($,J=a0.PAUSE){return o1($,J),S8}function YX($){let{scan:J}=Z1[$],X;if(J>1024){let Y=J-1024;X=G0.symbols.MapVirtualKeyW(Y,1)}else X=G0.symbols.MapVirtualKeyW(J,1);let K=G0.symbols.GetAsyncKeyState(X),q=G0.symbols.GetKeyState(X);return{isPressed:(K&32768)!==0,isToggled:(q&1)!==0}}function WX($=a0.PAUSE){let J=["shift","shiftleft","shiftright","ctrl","ctrlleft","ctrlright","alt","altleft","altright","win","winleft","winright"],X="abcdefghijklmnopqrstuvwxyz".split("");J.push(...X);for(let K of J)if(D1(K))f8(K,$);return S8}class r5{listeners=new Map;isRunning=!1;startPromise=null;on($,J){if(!this.listeners.has($))this.listeners.set($,new Set);this.listeners.get($).add(J)}off($,J){this.listeners.get($)?.delete(J)}once($,J){let X=(K)=>{try{J(K)}finally{this.off($,X)}};this.on($,X)}_emit($,J){this.listeners.get($)?.forEach((X)=>{try{X(J)}catch(K){console.error(`Listener error [${String($)}]:`,K)}})}async start($=8){if(this.isRunning)return console.warn("Listener already running"),this.startPromise??Promise.resolve();return this.isRunning=!0,this.startPromise=(async()=>{try{await this.run($)}catch(J){console.error("Listener run error:",J)}finally{this.isRunning=!1,this.startPromise=null}})(),this.startPromise}async stop(){if(this.isRunning=!1,this.startPromise)await this.startPromise}}var QX={};for(let[$,J]of Object.entries(Z1))QX[J.scan&4095]=$;var IV=new Set([1,2,4,5,6]),_V={112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",13:"enter",16:"shift",17:"ctrl",18:"alt",9:"tab",20:"capslock",27:"escape",32:"space"};class P7 extends r5{async run($=8){console.log("Keyboard listener started.");let J=Array(256).fill(!1),X=Array.from({length:256},(K,q)=>q);while(this.isRunning){for(let K of X){if(IV.has(K))continue;let q=G0.symbols.GetAsyncKeyState(K),Y=(q&32768)!==0,W=(q&1)!==0,Q=_V[K];if(!Q){let N=G0.symbols.MapVirtualKeyW(K,0);Q=QX[N]}if(!Q)if(K>=48&&K<=57)Q=String.fromCharCode(K);else if(K>=65&&K<=90)Q=String.fromCharCode(K).toLowerCase();else continue;if(Y!==J[K]){J[K]=Y;let N={event:Y?"down":"up",name:Q,vk_code:K,isKeyDown:Y};this._emit(Y?"down":"up",N)}else if(!Y&&W&&!J[K]){let N={event:"down",name:Q,vk_code:K,isKeyDown:!0},M={event:"up",name:Q,vk_code:K,isKeyDown:!1};this._emit("down",N),this._emit("up",M)}}await Bun.sleep($)}console.log("Keyboard listener stopped.")}}class NX{press=$1;release=f8;tap=o1;repeatTap=s4;write=a4;isPressed=D1;hotkey=$X;hold=JX;isAnyPressed=t4;areAllPressed=e4;waitForPress=XX;waitForRelease=KX;toggleKey=qX;getKeyState=YX;releaseAll=WX;listener=new P7}var S8=new NX;var q8="left",o9="right",i5="middle",S7="x1",A7="x2";var yV=2048,xV=4096,hV=120,gV={[q8]:{down:G7,up:H7,data:0},[i5]:{down:L7,up:E7,data:0},[o9]:{down:O7,up:U7,data:0},[S7]:{down:j7,up:R7,data:d4},[A7]:{down:j7,up:R7,data:n4}};function MX($,J){let X=gV[$];if(!X)throw Error(`Invalid button: ${$}`);return{event:X[J],mouseData:X.data}}function fV($,J){if($!==void 0){if(!Number.isFinite($))throw Error(`Invalid x coordinate: ${$}`);if($<0)throw Error(`x coordinate must be non-negative: ${$}`)}if(J!==void 0){if(!Number.isFinite(J))throw Error(`Invalid y coordinate: ${J}`);if(J<0)throw Error(`y coordinate must be non-negative: ${J}`)}}function k1($,J,X,K,q=0){let Y=p4($,J,X,K,q,0n),W=n9(0,Y);G0.symbols.SendInput(1,W,40)}function r9($=q8,J=a0.PAUSE){try{let{event:X,mouseData:K}=MX($,"down");if(k1(0,0,K,X,0),J)_6(J);return d6}catch(X){throw console.error("[Mouse Press Error]",X),X}}function i9($=q8,J=a0.PAUSE){try{let{event:X,mouseData:K}=MX($,"up");if(k1(0,0,K,X,0),J)_6(J);return d6}catch(X){throw console.error("[Mouse Release Error]",X),X}}function F7($=q8,J=1,X=0,K=a0.PAUSE){if([q8,i5,o9].includes($)){let q=0,Y=0;if($===q8)q=G7,Y=H7;else if($===i5)q=L7,Y=E7;else q=O7,Y=U7;for(let W=0;W<J;W++)if(g8(),k1(0,0,0,q,0),k1(0,0,0,Y,0),X>0)Bun.sleepSync(Math.round(X*1000))}if(K)_6(K);return d6}function J1($,J,X=!1,K=a0.PAUSE){try{if(g8(),fV($,J),!X){let[q,Y]=P8($,J),[W,Q]=l4(q,Y);if(k1(W,Q,0,V7|c4,0),K)_6(K)}else z7($??0,J??0,!0,K);return d6}catch(q){throw console.error("[Mouse MoveTo Error]",q),q}}function z7($=0,J=0,X=!1,K=a0.PAUSE){if(g8(),!X){let[q,Y]=P8();J1(q+$,Y+J,!1,K)}else if(k1($,J,0,V7,0),K)_6(K);return d6}function s9($){let J;if($===q8)J=1;else if($===o9)J=2;else if($===i5)J=4;else if($===S7)J=5;else if($===A7)J=6;else throw Error(`Invalid button: ${$}`);return(G0.symbols.GetAsyncKeyState(J)&32768)!==0}function v7($,J,X=q8,K=0.5,q=a0.PAUSE){g8();let[Y,W]=P8();if(r9(X,q),K<=0)J1($,J,!1,q);else{let Q=Math.max(10,Math.floor(K*100)),N=K/Q;for(let M=1;M<=Q;M++){let V=M/Q,G=Math.round(Y+($-Y)*V),H=Math.round(W+(J-W)*V);J1(G,H,!1,!1),Bun.sleepSync(Math.round(N*1000))}}return i9(X,q),d6}function VX($,J,X=q8,K=0.5,q=a0.PAUSE){let[Y,W]=P8();return v7(Y+$,W+J,X,K,q)}function GX($,J="vertical",X=a0.PAUSE){g8();let K=$*hV;if(k1(0,0,K,J==="vertical"?yV:xV,0),X)_6(X);return d6}var bV={linear:($)=>$,easeInQuad:($)=>$*$,easeOutQuad:($)=>$*(2-$),easeInOutQuad:($)=>$<0.5?2*$*$:-1+(4-2*$)*$,easeInCubic:($)=>$*$*$,easeOutCubic:($)=>--$*$*$+1,easeInOutCubic:($)=>$<0.5?4*$*$*$:($-1)*(2*$-2)*(2*$-2)+1};async function HX($,J,X=0.5,K="easeOutQuad",q=a0.PAUSE){g8();let[Y,W]=P8(),Q=bV[K];if(X<=0)return J1($,J,!1,q),d6;let N=Math.max(10,Math.floor(X*100)),M=X/N;for(let V=1;V<=N;V++){let G=V/N,H=Q(G),O=Math.round(Y+($-Y)*H),L=Math.round(W+(J-W)*H);J1(O,L,!1,!1),Bun.sleepSync(Math.round(M*1000))}if(q)_6(q);return d6}function OX($,J,X=a0.PAUSE){if(g8(),r9($,!1),Bun.sleepSync(Math.round(J*1000)),i9($,!1),X)_6(X);return d6}function UX($,J,X=q8,K=a0.PAUSE){return g8(),J1($,J,!1,K),F7(X,1,0,K),d6}function C7($,J,X=0){let[K,q]=P8(),Y=Math.abs(K-$),W=Math.abs(q-J);return Y<=X&&W<=X}function LX($,J,X,K=0){return new Promise((q)=>{let W=0,Q=setInterval(()=>{if(C7($,J,K)){clearInterval(Q),q(!0);return}if(X!==void 0){if(W+=8,W>=X)clearInterval(Q),q(!1)}},8)})}async function EX($,J){return new Promise((X)=>{let q=0,Y=setInterval(()=>{if(s9($)){clearInterval(Y),X(!0);return}if(J!==void 0){if(q+=8,q>=J)clearInterval(Y),X(!1)}},8)})}async function jX($,J){return new Promise((X)=>{let q=0,Y=setInterval(()=>{if(!s9($)){clearInterval(Y),X(!0);return}if(J!==void 0){if(q+=8,q>=J)clearInterval(Y),X(!1)}},8)})}import{ptr as pV}from"bun:ffi";class Z7 extends r5{async run($=8){console.log("Mouse listener started.");let J=new ArrayBuffer(8),X=new DataView(J),K={x:0,y:0},q={left:!1,right:!1,middle:!1,x1:!1,x2:!1};while(this.isRunning){G0.symbols.GetCursorPos(pV(J));let Y=X.getInt32(0,!0),W=X.getInt32(4,!0);if(Y!==K.x||W!==K.y){let M={event:"move",x:Y,y:W,lastX:K.x,lastY:K.y,deltaX:Y-K.x,deltaY:W-K.y};this._emit("move",M),K.x=Y,K.y=W}let Q={left:G0.symbols.GetAsyncKeyState(1),right:G0.symbols.GetAsyncKeyState(2),middle:G0.symbols.GetAsyncKeyState(4),x1:G0.symbols.GetAsyncKeyState(5),x2:G0.symbols.GetAsyncKeyState(6)},N=Object.fromEntries(Object.entries(Q).map(([M,V])=>[M,(V&32768)!==0]));for(let M of Object.keys(q))if(N[M]!==q[M]){q[M]=N[M];let V={event:N[M]?"down":"up",button:M,x:K.x,y:K.y};this._emit(N[M]?"down":"up",V)}await Bun.sleep($)}console.log("Mouse listener stopped.")}}class RX{get position(){let $=P8();return{x:$[0],y:$[1]}}press=r9;release=i9;click=F7;moveTo=J1;moveRel=z7;isPressed=s9;dragTo=v7;dragRel=VX;scroll=GX;smoothMoveTo=HX;hold=OX;clickAt=UX;isAtPosition=C7;waitForPosition=LX;waitForPress=EX;waitForRelease=jX;listener=new Z7}var d6=new RX;import{ptr as P6,JSCallback as nM}from"bun:ffi";var D7;(function($){$[$.BITMAP_INFO_HEADER=40]="BITMAP_INFO_HEADER",$[$.BITMAP_V2_INFO_HEADER=52]="BITMAP_V2_INFO_HEADER",$[$.BITMAP_V3_INFO_HEADER=56]="BITMAP_V3_INFO_HEADER",$[$.BITMAP_V4_HEADER=108]="BITMAP_V4_HEADER",$[$.BITMAP_V5_HEADER=124]="BITMAP_V5_HEADER"})(D7||(D7={}));var n6=D7;function k7($,J,X,K){let q=~$+1&$,Y=~J+1&J,W=~X+1&X,Q=~K+1&K,N=$/q+1,M=J/Y+1,V=X/W+1,G=K/Q+1;return{shiftRed:(H)=>(H&$)/q*256/N,shiftGreen:(H)=>(H&J)/Y*256/M,shiftBlue:(H)=>(H&X)/W*256/V,shiftAlpha:K!==0?(H)=>(H&K)/Q*256/G:()=>255}}var b8;(function($){$[$.NONE=0]="NONE",$[$.BI_RLE8=1]="BI_RLE8",$[$.BI_RLE4=2]="BI_RLE4",$[$.BI_BIT_FIELDS=3]="BI_BIT_FIELDS",$[$.BI_ALPHA_BIT_FIELDS=6]="BI_ALPHA_BIT_FIELDS"})(b8||(b8={}));class a9{flag;fileSize;reserved1;reserved2;offset;headerSize;width;height;planes;bitPP;compression;rawSize;hr;vr;colors;importantColors;palette;data;maskRed;maskGreen;maskBlue;maskAlpha;toRGBA;pos;bottomUp;buffer;locRed;locGreen;locBlue;locAlpha;shiftRed;shiftGreen;shiftBlue;shiftAlpha;constructor($,{toRGBA:J}={toRGBA:!1}){if(this.buffer=$,this.toRGBA=!!J,this.pos=0,this.bottomUp=!0,this.flag=this.buffer.toString("utf-8",0,this.pos+=2),this.flag!=="BM")throw Error("Invalid BMP File");this.locRed=this.toRGBA?0:3,this.locGreen=this.toRGBA?1:2,this.locBlue=this.toRGBA?2:1,this.locAlpha=this.toRGBA?3:0,this.parseHeader(),this.parseRGBA()}parseHeader(){if(this.fileSize=this.readUInt32LE(),this.reserved1=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.reserved2=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.offset=this.readUInt32LE(),this.headerSize=this.readUInt32LE(),!(this.headerSize in n6))throw Error(`Unsupported BMP header size ${this.headerSize}`);if(this.width=this.readUInt32LE(),this.height=this.readUInt32LE(),this.height=this.height>2147483647?this.height-4294967296:this.height,this.planes=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.bitPP=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.compression=this.readUInt32LE(),this.rawSize=this.readUInt32LE(),this.hr=this.readUInt32LE(),this.vr=this.readUInt32LE(),this.colors=this.readUInt32LE(),this.importantColors=this.readUInt32LE(),this.bitPP===32)this.maskAlpha=0,this.maskRed=16711680,this.maskGreen=65280,this.maskBlue=255;else if(this.bitPP===16)this.maskAlpha=0,this.maskRed=31744,this.maskGreen=992,this.maskBlue=31;if(this.headerSize>n6.BITMAP_INFO_HEADER||this.compression===b8.BI_BIT_FIELDS||this.compression===b8.BI_ALPHA_BIT_FIELDS)this.maskRed=this.readUInt32LE(),this.maskGreen=this.readUInt32LE(),this.maskBlue=this.readUInt32LE();if(this.headerSize>n6.BITMAP_V2_INFO_HEADER||this.compression===b8.BI_ALPHA_BIT_FIELDS)this.maskAlpha=this.readUInt32LE();if(this.headerSize>n6.BITMAP_V3_INFO_HEADER)this.pos+=n6.BITMAP_V4_HEADER-n6.BITMAP_V3_INFO_HEADER;if(this.headerSize>n6.BITMAP_V4_HEADER)this.pos+=n6.BITMAP_V5_HEADER-n6.BITMAP_V4_HEADER;if(this.bitPP<=8||this.colors>0){let J=this.colors===0?1<<this.bitPP:this.colors;this.palette=Array(J);for(let X=0;X<J;X++){let K=this.buffer.readUInt8(this.pos++),q=this.buffer.readUInt8(this.pos++),Y=this.buffer.readUInt8(this.pos++),W=this.buffer.readUInt8(this.pos++);this.palette[X]={red:Y,green:q,blue:K,quad:W}}}if(this.height<0)this.height*=-1,this.bottomUp=!1;let $=k7(this.maskRed,this.maskGreen,this.maskBlue,this.maskAlpha);this.shiftRed=$.shiftRed,this.shiftGreen=$.shiftGreen,this.shiftBlue=$.shiftBlue,this.shiftAlpha=$.shiftAlpha}parseRGBA(){switch(this.data=Buffer.alloc(this.width*this.height*4),this.bitPP){case 1:this.bit1();break;case 4:this.bit4();break;case 8:this.bit8();break;case 16:this.bit16();break;case 24:this.bit24();break;default:this.bit32()}}bit1(){let $=Math.ceil(this.width/8),J=$%4,X=J!==0?4-J:0,K;this.scanImage(X,$,(q,Y)=>{if(Y!==K)K=Y;let W=this.buffer.readUInt8(this.pos++),Q=Y*this.width*4+q*8*4;for(let N=0;N<8;N++)if(q*8+N<this.width){let M=this.palette[W>>7-N&1];this.data[Q+N*this.locAlpha]=0,this.data[Q+N*4+this.locBlue]=M.blue,this.data[Q+N*4+this.locGreen]=M.green,this.data[Q+N*4+this.locRed]=M.red}else break})}bit4(){if(this.compression===b8.BI_RLE4){this.data.fill(0);let $=!1,J=this.bottomUp?this.height-1:0,X=0;while(X<this.data.length){let K=this.buffer.readUInt8(this.pos++),q=this.buffer.readUInt8(this.pos++);if(K===0){if(q===0){J+=this.bottomUp?-1:1,X=J*this.width*4,$=!1;continue}if(q===1)break;if(q===2){let Y=this.buffer.readUInt8(this.pos++),W=this.buffer.readUInt8(this.pos++);J+=this.bottomUp?-W:W,X+=W*this.width*4+Y*4}else{let Y=this.buffer.readUInt8(this.pos++);for(let W=0;W<q;W++){if(X=this.setPixelData(X,$?Y&15:(Y&240)>>4),W&1&&W+1<q)Y=this.buffer.readUInt8(this.pos++);$=!$}if((q+1>>1&1)===1)this.pos++}}else for(let Y=0;Y<K;Y++)X=this.setPixelData(X,$?q&15:(q&240)>>4),$=!$}}else{let $=Math.ceil(this.width/2),J=$%4,X=J!==0?4-J:0;this.scanImage(X,$,(K,q)=>{let Y=this.buffer.readUInt8(this.pos++),W=q*this.width*4+K*2*4,Q=Y>>4,N=this.palette[Q];if(this.data[W]=0,this.data[W+1]=N.blue,this.data[W+2]=N.green,this.data[W+3]=N.red,K*2+1>=this.width)return!1;let M=Y&15;N=this.palette[M],this.data[W+4]=0,this.data[W+4+1]=N.blue,this.data[W+4+2]=N.green,this.data[W+4+3]=N.red})}}bit8(){if(this.compression===b8.BI_RLE8){this.data.fill(0);let $=this.bottomUp?this.height-1:0,J=0;while(J<this.data.length){let X=this.buffer.readUInt8(this.pos++),K=this.buffer.readUInt8(this.pos++);if(X===0){if(K===0){$+=this.bottomUp?-1:1,J=$*this.width*4;continue}if(K===1)break;if(K===2){let q=this.buffer.readUInt8(this.pos++),Y=this.buffer.readUInt8(this.pos++);$+=this.bottomUp?-Y:Y,J+=Y*this.width*4+q*4}else{for(let Y=0;Y<K;Y++){let W=this.buffer.readUInt8(this.pos++);J=this.setPixelData(J,W)}if(K&!0)this.pos++}}else for(let q=0;q<X;q++)J=this.setPixelData(J,K)}}else{let $=this.width%4,J=$!==0?4-$:0;this.scanImage(J,this.width,(X,K)=>{let q=this.buffer.readUInt8(this.pos++),Y=K*this.width*4+X*4;if(q<this.palette.length){let W=this.palette[q];this.data[Y]=0,this.data[Y+1]=W.blue,this.data[Y+2]=W.green,this.data[Y+3]=W.red}else this.data[Y]=0,this.data[Y+1]=255,this.data[Y+2]=255,this.data[Y+3]=255})}}bit16(){let $=this.width%2*2;this.scanImage($,this.width,(J,X)=>{let K=X*this.width*4+J*4,q=this.buffer.readUInt16LE(this.pos);this.pos+=2,this.data[K+this.locRed]=this.shiftRed(q),this.data[K+this.locGreen]=this.shiftGreen(q),this.data[K+this.locBlue]=this.shiftBlue(q),this.data[K+this.locAlpha]=this.shiftAlpha(q)})}bit24(){let $=this.width%4;this.scanImage($,this.width,(J,X)=>{let K=X*this.width*4+J*4,q=this.buffer.readUInt8(this.pos++),Y=this.buffer.readUInt8(this.pos++),W=this.buffer.readUInt8(this.pos++);this.data[K+this.locRed]=W,this.data[K+this.locGreen]=Y,this.data[K+this.locBlue]=q,this.data[K+this.locAlpha]=0})}bit32(){this.scanImage(0,this.width,($,J)=>{let X=J*this.width*4+$*4,K=this.readUInt32LE();this.data[X+this.locRed]=this.shiftRed(K),this.data[X+this.locGreen]=this.shiftGreen(K),this.data[X+this.locBlue]=this.shiftBlue(K),this.data[X+this.locAlpha]=this.shiftAlpha(K)})}scanImage($=0,J=this.width,X){for(let K=this.height-1;K>=0;K--){let q=this.bottomUp?K:this.height-1-K;for(let Y=0;Y<J;Y++)if(X.call(this,Y,q)===!1)return;this.pos+=$}}readUInt32LE(){let $=this.buffer.readUInt32LE(this.pos);return this.pos+=4,$}setPixelData($,J){let{blue:X,green:K,red:q}=this.palette[J];return this.data[$+this.locAlpha]=0,this.data[$+1+this.locBlue]=X,this.data[$+2+this.locGreen]=K,this.data[$+3+this.locRed]=q,$+4}}function BX($){return $.reduce((J,X)=>J<<1|X,0)}function w7($){return $.quad<<24|$.red<<16|$.green<<8|$.blue}class t9{fileSize;reserved1;reserved2;offset;width;flag;height;planes;bitPP;compress;hr;vr;colors;importantColors;rawSize;headerSize;data;palette;extraBytes;buffer;bytesInColor;pos;constructor($){if(this.buffer=$.data,this.width=$.width,this.height=$.height,this.headerSize=n6.BITMAP_INFO_HEADER,this.flag="BM",this.bitPP=$.bitPP||24,this.offset=54,this.reserved1=$.reserved1||0,this.reserved2=$.reserved2||0,this.planes=1,this.compress=0,this.hr=$.hr||0,this.vr=$.vr||0,this.importantColors=$.importantColors||0,this.colors=Math.min(2**(this.bitPP-1||1),$.colors||1/0),this.palette=$.palette||[],this.colors&&this.bitPP<16)this.offset+=this.colors*4;else this.colors=0;switch(this.bitPP){case 32:this.bytesInColor=4;break;case 16:this.bytesInColor=2;break;case 8:this.bytesInColor=1;break;case 4:this.bytesInColor=0.5;break;case 1:this.bytesInColor=0.125;break;default:this.bytesInColor=3,this.bitPP=24}let J=this.width*this.bitPP/32,X=Math.ceil(J);this.extraBytes=(X-J)*4,this.rawSize=this.height*X*4+2,this.fileSize=this.rawSize+this.offset,this.data=Buffer.alloc(this.fileSize,1),this.pos=0,this.encode()}encode(){switch(this.pos=0,this.writeHeader(),this.bitPP){case 32:this.bit32();break;case 16:this.bit16();break;case 8:this.bit8();break;case 4:this.bit4();break;case 1:this.bit1();break;default:this.bit24()}}writeHeader(){this.data.write(this.flag,this.pos,2),this.pos+=2,this.writeUInt32LE(this.fileSize),this.writeUInt32LE(this.reserved1<<16|this.reserved2),this.writeUInt32LE(this.offset),this.writeUInt32LE(this.headerSize),this.writeUInt32LE(this.width),this.writeUInt32LE(this.height),this.data.writeUInt16LE(this.planes,this.pos),this.pos+=2,this.data.writeUInt16LE(this.bitPP,this.pos),this.pos+=2,this.writeUInt32LE(this.compress),this.writeUInt32LE(this.rawSize),this.writeUInt32LE(this.hr),this.writeUInt32LE(this.vr),this.writeUInt32LE(this.colors),this.writeUInt32LE(this.importantColors)}bit1(){if(this.palette.length&&this.colors===2)this.initColors(1);else this.writeUInt32LE(16777215),this.writeUInt32LE(0);this.pos+=1;let $=[];this.writeImage((J,X,K)=>{let q=X;q++;let Y=this.buffer[q++],W=this.buffer[q++],N=this.buffer[q++]*0.2126+W*0.7152+Y*0.0722;if($.push(N>127?0:1),(K+1)%8===0)this.data[J-1]=BX($),$=[];else if(K===this.width-1&&$.length>0)this.data[J-1]=BX($)<<4,$=[];return q})}bit4(){let $=this.initColors(4),J=[];this.writeImage((X,K,q)=>{let Y=K,W=w7({quad:this.buffer[Y++],blue:this.buffer[Y++],green:this.buffer[Y++],red:this.buffer[Y++]}),Q=$.findIndex((N)=>N===W);if(Q!==-1)J.push(Q);else J.push(0);if((q+1)%2===0)this.data[X]=J[0]<<4|J[1],J=[];return Y})}bit8(){let $=this.initColors(8);this.writeImage((J,X)=>{let K=X,q=w7({quad:this.buffer[K++],blue:this.buffer[K++],green:this.buffer[K++],red:this.buffer[K++]}),Y=$.findIndex((W)=>W===q);if(Y!==-1)this.data[J]=Y;else this.data[J]=0;return K})}bit16(){this.writeImage(($,J)=>{let X=J+1,K=this.buffer[X++]/8,q=this.buffer[X++]/8,W=this.buffer[X++]/8<<10|q<<5|K;return this.data[$]=W&255,this.data[$+1]=(W&65280)>>8,X})}bit24(){this.writeImage(($,J)=>{let X=J+1;return this.data[$]=this.buffer[X++],this.data[$+1]=this.buffer[X++],this.data[$+2]=this.buffer[X++],X})}bit32(){this.writeImage(($,J)=>{let X=J;return this.data[$+3]=this.buffer[X++],this.data[$]=this.buffer[X++],this.data[$+1]=this.buffer[X++],this.data[$+2]=this.buffer[X++],X})}writeImage($){let J=this.extraBytes+this.width*this.bytesInColor,X=0;for(let K=0;K<this.height;K++)for(let q=0;q<this.width;q++){let Y=Math.floor(this.pos+(this.height-1-K)*J+q*this.bytesInColor);X=$.call(this,Y,X,q,K)}}initColors($){let J=[];if(this.palette.length)for(let X=0;X<this.colors;X++){let K=w7(this.palette[X]);this.writeUInt32LE(K),J.push(K)}else throw Error(`To encode ${$}-bit BMPs a pallette is needed. Please choose up to ${this.colors} colors. Colors must be 32-bit integers.`);return J}writeUInt32LE($){this.data.writeUInt32LE($,this.pos),this.pos+=4}}function PX($,J){return new a9($,J)}function SX($){return new t9($)}function e9($){return e9=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(J){return typeof J}:function(J){return J&&typeof Symbol=="function"&&J.constructor===Symbol&&J!==Symbol.prototype?"symbol":typeof J},e9($)}var lV=/^\s+/,cV=/\s+$/;function B0($,J){if($=$?$:"",J=J||{},$ instanceof B0)return $;if(!(this instanceof B0))return new B0($,J);var X=dV($);if(this._originalInput=$,this._r=X.r,this._g=X.g,this._b=X.b,this._a=X.a,this._roundA=Math.round(100*this._a)/100,this._format=J.format||X.format,this._gradientType=J.gradientType,this._r<1)this._r=Math.round(this._r);if(this._g<1)this._g=Math.round(this._g);if(this._b<1)this._b=Math.round(this._b);this._ok=X.ok}B0.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var J=this.toRgb();return(J.r*299+J.g*587+J.b*114)/1000},getLuminance:function(){var J=this.toRgb(),X,K,q,Y,W,Q;if(X=J.r/255,K=J.g/255,q=J.b/255,X<=0.03928)Y=X/12.92;else Y=Math.pow((X+0.055)/1.055,2.4);if(K<=0.03928)W=K/12.92;else W=Math.pow((K+0.055)/1.055,2.4);if(q<=0.03928)Q=q/12.92;else Q=Math.pow((q+0.055)/1.055,2.4);return 0.2126*Y+0.7152*W+0.0722*Q},setAlpha:function(J){return this._a=DX(J),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var J=FX(this._r,this._g,this._b);return{h:J.h*360,s:J.s,v:J.v,a:this._a}},toHsvString:function(){var J=FX(this._r,this._g,this._b),X=Math.round(J.h*360),K=Math.round(J.s*100),q=Math.round(J.v*100);return this._a==1?"hsv("+X+", "+K+"%, "+q+"%)":"hsva("+X+", "+K+"%, "+q+"%, "+this._roundA+")"},toHsl:function(){var J=AX(this._r,this._g,this._b);return{h:J.h*360,s:J.s,l:J.l,a:this._a}},toHslString:function(){var J=AX(this._r,this._g,this._b),X=Math.round(J.h*360),K=Math.round(J.s*100),q=Math.round(J.l*100);return this._a==1?"hsl("+X+", "+K+"%, "+q+"%)":"hsla("+X+", "+K+"%, "+q+"%, "+this._roundA+")"},toHex:function(J){return zX(this._r,this._g,this._b,J)},toHexString:function(J){return"#"+this.toHex(J)},toHex8:function(J){return iV(this._r,this._g,this._b,this._a,J)},toHex8String:function(J){return"#"+this.toHex8(J)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(e0(this._r,255)*100)+"%",g:Math.round(e0(this._g,255)*100)+"%",b:Math.round(e0(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(e0(this._r,255)*100)+"%, "+Math.round(e0(this._g,255)*100)+"%, "+Math.round(e0(this._b,255)*100)+"%)":"rgba("+Math.round(e0(this._r,255)*100)+"%, "+Math.round(e0(this._g,255)*100)+"%, "+Math.round(e0(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){if(this._a===0)return"transparent";if(this._a<1)return!1;return QG[zX(this._r,this._g,this._b,!0)]||!1},toFilter:function(J){var X="#"+vX(this._r,this._g,this._b,this._a),K=X,q=this._gradientType?"GradientType = 1, ":"";if(J){var Y=B0(J);K="#"+vX(Y._r,Y._g,Y._b,Y._a)}return"progid:DXImageTransform.Microsoft.gradient("+q+"startColorstr="+X+",endColorstr="+K+")"},toString:function(J){var X=!!J;J=J||this._format;var K=!1,q=this._a<1&&this._a>=0,Y=!X&&q&&(J==="hex"||J==="hex6"||J==="hex3"||J==="hex4"||J==="hex8"||J==="name");if(Y){if(J==="name"&&this._a===0)return this.toName();return this.toRgbString()}if(J==="rgb")K=this.toRgbString();if(J==="prgb")K=this.toPercentageRgbString();if(J==="hex"||J==="hex6")K=this.toHexString();if(J==="hex3")K=this.toHexString(!0);if(J==="hex4")K=this.toHex8String(!0);if(J==="hex8")K=this.toHex8String();if(J==="name")K=this.toName();if(J==="hsl")K=this.toHslString();if(J==="hsv")K=this.toHsvString();return K||this.toHexString()},clone:function(){return B0(this.toString())},_applyModification:function(J,X){var K=J.apply(null,[this].concat([].slice.call(X)));return this._r=K._r,this._g=K._g,this._b=K._b,this.setAlpha(K._a),this},lighten:function(){return this._applyModification(eV,arguments)},brighten:function(){return this._applyModification($G,arguments)},darken:function(){return this._applyModification(JG,arguments)},desaturate:function(){return this._applyModification(sV,arguments)},saturate:function(){return this._applyModification(aV,arguments)},greyscale:function(){return this._applyModification(tV,arguments)},spin:function(){return this._applyModification(XG,arguments)},_applyCombination:function(J,X){return J.apply(null,[this].concat([].slice.call(X)))},analogous:function(){return this._applyCombination(YG,arguments)},complement:function(){return this._applyCombination(KG,arguments)},monochromatic:function(){return this._applyCombination(WG,arguments)},splitcomplement:function(){return this._applyCombination(qG,arguments)},triad:function(){return this._applyCombination(CX,[3])},tetrad:function(){return this._applyCombination(CX,[4])}};B0.fromRatio=function($,J){if(e9($)=="object"){var X={};for(var K in $)if($.hasOwnProperty(K))if(K==="a")X[K]=$[K];else X[K]=s5($[K]);$=X}return B0($,J)};function dV($){var J={r:0,g:0,b:0},X=1,K=null,q=null,Y=null,W=!1,Q=!1;if(typeof $=="string")$=GG($);if(e9($)=="object"){if(m8($.r)&&m8($.g)&&m8($.b))J=nV($.r,$.g,$.b),W=!0,Q=String($.r).substr(-1)==="%"?"prgb":"rgb";else if(m8($.h)&&m8($.s)&&m8($.v))K=s5($.s),q=s5($.v),J=rV($.h,K,q),W=!0,Q="hsv";else if(m8($.h)&&m8($.s)&&m8($.l))K=s5($.s),Y=s5($.l),J=oV($.h,K,Y),W=!0,Q="hsl";if($.hasOwnProperty("a"))X=$.a}return X=DX(X),{ok:W,format:$.format||Q,r:Math.min(255,Math.max(J.r,0)),g:Math.min(255,Math.max(J.g,0)),b:Math.min(255,Math.max(J.b,0)),a:X}}function nV($,J,X){return{r:e0($,255)*255,g:e0(J,255)*255,b:e0(X,255)*255}}function AX($,J,X){$=e0($,255),J=e0(J,255),X=e0(X,255);var K=Math.max($,J,X),q=Math.min($,J,X),Y,W,Q=(K+q)/2;if(K==q)Y=W=0;else{var N=K-q;switch(W=Q>0.5?N/(2-K-q):N/(K+q),K){case $:Y=(J-X)/N+(J<X?6:0);break;case J:Y=(X-$)/N+2;break;case X:Y=($-J)/N+4;break}Y/=6}return{h:Y,s:W,l:Q}}function oV($,J,X){var K,q,Y;$=e0($,360),J=e0(J,100),X=e0(X,100);function W(M,V,G){if(G<0)G+=1;if(G>1)G-=1;if(G<0.16666666666666666)return M+(V-M)*6*G;if(G<0.5)return V;if(G<0.6666666666666666)return M+(V-M)*(0.6666666666666666-G)*6;return M}if(J===0)K=q=Y=X;else{var Q=X<0.5?X*(1+J):X+J-X*J,N=2*X-Q;K=W(N,Q,$+0.3333333333333333),q=W(N,Q,$),Y=W(N,Q,$-0.3333333333333333)}return{r:K*255,g:q*255,b:Y*255}}function FX($,J,X){$=e0($,255),J=e0(J,255),X=e0(X,255);var K=Math.max($,J,X),q=Math.min($,J,X),Y,W,Q=K,N=K-q;if(W=K===0?0:N/K,K==q)Y=0;else{switch(K){case $:Y=(J-X)/N+(J<X?6:0);break;case J:Y=(X-$)/N+2;break;case X:Y=($-J)/N+4;break}Y/=6}return{h:Y,s:W,v:Q}}function rV($,J,X){$=e0($,360)*6,J=e0(J,100),X=e0(X,100);var K=Math.floor($),q=$-K,Y=X*(1-J),W=X*(1-q*J),Q=X*(1-(1-q)*J),N=K%6,M=[X,W,Y,Y,Q,X][N],V=[Q,X,X,W,Y,Y][N],G=[Y,Y,Q,X,X,W][N];return{r:M*255,g:V*255,b:G*255}}function zX($,J,X,K){var q=[W8(Math.round($).toString(16)),W8(Math.round(J).toString(16)),W8(Math.round(X).toString(16))];if(K&&q[0].charAt(0)==q[0].charAt(1)&&q[1].charAt(0)==q[1].charAt(1)&&q[2].charAt(0)==q[2].charAt(1))return q[0].charAt(0)+q[1].charAt(0)+q[2].charAt(0);return q.join("")}function iV($,J,X,K,q){var Y=[W8(Math.round($).toString(16)),W8(Math.round(J).toString(16)),W8(Math.round(X).toString(16)),W8(kX(K))];if(q&&Y[0].charAt(0)==Y[0].charAt(1)&&Y[1].charAt(0)==Y[1].charAt(1)&&Y[2].charAt(0)==Y[2].charAt(1)&&Y[3].charAt(0)==Y[3].charAt(1))return Y[0].charAt(0)+Y[1].charAt(0)+Y[2].charAt(0)+Y[3].charAt(0);return Y.join("")}function vX($,J,X,K){var q=[W8(kX(K)),W8(Math.round($).toString(16)),W8(Math.round(J).toString(16)),W8(Math.round(X).toString(16))];return q.join("")}B0.equals=function($,J){if(!$||!J)return!1;return B0($).toRgbString()==B0(J).toRgbString()};B0.random=function(){return B0.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function sV($,J){J=J===0?0:J||10;var X=B0($).toHsl();return X.s-=J/100,X.s=$$(X.s),B0(X)}function aV($,J){J=J===0?0:J||10;var X=B0($).toHsl();return X.s+=J/100,X.s=$$(X.s),B0(X)}function tV($){return B0($).desaturate(100)}function eV($,J){J=J===0?0:J||10;var X=B0($).toHsl();return X.l+=J/100,X.l=$$(X.l),B0(X)}function $G($,J){J=J===0?0:J||10;var X=B0($).toRgb();return X.r=Math.max(0,Math.min(255,X.r-Math.round(255*-(J/100)))),X.g=Math.max(0,Math.min(255,X.g-Math.round(255*-(J/100)))),X.b=Math.max(0,Math.min(255,X.b-Math.round(255*-(J/100)))),B0(X)}function JG($,J){J=J===0?0:J||10;var X=B0($).toHsl();return X.l-=J/100,X.l=$$(X.l),B0(X)}function XG($,J){var X=B0($).toHsl(),K=(X.h+J)%360;return X.h=K<0?360+K:K,B0(X)}function KG($){var J=B0($).toHsl();return J.h=(J.h+180)%360,B0(J)}function CX($,J){if(isNaN(J)||J<=0)throw Error("Argument to polyad must be a positive number");var X=B0($).toHsl(),K=[B0($)],q=360/J;for(var Y=1;Y<J;Y++)K.push(B0({h:(X.h+Y*q)%360,s:X.s,l:X.l}));return K}function qG($){var J=B0($).toHsl(),X=J.h;return[B0($),B0({h:(X+72)%360,s:J.s,l:J.l}),B0({h:(X+216)%360,s:J.s,l:J.l})]}function YG($,J,X){J=J||6,X=X||30;var K=B0($).toHsl(),q=360/X,Y=[B0($)];for(K.h=(K.h-(q*J>>1)+720)%360;--J;)K.h=(K.h+q)%360,Y.push(B0(K));return Y}function WG($,J){J=J||6;var X=B0($).toHsv(),K=X.h,q=X.s,Y=X.v,W=[],Q=1/J;while(J--)W.push(B0({h:K,s:q,v:Y})),Y=(Y+Q)%1;return W}B0.mix=function($,J,X){X=X===0?0:X||50;var K=B0($).toRgb(),q=B0(J).toRgb(),Y=X/100,W={r:(q.r-K.r)*Y+K.r,g:(q.g-K.g)*Y+K.g,b:(q.b-K.b)*Y+K.b,a:(q.a-K.a)*Y+K.a};return B0(W)};B0.readability=function($,J){var X=B0($),K=B0(J);return(Math.max(X.getLuminance(),K.getLuminance())+0.05)/(Math.min(X.getLuminance(),K.getLuminance())+0.05)};B0.isReadable=function($,J,X){var K=B0.readability($,J),q,Y;switch(Y=!1,q=HG(X),q.level+q.size){case"AAsmall":case"AAAlarge":Y=K>=4.5;break;case"AAlarge":Y=K>=3;break;case"AAAsmall":Y=K>=7;break}return Y};B0.mostReadable=function($,J,X){var K=null,q=0,Y,W,Q,N;X=X||{},W=X.includeFallbackColors,Q=X.level,N=X.size;for(var M=0;M<J.length;M++)if(Y=B0.readability($,J[M]),Y>q)q=Y,K=B0(J[M]);if(B0.isReadable($,K,{level:Q,size:N})||!W)return K;else return X.includeFallbackColors=!1,B0.mostReadable($,["#fff","#000"],X)};var T7=B0.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},QG=B0.hexNames=NG(T7);function NG($){var J={};for(var X in $)if($.hasOwnProperty(X))J[$[X]]=X;return J}function DX($){if($=parseFloat($),isNaN($)||$<0||$>1)$=1;return $}function e0($,J){if(MG($))$="100%";var X=VG($);if($=Math.min(J,Math.max(0,parseFloat($))),X)$=parseInt($*J,10)/100;if(Math.abs($-J)<0.000001)return 1;return $%J/parseFloat(J)}function $$($){return Math.min(1,Math.max(0,$))}function y6($){return parseInt($,16)}function MG($){return typeof $=="string"&&$.indexOf(".")!=-1&&parseFloat($)===1}function VG($){return typeof $==="string"&&$.indexOf("%")!=-1}function W8($){return $.length==1?"0"+$:""+$}function s5($){if($<=1)$=$*100+"%";return $}function kX($){return Math.round(parseFloat($)*255).toString(16)}function ZX($){return y6($)/255}var Y8=function(){var $="[-\\+]?\\d+%?",J="[-\\+]?\\d*\\.\\d+%?",X="(?:"+J+")|(?:"+$+")",K="[\\s|\\(]+("+X+")[,|\\s]+("+X+")[,|\\s]+("+X+")\\s*\\)?",q="[\\s|\\(]+("+X+")[,|\\s]+("+X+")[,|\\s]+("+X+")[,|\\s]+("+X+")\\s*\\)?";return{CSS_UNIT:new RegExp(X),rgb:new RegExp("rgb"+K),rgba:new RegExp("rgba"+q),hsl:new RegExp("hsl"+K),hsla:new RegExp("hsla"+q),hsv:new RegExp("hsv"+K),hsva:new RegExp("hsva"+q),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function m8($){return!!Y8.CSS_UNIT.exec($)}function GG($){$=$.replace(lV,"").replace(cV,"").toLowerCase();var J=!1;if(T7[$])$=T7[$],J=!0;else if($=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var X;if(X=Y8.rgb.exec($))return{r:X[1],g:X[2],b:X[3]};if(X=Y8.rgba.exec($))return{r:X[1],g:X[2],b:X[3],a:X[4]};if(X=Y8.hsl.exec($))return{h:X[1],s:X[2],l:X[3]};if(X=Y8.hsla.exec($))return{h:X[1],s:X[2],l:X[3],a:X[4]};if(X=Y8.hsv.exec($))return{h:X[1],s:X[2],v:X[3]};if(X=Y8.hsva.exec($))return{h:X[1],s:X[2],v:X[3],a:X[4]};if(X=Y8.hex8.exec($))return{r:y6(X[1]),g:y6(X[2]),b:y6(X[3]),a:ZX(X[4]),format:J?"name":"hex8"};if(X=Y8.hex6.exec($))return{r:y6(X[1]),g:y6(X[2]),b:y6(X[3]),format:J?"name":"hex"};if(X=Y8.hex4.exec($))return{r:y6(X[1]+""+X[1]),g:y6(X[2]+""+X[2]),b:y6(X[3]+""+X[3]),a:ZX(X[4]+""+X[4]),format:J?"name":"hex8"};if(X=Y8.hex3.exec($))return{r:y6(X[1]+""+X[1]),g:y6(X[2]+""+X[2]),b:y6(X[3]+""+X[3]),format:J?"name":"hex"};return!1}function HG($){var J,X;if($=$||{level:"AA",size:"small"},J=($.level||"AA").toUpperCase(),X=($.size||"small").toLowerCase(),J!=="AA"&&J!=="AAA")J="AA";if(X!=="small"&&X!=="large")X="small";return{level:J,size:X}}function x6($){let J={width:$.bitmap.width,height:$.bitmap.height,data:Buffer.from($.bitmap.data)};return new $.constructor(J)}function o6($,J,X,K,q,Y){let W,Q,N,M,V;if(typeof J==="function")V=J,W=0,Q=0,N=$.bitmap.width,M=$.bitmap.height;else{if(W=J,typeof X!=="number")throw Error("y must be a number");if(Q=X,typeof K!=="number")throw Error("w must be a number");if(N=K,typeof q!=="number")throw Error("h must be a number");if(M=q,typeof Y!=="function")throw Error("cb must be a function");V=Y}W=Math.round(W),Q=Math.round(Q),N=Math.round(N),M=Math.round(M);let G=V.bind($);for(let H=Q;H<Q+M;H++)for(let O=W;O<W+N;O++){let L=$.bitmap.width*H+O<<2;G(O,H,L)}return $}function*wX($,J,X,K,q){J=Math.round(J),X=Math.round(X),K=Math.round(K),q=Math.round(q);for(let Y=X;Y<X+q;Y++)for(let W=J;W<J+K;W++){let Q=$.bitmap.width*Y+W<<2;yield{x:W,y:Y,idx:Q,image:$}}}function r1($){if(typeof $!=="number")throw Error("i must be a number");let J={r:0,g:0,b:0,a:0};return J.r=Math.floor($/Math.pow(256,3)),J.g=Math.floor(($-J.r*Math.pow(256,3))/Math.pow(256,2)),J.b=Math.floor(($-J.r*Math.pow(256,3)-J.g*Math.pow(256,2))/Math.pow(256,1)),J.a=Math.floor(($-J.r*Math.pow(256,3)-J.g*Math.pow(256,2)-J.b*Math.pow(256,1))/Math.pow(256,0)),J}function a5($,J){let X=(Q)=>Math.pow(Q,2),{max:K}=Math,q=195075,Y="a"in $?$.a:255,W="a"in J?J.a:255;return(K(X($.r-J.r),X($.r-J.r-Y+W))+K(X($.g-J.g),X($.g-J.g-Y+W))+K(X($.b-J.b),X($.b-J.b-Y+W)))/195075}function $6($){return $=Math.max($,0),$=Math.min($,255),$}function TX($){if(typeof $==="number")return $;return parseInt(B0($).toHex8(),16)}function IX($,J={}){return o6({bitmap:$},0,0,$.width,$.height,function(X,K,q){let Y=$.data[q+0],W=$.data[q+1],Q=$.data[q+2],N=$.data[q+3];$.data[q+0]=N,$.data[q+1]=Q,$.data[q+2]=W,$.data[q+3]=Y}),SX({...$,...J}).data}function _X($,J){let X=PX($,J);return o6({bitmap:X},0,0,X.width,X.height,function(K,q,Y){let W=X.data[Y+1],Q=X.data[Y+2],N=X.data[Y+3];X.data[Y+0]=N,X.data[Y+1]=Q,X.data[Y+2]=W,X.data[Y+3]=255}),X}function yX(){return{mime:"image/x-ms-bmp",encode:IX,decode:_X}}function J$(){return{mime:"image/bmp",encode:IX,decode:_X}}var fK=h8(I7(),1),Y1=h8(gK(),1);function H$(){return{mime:"image/gif",encode:async($)=>{let J=new Y1.BitmapImage($);Y1.GifUtil.quantizeDekker(J,256);let X=new Y1.GifFrame($);return(await new Y1.GifCodec().encodeGif([X],{})).buffer},decode:($)=>{let J=new fK.default.GifReader($),X=Buffer.alloc(J.width*J.height*4);return J.decodeAndBlitFrameRGBA(0,X),{data:X,width:J.width,height:J.height}}}}var n7=h8(dK(),1);function U$(){return{mime:"image/jpeg",encode:($,{quality:J=100}={})=>n7.default.encode($,J).data,decode:($,J)=>n7.default.decode($,J)}}var E$=h8(gq(),1);var L$;(function($){$[$.AUTO=-1]="AUTO",$[$.NONE=0]="NONE",$[$.SUB=1]="SUB",$[$.UP=2]="UP",$[$.AVERAGE=3]="AVERAGE",$[$.PATH=4]="PATH"})(L$||(L$={}));var Q9;(function($){$[$.GRAYSCALE=0]="GRAYSCALE",$[$.COLOR=2]="COLOR",$[$.GRAYSCALE_ALPHA=4]="GRAYSCALE_ALPHA",$[$.COLOR_ALPHA=6]="COLOR_ALPHA"})(Q9||(Q9={}));function j$(){return{mime:"image/png",hasAlpha:!0,encode:($,{deflateLevel:J=9,deflateStrategy:X=3,filterType:K=L$.AUTO,colorType:q,inputHasAlpha:Y=!0,...W}={})=>{let Q=new E$.PNG({width:$.width,height:$.height});return Q.data=$.data,E$.PNG.sync.write(Q,{...W,deflateLevel:J,deflateStrategy:X,filterType:K,colorType:typeof q<"u"?q:Y?Q9.COLOR_ALPHA:Q9.COLOR,inputHasAlpha:Y})},decode:($,J)=>{let X=E$.PNG.sync.read($,J);return{data:X.data,width:X.width,height:X.height}}}}var A9=h8(CW(),1);function ZW($){if(typeof $==="number")return $;if($ instanceof Uint8Array)return $[0];if(typeof $[0]==="string")return parseInt($[0]);return $[0]}function y$(){return{mime:"image/tiff",encode:($)=>{let J=A9.default.encodeImage($.data,$.width,$.height);return Buffer.from(J)},decode:($)=>{let J=A9.default.decode($),X=J[0];if(!X)throw Error("No page found in TIFF");if(!X.t256)throw Error("No image width found in TIFF");if(!X.t257)throw Error("No image height found in TIFF");J.forEach((q)=>{A9.default.decodeImage($,q)});let K=A9.default.toRGBA8(X);return{data:Buffer.from(K),width:ZW(X.t256),height:ZW(X.t257)}}}}var f={};f4(f,{void:()=>LE,util:()=>c0,unknown:()=>OE,union:()=>BE,undefined:()=>VE,tuple:()=>AE,transformer:()=>IE,symbol:()=>ME,string:()=>hW,strictObject:()=>RE,setErrorMap:()=>yL,set:()=>vE,record:()=>FE,quotelessJson:()=>IL,promise:()=>TE,preprocess:()=>xE,pipeline:()=>hE,ostring:()=>gE,optional:()=>_E,onumber:()=>fE,oboolean:()=>bE,objectUtil:()=>lJ,object:()=>jE,number:()=>gW,nullable:()=>yE,null:()=>GE,never:()=>UE,nativeEnum:()=>wE,nan:()=>WE,map:()=>zE,makeIssue:()=>F9,literal:()=>DE,lazy:()=>ZE,late:()=>qE,isValid:()=>U1,isDirty:()=>h$,isAsync:()=>U5,isAborted:()=>x$,intersection:()=>SE,instanceof:()=>YE,getParsedType:()=>w8,getErrorMap:()=>O5,function:()=>CE,enum:()=>kE,effect:()=>IE,discriminatedUnion:()=>PE,defaultErrorMap:()=>o8,datetimeRegex:()=>_W,date:()=>NE,custom:()=>xW,coerce:()=>mE,boolean:()=>fW,bigint:()=>QE,array:()=>EE,any:()=>HE,addIssueToContext:()=>E0,ZodVoid:()=>v9,ZodUnknown:()=>L1,ZodUnion:()=>P5,ZodUndefined:()=>R5,ZodType:()=>p0,ZodTuple:()=>I8,ZodTransformer:()=>U8,ZodSymbol:()=>z9,ZodString:()=>V8,ZodSet:()=>l1,ZodSchema:()=>p0,ZodRecord:()=>C9,ZodReadonly:()=>Z5,ZodPromise:()=>c1,ZodPipeline:()=>k9,ZodParsedType:()=>H0,ZodOptional:()=>H8,ZodObject:()=>W6,ZodNumber:()=>E1,ZodNullable:()=>i8,ZodNull:()=>B5,ZodNever:()=>T8,ZodNativeEnum:()=>z5,ZodNaN:()=>D9,ZodMap:()=>Z9,ZodLiteral:()=>F5,ZodLazy:()=>A5,ZodIssueCode:()=>Q0,ZodIntersection:()=>S5,ZodFunction:()=>E5,ZodFirstPartyTypeKind:()=>D0,ZodError:()=>I6,ZodEnum:()=>R1,ZodEffects:()=>U8,ZodDiscriminatedUnion:()=>g$,ZodDefault:()=>v5,ZodDate:()=>p1,ZodCatch:()=>C5,ZodBranded:()=>f$,ZodBoolean:()=>j5,ZodBigInt:()=>j1,ZodArray:()=>G8,ZodAny:()=>u1,Schema:()=>p0,ParseStatus:()=>R6,OK:()=>A6,NEVER:()=>pE,INVALID:()=>C0,EMPTY_PATH:()=>xL,DIRTY:()=>m1,BRAND:()=>KE});var c0;(function($){$.assertEqual=(q)=>{};function J(q){}$.assertIs=J;function X(q){throw Error()}$.assertNever=X,$.arrayToEnum=(q)=>{let Y={};for(let W of q)Y[W]=W;return Y},$.getValidEnumValues=(q)=>{let Y=$.objectKeys(q).filter((Q)=>typeof q[q[Q]]!=="number"),W={};for(let Q of Y)W[Q]=q[Q];return $.objectValues(W)},$.objectValues=(q)=>{return $.objectKeys(q).map(function(Y){return q[Y]})},$.objectKeys=typeof Object.keys==="function"?(q)=>Object.keys(q):(q)=>{let Y=[];for(let W in q)if(Object.prototype.hasOwnProperty.call(q,W))Y.push(W);return Y},$.find=(q,Y)=>{for(let W of q)if(Y(W))return W;return},$.isInteger=typeof Number.isInteger==="function"?(q)=>Number.isInteger(q):(q)=>typeof q==="number"&&Number.isFinite(q)&&Math.floor(q)===q;function K(q,Y=" | "){return q.map((W)=>typeof W==="string"?`'${W}'`:W).join(Y)}$.joinValues=K,$.jsonStringifyReplacer=(q,Y)=>{if(typeof Y==="bigint")return Y.toString();return Y}})(c0||(c0={}));var lJ;(function($){$.mergeShapes=(J,X)=>{return{...J,...X}}})(lJ||(lJ={}));var H0=c0.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),w8=($)=>{switch(typeof $){case"undefined":return H0.undefined;case"string":return H0.string;case"number":return Number.isNaN($)?H0.nan:H0.number;case"boolean":return H0.boolean;case"function":return H0.function;case"bigint":return H0.bigint;case"symbol":return H0.symbol;case"object":if(Array.isArray($))return H0.array;if($===null)return H0.null;if($.then&&typeof $.then==="function"&&$.catch&&typeof $.catch==="function")return H0.promise;if(typeof Map<"u"&&$ instanceof Map)return H0.map;if(typeof Set<"u"&&$ instanceof Set)return H0.set;if(typeof Date<"u"&&$ instanceof Date)return H0.date;return H0.object;default:return H0.unknown}};var Q0=c0.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),IL=($)=>{return JSON.stringify($,null,2).replace(/"([^"]+)":/g,"$1:")};class I6 extends Error{get errors(){return this.issues}constructor($){super();this.issues=[],this.addIssue=(X)=>{this.issues=[...this.issues,X]},this.addIssues=(X=[])=>{this.issues=[...this.issues,...X]};let J=new.target.prototype;if(Object.setPrototypeOf)Object.setPrototypeOf(this,J);else this.__proto__=J;this.name="ZodError",this.issues=$}format($){let J=$||function(q){return q.message},X={_errors:[]},K=(q)=>{for(let Y of q.issues)if(Y.code==="invalid_union")Y.unionErrors.map(K);else if(Y.code==="invalid_return_type")K(Y.returnTypeError);else if(Y.code==="invalid_arguments")K(Y.argumentsError);else if(Y.path.length===0)X._errors.push(J(Y));else{let W=X,Q=0;while(Q<Y.path.length){let N=Y.path[Q];if(Q!==Y.path.length-1)W[N]=W[N]||{_errors:[]};else W[N]=W[N]||{_errors:[]},W[N]._errors.push(J(Y));W=W[N],Q++}}};return K(this),X}static assert($){if(!($ instanceof I6))throw Error(`Not a ZodError: ${$}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,c0.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten($=(J)=>J.message){let J={},X=[];for(let K of this.issues)if(K.path.length>0){let q=K.path[0];J[q]=J[q]||[],J[q].push($(K))}else X.push($(K));return{formErrors:X,fieldErrors:J}}get formErrors(){return this.flatten()}}I6.create=($)=>{return new I6($)};var _L=($,J)=>{let X;switch($.code){case Q0.invalid_type:if($.received===H0.undefined)X="Required";else X=`Expected ${$.expected}, received ${$.received}`;break;case Q0.invalid_literal:X=`Invalid literal value, expected ${JSON.stringify($.expected,c0.jsonStringifyReplacer)}`;break;case Q0.unrecognized_keys:X=`Unrecognized key(s) in object: ${c0.joinValues($.keys,", ")}`;break;case Q0.invalid_union:X="Invalid input";break;case Q0.invalid_union_discriminator:X=`Invalid discriminator value. Expected ${c0.joinValues($.options)}`;break;case Q0.invalid_enum_value:X=`Invalid enum value. Expected ${c0.joinValues($.options)}, received '${$.received}'`;break;case Q0.invalid_arguments:X="Invalid function arguments";break;case Q0.invalid_return_type:X="Invalid function return type";break;case Q0.invalid_date:X="Invalid date";break;case Q0.invalid_string:if(typeof $.validation==="object")if("includes"in $.validation){if(X=`Invalid input: must include "${$.validation.includes}"`,typeof $.validation.position==="number")X=`${X} at one or more positions greater than or equal to ${$.validation.position}`}else if("startsWith"in $.validation)X=`Invalid input: must start with "${$.validation.startsWith}"`;else if("endsWith"in $.validation)X=`Invalid input: must end with "${$.validation.endsWith}"`;else c0.assertNever($.validation);else if($.validation!=="regex")X=`Invalid ${$.validation}`;else X="Invalid";break;case Q0.too_small:if($.type==="array")X=`Array must contain ${$.exact?"exactly":$.inclusive?"at least":"more than"} ${$.minimum} element(s)`;else if($.type==="string")X=`String must contain ${$.exact?"exactly":$.inclusive?"at least":"over"} ${$.minimum} character(s)`;else if($.type==="number")X=`Number must be ${$.exact?"exactly equal to ":$.inclusive?"greater than or equal to ":"greater than "}${$.minimum}`;else if($.type==="bigint")X=`Number must be ${$.exact?"exactly equal to ":$.inclusive?"greater than or equal to ":"greater than "}${$.minimum}`;else if($.type==="date")X=`Date must be ${$.exact?"exactly equal to ":$.inclusive?"greater than or equal to ":"greater than "}${new Date(Number($.minimum))}`;else X="Invalid input";break;case Q0.too_big:if($.type==="array")X=`Array must contain ${$.exact?"exactly":$.inclusive?"at most":"less than"} ${$.maximum} element(s)`;else if($.type==="string")X=`String must contain ${$.exact?"exactly":$.inclusive?"at most":"under"} ${$.maximum} character(s)`;else if($.type==="number")X=`Number must be ${$.exact?"exactly":$.inclusive?"less than or equal to":"less than"} ${$.maximum}`;else if($.type==="bigint")X=`BigInt must be ${$.exact?"exactly":$.inclusive?"less than or equal to":"less than"} ${$.maximum}`;else if($.type==="date")X=`Date must be ${$.exact?"exactly":$.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number($.maximum))}`;else X="Invalid input";break;case Q0.custom:X="Invalid input";break;case Q0.invalid_intersection_types:X="Intersection results could not be merged";break;case Q0.not_multiple_of:X=`Number must be a multiple of ${$.multipleOf}`;break;case Q0.not_finite:X="Number must be finite";break;default:X=J.defaultError,c0.assertNever($)}return{message:X}},o8=_L;var DW=o8;function yL($){DW=$}function O5(){return DW}var F9=($)=>{let{data:J,path:X,errorMaps:K,issueData:q}=$,Y=[...X,...q.path||[]],W={...q,path:Y};if(q.message!==void 0)return{...q,path:Y,message:q.message};let Q="",N=K.filter((M)=>!!M).slice().reverse();for(let M of N)Q=M(W,{data:J,defaultError:Q}).message;return{...q,path:Y,message:Q}},xL=[];function E0($,J){let X=O5(),K=F9({issueData:J,data:$.data,path:$.path,errorMaps:[$.common.contextualErrorMap,$.schemaErrorMap,X,X===o8?void 0:o8].filter((q)=>!!q)});$.common.issues.push(K)}class R6{constructor(){this.value="valid"}dirty(){if(this.value==="valid")this.value="dirty"}abort(){if(this.value!=="aborted")this.value="aborted"}static mergeArray($,J){let X=[];for(let K of J){if(K.status==="aborted")return C0;if(K.status==="dirty")$.dirty();X.push(K.value)}return{status:$.value,value:X}}static async mergeObjectAsync($,J){let X=[];for(let K of J){let q=await K.key,Y=await K.value;X.push({key:q,value:Y})}return R6.mergeObjectSync($,X)}static mergeObjectSync($,J){let X={};for(let K of J){let{key:q,value:Y}=K;if(q.status==="aborted")return C0;if(Y.status==="aborted")return C0;if(q.status==="dirty")$.dirty();if(Y.status==="dirty")$.dirty();if(q.value!=="__proto__"&&(typeof Y.value<"u"||K.alwaysSet))X[q.value]=Y.value}return{status:$.value,value:X}}}var C0=Object.freeze({status:"aborted"}),m1=($)=>({status:"dirty",value:$}),A6=($)=>({status:"valid",value:$}),x$=($)=>$.status==="aborted",h$=($)=>$.status==="dirty",U1=($)=>$.status==="valid",U5=($)=>typeof Promise<"u"&&$ instanceof Promise;var P0;(function($){$.errToObj=(J)=>typeof J==="string"?{message:J}:J||{},$.toString=(J)=>typeof J==="string"?J:J?.message})(P0||(P0={}));class O8{constructor($,J,X,K){this._cachedPath=[],this.parent=$,this.data=J,this._path=X,this._key=K}get path(){if(!this._cachedPath.length)if(Array.isArray(this._key))this._cachedPath.push(...this._path,...this._key);else this._cachedPath.push(...this._path,this._key);return this._cachedPath}}var kW=($,J)=>{if(U1(J))return{success:!0,data:J.value};else{if(!$.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let X=new I6($.common.issues);return this._error=X,this._error}}}};function x0($){if(!$)return{};let{errorMap:J,invalid_type_error:X,required_error:K,description:q}=$;if(J&&(X||K))throw Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);if(J)return{errorMap:J,description:q};return{errorMap:(W,Q)=>{let{message:N}=$;if(W.code==="invalid_enum_value")return{message:N??Q.defaultError};if(typeof Q.data>"u")return{message:N??K??Q.defaultError};if(W.code!=="invalid_type")return{message:Q.defaultError};return{message:N??X??Q.defaultError}},description:q}}class p0{get description(){return this._def.description}_getType($){return w8($.data)}_getOrReturnCtx($,J){return J||{common:$.parent.common,data:$.data,parsedType:w8($.data),schemaErrorMap:this._def.errorMap,path:$.path,parent:$.parent}}_processInputParams($){return{status:new R6,ctx:{common:$.parent.common,data:$.data,parsedType:w8($.data),schemaErrorMap:this._def.errorMap,path:$.path,parent:$.parent}}}_parseSync($){let J=this._parse($);if(U5(J))throw Error("Synchronous parse encountered promise.");return J}_parseAsync($){let J=this._parse($);return Promise.resolve(J)}parse($,J){let X=this.safeParse($,J);if(X.success)return X.data;throw X.error}safeParse($,J){let X={common:{issues:[],async:J?.async??!1,contextualErrorMap:J?.errorMap},path:J?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:$,parsedType:w8($)},K=this._parseSync({data:$,path:X.path,parent:X});return kW(X,K)}"~validate"($){let J={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:$,parsedType:w8($)};if(!this["~standard"].async)try{let X=this._parseSync({data:$,path:[],parent:J});return U1(X)?{value:X.value}:{issues:J.common.issues}}catch(X){if(X?.message?.toLowerCase()?.includes("encountered"))this["~standard"].async=!0;J.common={issues:[],async:!0}}return this._parseAsync({data:$,path:[],parent:J}).then((X)=>U1(X)?{value:X.value}:{issues:J.common.issues})}async parseAsync($,J){let X=await this.safeParseAsync($,J);if(X.success)return X.data;throw X.error}async safeParseAsync($,J){let X={common:{issues:[],contextualErrorMap:J?.errorMap,async:!0},path:J?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:$,parsedType:w8($)},K=this._parse({data:$,path:X.path,parent:X}),q=await(U5(K)?K:Promise.resolve(K));return kW(X,q)}refine($,J){let X=(K)=>{if(typeof J==="string"||typeof J>"u")return{message:J};else if(typeof J==="function")return J(K);else return J};return this._refinement((K,q)=>{let Y=$(K),W=()=>q.addIssue({code:Q0.custom,...X(K)});if(typeof Promise<"u"&&Y instanceof Promise)return Y.then((Q)=>{if(!Q)return W(),!1;else return!0});if(!Y)return W(),!1;else return!0})}refinement($,J){return this._refinement((X,K)=>{if(!$(X))return K.addIssue(typeof J==="function"?J(X,K):J),!1;else return!0})}_refinement($){return new U8({schema:this,typeName:D0.ZodEffects,effect:{type:"refinement",refinement:$}})}superRefine($){return this._refinement($)}constructor($){this.spa=this.safeParseAsync,this._def=$,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:(J)=>this["~validate"](J)}}optional(){return H8.create(this,this._def)}nullable(){return i8.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return G8.create(this)}promise(){return c1.create(this,this._def)}or($){return P5.create([this,$],this._def)}and($){return S5.create(this,$,this._def)}transform($){return new U8({...x0(this._def),schema:this,typeName:D0.ZodEffects,effect:{type:"transform",transform:$}})}default($){let J=typeof $==="function"?$:()=>$;return new v5({...x0(this._def),innerType:this,defaultValue:J,typeName:D0.ZodDefault})}brand(){return new f$({typeName:D0.ZodBranded,type:this,...x0(this._def)})}catch($){let J=typeof $==="function"?$:()=>$;return new C5({...x0(this._def),innerType:this,catchValue:J,typeName:D0.ZodCatch})}describe($){return new this.constructor({...this._def,description:$})}pipe($){return k9.create(this,$)}readonly(){return Z5.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}var hL=/^c[^\s-]{8,}$/i,gL=/^[0-9a-z]+$/,fL=/^[0-9A-HJKMNP-TV-Z]{26}$/i,bL=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,mL=/^[a-z0-9_-]{21}$/i,pL=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,uL=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,lL=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,cL="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",cJ,dL=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,nL=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,oL=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,rL=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,iL=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,sL=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,TW="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",aL=new RegExp(`^${TW}$`);function IW($){let J="[0-5]\\d";if($.precision)J=`${J}\\.\\d{${$.precision}}`;else if($.precision==null)J=`${J}(\\.\\d+)?`;let X=$.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${J})${X}`}function tL($){return new RegExp(`^${IW($)}$`)}function _W($){let J=`${TW}T${IW($)}`,X=[];if(X.push($.local?"Z?":"Z"),$.offset)X.push("([+-]\\d{2}:?\\d{2})");return J=`${J}(${X.join("|")})`,new RegExp(`^${J}$`)}function eL($,J){if((J==="v4"||!J)&&dL.test($))return!0;if((J==="v6"||!J)&&oL.test($))return!0;return!1}function $E($,J){if(!pL.test($))return!1;try{let[X]=$.split(".");if(!X)return!1;let K=X.replace(/-/g,"+").replace(/_/g,"/").padEnd(X.length+(4-X.length%4)%4,"="),q=JSON.parse(atob(K));if(typeof q!=="object"||q===null)return!1;if("typ"in q&&q?.typ!=="JWT")return!1;if(!q.alg)return!1;if(J&&q.alg!==J)return!1;return!0}catch{return!1}}function JE($,J){if((J==="v4"||!J)&&nL.test($))return!0;if((J==="v6"||!J)&&rL.test($))return!0;return!1}class V8 extends p0{_parse($){if(this._def.coerce)$.data=String($.data);if(this._getType($)!==H0.string){let q=this._getOrReturnCtx($);return E0(q,{code:Q0.invalid_type,expected:H0.string,received:q.parsedType}),C0}let X=new R6,K=void 0;for(let q of this._def.checks)if(q.kind==="min"){if($.data.length<q.value)K=this._getOrReturnCtx($,K),E0(K,{code:Q0.too_small,minimum:q.value,type:"string",inclusive:!0,exact:!1,message:q.message}),X.dirty()}else if(q.kind==="max"){if($.data.length>q.value)K=this._getOrReturnCtx($,K),E0(K,{code:Q0.too_big,maximum:q.value,type:"string",inclusive:!0,exact:!1,message:q.message}),X.dirty()}else if(q.kind==="length"){let Y=$.data.length>q.value,W=$.data.length<q.value;if(Y||W){if(K=this._getOrReturnCtx($,K),Y)E0(K,{code:Q0.too_big,maximum:q.value,type:"string",inclusive:!0,exact:!0,message:q.message});else if(W)E0(K,{code:Q0.too_small,minimum:q.value,type:"string",inclusive:!0,exact:!0,message:q.message});X.dirty()}}else if(q.kind==="email"){if(!lL.test($.data))K=this._getOrReturnCtx($,K),E0(K,{validation:"email",code:Q0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="emoji"){if(!cJ)cJ=new RegExp(cL,"u");if(!cJ.test($.data))K=this._getOrReturnCtx($,K),E0(K,{validation:"emoji",code:Q0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="uuid"){if(!bL.test($.data))K=this._getOrReturnCtx($,K),E0(K,{validation:"uuid",code:Q0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="nanoid"){if(!mL.test($.data))K=this._getOrReturnCtx($,K),E0(K,{validation:"nanoid",code:Q0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="cuid"){if(!hL.test($.data))K=this._getOrReturnCtx($,K),E0(K,{validation:"cuid",code:Q0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="cuid2"){if(!gL.test($.data))K=this._getOrReturnCtx($,K),E0(K,{validation:"cuid2",code:Q0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="ulid"){if(!fL.test($.data))K=this._getOrReturnCtx($,K),E0(K,{validation:"ulid",code:Q0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="url")try{new URL($.data)}catch{K=this._getOrReturnCtx($,K),E0(K,{validation:"url",code:Q0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="regex"){if(q.regex.lastIndex=0,!q.regex.test($.data))K=this._getOrReturnCtx($,K),E0(K,{validation:"regex",code:Q0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="trim")$.data=$.data.trim();else if(q.kind==="includes"){if(!$.data.includes(q.value,q.position))K=this._getOrReturnCtx($,K),E0(K,{code:Q0.invalid_string,validation:{includes:q.value,position:q.position},message:q.message}),X.dirty()}else if(q.kind==="toLowerCase")$.data=$.data.toLowerCase();else if(q.kind==="toUpperCase")$.data=$.data.toUpperCase();else if(q.kind==="startsWith"){if(!$.data.startsWith(q.value))K=this._getOrReturnCtx($,K),E0(K,{code:Q0.invalid_string,validation:{startsWith:q.value},message:q.message}),X.dirty()}else if(q.kind==="endsWith"){if(!$.data.endsWith(q.value))K=this._getOrReturnCtx($,K),E0(K,{code:Q0.invalid_string,validation:{endsWith:q.value},message:q.message}),X.dirty()}else if(q.kind==="datetime"){if(!_W(q).test($.data))K=this._getOrReturnCtx($,K),E0(K,{code:Q0.invalid_string,validation:"datetime",message:q.message}),X.dirty()}else if(q.kind==="date"){if(!aL.test($.data))K=this._getOrReturnCtx($,K),E0(K,{code:Q0.invalid_string,validation:"date",message:q.message}),X.dirty()}else if(q.kind==="time"){if(!tL(q).test($.data))K=this._getOrReturnCtx($,K),E0(K,{code:Q0.invalid_string,validation:"time",message:q.message}),X.dirty()}else if(q.kind==="duration"){if(!uL.test($.data))K=this._getOrReturnCtx($,K),E0(K,{validation:"duration",code:Q0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="ip"){if(!eL($.data,q.version))K=this._getOrReturnCtx($,K),E0(K,{validation:"ip",code:Q0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="jwt"){if(!$E($.data,q.alg))K=this._getOrReturnCtx($,K),E0(K,{validation:"jwt",code:Q0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="cidr"){if(!JE($.data,q.version))K=this._getOrReturnCtx($,K),E0(K,{validation:"cidr",code:Q0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="base64"){if(!iL.test($.data))K=this._getOrReturnCtx($,K),E0(K,{validation:"base64",code:Q0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="base64url"){if(!sL.test($.data))K=this._getOrReturnCtx($,K),E0(K,{validation:"base64url",code:Q0.invalid_string,message:q.message}),X.dirty()}else c0.assertNever(q);return{status:X.value,value:$.data}}_regex($,J,X){return this.refinement((K)=>$.test(K),{validation:J,code:Q0.invalid_string,...P0.errToObj(X)})}_addCheck($){return new V8({...this._def,checks:[...this._def.checks,$]})}email($){return this._addCheck({kind:"email",...P0.errToObj($)})}url($){return this._addCheck({kind:"url",...P0.errToObj($)})}emoji($){return this._addCheck({kind:"emoji",...P0.errToObj($)})}uuid($){return this._addCheck({kind:"uuid",...P0.errToObj($)})}nanoid($){return this._addCheck({kind:"nanoid",...P0.errToObj($)})}cuid($){return this._addCheck({kind:"cuid",...P0.errToObj($)})}cuid2($){return this._addCheck({kind:"cuid2",...P0.errToObj($)})}ulid($){return this._addCheck({kind:"ulid",...P0.errToObj($)})}base64($){return this._addCheck({kind:"base64",...P0.errToObj($)})}base64url($){return this._addCheck({kind:"base64url",...P0.errToObj($)})}jwt($){return this._addCheck({kind:"jwt",...P0.errToObj($)})}ip($){return this._addCheck({kind:"ip",...P0.errToObj($)})}cidr($){return this._addCheck({kind:"cidr",...P0.errToObj($)})}datetime($){if(typeof $==="string")return this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:$});return this._addCheck({kind:"datetime",precision:typeof $?.precision>"u"?null:$?.precision,offset:$?.offset??!1,local:$?.local??!1,...P0.errToObj($?.message)})}date($){return this._addCheck({kind:"date",message:$})}time($){if(typeof $==="string")return this._addCheck({kind:"time",precision:null,message:$});return this._addCheck({kind:"time",precision:typeof $?.precision>"u"?null:$?.precision,...P0.errToObj($?.message)})}duration($){return this._addCheck({kind:"duration",...P0.errToObj($)})}regex($,J){return this._addCheck({kind:"regex",regex:$,...P0.errToObj(J)})}includes($,J){return this._addCheck({kind:"includes",value:$,position:J?.position,...P0.errToObj(J?.message)})}startsWith($,J){return this._addCheck({kind:"startsWith",value:$,...P0.errToObj(J)})}endsWith($,J){return this._addCheck({kind:"endsWith",value:$,...P0.errToObj(J)})}min($,J){return this._addCheck({kind:"min",value:$,...P0.errToObj(J)})}max($,J){return this._addCheck({kind:"max",value:$,...P0.errToObj(J)})}length($,J){return this._addCheck({kind:"length",value:$,...P0.errToObj(J)})}nonempty($){return this.min(1,P0.errToObj($))}trim(){return new V8({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new V8({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new V8({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(($)=>$.kind==="datetime")}get isDate(){return!!this._def.checks.find(($)=>$.kind==="date")}get isTime(){return!!this._def.checks.find(($)=>$.kind==="time")}get isDuration(){return!!this._def.checks.find(($)=>$.kind==="duration")}get isEmail(){return!!this._def.checks.find(($)=>$.kind==="email")}get isURL(){return!!this._def.checks.find(($)=>$.kind==="url")}get isEmoji(){return!!this._def.checks.find(($)=>$.kind==="emoji")}get isUUID(){return!!this._def.checks.find(($)=>$.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(($)=>$.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(($)=>$.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(($)=>$.kind==="cuid2")}get isULID(){return!!this._def.checks.find(($)=>$.kind==="ulid")}get isIP(){return!!this._def.checks.find(($)=>$.kind==="ip")}get isCIDR(){return!!this._def.checks.find(($)=>$.kind==="cidr")}get isBase64(){return!!this._def.checks.find(($)=>$.kind==="base64")}get isBase64url(){return!!this._def.checks.find(($)=>$.kind==="base64url")}get minLength(){let $=null;for(let J of this._def.checks)if(J.kind==="min"){if($===null||J.value>$)$=J.value}return $}get maxLength(){let $=null;for(let J of this._def.checks)if(J.kind==="max"){if($===null||J.value<$)$=J.value}return $}}V8.create=($)=>{return new V8({checks:[],typeName:D0.ZodString,coerce:$?.coerce??!1,...x0($)})};function XE($,J){let X=($.toString().split(".")[1]||"").length,K=(J.toString().split(".")[1]||"").length,q=X>K?X:K,Y=Number.parseInt($.toFixed(q).replace(".","")),W=Number.parseInt(J.toFixed(q).replace(".",""));return Y%W/10**q}class E1 extends p0{constructor(){super(...arguments);this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse($){if(this._def.coerce)$.data=Number($.data);if(this._getType($)!==H0.number){let q=this._getOrReturnCtx($);return E0(q,{code:Q0.invalid_type,expected:H0.number,received:q.parsedType}),C0}let X=void 0,K=new R6;for(let q of this._def.checks)if(q.kind==="int"){if(!c0.isInteger($.data))X=this._getOrReturnCtx($,X),E0(X,{code:Q0.invalid_type,expected:"integer",received:"float",message:q.message}),K.dirty()}else if(q.kind==="min"){if(q.inclusive?$.data<q.value:$.data<=q.value)X=this._getOrReturnCtx($,X),E0(X,{code:Q0.too_small,minimum:q.value,type:"number",inclusive:q.inclusive,exact:!1,message:q.message}),K.dirty()}else if(q.kind==="max"){if(q.inclusive?$.data>q.value:$.data>=q.value)X=this._getOrReturnCtx($,X),E0(X,{code:Q0.too_big,maximum:q.value,type:"number",inclusive:q.inclusive,exact:!1,message:q.message}),K.dirty()}else if(q.kind==="multipleOf"){if(XE($.data,q.value)!==0)X=this._getOrReturnCtx($,X),E0(X,{code:Q0.not_multiple_of,multipleOf:q.value,message:q.message}),K.dirty()}else if(q.kind==="finite"){if(!Number.isFinite($.data))X=this._getOrReturnCtx($,X),E0(X,{code:Q0.not_finite,message:q.message}),K.dirty()}else c0.assertNever(q);return{status:K.value,value:$.data}}gte($,J){return this.setLimit("min",$,!0,P0.toString(J))}gt($,J){return this.setLimit("min",$,!1,P0.toString(J))}lte($,J){return this.setLimit("max",$,!0,P0.toString(J))}lt($,J){return this.setLimit("max",$,!1,P0.toString(J))}setLimit($,J,X,K){return new E1({...this._def,checks:[...this._def.checks,{kind:$,value:J,inclusive:X,message:P0.toString(K)}]})}_addCheck($){return new E1({...this._def,checks:[...this._def.checks,$]})}int($){return this._addCheck({kind:"int",message:P0.toString($)})}positive($){return this._addCheck({kind:"min",value:0,inclusive:!1,message:P0.toString($)})}negative($){return this._addCheck({kind:"max",value:0,inclusive:!1,message:P0.toString($)})}nonpositive($){return this._addCheck({kind:"max",value:0,inclusive:!0,message:P0.toString($)})}nonnegative($){return this._addCheck({kind:"min",value:0,inclusive:!0,message:P0.toString($)})}multipleOf($,J){return this._addCheck({kind:"multipleOf",value:$,message:P0.toString(J)})}finite($){return this._addCheck({kind:"finite",message:P0.toString($)})}safe($){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:P0.toString($)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:P0.toString($)})}get minValue(){let $=null;for(let J of this._def.checks)if(J.kind==="min"){if($===null||J.value>$)$=J.value}return $}get maxValue(){let $=null;for(let J of this._def.checks)if(J.kind==="max"){if($===null||J.value<$)$=J.value}return $}get isInt(){return!!this._def.checks.find(($)=>$.kind==="int"||$.kind==="multipleOf"&&c0.isInteger($.value))}get isFinite(){let $=null,J=null;for(let X of this._def.checks)if(X.kind==="finite"||X.kind==="int"||X.kind==="multipleOf")return!0;else if(X.kind==="min"){if(J===null||X.value>J)J=X.value}else if(X.kind==="max"){if($===null||X.value<$)$=X.value}return Number.isFinite(J)&&Number.isFinite($)}}E1.create=($)=>{return new E1({checks:[],typeName:D0.ZodNumber,coerce:$?.coerce||!1,...x0($)})};class j1 extends p0{constructor(){super(...arguments);this.min=this.gte,this.max=this.lte}_parse($){if(this._def.coerce)try{$.data=BigInt($.data)}catch{return this._getInvalidInput($)}if(this._getType($)!==H0.bigint)return this._getInvalidInput($);let X=void 0,K=new R6;for(let q of this._def.checks)if(q.kind==="min"){if(q.inclusive?$.data<q.value:$.data<=q.value)X=this._getOrReturnCtx($,X),E0(X,{code:Q0.too_small,type:"bigint",minimum:q.value,inclusive:q.inclusive,message:q.message}),K.dirty()}else if(q.kind==="max"){if(q.inclusive?$.data>q.value:$.data>=q.value)X=this._getOrReturnCtx($,X),E0(X,{code:Q0.too_big,type:"bigint",maximum:q.value,inclusive:q.inclusive,message:q.message}),K.dirty()}else if(q.kind==="multipleOf"){if($.data%q.value!==BigInt(0))X=this._getOrReturnCtx($,X),E0(X,{code:Q0.not_multiple_of,multipleOf:q.value,message:q.message}),K.dirty()}else c0.assertNever(q);return{status:K.value,value:$.data}}_getInvalidInput($){let J=this._getOrReturnCtx($);return E0(J,{code:Q0.invalid_type,expected:H0.bigint,received:J.parsedType}),C0}gte($,J){return this.setLimit("min",$,!0,P0.toString(J))}gt($,J){return this.setLimit("min",$,!1,P0.toString(J))}lte($,J){return this.setLimit("max",$,!0,P0.toString(J))}lt($,J){return this.setLimit("max",$,!1,P0.toString(J))}setLimit($,J,X,K){return new j1({...this._def,checks:[...this._def.checks,{kind:$,value:J,inclusive:X,message:P0.toString(K)}]})}_addCheck($){return new j1({...this._def,checks:[...this._def.checks,$]})}positive($){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:P0.toString($)})}negative($){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:P0.toString($)})}nonpositive($){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:P0.toString($)})}nonnegative($){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:P0.toString($)})}multipleOf($,J){return this._addCheck({kind:"multipleOf",value:$,message:P0.toString(J)})}get minValue(){let $=null;for(let J of this._def.checks)if(J.kind==="min"){if($===null||J.value>$)$=J.value}return $}get maxValue(){let $=null;for(let J of this._def.checks)if(J.kind==="max"){if($===null||J.value<$)$=J.value}return $}}j1.create=($)=>{return new j1({checks:[],typeName:D0.ZodBigInt,coerce:$?.coerce??!1,...x0($)})};class j5 extends p0{_parse($){if(this._def.coerce)$.data=Boolean($.data);if(this._getType($)!==H0.boolean){let X=this._getOrReturnCtx($);return E0(X,{code:Q0.invalid_type,expected:H0.boolean,received:X.parsedType}),C0}return A6($.data)}}j5.create=($)=>{return new j5({typeName:D0.ZodBoolean,coerce:$?.coerce||!1,...x0($)})};class p1 extends p0{_parse($){if(this._def.coerce)$.data=new Date($.data);if(this._getType($)!==H0.date){let q=this._getOrReturnCtx($);return E0(q,{code:Q0.invalid_type,expected:H0.date,received:q.parsedType}),C0}if(Number.isNaN($.data.getTime())){let q=this._getOrReturnCtx($);return E0(q,{code:Q0.invalid_date}),C0}let X=new R6,K=void 0;for(let q of this._def.checks)if(q.kind==="min"){if($.data.getTime()<q.value)K=this._getOrReturnCtx($,K),E0(K,{code:Q0.too_small,message:q.message,inclusive:!0,exact:!1,minimum:q.value,type:"date"}),X.dirty()}else if(q.kind==="max"){if($.data.getTime()>q.value)K=this._getOrReturnCtx($,K),E0(K,{code:Q0.too_big,message:q.message,inclusive:!0,exact:!1,maximum:q.value,type:"date"}),X.dirty()}else c0.assertNever(q);return{status:X.value,value:new Date($.data.getTime())}}_addCheck($){return new p1({...this._def,checks:[...this._def.checks,$]})}min($,J){return this._addCheck({kind:"min",value:$.getTime(),message:P0.toString(J)})}max($,J){return this._addCheck({kind:"max",value:$.getTime(),message:P0.toString(J)})}get minDate(){let $=null;for(let J of this._def.checks)if(J.kind==="min"){if($===null||J.value>$)$=J.value}return $!=null?new Date($):null}get maxDate(){let $=null;for(let J of this._def.checks)if(J.kind==="max"){if($===null||J.value<$)$=J.value}return $!=null?new Date($):null}}p1.create=($)=>{return new p1({checks:[],coerce:$?.coerce||!1,typeName:D0.ZodDate,...x0($)})};class z9 extends p0{_parse($){if(this._getType($)!==H0.symbol){let X=this._getOrReturnCtx($);return E0(X,{code:Q0.invalid_type,expected:H0.symbol,received:X.parsedType}),C0}return A6($.data)}}z9.create=($)=>{return new z9({typeName:D0.ZodSymbol,...x0($)})};class R5 extends p0{_parse($){if(this._getType($)!==H0.undefined){let X=this._getOrReturnCtx($);return E0(X,{code:Q0.invalid_type,expected:H0.undefined,received:X.parsedType}),C0}return A6($.data)}}R5.create=($)=>{return new R5({typeName:D0.ZodUndefined,...x0($)})};class B5 extends p0{_parse($){if(this._getType($)!==H0.null){let X=this._getOrReturnCtx($);return E0(X,{code:Q0.invalid_type,expected:H0.null,received:X.parsedType}),C0}return A6($.data)}}B5.create=($)=>{return new B5({typeName:D0.ZodNull,...x0($)})};class u1 extends p0{constructor(){super(...arguments);this._any=!0}_parse($){return A6($.data)}}u1.create=($)=>{return new u1({typeName:D0.ZodAny,...x0($)})};class L1 extends p0{constructor(){super(...arguments);this._unknown=!0}_parse($){return A6($.data)}}L1.create=($)=>{return new L1({typeName:D0.ZodUnknown,...x0($)})};class T8 extends p0{_parse($){let J=this._getOrReturnCtx($);return E0(J,{code:Q0.invalid_type,expected:H0.never,received:J.parsedType}),C0}}T8.create=($)=>{return new T8({typeName:D0.ZodNever,...x0($)})};class v9 extends p0{_parse($){if(this._getType($)!==H0.undefined){let X=this._getOrReturnCtx($);return E0(X,{code:Q0.invalid_type,expected:H0.void,received:X.parsedType}),C0}return A6($.data)}}v9.create=($)=>{return new v9({typeName:D0.ZodVoid,...x0($)})};class G8 extends p0{_parse($){let{ctx:J,status:X}=this._processInputParams($),K=this._def;if(J.parsedType!==H0.array)return E0(J,{code:Q0.invalid_type,expected:H0.array,received:J.parsedType}),C0;if(K.exactLength!==null){let Y=J.data.length>K.exactLength.value,W=J.data.length<K.exactLength.value;if(Y||W)E0(J,{code:Y?Q0.too_big:Q0.too_small,minimum:W?K.exactLength.value:void 0,maximum:Y?K.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:K.exactLength.message}),X.dirty()}if(K.minLength!==null){if(J.data.length<K.minLength.value)E0(J,{code:Q0.too_small,minimum:K.minLength.value,type:"array",inclusive:!0,exact:!1,message:K.minLength.message}),X.dirty()}if(K.maxLength!==null){if(J.data.length>K.maxLength.value)E0(J,{code:Q0.too_big,maximum:K.maxLength.value,type:"array",inclusive:!0,exact:!1,message:K.maxLength.message}),X.dirty()}if(J.common.async)return Promise.all([...J.data].map((Y,W)=>{return K.type._parseAsync(new O8(J,Y,J.path,W))})).then((Y)=>{return R6.mergeArray(X,Y)});let q=[...J.data].map((Y,W)=>{return K.type._parseSync(new O8(J,Y,J.path,W))});return R6.mergeArray(X,q)}get element(){return this._def.type}min($,J){return new G8({...this._def,minLength:{value:$,message:P0.toString(J)}})}max($,J){return new G8({...this._def,maxLength:{value:$,message:P0.toString(J)}})}length($,J){return new G8({...this._def,exactLength:{value:$,message:P0.toString(J)}})}nonempty($){return this.min(1,$)}}G8.create=($,J)=>{return new G8({type:$,minLength:null,maxLength:null,exactLength:null,typeName:D0.ZodArray,...x0(J)})};function L5($){if($ instanceof W6){let J={};for(let X in $.shape){let K=$.shape[X];J[X]=H8.create(L5(K))}return new W6({...$._def,shape:()=>J})}else if($ instanceof G8)return new G8({...$._def,type:L5($.element)});else if($ instanceof H8)return H8.create(L5($.unwrap()));else if($ instanceof i8)return i8.create(L5($.unwrap()));else if($ instanceof I8)return I8.create($.items.map((J)=>L5(J)));else return $}class W6 extends p0{constructor(){super(...arguments);this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let $=this._def.shape(),J=c0.objectKeys($);return this._cached={shape:$,keys:J},this._cached}_parse($){if(this._getType($)!==H0.object){let N=this._getOrReturnCtx($);return E0(N,{code:Q0.invalid_type,expected:H0.object,received:N.parsedType}),C0}let{status:X,ctx:K}=this._processInputParams($),{shape:q,keys:Y}=this._getCached(),W=[];if(!(this._def.catchall instanceof T8&&this._def.unknownKeys==="strip")){for(let N in K.data)if(!Y.includes(N))W.push(N)}let Q=[];for(let N of Y){let M=q[N],V=K.data[N];Q.push({key:{status:"valid",value:N},value:M._parse(new O8(K,V,K.path,N)),alwaysSet:N in K.data})}if(this._def.catchall instanceof T8){let N=this._def.unknownKeys;if(N==="passthrough")for(let M of W)Q.push({key:{status:"valid",value:M},value:{status:"valid",value:K.data[M]}});else if(N==="strict"){if(W.length>0)E0(K,{code:Q0.unrecognized_keys,keys:W}),X.dirty()}else if(N==="strip");else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let N=this._def.catchall;for(let M of W){let V=K.data[M];Q.push({key:{status:"valid",value:M},value:N._parse(new O8(K,V,K.path,M)),alwaysSet:M in K.data})}}if(K.common.async)return Promise.resolve().then(async()=>{let N=[];for(let M of Q){let V=await M.key,G=await M.value;N.push({key:V,value:G,alwaysSet:M.alwaysSet})}return N}).then((N)=>{return R6.mergeObjectSync(X,N)});else return R6.mergeObjectSync(X,Q)}get shape(){return this._def.shape()}strict($){return P0.errToObj,new W6({...this._def,unknownKeys:"strict",...$!==void 0?{errorMap:(J,X)=>{let K=this._def.errorMap?.(J,X).message??X.defaultError;if(J.code==="unrecognized_keys")return{message:P0.errToObj($).message??K};return{message:K}}}:{}})}strip(){return new W6({...this._def,unknownKeys:"strip"})}passthrough(){return new W6({...this._def,unknownKeys:"passthrough"})}extend($){return new W6({...this._def,shape:()=>({...this._def.shape(),...$})})}merge($){return new W6({unknownKeys:$._def.unknownKeys,catchall:$._def.catchall,shape:()=>({...this._def.shape(),...$._def.shape()}),typeName:D0.ZodObject})}setKey($,J){return this.augment({[$]:J})}catchall($){return new W6({...this._def,catchall:$})}pick($){let J={};for(let X of c0.objectKeys($))if($[X]&&this.shape[X])J[X]=this.shape[X];return new W6({...this._def,shape:()=>J})}omit($){let J={};for(let X of c0.objectKeys(this.shape))if(!$[X])J[X]=this.shape[X];return new W6({...this._def,shape:()=>J})}deepPartial(){return L5(this)}partial($){let J={};for(let X of c0.objectKeys(this.shape)){let K=this.shape[X];if($&&!$[X])J[X]=K;else J[X]=K.optional()}return new W6({...this._def,shape:()=>J})}required($){let J={};for(let X of c0.objectKeys(this.shape))if($&&!$[X])J[X]=this.shape[X];else{let q=this.shape[X];while(q instanceof H8)q=q._def.innerType;J[X]=q}return new W6({...this._def,shape:()=>J})}keyof(){return yW(c0.objectKeys(this.shape))}}W6.create=($,J)=>{return new W6({shape:()=>$,unknownKeys:"strip",catchall:T8.create(),typeName:D0.ZodObject,...x0(J)})};W6.strictCreate=($,J)=>{return new W6({shape:()=>$,unknownKeys:"strict",catchall:T8.create(),typeName:D0.ZodObject,...x0(J)})};W6.lazycreate=($,J)=>{return new W6({shape:$,unknownKeys:"strip",catchall:T8.create(),typeName:D0.ZodObject,...x0(J)})};class P5 extends p0{_parse($){let{ctx:J}=this._processInputParams($),X=this._def.options;function K(q){for(let W of q)if(W.result.status==="valid")return W.result;for(let W of q)if(W.result.status==="dirty")return J.common.issues.push(...W.ctx.common.issues),W.result;let Y=q.map((W)=>new I6(W.ctx.common.issues));return E0(J,{code:Q0.invalid_union,unionErrors:Y}),C0}if(J.common.async)return Promise.all(X.map(async(q)=>{let Y={...J,common:{...J.common,issues:[]},parent:null};return{result:await q._parseAsync({data:J.data,path:J.path,parent:Y}),ctx:Y}})).then(K);else{let q=void 0,Y=[];for(let Q of X){let N={...J,common:{...J.common,issues:[]},parent:null},M=Q._parseSync({data:J.data,path:J.path,parent:N});if(M.status==="valid")return M;else if(M.status==="dirty"&&!q)q={result:M,ctx:N};if(N.common.issues.length)Y.push(N.common.issues)}if(q)return J.common.issues.push(...q.ctx.common.issues),q.result;let W=Y.map((Q)=>new I6(Q));return E0(J,{code:Q0.invalid_union,unionErrors:W}),C0}}get options(){return this._def.options}}P5.create=($,J)=>{return new P5({options:$,typeName:D0.ZodUnion,...x0(J)})};var r8=($)=>{if($ instanceof A5)return r8($.schema);else if($ instanceof U8)return r8($.innerType());else if($ instanceof F5)return[$.value];else if($ instanceof R1)return $.options;else if($ instanceof z5)return c0.objectValues($.enum);else if($ instanceof v5)return r8($._def.innerType);else if($ instanceof R5)return[void 0];else if($ instanceof B5)return[null];else if($ instanceof H8)return[void 0,...r8($.unwrap())];else if($ instanceof i8)return[null,...r8($.unwrap())];else if($ instanceof f$)return r8($.unwrap());else if($ instanceof Z5)return r8($.unwrap());else if($ instanceof C5)return r8($._def.innerType);else return[]};class g$ extends p0{_parse($){let{ctx:J}=this._processInputParams($);if(J.parsedType!==H0.object)return E0(J,{code:Q0.invalid_type,expected:H0.object,received:J.parsedType}),C0;let X=this.discriminator,K=J.data[X],q=this.optionsMap.get(K);if(!q)return E0(J,{code:Q0.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[X]}),C0;if(J.common.async)return q._parseAsync({data:J.data,path:J.path,parent:J});else return q._parseSync({data:J.data,path:J.path,parent:J})}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create($,J,X){let K=new Map;for(let q of J){let Y=r8(q.shape[$]);if(!Y.length)throw Error(`A discriminator value for key \`${$}\` could not be extracted from all schema options`);for(let W of Y){if(K.has(W))throw Error(`Discriminator property ${String($)} has duplicate value ${String(W)}`);K.set(W,q)}}return new g$({typeName:D0.ZodDiscriminatedUnion,discriminator:$,options:J,optionsMap:K,...x0(X)})}}function dJ($,J){let X=w8($),K=w8(J);if($===J)return{valid:!0,data:$};else if(X===H0.object&&K===H0.object){let q=c0.objectKeys(J),Y=c0.objectKeys($).filter((Q)=>q.indexOf(Q)!==-1),W={...$,...J};for(let Q of Y){let N=dJ($[Q],J[Q]);if(!N.valid)return{valid:!1};W[Q]=N.data}return{valid:!0,data:W}}else if(X===H0.array&&K===H0.array){if($.length!==J.length)return{valid:!1};let q=[];for(let Y=0;Y<$.length;Y++){let W=$[Y],Q=J[Y],N=dJ(W,Q);if(!N.valid)return{valid:!1};q.push(N.data)}return{valid:!0,data:q}}else if(X===H0.date&&K===H0.date&&+$===+J)return{valid:!0,data:$};else return{valid:!1}}class S5 extends p0{_parse($){let{status:J,ctx:X}=this._processInputParams($),K=(q,Y)=>{if(x$(q)||x$(Y))return C0;let W=dJ(q.value,Y.value);if(!W.valid)return E0(X,{code:Q0.invalid_intersection_types}),C0;if(h$(q)||h$(Y))J.dirty();return{status:J.value,value:W.data}};if(X.common.async)return Promise.all([this._def.left._parseAsync({data:X.data,path:X.path,parent:X}),this._def.right._parseAsync({data:X.data,path:X.path,parent:X})]).then(([q,Y])=>K(q,Y));else return K(this._def.left._parseSync({data:X.data,path:X.path,parent:X}),this._def.right._parseSync({data:X.data,path:X.path,parent:X}))}}S5.create=($,J,X)=>{return new S5({left:$,right:J,typeName:D0.ZodIntersection,...x0(X)})};class I8 extends p0{_parse($){let{status:J,ctx:X}=this._processInputParams($);if(X.parsedType!==H0.array)return E0(X,{code:Q0.invalid_type,expected:H0.array,received:X.parsedType}),C0;if(X.data.length<this._def.items.length)return E0(X,{code:Q0.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),C0;if(!this._def.rest&&X.data.length>this._def.items.length)E0(X,{code:Q0.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),J.dirty();let q=[...X.data].map((Y,W)=>{let Q=this._def.items[W]||this._def.rest;if(!Q)return null;return Q._parse(new O8(X,Y,X.path,W))}).filter((Y)=>!!Y);if(X.common.async)return Promise.all(q).then((Y)=>{return R6.mergeArray(J,Y)});else return R6.mergeArray(J,q)}get items(){return this._def.items}rest($){return new I8({...this._def,rest:$})}}I8.create=($,J)=>{if(!Array.isArray($))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new I8({items:$,typeName:D0.ZodTuple,rest:null,...x0(J)})};class C9 extends p0{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse($){let{status:J,ctx:X}=this._processInputParams($);if(X.parsedType!==H0.object)return E0(X,{code:Q0.invalid_type,expected:H0.object,received:X.parsedType}),C0;let K=[],q=this._def.keyType,Y=this._def.valueType;for(let W in X.data)K.push({key:q._parse(new O8(X,W,X.path,W)),value:Y._parse(new O8(X,X.data[W],X.path,W)),alwaysSet:W in X.data});if(X.common.async)return R6.mergeObjectAsync(J,K);else return R6.mergeObjectSync(J,K)}get element(){return this._def.valueType}static create($,J,X){if(J instanceof p0)return new C9({keyType:$,valueType:J,typeName:D0.ZodRecord,...x0(X)});return new C9({keyType:V8.create(),valueType:$,typeName:D0.ZodRecord,...x0(J)})}}class Z9 extends p0{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse($){let{status:J,ctx:X}=this._processInputParams($);if(X.parsedType!==H0.map)return E0(X,{code:Q0.invalid_type,expected:H0.map,received:X.parsedType}),C0;let K=this._def.keyType,q=this._def.valueType,Y=[...X.data.entries()].map(([W,Q],N)=>{return{key:K._parse(new O8(X,W,X.path,[N,"key"])),value:q._parse(new O8(X,Q,X.path,[N,"value"]))}});if(X.common.async){let W=new Map;return Promise.resolve().then(async()=>{for(let Q of Y){let N=await Q.key,M=await Q.value;if(N.status==="aborted"||M.status==="aborted")return C0;if(N.status==="dirty"||M.status==="dirty")J.dirty();W.set(N.value,M.value)}return{status:J.value,value:W}})}else{let W=new Map;for(let Q of Y){let{key:N,value:M}=Q;if(N.status==="aborted"||M.status==="aborted")return C0;if(N.status==="dirty"||M.status==="dirty")J.dirty();W.set(N.value,M.value)}return{status:J.value,value:W}}}}Z9.create=($,J,X)=>{return new Z9({valueType:J,keyType:$,typeName:D0.ZodMap,...x0(X)})};class l1 extends p0{_parse($){let{status:J,ctx:X}=this._processInputParams($);if(X.parsedType!==H0.set)return E0(X,{code:Q0.invalid_type,expected:H0.set,received:X.parsedType}),C0;let K=this._def;if(K.minSize!==null){if(X.data.size<K.minSize.value)E0(X,{code:Q0.too_small,minimum:K.minSize.value,type:"set",inclusive:!0,exact:!1,message:K.minSize.message}),J.dirty()}if(K.maxSize!==null){if(X.data.size>K.maxSize.value)E0(X,{code:Q0.too_big,maximum:K.maxSize.value,type:"set",inclusive:!0,exact:!1,message:K.maxSize.message}),J.dirty()}let q=this._def.valueType;function Y(Q){let N=new Set;for(let M of Q){if(M.status==="aborted")return C0;if(M.status==="dirty")J.dirty();N.add(M.value)}return{status:J.value,value:N}}let W=[...X.data.values()].map((Q,N)=>q._parse(new O8(X,Q,X.path,N)));if(X.common.async)return Promise.all(W).then((Q)=>Y(Q));else return Y(W)}min($,J){return new l1({...this._def,minSize:{value:$,message:P0.toString(J)}})}max($,J){return new l1({...this._def,maxSize:{value:$,message:P0.toString(J)}})}size($,J){return this.min($,J).max($,J)}nonempty($){return this.min(1,$)}}l1.create=($,J)=>{return new l1({valueType:$,minSize:null,maxSize:null,typeName:D0.ZodSet,...x0(J)})};class E5 extends p0{constructor(){super(...arguments);this.validate=this.implement}_parse($){let{ctx:J}=this._processInputParams($);if(J.parsedType!==H0.function)return E0(J,{code:Q0.invalid_type,expected:H0.function,received:J.parsedType}),C0;function X(W,Q){return F9({data:W,path:J.path,errorMaps:[J.common.contextualErrorMap,J.schemaErrorMap,O5(),o8].filter((N)=>!!N),issueData:{code:Q0.invalid_arguments,argumentsError:Q}})}function K(W,Q){return F9({data:W,path:J.path,errorMaps:[J.common.contextualErrorMap,J.schemaErrorMap,O5(),o8].filter((N)=>!!N),issueData:{code:Q0.invalid_return_type,returnTypeError:Q}})}let q={errorMap:J.common.contextualErrorMap},Y=J.data;if(this._def.returns instanceof c1){let W=this;return A6(async function(...Q){let N=new I6([]),M=await W._def.args.parseAsync(Q,q).catch((H)=>{throw N.addIssue(X(Q,H)),N}),V=await Reflect.apply(Y,this,M);return await W._def.returns._def.type.parseAsync(V,q).catch((H)=>{throw N.addIssue(K(V,H)),N})})}else{let W=this;return A6(function(...Q){let N=W._def.args.safeParse(Q,q);if(!N.success)throw new I6([X(Q,N.error)]);let M=Reflect.apply(Y,this,N.data),V=W._def.returns.safeParse(M,q);if(!V.success)throw new I6([K(M,V.error)]);return V.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...$){return new E5({...this._def,args:I8.create($).rest(L1.create())})}returns($){return new E5({...this._def,returns:$})}implement($){return this.parse($)}strictImplement($){return this.parse($)}static create($,J,X){return new E5({args:$?$:I8.create([]).rest(L1.create()),returns:J||L1.create(),typeName:D0.ZodFunction,...x0(X)})}}class A5 extends p0{get schema(){return this._def.getter()}_parse($){let{ctx:J}=this._processInputParams($);return this._def.getter()._parse({data:J.data,path:J.path,parent:J})}}A5.create=($,J)=>{return new A5({getter:$,typeName:D0.ZodLazy,...x0(J)})};class F5 extends p0{_parse($){if($.data!==this._def.value){let J=this._getOrReturnCtx($);return E0(J,{received:J.data,code:Q0.invalid_literal,expected:this._def.value}),C0}return{status:"valid",value:$.data}}get value(){return this._def.value}}F5.create=($,J)=>{return new F5({value:$,typeName:D0.ZodLiteral,...x0(J)})};function yW($,J){return new R1({values:$,typeName:D0.ZodEnum,...x0(J)})}class R1 extends p0{_parse($){if(typeof $.data!=="string"){let J=this._getOrReturnCtx($),X=this._def.values;return E0(J,{expected:c0.joinValues(X),received:J.parsedType,code:Q0.invalid_type}),C0}if(!this._cache)this._cache=new Set(this._def.values);if(!this._cache.has($.data)){let J=this._getOrReturnCtx($),X=this._def.values;return E0(J,{received:J.data,code:Q0.invalid_enum_value,options:X}),C0}return A6($.data)}get options(){return this._def.values}get enum(){let $={};for(let J of this._def.values)$[J]=J;return $}get Values(){let $={};for(let J of this._def.values)$[J]=J;return $}get Enum(){let $={};for(let J of this._def.values)$[J]=J;return $}extract($,J=this._def){return R1.create($,{...this._def,...J})}exclude($,J=this._def){return R1.create(this.options.filter((X)=>!$.includes(X)),{...this._def,...J})}}R1.create=yW;class z5 extends p0{_parse($){let J=c0.getValidEnumValues(this._def.values),X=this._getOrReturnCtx($);if(X.parsedType!==H0.string&&X.parsedType!==H0.number){let K=c0.objectValues(J);return E0(X,{expected:c0.joinValues(K),received:X.parsedType,code:Q0.invalid_type}),C0}if(!this._cache)this._cache=new Set(c0.getValidEnumValues(this._def.values));if(!this._cache.has($.data)){let K=c0.objectValues(J);return E0(X,{received:X.data,code:Q0.invalid_enum_value,options:K}),C0}return A6($.data)}get enum(){return this._def.values}}z5.create=($,J)=>{return new z5({values:$,typeName:D0.ZodNativeEnum,...x0(J)})};class c1 extends p0{unwrap(){return this._def.type}_parse($){let{ctx:J}=this._processInputParams($);if(J.parsedType!==H0.promise&&J.common.async===!1)return E0(J,{code:Q0.invalid_type,expected:H0.promise,received:J.parsedType}),C0;let X=J.parsedType===H0.promise?J.data:Promise.resolve(J.data);return A6(X.then((K)=>{return this._def.type.parseAsync(K,{path:J.path,errorMap:J.common.contextualErrorMap})}))}}c1.create=($,J)=>{return new c1({type:$,typeName:D0.ZodPromise,...x0(J)})};class U8 extends p0{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===D0.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse($){let{status:J,ctx:X}=this._processInputParams($),K=this._def.effect||null,q={addIssue:(Y)=>{if(E0(X,Y),Y.fatal)J.abort();else J.dirty()},get path(){return X.path}};if(q.addIssue=q.addIssue.bind(q),K.type==="preprocess"){let Y=K.transform(X.data,q);if(X.common.async)return Promise.resolve(Y).then(async(W)=>{if(J.value==="aborted")return C0;let Q=await this._def.schema._parseAsync({data:W,path:X.path,parent:X});if(Q.status==="aborted")return C0;if(Q.status==="dirty")return m1(Q.value);if(J.value==="dirty")return m1(Q.value);return Q});else{if(J.value==="aborted")return C0;let W=this._def.schema._parseSync({data:Y,path:X.path,parent:X});if(W.status==="aborted")return C0;if(W.status==="dirty")return m1(W.value);if(J.value==="dirty")return m1(W.value);return W}}if(K.type==="refinement"){let Y=(W)=>{let Q=K.refinement(W,q);if(X.common.async)return Promise.resolve(Q);if(Q instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return W};if(X.common.async===!1){let W=this._def.schema._parseSync({data:X.data,path:X.path,parent:X});if(W.status==="aborted")return C0;if(W.status==="dirty")J.dirty();return Y(W.value),{status:J.value,value:W.value}}else return this._def.schema._parseAsync({data:X.data,path:X.path,parent:X}).then((W)=>{if(W.status==="aborted")return C0;if(W.status==="dirty")J.dirty();return Y(W.value).then(()=>{return{status:J.value,value:W.value}})})}if(K.type==="transform")if(X.common.async===!1){let Y=this._def.schema._parseSync({data:X.data,path:X.path,parent:X});if(!U1(Y))return C0;let W=K.transform(Y.value,q);if(W instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:J.value,value:W}}else return this._def.schema._parseAsync({data:X.data,path:X.path,parent:X}).then((Y)=>{if(!U1(Y))return C0;return Promise.resolve(K.transform(Y.value,q)).then((W)=>({status:J.value,value:W}))});c0.assertNever(K)}}U8.create=($,J,X)=>{return new U8({schema:$,typeName:D0.ZodEffects,effect:J,...x0(X)})};U8.createWithPreprocess=($,J,X)=>{return new U8({schema:J,effect:{type:"preprocess",transform:$},typeName:D0.ZodEffects,...x0(X)})};class H8 extends p0{_parse($){if(this._getType($)===H0.undefined)return A6(void 0);return this._def.innerType._parse($)}unwrap(){return this._def.innerType}}H8.create=($,J)=>{return new H8({innerType:$,typeName:D0.ZodOptional,...x0(J)})};class i8 extends p0{_parse($){if(this._getType($)===H0.null)return A6(null);return this._def.innerType._parse($)}unwrap(){return this._def.innerType}}i8.create=($,J)=>{return new i8({innerType:$,typeName:D0.ZodNullable,...x0(J)})};class v5 extends p0{_parse($){let{ctx:J}=this._processInputParams($),X=J.data;if(J.parsedType===H0.undefined)X=this._def.defaultValue();return this._def.innerType._parse({data:X,path:J.path,parent:J})}removeDefault(){return this._def.innerType}}v5.create=($,J)=>{return new v5({innerType:$,typeName:D0.ZodDefault,defaultValue:typeof J.default==="function"?J.default:()=>J.default,...x0(J)})};class C5 extends p0{_parse($){let{ctx:J}=this._processInputParams($),X={...J,common:{...J.common,issues:[]}},K=this._def.innerType._parse({data:X.data,path:X.path,parent:{...X}});if(U5(K))return K.then((q)=>{return{status:"valid",value:q.status==="valid"?q.value:this._def.catchValue({get error(){return new I6(X.common.issues)},input:X.data})}});else return{status:"valid",value:K.status==="valid"?K.value:this._def.catchValue({get error(){return new I6(X.common.issues)},input:X.data})}}removeCatch(){return this._def.innerType}}C5.create=($,J)=>{return new C5({innerType:$,typeName:D0.ZodCatch,catchValue:typeof J.catch==="function"?J.catch:()=>J.catch,...x0(J)})};class D9 extends p0{_parse($){if(this._getType($)!==H0.nan){let X=this._getOrReturnCtx($);return E0(X,{code:Q0.invalid_type,expected:H0.nan,received:X.parsedType}),C0}return{status:"valid",value:$.data}}}D9.create=($)=>{return new D9({typeName:D0.ZodNaN,...x0($)})};var KE=Symbol("zod_brand");class f$ extends p0{_parse($){let{ctx:J}=this._processInputParams($),X=J.data;return this._def.type._parse({data:X,path:J.path,parent:J})}unwrap(){return this._def.type}}class k9 extends p0{_parse($){let{status:J,ctx:X}=this._processInputParams($);if(X.common.async)return(async()=>{let q=await this._def.in._parseAsync({data:X.data,path:X.path,parent:X});if(q.status==="aborted")return C0;if(q.status==="dirty")return J.dirty(),m1(q.value);else return this._def.out._parseAsync({data:q.value,path:X.path,parent:X})})();else{let K=this._def.in._parseSync({data:X.data,path:X.path,parent:X});if(K.status==="aborted")return C0;if(K.status==="dirty")return J.dirty(),{status:"dirty",value:K.value};else return this._def.out._parseSync({data:K.value,path:X.path,parent:X})}}static create($,J){return new k9({in:$,out:J,typeName:D0.ZodPipeline})}}class Z5 extends p0{_parse($){let J=this._def.innerType._parse($),X=(K)=>{if(U1(K))K.value=Object.freeze(K.value);return K};return U5(J)?J.then((K)=>X(K)):X(J)}unwrap(){return this._def.innerType}}Z5.create=($,J)=>{return new Z5({innerType:$,typeName:D0.ZodReadonly,...x0(J)})};function wW($,J){let X=typeof $==="function"?$(J):typeof $==="string"?{message:$}:$;return typeof X==="string"?{message:X}:X}function xW($,J={},X){if($)return u1.create().superRefine((K,q)=>{let Y=$(K);if(Y instanceof Promise)return Y.then((W)=>{if(!W){let Q=wW(J,K),N=Q.fatal??X??!0;q.addIssue({code:"custom",...Q,fatal:N})}});if(!Y){let W=wW(J,K),Q=W.fatal??X??!0;q.addIssue({code:"custom",...W,fatal:Q})}return});return u1.create()}var qE={object:W6.lazycreate},D0;(function($){$.ZodString="ZodString",$.ZodNumber="ZodNumber",$.ZodNaN="ZodNaN",$.ZodBigInt="ZodBigInt",$.ZodBoolean="ZodBoolean",$.ZodDate="ZodDate",$.ZodSymbol="ZodSymbol",$.ZodUndefined="ZodUndefined",$.ZodNull="ZodNull",$.ZodAny="ZodAny",$.ZodUnknown="ZodUnknown",$.ZodNever="ZodNever",$.ZodVoid="ZodVoid",$.ZodArray="ZodArray",$.ZodObject="ZodObject",$.ZodUnion="ZodUnion",$.ZodDiscriminatedUnion="ZodDiscriminatedUnion",$.ZodIntersection="ZodIntersection",$.ZodTuple="ZodTuple",$.ZodRecord="ZodRecord",$.ZodMap="ZodMap",$.ZodSet="ZodSet",$.ZodFunction="ZodFunction",$.ZodLazy="ZodLazy",$.ZodLiteral="ZodLiteral",$.ZodEnum="ZodEnum",$.ZodEffects="ZodEffects",$.ZodNativeEnum="ZodNativeEnum",$.ZodOptional="ZodOptional",$.ZodNullable="ZodNullable",$.ZodDefault="ZodDefault",$.ZodCatch="ZodCatch",$.ZodPromise="ZodPromise",$.ZodBranded="ZodBranded",$.ZodPipeline="ZodPipeline",$.ZodReadonly="ZodReadonly"})(D0||(D0={}));var YE=($,J={message:`Input not instance of ${$.name}`})=>xW((X)=>X instanceof $,J),hW=V8.create,gW=E1.create,WE=D9.create,QE=j1.create,fW=j5.create,NE=p1.create,ME=z9.create,VE=R5.create,GE=B5.create,HE=u1.create,OE=L1.create,UE=T8.create,LE=v9.create,EE=G8.create,jE=W6.create,RE=W6.strictCreate,BE=P5.create,PE=g$.create,SE=S5.create,AE=I8.create,FE=C9.create,zE=Z9.create,vE=l1.create,CE=E5.create,ZE=A5.create,DE=F5.create,kE=R1.create,wE=z5.create,TE=c1.create,IE=U8.create,_E=H8.create,yE=i8.create,xE=U8.createWithPreprocess,hE=k9.create,gE=()=>hW().optional(),fE=()=>gW().optional(),bE=()=>fW().optional(),mE={string:($)=>V8.create({...$,coerce:!0}),number:($)=>E1.create({...$,coerce:!0}),boolean:($)=>j5.create({...$,coerce:!0}),bigint:($)=>j1.create({...$,coerce:!0}),date:($)=>p1.create({...$,coerce:!0})};var pE=C0;var r0=f;var L8;(function($){$[$.EXTEND=1]="EXTEND",$[$.WRAP=2]="WRAP",$[$.CROP=3]="CROP"})(L8||(L8={}));var B1=f.object({bitmap:f.object({data:f.union([f.instanceof(Buffer),f.instanceof(Uint8Array)]),width:f.number(),height:f.number()})});var uE=f.object({src:B1,x:f.number().optional(),y:f.number().optional(),srcX:f.number().optional(),srcY:f.number().optional(),srcW:f.number().optional(),srcH:f.number().optional()}),lE=f.union([B1,uE]),D5={blit($,J){let X=lE.parse(J),{src:K,x:q=0,y:Y=0,srcX:W=0,srcY:Q=0,srcW:N=K.bitmap.width,srcH:M=K.bitmap.height}="bitmap"in X?{src:X}:X;if(!("bitmap"in K))throw Error("The source must be a Jimp image");if(typeof q!=="number"||typeof Y!=="number")throw Error("x and y must be numbers");q=Math.round(q),Y=Math.round(Y),W=Math.round(W),Q=Math.round(Q),N=Math.round(N),M=Math.round(M);let V=$.bitmap.width,G=$.bitmap.height;return o6(K,W,Q,N,M,function(H,O,L){let j=q+H-W,E=Y+O-Q;if(j>=0&&E>=0&&V-j>0&&G-E>0){let B=$.getPixelIndex(j,E),S={r:K.bitmap.data[L]||0,g:K.bitmap.data[L+1]||0,b:K.bitmap.data[L+2]||0,a:K.bitmap.data[L+3]||0},A={r:$.bitmap.data[B]||0,g:$.bitmap.data[B+1]||0,b:$.bitmap.data[B+2]||0,a:$.bitmap.data[B+3]||0};$.bitmap.data[B]=(S.a*(S.r-A.r)-A.r+255>>8)+A.r,$.bitmap.data[B+1]=(S.a*(S.g-A.g)-A.g+255>>8)+A.g,$.bitmap.data[B+2]=(S.a*(S.b-A.b)-A.b+255>>8)+A.b,$.bitmap.data[B+3]=$6(A.a+S.a)}}),$}};var bW=[1,57,41,21,203,34,97,73,227,91,149,62,105,45,39,137,241,107,3,173,39,71,65,238,219,101,187,87,81,151,141,133,249,117,221,209,197,187,177,169,5,153,73,139,133,127,243,233,223,107,103,99,191,23,177,171,165,159,77,149,9,139,135,131,253,245,119,231,224,109,211,103,25,195,189,23,45,175,171,83,81,79,155,151,147,9,141,137,67,131,129,251,123,30,235,115,113,221,217,53,13,51,50,49,193,189,185,91,179,175,43,169,83,163,5,79,155,19,75,147,145,143,35,69,17,67,33,65,255,251,247,243,239,59,29,229,113,111,219,27,213,105,207,51,201,199,49,193,191,47,93,183,181,179,11,87,43,85,167,165,163,161,159,157,155,77,19,75,37,73,145,143,141,35,138,137,135,67,33,131,129,255,63,250,247,61,121,239,237,117,29,229,227,225,111,55,109,216,213,211,209,207,205,203,201,199,197,195,193,48,190,47,93,185,183,181,179,178,176,175,173,171,85,21,167,165,41,163,161,5,79,157,78,154,153,19,75,149,74,147,73,144,143,71,141,140,139,137,17,135,134,133,66,131,65,129,1],mW=[0,9,10,10,14,12,14,14,16,15,16,15,16,15,15,17,18,17,12,18,16,17,17,19,19,18,19,18,18,19,19,19,20,19,20,20,20,20,20,20,15,20,19,20,20,20,21,21,21,20,20,20,21,18,21,21,21,21,20,21,17,21,21,21,22,22,21,22,22,21,22,21,19,22,22,19,20,22,22,21,21,21,22,22,22,18,22,22,21,22,22,23,22,20,23,22,22,23,23,21,19,21,21,21,23,23,23,22,23,23,21,23,22,23,18,22,23,20,22,23,23,23,21,22,20,22,21,22,24,24,24,24,24,22,21,24,23,23,24,21,24,23,24,22,24,24,22,24,24,22,23,24,24,24,20,23,22,23,24,24,24,24,24,24,24,23,21,23,22,23,24,24,24,22,24,24,24,23,22,24,24,25,23,25,25,23,24,25,25,24,22,25,25,25,24,23,24,25,25,25,25,25,25,25,25,25,25,25,25,23,25,23,24,25,25,25,25,25,25,25,25,25,24,22,25,25,23,25,25,20,24,25,24,25,25,22,24,25,24,25,24,25,25,24,25,25,25,25,22,25,25,25,24,25,24,25,18];var pW={blur($,J){if(typeof J!=="number")throw Error("r must be a number");if(J<1)throw Error("r must be greater than 0");let X,K,q,Y,W,Q,N,M,V,G,H,O,L,j=$.bitmap.width-1,E=$.bitmap.height-1,B=J+1,S=bW[J],A=mW[J],z=[],P=[],R=[],U=[],C=[],k=[],h=2;while(h-- >0){O=0,L=0;for(Q=0;Q<$.bitmap.height;Q++){X=$.bitmap.data[L]*B,K=$.bitmap.data[L+1]*B,q=$.bitmap.data[L+2]*B,Y=$.bitmap.data[L+3]*B;for(N=1;N<=J;N++)M=L+((N>j?j:N)<<2),X+=$.bitmap.data[M++],K+=$.bitmap.data[M++],q+=$.bitmap.data[M++],Y+=$.bitmap.data[M];for(W=0;W<$.bitmap.width;W++){if(z[O]=X,P[O]=K,R[O]=q,U[O]=Y,Q===0)C[W]=((M=W+B)<j?M:j)<<2,k[W]=(M=W-J)>0?M<<2:0;V=L+C[W],G=L+k[W],X+=$.bitmap.data[V++]-$.bitmap.data[G++],K+=$.bitmap.data[V++]-$.bitmap.data[G++],q+=$.bitmap.data[V++]-$.bitmap.data[G++],Y+=$.bitmap.data[V]-$.bitmap.data[G++],O++}L+=$.bitmap.width<<2}for(W=0;W<$.bitmap.width;W++){H=W,X=z[H]*B,K=P[H]*B,q=R[H]*B,Y=U[H]*B;for(N=1;N<=J;N++)H+=N>E?0:$.bitmap.width,X+=z[H],K+=P[H],q+=R[H],Y+=U[H];O=W<<2;for(Q=0;Q<$.bitmap.height;Q++){if($.bitmap.data[O]=$6(X*S>>>A),$.bitmap.data[O+1]=$6(K*S>>>A),$.bitmap.data[O+2]=$6(q*S>>>A),$.bitmap.data[O+3]=$6(Y*S>>>A),W===0)C[Q]=((M=Q+B)<E?M:E)*$.bitmap.width,k[Q]=(M=Q-J)>0?M*$.bitmap.width:0;V=W+C[Q],G=W+k[Q],X+=z[V]-z[G],K+=P[V]-P[G],q+=R[V]-R[G],Y+=U[V]-U[G],O+=$.bitmap.width<<2}}}return $},gaussian($,J){if(typeof J!=="number")throw Error("r must be a number");if(J<1)throw Error("r must be greater than 0");let X=Math.ceil(J*2.57),K=X*2+1,q=J*J*2,Y=q*Math.PI,W=[];for(let Q=0;Q<K;Q++){let N=[];for(let M=0;M<K;M++){let V=(M-X)**2+(Q-X)**2;N[M]=Math.exp(-V/q)/Y}W.push(N)}for(let Q=0;Q<$.bitmap.height;Q++)for(let N=0;N<$.bitmap.width;N++){let M=0,V=0,G=0,H=0,O=0;for(let L=0;L<K;L++){for(let E=0;E<K;E++){let B=Math.min($.bitmap.width-1,Math.max(0,E+N-X)),S=Math.min($.bitmap.height-1,Math.max(0,L+Q-X)),A=W[L][E],z=S*$.bitmap.width+B<<2;M+=$.bitmap.data[z]*A,V+=$.bitmap.data[z+1]*A,G+=$.bitmap.data[z+2]*A,H+=$.bitmap.data[z+3]*A,O+=A}let j=Q*$.bitmap.width+N<<2;$.bitmap.data[j]=Math.round(M/O),$.bitmap.data[j+1]=Math.round(V/O),$.bitmap.data[j+2]=Math.round(G/O),$.bitmap.data[j+3]=Math.round(H/O)}}return $}};var nE=f.object({x:f.number().optional(),y:f.number().optional(),radius:f.number().min(0).optional()}),uW={circle($,J={}){let X=nE.parse(J),K=X.radius||($.bitmap.width>$.bitmap.height?$.bitmap.height:$.bitmap.width)/2,q={x:typeof X.x==="number"?X.x:$.bitmap.width/2,y:typeof X.y==="number"?X.y:$.bitmap.height/2};return $.scan((Y,W,Q)=>{let N=Math.sqrt(Math.pow(Y-q.x,2)+Math.pow(W-q.y,2));if(K-N<=0)$.bitmap.data[Q+3]=0;else if(K-N<1)$.bitmap.data[Q+3]=255*(K-N)}),$}};var b$=f.array(f.number()).min(1).array(),rE=f.object({kernel:b$,edgeHandling:f.nativeEnum(L8).optional()}),iE=f.union([b$,rE]),sE=f.object({kernel:b$,x:f.number().optional(),y:f.number().optional(),w:f.number().optional(),h:f.number().optional()}),aE=f.union([b$,sE]),cW=f.number().min(1).max(1/0),tE=f.object({size:cW,x:f.number().optional(),y:f.number().optional(),w:f.number().optional(),h:f.number().optional()}),eE=f.union([cW,tE]);function lW($,J,X,K){let q=[0,0,0,0],Y=(J.length-1)/2;for(let W=0;W<J.length;W+=1)for(let Q=0;Q<J[W].length;Q+=1){let N=$.getPixelIndex(X+W-Y,K+Q-Y);q[0]+=$.bitmap.data[N]*J[W][Q],q[1]+=$.bitmap.data[N+1]*J[W][Q],q[2]+=$.bitmap.data[N+2]*J[W][Q],q[3]+=$.bitmap.data[N+3]*J[W][Q]}return q}function nJ($,J,X=50){return{r:(J.r-$.r)*(X/100)+$.r,g:(J.g-$.g)*(X/100)+$.g,b:(J.b-$.b)*(X/100)+$.b}}var $j=f.object({apply:f.literal("hue"),params:f.tuple([f.number().min(-360).max(360)])}),Jj=f.object({apply:f.literal("spin"),params:f.tuple([f.number().min(-360).max(360)])}),Xj=f.object({apply:f.literal("lighten"),params:f.tuple([f.number().min(0).max(100)]).optional()}),iJ=f.object({r:f.number().min(0).max(255),g:f.number().min(0).max(255),b:f.number().min(0).max(255)}),Kj=f.object({apply:f.literal("mix"),params:f.union([f.tuple([iJ]),f.tuple([iJ,f.number().min(0).max(100)])])}),qj=f.object({apply:f.literal("tint"),params:f.tuple([f.number().min(0).max(100)]).optional()}),Yj=f.object({apply:f.literal("shade"),params:f.tuple([f.number().min(0).max(100)]).optional()}),Wj=f.object({apply:f.literal("xor"),params:f.tuple([iJ])}),Qj=f.object({apply:f.literal("red"),params:f.tuple([f.number().min(-255).max(255)])}),Nj=f.object({apply:f.literal("green"),params:f.tuple([f.number().min(-255).max(255)])}),Mj=f.object({apply:f.literal("blue"),params:f.tuple([f.number().min(-255).max(255)])}),Vj=f.object({apply:f.literal("brighten"),params:f.tuple([f.number().min(0).max(100)]).optional()}),Gj=f.object({apply:f.literal("darken"),params:f.tuple([f.number().min(0).max(100)]).optional()}),Hj=f.object({apply:f.literal("desaturate"),params:f.tuple([f.number().min(0).max(100)]).optional()}),Oj=f.object({apply:f.literal("saturate"),params:f.tuple([f.number().min(0).max(100)]).optional()}),Uj=f.object({apply:f.literal("greyscale"),params:f.tuple([]).optional()}),Lj=f.union([$j,Jj,Xj,Kj,qj,Yj,Wj,Qj,Nj,Mj,Vj,Gj,Hj,Oj,Uj]),Xz=Object.freeze({LIGHTEN:"lighten",BRIGHTEN:"brighten",DARKEN:"darken",DESATURATE:"desaturate",SATURATE:"saturate",GREYSCALE:"greyscale",SPIN:"spin",HUE:"hue",MIX:"mix",TINT:"tint",SHADE:"shade",XOR:"xor",RED:"red",GREEN:"green",BLUE:"blue"});function Ej($){let J={r:Array(256).fill(0),g:Array(256).fill(0),b:Array(256).fill(0)};return $.scan((X,K,q)=>{J.r[$.bitmap.data[q+0]]++,J.g[$.bitmap.data[q+1]]++,J.b[$.bitmap.data[q+2]]++}),J}var oJ=function($,J,X){return($-J)*255/(X-J)},rJ=function($){return[$.findIndex((J)=>J>0),255-$.slice().reverse().findIndex((J)=>J>0)]},k5={normalize($){let J=Ej($),X={r:rJ(J.r),g:rJ(J.g),b:rJ(J.b)};return $.scan((K,q,Y)=>{let W=$.bitmap.data[Y+0],Q=$.bitmap.data[Y+1],N=$.bitmap.data[Y+2];$.bitmap.data[Y+0]=oJ(W,X.r[0],X.r[1]),$.bitmap.data[Y+1]=oJ(Q,X.g[0],X.g[1]),$.bitmap.data[Y+2]=oJ(N,X.b[0],X.b[1])}),$},invert($){return $.scan((J,X,K)=>{$.bitmap.data[K]=255-$.bitmap.data[K],$.bitmap.data[K+1]=255-$.bitmap.data[K+1],$.bitmap.data[K+2]=255-$.bitmap.data[K+2]}),$},brightness($,J){if(typeof J!=="number")throw Error("val must be numbers");return $.scan((X,K,q)=>{$.bitmap.data[q]=$6($.bitmap.data[q]*J),$.bitmap.data[q+1]=$6($.bitmap.data[q+1]*J),$.bitmap.data[q+2]=$6($.bitmap.data[q+2]*J)}),$},contrast($,J){if(typeof J!=="number")throw Error("val must be numbers");if(J<-1||J>1)throw Error("val must be a number between -1 and +1");let X=(J+1)/(1-J);function K(q){return q=Math.floor(X*(q-127)+127),q<0?0:q>255?255:q}return $.scan((q,Y,W)=>{$.bitmap.data[W]=K($.bitmap.data[W]),$.bitmap.data[W+1]=K($.bitmap.data[W+1]),$.bitmap.data[W+2]=K($.bitmap.data[W+2])}),$},posterize($,J){if(typeof J!=="number")throw Error("n must be numbers");if(J<2)J=2;return $.scan((X,K,q)=>{let Y=$.bitmap.data[q],W=$.bitmap.data[q+1],Q=$.bitmap.data[q+2];$.bitmap.data[q]=Math.floor(Y/255*(J-1))/(J-1)*255,$.bitmap.data[q+1]=Math.floor(W/255*(J-1))/(J-1)*255,$.bitmap.data[q+2]=Math.floor(Q/255*(J-1))/(J-1)*255}),$},greyscale($){return $.scan((J,X,K)=>{let q=0.2126*$.bitmap.data[K]+0.7152*$.bitmap.data[K+1]+0.0722*$.bitmap.data[K+2];$.bitmap.data[K]=q,$.bitmap.data[K+1]=q,$.bitmap.data[K+2]=q}),$},opacity($,J){if(typeof J!=="number")throw Error("f must be a number");if(J<0||J>1)throw Error("f must be a number from 0 to 1");return $.scan((X,K,q)=>{let Y=$.bitmap.data[q+3]*J;$.bitmap.data[q+3]=Y}),$},sepia($){return $.scan((J,X,K)=>{let q=$.bitmap.data[K],Y=$.bitmap.data[K+1],W=$.bitmap.data[K+2];q=q*0.393+Y*0.769+W*0.189,Y=q*0.349+Y*0.686+W*0.168,W=q*0.272+Y*0.534+W*0.131,$.bitmap.data[K]=q<255?q:255,$.bitmap.data[K+1]=Y<255?Y:255,$.bitmap.data[K+2]=W<255?W:255}),$},fade($,J){if(typeof J!=="number")throw Error("f must be a number");if(J<0||J>1)throw Error("f must be a number from 0 to 1");return this.opacity($,1-J)},convolution($,J){let X=iE.parse(J),{kernel:K,edgeHandling:q=L8.EXTEND}="kernel"in X?X:{kernel:X,edgeHandling:void 0};if(!K[0])throw Error("kernel must be a matrix");let Y=Buffer.from($.bitmap.data),W=K.length,Q=K[0].length,N=Math.floor(W/2),M=Math.floor(Q/2),V=-N,G=-M,H,O,L,j,E,B,S,A,z,P;return $.scan((R,U,C)=>{j=0,L=0,O=0;for(let k=V;k<=N;k++)for(let h=G;h<=M;h++){if(A=R+h,z=U+k,H=K[k+N][h+M],P=$.getPixelIndex(A,z,q),P===-1)S=0,B=0,E=0;else E=$.bitmap.data[P+0],B=$.bitmap.data[P+1],S=$.bitmap.data[P+2];O+=H*E,L+=H*B,j+=H*S}if(O<0)O=0;if(L<0)L=0;if(j<0)j=0;if(O>255)O=255;if(L>255)L=255;if(j>255)j=255;Y[C+0]=O,Y[C+1]=L,Y[C+2]=j}),$.bitmap.data=Y,$},opaque($){return $.scan((J,X,K)=>{$.bitmap.data[K+3]=255}),$},pixelate($,J){let X=eE.parse(J),{size:K,x:q=0,y:Y=0,w:W=$.bitmap.width-q,h:Q=$.bitmap.height-Y}=typeof X==="number"?{size:X}:X,N=[[0.0625,0.125,0.0625],[0.125,0.25,0.125],[0.0625,0.125,0.0625]],M=x6($);return o6(M,q,Y,W,Q,(V,G,H)=>{V=K*Math.floor(V/K),G=K*Math.floor(G/K);let O=lW(M,N,V,G);$.bitmap.data[H]=O[0],$.bitmap.data[H+1]=O[1],$.bitmap.data[H+2]=O[2],$.bitmap.data[H+3]=O[3]}),$},convolute($,J){let X=aE.parse(J),{kernel:K,x:q=0,y:Y=0,w:W=$.bitmap.width-q,h:Q=$.bitmap.height-Y}="kernel"in X?X:{kernel:X},N=x6($);return o6(N,q,Y,W,Q,(M,V,G)=>{let H=lW(N,K,M,V);$.bitmap.data[G]=$6(H[0]),$.bitmap.data[G+1]=$6(H[1]),$.bitmap.data[G+2]=$6(H[2]),$.bitmap.data[G+3]=$6(H[3])}),$},color($,J){if(!J||!Array.isArray(J))throw Error("actions must be an array");return J.forEach((X)=>Lj.parse(X)),J=J.map((X)=>{if(X.apply==="xor"||X.apply==="mix")X.params[0]=B0(X.params[0]).toRgb();return X}),$.scan((X,K,q)=>{let Y={r:$.bitmap.data[q],g:$.bitmap.data[q+1],b:$.bitmap.data[q+2]},W=(Q,N)=>$6(Y[Q]+N);J.forEach((Q)=>{if(Q.apply==="mix")Y=nJ(Y,Q.params[0],Q.params[1]);else if(Q.apply==="tint")Y=nJ(Y,{r:255,g:255,b:255},Q.params?.[0]);else if(Q.apply==="shade")Y=nJ(Y,{r:0,g:0,b:0},Q.params?.[0]);else if(Q.apply==="xor")Y={r:Y.r^Q.params[0].r,g:Y.g^Q.params[0].g,b:Y.b^Q.params[0].b};else if(Q.apply==="red")Y.r=W("r",Q.params[0]);else if(Q.apply==="green")Y.g=W("g",Q.params[0]);else if(Q.apply==="blue")Y.b=W("b",Q.params[0]);else{if(Q.apply==="hue")Q.apply="spin";let N=B0(Y),M=N[Q.apply].bind(N);if(!M)throw Error("action "+Q.apply+" not supported");Y=M(...Q.params||[]).toRgb()}}),$.bitmap.data[q]=Y.r,$.bitmap.data[q+1]=Y.g,$.bitmap.data[q+2]=Y.b}),$}};var ZN=h8(IQ(),1);function J4($,J){return $.then(function(X){return[null,X]}).catch(function(X){if(J)Object.assign(X,J);return[X,void 0]})}import{promises as _Q}from"fs";import{existsSync as hQ}from"fs";var yQ=_Q.readFile,xQ=_Q.writeFile;var DN=h8(uQ(),1);var e6;(function($){$[$.LEFT=1]="LEFT",$[$.CENTER=2]="CENTER",$[$.RIGHT=4]="RIGHT"})(e6||(e6={}));var $8;(function($){$[$.TOP=8]="TOP",$[$.MIDDLE=16]="MIDDLE",$[$.BOTTOM=32]="BOTTOM"})($8||($8={}));var o$;(function($){$.SRC_OVER="srcOver",$.DST_OVER="dstOver",$.MULTIPLY="multiply",$.ADD="add",$.SCREEN="screen",$.OVERLAY="overlay",$.DARKEN="darken",$.LIGHTEN="lighten",$.HARD_LIGHT="hardLight",$.DIFFERENCE="difference",$.EXCLUSION="exclusion"})(o$||(o$={}));var X4={};f4(X4,{srcOver:()=>lQ,screen:()=>oQ,overlay:()=>rQ,names:()=>AR,multiply:()=>dQ,lighten:()=>sQ,hardLight:()=>aQ,exclusion:()=>eQ,dstOver:()=>cQ,difference:()=>tQ,darken:()=>iQ,add:()=>nQ});function lQ($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=($.r*$.a+J.r*J.a*(1-$.a))/K,Y=($.g*$.a+J.g*J.a*(1-$.a))/K,W=($.b*$.a+J.b*J.a*(1-$.a))/K;return{r:q,g:Y,b:W,a:K}}function cQ($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=(J.r*J.a+$.r*$.a*(1-J.a))/K,Y=(J.g*J.a+$.g*$.a*(1-J.a))/K,W=(J.b*J.a+$.b*$.a*(1-J.a))/K;return{r:q,g:Y,b:W,a:K}}function dQ($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=$.r*$.a,Y=$.g*$.a,W=$.b*$.a,Q=J.r*J.a,N=J.g*J.a,M=J.b*J.a,V=(q*Q+q*(1-J.a)+Q*(1-$.a))/K,G=(Y*N+Y*(1-J.a)+N*(1-$.a))/K,H=(W*M+W*(1-J.a)+M*(1-$.a))/K;return{r:V,g:G,b:H,a:K}}function nQ($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=$.r*$.a,Y=$.g*$.a,W=$.b*$.a,Q=J.r*J.a,N=J.g*J.a,M=J.b*J.a,V=(q+Q)/K,G=(Y+N)/K,H=(W+M)/K;return{r:V,g:G,b:H,a:K}}function oQ($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=$.r*$.a,Y=$.g*$.a,W=$.b*$.a,Q=J.r*J.a,N=J.g*J.a,M=J.b*J.a,V=(q*J.a+Q*$.a-q*Q+q*(1-J.a)+Q*(1-$.a))/K,G=(Y*J.a+N*$.a-Y*N+Y*(1-J.a)+N*(1-$.a))/K,H=(W*J.a+M*$.a-W*M+W*(1-J.a)+M*(1-$.a))/K;return{r:V,g:G,b:H,a:K}}function rQ($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=$.r*$.a,Y=$.g*$.a,W=$.b*$.a,Q=J.r*J.a,N=J.g*J.a,M=J.b*J.a,V=(2*Q<=J.a?2*q*Q+q*(1-J.a)+Q*(1-$.a):q*(1+J.a)+Q*(1+$.a)-2*Q*q-J.a*$.a)/K,G=(2*N<=J.a?2*Y*N+Y*(1-J.a)+N*(1-$.a):Y*(1+J.a)+N*(1+$.a)-2*N*Y-J.a*$.a)/K,H=(2*M<=J.a?2*W*M+W*(1-J.a)+M*(1-$.a):W*(1+J.a)+M*(1+$.a)-2*M*W-J.a*$.a)/K;return{r:V,g:G,b:H,a:K}}function iQ($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=$.r*$.a,Y=$.g*$.a,W=$.b*$.a,Q=J.r*J.a,N=J.g*J.a,M=J.b*J.a,V=(Math.min(q*J.a,Q*$.a)+q*(1-J.a)+Q*(1-$.a))/K,G=(Math.min(Y*J.a,N*$.a)+Y*(1-J.a)+N*(1-$.a))/K,H=(Math.min(W*J.a,M*$.a)+W*(1-J.a)+M*(1-$.a))/K;return{r:V,g:G,b:H,a:K}}function sQ($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=$.r*$.a,Y=$.g*$.a,W=$.b*$.a,Q=J.r*J.a,N=J.g*J.a,M=J.b*J.a,V=(Math.max(q*J.a,Q*$.a)+q*(1-J.a)+Q*(1-$.a))/K,G=(Math.max(Y*J.a,N*$.a)+Y*(1-J.a)+N*(1-$.a))/K,H=(Math.max(W*J.a,M*$.a)+W*(1-J.a)+M*(1-$.a))/K;return{r:V,g:G,b:H,a:K}}function aQ($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=$.r*$.a,Y=$.g*$.a,W=$.b*$.a,Q=J.r*J.a,N=J.g*J.a,M=J.b*J.a,V=(2*q<=$.a?2*q*Q+q*(1-J.a)+Q*(1-$.a):q*(1+J.a)+Q*(1+$.a)-2*Q*q-J.a*$.a)/K,G=(2*Y<=$.a?2*Y*N+Y*(1-J.a)+N*(1-$.a):Y*(1+J.a)+N*(1+$.a)-2*N*Y-J.a*$.a)/K,H=(2*W<=$.a?2*W*M+W*(1-J.a)+M*(1-$.a):W*(1+J.a)+M*(1+$.a)-2*M*W-J.a*$.a)/K;return{r:V,g:G,b:H,a:K}}function tQ($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=$.r*$.a,Y=$.g*$.a,W=$.b*$.a,Q=J.r*J.a,N=J.g*J.a,M=J.b*J.a,V=(q+Q-2*Math.min(q*J.a,Q*$.a))/K,G=(Y+N-2*Math.min(Y*J.a,N*$.a))/K,H=(W+M-2*Math.min(W*J.a,M*$.a))/K;return{r:V,g:G,b:H,a:K}}function eQ($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=$.r*$.a,Y=$.g*$.a,W=$.b*$.a,Q=J.r*J.a,N=J.g*J.a,M=J.b*J.a,V=(q*J.a+Q*$.a-2*q*Q+q*(1-J.a)+Q*(1-$.a))/K,G=(Y*J.a+N*$.a-2*Y*N+Y*(1-J.a)+N*(1-$.a))/K,H=(W*J.a+M*$.a-2*W*M+W*(1-J.a)+M*(1-$.a))/K;return{r:V,g:G,b:H,a:K}}var AR=[lQ,cQ,dQ,nQ,oQ,rQ,iQ,sQ,aQ,tQ,eQ];function w5($,J,X=0,K=0,q={}){if(!(J instanceof $.constructor))throw Error("The source must be a Jimp image");if(typeof X!=="number"||typeof K!=="number")throw Error("x and y must be numbers");let{mode:Y=o$.SRC_OVER}=q,{opacitySource:W=1,opacityDest:Q=1}=q;if(typeof W!=="number"||W<0||W>1)W=1;if(typeof Q!=="number"||Q<0||Q>1)Q=1;let N=X4[Y];if(X=Math.round(X),K=Math.round(K),Q!==1)$.scan((M,V,G)=>{let H=$.bitmap.data[G+3]*Q;$.bitmap.data[G+3]=H});return J.scan((M,V,G)=>{let H=$.getPixelIndex(X+M,K+V,L8.CROP);if(H===-1)return;let O=N({r:J.bitmap.data[G+0]/255,g:J.bitmap.data[G+1]/255,b:J.bitmap.data[G+2]/255,a:J.bitmap.data[G+3]/255},{r:$.bitmap.data[H+0]/255,g:$.bitmap.data[H+1]/255,b:$.bitmap.data[H+2]/255,a:$.bitmap.data[H+3]/255},W);$.bitmap.data[H+0]=$6(O.r*255),$.bitmap.data[H+1]=$6(O.g*255),$.bitmap.data[H+2]=$6(O.b*255),$.bitmap.data[H+3]=$6(O.a*255)}),$}var zN=h8(FN(),1);function W4($){let J=$._exif;return J&&J.tags&&J.tags.Orientation||1}function yR($){let J=$.bitmap.width,X=$.bitmap.height;switch(W4($)){case 1:return null;case 2:return function(K,q){return[J-K-1,q]};case 3:return function(K,q){return[J-K-1,X-q-1]};case 4:return function(K,q){return[K,X-q-1]};case 5:return function(K,q){return[q,K]};case 6:return function(K,q){return[q,X-K-1]};case 7:return function(K,q){return[J-q-1,X-K-1]};case 8:return function(K,q){return[J-q-1,K]};default:return null}}function xR($,J,X,K){let q=$.bitmap.data,Y=$.bitmap.width,W=Buffer.alloc(q.length);for(let Q=0;Q<J;Q++)for(let N=0;N<X;N++){let[M,V]=K(Q,N),G=J*N+Q<<2,H=Y*V+M<<2,O=q.readUInt32BE(H);W.writeUInt32BE(O,G)}$.bitmap.data=W,$.bitmap.width=J,$.bitmap.height=X,$._exif.tags.Orientation=1}function hR($){if(W4($)<2)return;let J=yR($),X=W4($)>4,K=X?$.bitmap.height:$.bitmap.width,q=X?$.bitmap.width:$.bitmap.height;if(J)xR($,K,q,J)}async function vN($,J){try{$._exif=zN.default.create(J).parse(),hR($)}catch{}}var Q4={data:Buffer.alloc(0),width:0,height:0};function CN($){let J=Buffer.alloc($.byteLength),X=new Uint8Array($);for(let K=0;K<J.length;++K)J[K]=X[K];return J}function kN({plugins:$,formats:J}={}){let X=$||[],K=(J||[]).map((Y)=>Y()),q=class{bitmap=Q4;background=0;formats=[];mime;constructor(W=Q4){if(this.formats=K,"data"in W)this.bitmap=W;else if(this.bitmap={data:Buffer.alloc(W.width*W.height*4),width:W.width,height:W.height},W.color){this.background=typeof W.color==="string"?TX(W.color):W.color;for(let Q=0;Q<this.bitmap.data.length;Q+=4)this.bitmap.data.writeUInt32BE(this.background,Q)}for(let Q of X)for(let N in Q)this[N]=(...M)=>{let V=Q[N]?.(this,...M);if(typeof V==="object"&&"bitmap"in V)return this.bitmap=V.bitmap,this;return V}}static async read(W,Q){if(Buffer.isBuffer(W)||W instanceof ArrayBuffer)return this.fromBuffer(W);if(hQ(W))return this.fromBuffer(await yQ(W));let[N,M]=await J4(fetch(W));if(N)throw Error(`Could not load Buffer from URL: ${W}`);if(!M.ok)throw Error(`HTTP Status ${M.status} for url ${W}`);let[V,G]=await J4(M.arrayBuffer());if(V)throw Error(`Could not load Buffer from ${W}`);let H=CN(G);return this.fromBuffer(H,Q)}static fromBitmap(W){let Q;if(W.data instanceof Buffer)Q=Buffer.from(W.data);if(W.data instanceof Uint8Array||W.data instanceof Uint8ClampedArray)Q=Buffer.from(W.data.buffer);if(Array.isArray(W.data))Q=Buffer.concat(W.data.map((N)=>Buffer.from(N.toString(16).padStart(8,"0"),"hex")));if(!Q)throw Error("data must be a Buffer");if(typeof W.height!=="number"||typeof W.width!=="number")throw Error("bitmap must have width and height");return new q({height:W.height,width:W.width,data:Q})}static async fromBuffer(W,Q){let N=W instanceof ArrayBuffer?CN(W):W,M=await ZN.default.fromBuffer(N);if(!M||!M.mime)throw Error("Could not find MIME for Buffer");let V=K.find((H)=>H.mime===M.mime);if(!V||!V.decode)throw Error(`Mime type ${M.mime} does not support decoding`);let G=new q(await V.decode(N,Q?.[V.mime]));return G.mime=M.mime,vN(G,N),G}inspect(){return"<Jimp "+(this.bitmap===Q4?"pending...":this.bitmap.width+"x"+this.bitmap.height)+">"}toString(){return"[object Jimp]"}get width(){return this.bitmap.width}get height(){return this.bitmap.height}async getBuffer(W,Q){let N=this.formats.find((V)=>V.mime===W);if(!N||!N.encode)throw Error(`Unsupported MIME type: ${W}`);let M;if(N.hasAlpha)M=this;else M=new q({width:this.bitmap.width,height:this.bitmap.height,color:this.background}),w5(M,this);return N.encode(M.bitmap,Q)}async getBase64(W,Q){let N=await this.getBuffer(W,Q);return"data:"+W+";base64,"+N.toString("base64")}async write(W,Q){let N=DN.default.getType(W);await xQ(W,await this.getBuffer(N,Q))}clone(){return new q({...this.bitmap,data:Buffer.from(this.bitmap.data)})}getPixelIndex(W,Q,N){let M,V;if(!N)N=L8.EXTEND;if(typeof W!=="number"||typeof Q!=="number")throw Error("x and y must be numbers");if(W=Math.round(W),Q=Math.round(Q),M=W,V=Q,N===L8.EXTEND){if(W<0)M=0;if(W>=this.bitmap.width)M=this.bitmap.width-1;if(Q<0)V=0;if(Q>=this.bitmap.height)V=this.bitmap.height-1}if(N===L8.WRAP){if(W<0)M=this.bitmap.width+W;if(W>=this.bitmap.width)M=W%this.bitmap.width;if(Q<0)V=this.bitmap.height+Q;if(Q>=this.bitmap.height)V=Q%this.bitmap.height}let G=this.bitmap.width*V+M<<2;if(M<0||M>=this.bitmap.width)G=-1;if(V<0||V>=this.bitmap.height)G=-1;return G}getPixelColor(W,Q){if(typeof W!=="number"||typeof Q!=="number")throw Error("x and y must be numbers");let N=this.getPixelIndex(W,Q);return this.bitmap.data.readUInt32BE(N)}setPixelColor(W,Q,N){if(typeof W!=="number"||typeof Q!=="number"||typeof N!=="number")throw Error("hex, x and y must be numbers");let M=this.getPixelIndex(Q,N);return this.bitmap.data.writeUInt32BE(W,M),this}hasAlpha(){let{width:W,height:Q,data:N}=this.bitmap,M=W*Q<<2;for(let V=3;V<M;V+=4)if(N[V]!==255)return!0;return!1}composite(W,Q=0,N=0,M={}){return w5(this,W,Q,N,M)}scan(W,Q,N,M,V){return o6(this,W,Q,N,M,V)}scanIterator(W=0,Q=0,N=this.bitmap.width,M=this.bitmap.height){if(typeof W!=="number"||typeof Q!=="number")throw Error("x and y must be numbers");if(typeof N!=="number"||typeof M!=="number")throw Error("w and h must be numbers");return wX(this,W,Q,N,M)}};return q}var m6;(function($){$.NEAREST_NEIGHBOR="nearestNeighbor",$.BILINEAR="bilinearInterpolation",$.BICUBIC="bicubicInterpolation",$.HERMITE="hermiteInterpolation",$.BEZIER="bezierInterpolation"})(m6||(m6={}));function V6($,J,X,K,q,Y,W){this.widthOriginal=Math.abs(Math.floor($)||0),this.heightOriginal=Math.abs(Math.floor(J)||0),this.targetWidth=Math.abs(Math.floor(X)||0),this.targetHeight=Math.abs(Math.floor(K)||0),this.colorChannels=q?4:3,this.interpolationPass=Boolean(Y),this.resizeCallback=typeof W==="function"?W:function(){},this.targetWidthMultipliedByChannels=this.targetWidth*this.colorChannels,this.originalWidthMultipliedByChannels=this.widthOriginal*this.colorChannels,this.originalHeightMultipliedByChannels=this.heightOriginal*this.colorChannels,this.widthPassResultSize=this.targetWidthMultipliedByChannels*this.heightOriginal,this.finalResultSize=this.targetWidthMultipliedByChannels*this.targetHeight,this.initialize()}V6.prototype.initialize=function(){if(this.widthOriginal>0&&this.heightOriginal>0&&this.targetWidth>0&&this.targetHeight>0)this.configurePasses();else throw console.log(this),Error("Invalid settings specified for the resizer.")};V6.prototype.configurePasses=function(){if(this.widthOriginal===this.targetWidth)this.resizeWidth=this.bypassResizer;else if(this.ratioWeightWidthPass=this.widthOriginal/this.targetWidth,this.ratioWeightWidthPass<1&&this.interpolationPass)this.initializeFirstPassBuffers(!0),this.resizeWidth=this.colorChannels===4?this.resizeWidthInterpolatedRGBA:this.resizeWidthInterpolatedRGB;else this.initializeFirstPassBuffers(!1),this.resizeWidth=this.colorChannels===4?this.resizeWidthRGBA:this.resizeWidthRGB;if(this.heightOriginal===this.targetHeight)this.resizeHeight=this.bypassResizer;else if(this.ratioWeightHeightPass=this.heightOriginal/this.targetHeight,this.ratioWeightHeightPass<1&&this.interpolationPass)this.initializeSecondPassBuffers(!0),this.resizeHeight=this.resizeHeightInterpolated;else this.initializeSecondPassBuffers(!1),this.resizeHeight=this.colorChannels===4?this.resizeHeightRGBA:this.resizeHeightRGB};V6.prototype._resizeWidthInterpolatedRGBChannels=function($,J){let X=J?4:3,K=this.ratioWeightWidthPass,q=this.widthBuffer,Y=0,W=0,Q=0,N=0,M=0,V;for(V=0;Y<0.3333333333333333;V+=X,Y+=K)for(W=V,Q=0;W<this.widthPassResultSize;Q+=this.originalWidthMultipliedByChannels,W+=this.targetWidthMultipliedByChannels)if(q[W]=$[Q],q[W+1]=$[Q+1],q[W+2]=$[Q+2],J)q[W+3]=$[Q+3];Y-=0.3333333333333333;let G;for(G=this.widthOriginal-1;Y<G;V+=X,Y+=K){M=Y%1,N=1-M;for(W=V,Q=Math.floor(Y)*X;W<this.widthPassResultSize;Q+=this.originalWidthMultipliedByChannels,W+=this.targetWidthMultipliedByChannels)if(q[W+0]=$[Q+0]*N+$[Q+X+0]*M,q[W+1]=$[Q+1]*N+$[Q+X+1]*M,q[W+2]=$[Q+2]*N+$[Q+X+2]*M,J)q[W+3]=$[Q+3]*N+$[Q+X+3]*M}for(G=this.originalWidthMultipliedByChannels-X;V<this.targetWidthMultipliedByChannels;V+=X)for(W=V,Q=G;W<this.widthPassResultSize;Q+=this.originalWidthMultipliedByChannels,W+=this.targetWidthMultipliedByChannels)if(q[W]=$[Q],q[W+1]=$[Q+1],q[W+2]=$[Q+2],J)q[W+3]=$[Q+3];return q};V6.prototype._resizeWidthRGBChannels=function($,J){let X=J?4:3,K=this.ratioWeightWidthPass,q=1/K,Y=this.originalWidthMultipliedByChannels-X+1,W=this.targetWidthMultipliedByChannels-X+1,Q=this.outputWidthWorkBench,N=this.widthBuffer,M=this.outputWidthWorkBenchOpaquePixelsCount,V=0,G=0,H=0,O=0,L=0,j=0,E=0,B=1,S=0,A=0,z=0,P=0;do{for(L=0;L<this.originalHeightMultipliedByChannels;)if(Q[L++]=0,Q[L++]=0,Q[L++]=0,J)Q[L++]=0,M[L/X-1]=0;V=K;do{G=1+H-O,B=Math.min(V,G);for(L=0,j=H;L<this.originalHeightMultipliedByChannels;j+=Y)if(S=$[j],A=$[++j],z=$[++j],P=J?$[++j]:255,Q[L++]+=(P?S:0)*B,Q[L++]+=(P?A:0)*B,Q[L++]+=(P?z:0)*B,J)Q[L++]+=P*B,M[L/X-1]+=P?B:0;if(V>=G)H+=X,O=H,V-=G;else{O+=V;break}}while(V>0&&H<this.originalWidthMultipliedByChannels);for(L=0,j=E;L<this.originalHeightMultipliedByChannels;j+=W)if(V=J?M[L/X]:1,B=J?V?1/V:0:q,N[j]=Q[L++]*B,N[++j]=Q[L++]*B,N[++j]=Q[L++]*B,J)N[++j]=Q[L++]*q;E+=X}while(E<this.targetWidthMultipliedByChannels);return N};V6.prototype._resizeHeightRGBChannels=function($,J){let X=this.ratioWeightHeightPass,K=1/X,q=this.outputHeightWorkBench,Y=this.heightBuffer,W=this.outputHeightWorkBenchOpaquePixelsCount,Q=0,N=0,M=0,V=0,G=0,H=0,O=0,L=1,j=0,E=0,B=0,S=0;do{for(G=0;G<this.targetWidthMultipliedByChannels;)if(q[G++]=0,q[G++]=0,q[G++]=0,J)q[G++]=0,W[G/4-1]=0;Q=X;do{N=1+M-V,L=Math.min(Q,N),O=M;for(G=0;G<this.targetWidthMultipliedByChannels;)if(j=$[O++],E=$[O++],B=$[O++],S=J?$[O++]:255,q[G++]+=(S?j:0)*L,q[G++]+=(S?E:0)*L,q[G++]+=(S?B:0)*L,J)q[G++]+=S*L,W[G/4-1]+=S?L:0;if(Q>=N)M=O,V=M,Q-=N;else{V+=Q;break}}while(Q>0&&M<this.widthPassResultSize);for(G=0;G<this.targetWidthMultipliedByChannels;)if(Q=J?W[G/4]:1,L=J?Q?1/Q:0:K,Y[H++]=Math.round(q[G++]*L),Y[H++]=Math.round(q[G++]*L),Y[H++]=Math.round(q[G++]*L),J)Y[H++]=Math.round(q[G++]*K)}while(H<this.finalResultSize);return Y};V6.prototype.resizeWidthInterpolatedRGB=function($){return this._resizeWidthInterpolatedRGBChannels($,!1)};V6.prototype.resizeWidthInterpolatedRGBA=function($){return this._resizeWidthInterpolatedRGBChannels($,!0)};V6.prototype.resizeWidthRGB=function($){return this._resizeWidthRGBChannels($,!1)};V6.prototype.resizeWidthRGBA=function($){return this._resizeWidthRGBChannels($,!0)};V6.prototype.resizeHeightInterpolated=function($){let J=this.ratioWeightHeightPass,X=this.heightBuffer,K=0,q=0,Y=0,W=0,Q=0,N=0,M=0,V;for(;K<0.3333333333333333;K+=J)for(Y=0;Y<this.targetWidthMultipliedByChannels;)X[q++]=Math.round($[Y++]);K-=0.3333333333333333;for(V=this.heightOriginal-1;K<V;K+=J){M=K%1,N=1-M,W=Math.floor(K)*this.targetWidthMultipliedByChannels,Q=W+this.targetWidthMultipliedByChannels;for(Y=0;Y<this.targetWidthMultipliedByChannels;++Y)X[q++]=Math.round($[W++]*N+$[Q++]*M)}while(q<this.finalResultSize)for(Y=0,W=V*this.targetWidthMultipliedByChannels;Y<this.targetWidthMultipliedByChannels;++Y)X[q++]=Math.round($[W++]);return X};V6.prototype.resizeHeightRGB=function($){return this._resizeHeightRGBChannels($,!1)};V6.prototype.resizeHeightRGBA=function($){return this._resizeHeightRGBChannels($,!0)};V6.prototype.resize=function($){this.resizeCallback(this.resizeHeight(this.resizeWidth($)))};V6.prototype.bypassResizer=function($){return $};V6.prototype.initializeFirstPassBuffers=function($){if(this.widthBuffer=this.generateFloatBuffer(this.widthPassResultSize),!$){if(this.outputWidthWorkBench=this.generateFloatBuffer(this.originalHeightMultipliedByChannels),this.colorChannels>3)this.outputWidthWorkBenchOpaquePixelsCount=this.generateFloat64Buffer(this.heightOriginal)}};V6.prototype.initializeSecondPassBuffers=function($){if(this.heightBuffer=this.generateUint8Buffer(this.finalResultSize),!$){if(this.outputHeightWorkBench=this.generateFloatBuffer(this.targetWidthMultipliedByChannels),this.colorChannels>3)this.outputHeightWorkBenchOpaquePixelsCount=this.generateFloat64Buffer(this.targetWidth)}};V6.prototype.generateFloatBuffer=function($){try{return new Float32Array($)}catch(J){return console.error(J),[]}};V6.prototype.generateFloat64Buffer=function($){try{return new Float64Array($)}catch(J){return console.error(J),[]}};V6.prototype.generateUint8Buffer=function($){try{return new Uint8Array($)}catch(J){return console.error(J),[]}};var wN=V6;var N4={nearestNeighbor($,J){let{width:X,height:K}=$,q=J.width,Y=J.height,W=$.data,Q=J.data;for(let N=0;N<Y;N++)for(let M=0;M<q;M++){let V=(N*q+M)*4,G=Math.floor(N*K/Y),H=Math.floor(M*X/q),O=(G*X+H)*4;Q[V++]=W[O++],Q[V++]=W[O++],Q[V++]=W[O++],Q[V++]=W[O++]}},bilinearInterpolation($,J){let{width:X,height:K}=$,q=J.width,Y=J.height,W=$.data,Q=J.data,N=function(V,G,H,O,L){if(G===O)return H;return Math.round((V-G)*L+(O-V)*H)},M=function(V,G,H,O,L,j,E,B){let S=(E*X+O)*4+G,A=(E*X+L)*4+G,z=N(H,O,W[S],L,W[A]);if(B===E)Q[V+G]=z;else{S=(B*X+O)*4+G,A=(B*X+L)*4+G;let P=N(H,O,W[S],L,W[A]);Q[V+G]=N(j,E,z,B,P)}};for(let V=0;V<Y;V++)for(let G=0;G<q;G++){let H=(V*q+G)*4,O=G*X/q,L=Math.floor(O),j=Math.min(Math.ceil(O),X-1),E=V*K/Y,B=Math.floor(E),S=Math.min(Math.ceil(E),K-1);M(H,0,O,L,j,E,B,S),M(H,1,O,L,j,E,B,S),M(H,2,O,L,j,E,B,S),M(H,3,O,L,j,E,B,S)}},_interpolate2D($,J,X,K){let q=$.data,Y=J.data,W=$.width,Q=$.height,N=J.width,M=J.height,V=Math.max(1,Math.floor(W/N)),G=N*V,H=Math.max(1,Math.floor(Q/M)),O=M*H,L=Buffer.alloc(G*Q*4);for(let B=0;B<Q;B++)for(let S=0;S<G;S++){let A=S*(W-1)/G,z=Math.floor(A),P=A-z,R=(B*W+z)*4,U=(B*G+S)*4;for(let C=0;C<4;C++){let k=R+C,h=z>0?q[k-4]:2*q[k]-q[k+4],F=q[k],v=q[k+4],D=z<W-2?q[k+8]:2*q[k+4]-q[k];L[U+C]=K(h,F,v,D,P)}}let j=Buffer.alloc(G*O*4);for(let B=0;B<O;B++)for(let S=0;S<G;S++){let A=B*(Q-1)/O,z=Math.floor(A),P=A-z,R=(z*G+S)*4,U=(B*G+S)*4;for(let C=0;C<4;C++){let k=R+C,h=z>0?L[k-G*4]:2*L[k]-L[k+G*4],F=L[k],v=L[k+G*4],D=z<Q-2?L[k+G*8]:2*L[k+G*4]-L[k];j[U+C]=K(h,F,v,D,P)}}let E=V*H;if(E>1)for(let B=0;B<M;B++)for(let S=0;S<N;S++){let A=0,z=0,P=0,R=0,U=0;for(let k=0;k<H;k++){let h=B*H+k;for(let F=0;F<V;F++){let v=S*V+F,D=(h*G+v)*4,w=j[D+3];if(w)A+=j[D],z+=j[D+1],P+=j[D+2],U++;R+=w}}let C=(B*N+S)*4;Y[C]=U?Math.round(A/U):0,Y[C+1]=U?Math.round(z/U):0,Y[C+2]=U?Math.round(P/U):0,Y[C+3]=Math.round(R/E)}else J.data=j},bicubicInterpolation($,J,X){let K=function(q,Y,W,Q,N){let M=Q-W-q+Y,V=q-Y-M,G=W-q,H=Y;return Math.max(0,Math.min(255,M*(N*N*N)+V*(N*N)+G*N+H))};return this._interpolate2D($,J,X,K)},hermiteInterpolation($,J,X){let K=function(q,Y,W,Q,N){let M=Y,V=0.5*(W-q),G=q-2.5*Y+2*W-0.5*Q,H=0.5*(Q-q)+1.5*(Y-W);return Math.max(0,Math.min(255,Math.round(((H*N+G)*N+V)*N+M)))};return this._interpolate2D($,J,X,K)},bezierInterpolation($,J,X){let K=function(q,Y,W,Q,N){let M=Y+(W-q)/4,V=W-(Q-Y)/4,G=1-N,H=Y*G*G*G,O=3*M*G*G*N,L=3*V*G*N*N,j=W*N*N*N;return Math.max(0,Math.min(255,Math.round(H+O+L+j)))};return this._interpolate2D($,J,X,K)}};var gR=f.union([f.object({w:f.number().min(0),h:f.number().min(0).optional(),mode:f.nativeEnum(m6).optional()}),f.object({w:f.number().min(0).optional(),h:f.number().min(0),mode:f.nativeEnum(m6).optional()})]),fR=f.object({w:f.number().min(0),h:f.number().min(0),mode:f.nativeEnum(m6).optional()}),bR=f.object({f:f.number().min(0),mode:f.nativeEnum(m6).optional()}),E8={resize($,J){let{mode:X}=gR.parse(J),K,q;if(typeof J.w==="number")K=J.w,q=J.h??$.bitmap.height*(K/$.bitmap.width);else if(typeof J.h==="number")q=J.h,K=J.w??$.bitmap.width*(q/$.bitmap.height);else throw Error("w must be a number");if(K=Math.round(K)||1,q=Math.round(q)||1,X&&typeof N4[X]==="function"){let Y={data:Buffer.alloc(K*q*4),width:K,height:q};N4[X]($.bitmap,Y),$.bitmap=Y}else new wN($.bitmap.width,$.bitmap.height,K,q,!0,!0,(W)=>{$.bitmap.data=Buffer.from(W),$.bitmap.width=K,$.bitmap.height=q}).resize($.bitmap.data);return $},scale($,J){let{f:X,mode:K}=typeof J==="number"?{f:J}:bR.parse(J),q=$.bitmap.width*X,Y=$.bitmap.height*X;return this.resize($,{w:q,h:Y,mode:K})},scaleToFit($,J){let{h:X,w:K,mode:q}=fR.parse(J),Y=K/X>$.bitmap.width/$.bitmap.height?X/$.bitmap.height:K/$.bitmap.width;return this.scale($,{f:Y,mode:q})}};var pR=f.object({w:f.number(),h:f.number(),align:f.number().optional(),mode:f.nativeEnum(m6).optional()}),TN={contain($,J){let{w:X,h:K,align:q=e6.CENTER|$8.MIDDLE,mode:Y}=pR.parse(J),W=q&7,Q=q>>3;if(!(W!==0&&!(W&W-1)||Q!==0&&!(Q&Q-1)))throw Error("only use one flag per alignment direction");let N=W>>1,M=Q>>1,V=X/K>$.bitmap.width/$.bitmap.height?K/$.bitmap.height:X/$.bitmap.width,G=E8.scale(x6($),{f:V,mode:Y});return $=E8.resize($,{w:X,h:K,mode:Y}),$.scan((H,O,L)=>{$.bitmap.data.writeUInt32BE($.background,L)}),$=D5.blit($,{src:G,x:($.bitmap.width-G.bitmap.width)/2*N,y:($.bitmap.height-G.bitmap.height)/2*M}),$}};var lR=f.object({x:f.number(),y:f.number(),w:f.number(),h:f.number()}),cR=f.object({tolerance:f.number().min(0).max(1).optional(),cropOnlyFrames:f.boolean().optional(),cropSymmetric:f.boolean().optional(),leaveBorder:f.number().optional(),ignoreSides:f.object({north:f.boolean().optional(),south:f.boolean().optional(),east:f.boolean().optional(),west:f.boolean().optional()}).optional()}),_5={crop($,J){let{x:X,y:K,w:q,h:Y}=lR.parse(J);if(X=Math.round(X),K=Math.round(K),q=Math.round(q),Y=Math.round(Y),X===0&&q===$.bitmap.width){let W=q*K+X<<2,Q=W+(Y*q<<2);$.bitmap.data=$.bitmap.data.slice(W,Q)}else{let W=Buffer.allocUnsafe(q*Y*4),Q=0;o6($,X,K,q,Y,function(N,M,V){let G=$.bitmap.data.readUInt32BE(V);W.writeUInt32BE(G,Q),Q+=4}),$.bitmap.data=W}return $.bitmap.width=q,$.bitmap.height=Y,$},autocrop($,J={}){let{tolerance:X=0.0002,cropOnlyFrames:K=!0,cropSymmetric:q=!1,leaveBorder:Y=0,ignoreSides:W}=typeof J==="number"?{tolerance:J}:cR.parse(J),Q=$.bitmap.width,N=$.bitmap.height,M=1,V={north:!1,south:!1,east:!1,west:!1,...W},G=$.getPixelColor(0,0),H=r1(G),O=0,L=0,j=0,E=0;if(G=$.getPixelColor(0,0),!V.north)$:for(let z=0;z<N-1;z++){for(let P=0;P<Q;P++){let R=$.getPixelColor(P,z),U=r1(R);if(a5(H,U)>X)break $}O++}if(G=$.getPixelColor(Q,0),!V.west)$:for(let z=0;z<Q-1;z++){for(let P=0+O;P<N;P++){let R=$.getPixelColor(z,P),U=r1(R);if(a5(H,U)>X)break $}E++}if(G=$.getPixelColor(0,N),!V.south)$:for(let z=N-1;z>=O+1;z--){for(let P=Q-L-1;P>=0;P--){let R=$.getPixelColor(P,z),U=r1(R);if(a5(H,U)>X)break $}j++}if(G=$.getPixelColor(Q,N),!V.east)$:for(let z=Q-1;z>=0+E+1;z--){for(let P=N-1;P>=0+O;P--){let R=$.getPixelColor(z,P),U=r1(R);if(a5(H,U)>X)break $}L++}let B=!1;if(E-=Y,L-=Y,O-=Y,j-=Y,q){let z=Math.min(L,E),P=Math.min(O,j);E=z,L=z,O=P,j=P}E=E>=0?E:0,L=L>=0?L:0,O=O>=0?O:0,j=j>=0?j:0;let S=Q-(E+L),A=N-(j+O);if(K)B=L!==0&&O!==0&&E!==0&&j!==0;else B=L!==0||O!==0||E!==0||j!==0;if(B)this.crop($,{x:E,y:O,w:S,h:A});return $}};var nR=f.object({w:f.number(),h:f.number(),align:f.number().optional(),mode:f.nativeEnum(m6).optional()}),IN={cover($,J){let{w:X,h:K,align:q=e6.CENTER|$8.MIDDLE,mode:Y}=nR.parse(J),W=q&7,Q=q>>3;if(!(W!==0&&!(W&W-1)||Q!==0&&!(Q&Q-1)))throw Error("only use one flag per alignment direction");let N=W>>1,M=Q>>1,V=X/K>$.bitmap.width/$.bitmap.height?X/$.bitmap.width:K/$.bitmap.height;return $=E8.scale($,{f:V,mode:Y}),$=_5.crop($,{x:($.bitmap.width-X)/2*N,y:($.bitmap.height-K)/2*M,w:X,h:K}),$}};var rR=f.object({map:B1,offset:f.number()}),_N={displace($,J){let{map:X,offset:K}=rR.parse(J),q=x6($);return $.scan((Y,W,Q)=>{let N=X.bitmap.data[Q]/256*K;N=Math.round(N);let M=$.getPixelIndex(Y+N,W);$.bitmap.data[M]=q.bitmap.data[Q],$.bitmap.data[M+1]=q.bitmap.data[Q+1],$.bitmap.data[M+2]=q.bitmap.data[Q+2]}),$}};var yN={dither($){let J=[1,9,3,11,13,5,15,7,4,12,2,10,16,8,14,6];return $.scan((X,K,q)=>{let Y=((K&3)<<2)+X%4,W=J[Y];$.bitmap.data[q]=Math.min($.bitmap.data[q]+W,255),$.bitmap.data[q+1]=Math.min($.bitmap.data[q+1]+W,255),$.bitmap.data[q+2]=Math.min($.bitmap.data[q+2]+W,255)}),$}};var aR=f.object({radius:f.number().min(0).optional()}),xN={fisheye($,J={}){let{radius:X=2.5}=aR.parse(J),K=x6($),{width:q,height:Y}=K.bitmap;return K.scan((W,Q)=>{let N=W/q,M=Q/Y,V=Math.sqrt(Math.pow(N-0.5,2)+Math.pow(M-0.5,2)),G=2*Math.pow(V,X),H=(N-0.5)/V,O=(M-0.5)/V,L=Math.round((G*H+0.5)*q),j=Math.round((G*O+0.5)*Y),E=K.getPixelColor(L,j);$.setPixelColor(E,W,Q)}),$.setPixelColor(K.getPixelColor(q/2,Y/2),q/2,Y/2),$}};var eR=f.object({horizontal:f.boolean().optional(),vertical:f.boolean().optional()}),hN={flip($,J){let{horizontal:X,vertical:K}=eR.parse(J),q=Buffer.alloc($.bitmap.data.length);return $.scan((Y,W,Q)=>{let N=X?$.bitmap.width-1-Y:Y,M=K?$.bitmap.height-1-W:W,V=$.bitmap.width*M+N<<2,G=$.bitmap.data.readUInt32BE(Q);q.writeUInt32BE(G,V)}),$.bitmap.data=Buffer.from(q),$}};var _9=h8(mN(),1);class pN{size;smallerSize;constructor($,J){this.size=$||32,this.smallerSize=J||8,KB(this.size)}distance($,J){let X=0;for(let K=0;K<$.length;K++)if($[K]!==J[K])X++;return X/$.length}getHash($){$=E8.resize(x6($),{w:this.size,h:this.size}),$=k5.greyscale($);let J=[];for(let W=0;W<$.bitmap.width;W++){let Q=[];for(let N=0;N<$.bitmap.height;N++)Q[N]=XB($.getPixelColor(W,N)).b;J[W]=Q}let X=qB(J,this.size),K=0;for(let W=0;W<this.smallerSize;W++)for(let Q=0;Q<this.smallerSize;Q++)K+=X[W][Q];let q=K/(this.smallerSize*this.smallerSize),Y="";for(let W=0;W<this.smallerSize;W++)for(let Q=0;Q<this.smallerSize;Q++)Y+=X[W][Q]>q?"1":"0";return Y}}function XB($){let J=$&255;$>>>=8;let X=$&255;$>>>=8;let K=$&255;return $>>>=8,{r:$&255,g:K,b:X,a:J}}var s$=[];function KB($){for(let J=1;J<$;J++)s$[J]=1;s$[0]=1/Math.sqrt(2)}function qB($,J){let X=J,K=[];for(let q=0;q<X;q++){let Y=[];for(let W=0;W<X;W++){let Q=0;for(let N=0;N<X;N++)for(let M=0;M<X;M++)Q+=Math.cos((2*N+1)/(2*X)*q*Math.PI)*Math.cos((2*M+1)/(2*X)*W*Math.PI)*$[N][M];Q*=s$[q]*s$[W]/4,Y[W]=Q,K[q]=Y}}return K}var V4=pN;var uN="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",lN=[NaN,NaN];for(let $=2;$<65;$++){let J=_9.default(_9.default.BIN,uN.slice(0,$))(Array(65).join("1"));lN.push(J.length)}var cN={pHash($){return new V4().getHash($)},hash($,J=64){if(J<2||J>64)throw Error("base must be a number between 2 and 64");let X=uN.slice(0,J),K=this.pHash($),q=lN[J];return _9.default(_9.default.BIN,X)(K).padStart(q,"0")},distanceFromHash($,J){let X=new V4,K=X.getHash($);return X.distance(K,J)}};var WB=f.object({src:B1,x:f.number().optional(),y:f.number().optional()}),QB=f.union([B1,WB]),dN={mask($,J){QB.parse(J);let X,K,q;if("bitmap"in J)X=J,K=0,q=0;else X=J.src,K=J.x??0,q=J.y??0;K=Math.round(K),q=Math.round(q);let Y=$.bitmap.width,W=$.bitmap.height;return X.scan(function(Q,N,M){let V=K+Q,G=q+N;if(V>=0&&G>=0&&V<Y&&G<W){let H=$.getPixelIndex(V,G),{data:O}=X.bitmap,L=(O[M+0]+O[M+1]+O[M+2])/3;$.bitmap.data[H+3]*=L/255}}),$}};function y5($,J){let X=0;for(let K=0;K<J.length;K++){let q=J[K],Y=$.chars[q];if(Y){let W=$.kernings[q],Q=J[K+1],N=W&&Q&&W[Q]?W[Q]||0:0;X+=(Y.xadvance||0)+N}}return X}function G4($,J,X){let K=J.replace(/[\r\n]+/g,` 
`).split(" "),q=[],Y=[],W=0;return K.forEach((Q)=>{if(y5($,Q+(K.length>1?" ":""))>X){let G=Q[Symbol.iterator](),H="";for(let O of G){let L=[...Y,H+O].join(" "),j=y5($,L);if(j<X)H+=O;else if(j>X)q.push([...Y,H]),Y=[],H=O;else q.push([...Y,H+O]),Y=[],H=""}return}let M=[...Y,Q].join(" "),V=y5($,M);if(V<=X&&!Q.includes(`
`)){if(V>W)W=V;Y.push(Q)}else q.push(Y),Y=[Q.replace(`
`,"")]}),q.push(Y),{lines:q,longestLine:W}}function H4($,J,X){let{lines:K}=G4($,J,X);return K.length*$.common.lineHeight}var MB=f.object({x:f.number(),y:f.number(),text:f.union([f.union([f.string(),f.number()]),f.object({text:f.union([f.string(),f.number()]),alignmentX:f.nativeEnum(e6).optional(),alignmentY:f.nativeEnum($8).optional()})]),maxWidth:f.number().optional(),maxHeight:f.number().optional(),cb:f.function(f.tuple([f.object({x:f.number(),y:f.number()})])).optional()});function VB($,J,X,K){if(K===e6.LEFT)return 0;if(K===e6.CENTER)return(X-y5($,J))/2;return X-y5($,J)}function GB($,J,X,K,q){if(q.width>0&&q.height>0){let Y=J.pages[q.page];if(Y)$=D5.blit($,{src:Y,x:X+q.xoffset,y:K+q.yoffset,srcX:q.x,srcY:q.y,srcW:q.width,srcH:q.height})}return $}function HB($,J,X,K,q,Y){for(let W=0;W<q.length;W++){let Q=q[W],N;if(J.chars[Q])N=Q;else if(/\s/.test(Q))N="";else N="?";let M=J.chars[N]||{xadvance:void 0},V=J.kernings[N];if(M)GB($,J,X,K,M);let G=q[W+1],H=V&&G&&V[G]?V[G]||0:0;X+=H+(M.xadvance||Y)}}var nN={print($,{font:J,...X}){let{x:K,y:q,text:Y,maxWidth:W=1/0,maxHeight:Q=1/0,cb:N=()=>{}}=MB.parse(X),M,V;if(typeof Y==="object"&&Y.text!==null&&Y.text!==void 0)M=Y.alignmentX||e6.LEFT,V=Y.alignmentY||$8.TOP,{text:Y}=Y;else M=e6.LEFT,V=$8.TOP,Y=Y.toString();if(typeof Y==="number")Y=Y.toString();if(Q!==1/0&&V===$8.BOTTOM)q+=Q-H4(J,Y,W);else if(Q!==1/0&&V===$8.MIDDLE)q+=Q/2-H4(J,Y,W)/2;let G=Object.entries(J.chars).find((L)=>L[1].xadvance)?.[1].xadvance;if(typeof G!=="number")throw Error("Could not find default character width");let{lines:H,longestLine:O}=G4(J,Y,W);return H.forEach((L)=>{let j=L.join(" "),E=VB(J,j,W,M);HB($,J,K+E,q,j,G),q+=J.common.lineHeight}),N.bind($)({x:K+O,y:q}),$}};var UB=f.union([f.number(),f.object({deg:f.number(),mode:f.union([f.boolean(),f.nativeEnum(m6)]).optional()})]);function oN($){return function(J,X){return X*$+J<<2}}function LB($,J){if(Math.abs(J)%90!==0)throw Error("Unsupported matrix rotation degree");let X=$.bitmap.width,K=$.bitmap.height,q;switch(J){case 90:case-270:q=90;break;case 180:case-180:q=180;break;case 270:case-90:q=-90;break;default:throw Error("Unsupported matrix rotation degree")}let Y=q===180?X:K,W=q===180?K:X,Q=Buffer.alloc($.bitmap.data.length),N=oN(X),M=oN(Y);for(let V=0;V<X;V++)for(let G=0;G<K;G++){let H=N(V,G),O=$.bitmap.data.readUInt32BE(H),L;switch(q){case 90:L=M(G,X-V-1);break;case-90:L=M(K-G-1,V);break;case 180:L=M(X-V-1,K-G-1);break;default:throw Error("Unsupported matrix rotation angle")}Q.writeUInt32BE(O,L)}$.bitmap.data=Q,$.bitmap.width=Y,$.bitmap.height=W}function rN($,J){return function(X,K){return{x:X+$,y:K+J}}}function EB($,J,X){let K=J*Math.PI/180,q=Math.cos(K),Y=Math.sin(K),W=$.bitmap.width,Q=$.bitmap.height;if(X===!0||typeof X==="string"){if(W=Math.ceil(Math.abs($.bitmap.width*q)+Math.abs($.bitmap.height*Y))+1,Q=Math.ceil(Math.abs($.bitmap.width*Y)+Math.abs($.bitmap.height*q))+1,W%2!==0)W++;if(Q%2!==0)Q++;let O=x6($);$.scan((j,E,B)=>{$.bitmap.data.writeUInt32BE($.background,B)});let L=Math.max(W,Q,$.bitmap.width,$.bitmap.height);$=E8.resize($,{h:L,w:L,mode:X===!0?void 0:X}),$=w5($,O,$.bitmap.width/2-O.bitmap.width/2,$.bitmap.height/2-O.bitmap.height/2)}let N=$.bitmap.width,M=$.bitmap.height,V=Buffer.alloc($.bitmap.data.length),G=rN(-(N/2),-(M/2)),H=rN(N/2+0.5,M/2+0.5);for(let O=1;O<=M;O++)for(let L=1;L<=N;L++){let j=G(L,O),E=H(q*j.x-Y*j.y,q*j.y+Y*j.x),B=N*(O-1)+L-1<<2;if(E.x>=0&&E.x<N&&E.y>=0&&E.y<M){let S=(N*(E.y|0)+E.x|0)<<2,A=$.bitmap.data.readUInt32BE(S);V.writeUInt32BE(A,B)}else V.writeUInt32BE($.background,B)}if($.bitmap.data=V,X===!0||typeof X==="string"){let O=Math.max(N/2-W/2,0),L=Math.max(M/2-Q/2,0);$=_5.crop($,{x:O,y:L,w:W,h:Q})}}var iN={rotate($,J){let X=UB.parse(J),K=typeof X==="number"?{deg:X}:X,{mode:q=!0}=K,{deg:Y}=K;if(Y%=360,Y%360===0)return $;if(Y%90===0&&(q||$.bitmap.width===$.bitmap.height||Y%180===0))LB($,Y);else EB($,Y,q);return $}};var RB=f.object({max:f.number().min(0).max(255),replace:f.number().min(0).max(255).optional(),autoGreyscale:f.boolean().optional()}),sN={threshold($,J){let{max:X,replace:K=255,autoGreyscale:q=!0}=RB.parse(J);if(X=$6(X),K=$6(K),q)k5.greyscale($);return $.scan((Y,W,Q)=>{let N=$.bitmap.data[Q]<X?$.bitmap.data[Q]:K;$.bitmap.data[Q]=N,$.bitmap.data[Q+1]=N,$.bitmap.data[Q+2]=N}),$}};var $M=Object.defineProperty,PB=($,J,X)=>(J in $)?$M($,J,{enumerable:!0,configurable:!0,writable:!0,value:X}):$[J]=X,t8=($,J)=>{for(var X in J)$M($,X,{get:J[X],enumerable:!0})},n=($,J,X)=>{return PB($,typeof J!=="symbol"?J+"":J,X),X},SB={};t8(SB,{bt709:()=>JM});var JM={};t8(JM,{Y:()=>XM,x:()=>KM,y:()=>qM});var XM=(($)=>{return $[$.RED=0.2126]="RED",$[$.GREEN=0.7152]="GREEN",$[$.BLUE=0.0722]="BLUE",$[$.WHITE=1]="WHITE",$})(XM||{}),KM=(($)=>{return $[$.RED=0.64]="RED",$[$.GREEN=0.3]="GREEN",$[$.BLUE=0.15]="BLUE",$[$.WHITE=0.3127]="WHITE",$})(KM||{}),qM=(($)=>{return $[$.RED=0.33]="RED",$[$.GREEN=0.6]="GREEN",$[$.BLUE=0.06]="BLUE",$[$.WHITE=0.329]="WHITE",$})(qM||{}),AB={};t8(AB,{lab2rgb:()=>wB,lab2xyz:()=>VM,rgb2hsl:()=>a$,rgb2lab:()=>x9,rgb2xyz:()=>YM,xyz2lab:()=>MM,xyz2rgb:()=>GM});function O4($){return $>0.04045?(($+0.055)/1.055)**2.4:$/12.92}function YM($,J,X){return $=O4($/255),J=O4(J/255),X=O4(X/255),{x:$*0.4124+J*0.3576+X*0.1805,y:$*0.2126+J*0.7152+X*0.0722,z:$*0.0193+J*0.1192+X*0.9505}}var WM={};t8(WM,{degrees2radians:()=>A1,inRange0to255:()=>u6,inRange0to255Rounded:()=>J8,intInRange:()=>FB,max3:()=>QM,min3:()=>NM,stableSort:()=>R4});function A1($){return $*(Math.PI/180)}function QM($,J,X){let K=$;if(K<J)K=J;if(K<X)K=X;return K}function NM($,J,X){let K=$;if(K>J)K=J;if(K>X)K=X;return K}function FB($,J,X){if($>X)$=X;if($<J)$=J;return $|0}function J8($){if($=Math.round($),$>255)$=255;else if($<0)$=0;return $}function u6($){if($>255)$=255;else if($<0)$=0;return $}function R4($,J){let X=typeof $[0],K;if(X==="number"||X==="string"){let q=Object.create(null);for(let Y=0,W=$.length;Y<W;Y++){let Q=$[Y];if(q[Q]||q[Q]===0)continue;q[Q]=Y}K=$.sort((Y,W)=>J(Y,W)||q[Y]-q[W])}else{let q=$.slice(0);K=$.sort((Y,W)=>J(Y,W)||q.indexOf(Y)-q.indexOf(W))}return K}function a$($,J,X){let K=NM($,J,X),q=QM($,J,X),Y=q-K,W=(K+q)/510,Q=0;if(W>0&&W<1)Q=Y/(W<0.5?q+K:510-q-K);let N=0;if(Y>0){if(q===$)N=(J-X)/Y;else if(q===J)N=2+(X-$)/Y;else N=4+($-J)/Y;if(N*=60,N<0)N+=360}return{h:N,s:Q,l:W}}var zB=0.95047,vB=1,CB=1.08883;function U4($){return $>0.008856?$**0.3333333333333333:7.787*$+0.13793103448275862}function MM($,J,X){if($=U4($/zB),J=U4(J/vB),X=U4(X/CB),116*J-16<0)throw Error("xxx");return{L:Math.max(0,116*J-16),a:500*($-J),b:200*(J-X)}}function x9($,J,X){let K=YM($,J,X);return MM(K.x,K.y,K.z)}var ZB=0.95047,DB=1,kB=1.08883;function L4($){return $>0.206893034?$**3:($-0.13793103448275862)/7.787}function VM($,J,X){let K=($+16)/116,q=J/500+K,Y=K-X/200;return{x:ZB*L4(q),y:DB*L4(K),z:kB*L4(Y)}}function E4($){return $>0.0031308?1.055*$**0.4166666666666667-0.055:12.92*$}function GM($,J,X){let K=E4($*3.2406+J*-1.5372+X*-0.4986),q=E4($*-0.9689+J*1.8758+X*0.0415),Y=E4($*0.0557+J*-0.204+X*1.057);return{r:J8(K*255),g:J8(q*255),b:J8(Y*255)}}function wB($,J,X){let K=VM($,J,X);return GM(K.x,K.y,K.z)}var TB={};t8(TB,{AbstractDistanceCalculator:()=>d1,AbstractEuclidean:()=>t$,AbstractManhattan:()=>e$,CIE94GraphicArts:()=>UM,CIE94Textiles:()=>OM,CIEDE2000:()=>j8,CMetric:()=>LM,Euclidean:()=>EM,EuclideanBT709:()=>jM,EuclideanBT709NoAlpha:()=>RM,Manhattan:()=>BM,ManhattanBT709:()=>SM,ManhattanNommyde:()=>PM,PNGQuant:()=>AM});var d1=class{constructor(){n(this,"_maxDistance"),n(this,"_whitePoint"),this._setDefaults(),this.setWhitePoint(255,255,255,255)}setWhitePoint($,J,X,K){this._whitePoint={r:$>0?255/$:0,g:J>0?255/J:0,b:X>0?255/X:0,a:K>0?255/K:0},this._maxDistance=this.calculateRaw($,J,X,K,0,0,0,0)}calculateNormalized($,J){return this.calculateRaw($.r,$.g,$.b,$.a,J.r,J.g,J.b,J.a)/this._maxDistance}},HM=class extends d1{calculateRaw($,J,X,K,q,Y,W,Q){let N=x9(u6($*this._whitePoint.r),u6(J*this._whitePoint.g),u6(X*this._whitePoint.b)),M=x9(u6(q*this._whitePoint.r),u6(Y*this._whitePoint.g),u6(W*this._whitePoint.b)),V=N.L-M.L,G=N.a-M.a,H=N.b-M.b,O=Math.sqrt(N.a*N.a+N.b*N.b),L=Math.sqrt(M.a*M.a+M.b*M.b),j=O-L,E=G*G+H*H-j*j;E=E<0?0:Math.sqrt(E);let B=(Q-K)*this._whitePoint.a*this._kA;return Math.sqrt((V/this._Kl)**2+(j/(1+this._K1*O))**2+(E/(1+this._K2*O))**2+B**2)}},OM=class extends HM{_setDefaults(){this._Kl=2,this._K1=0.048,this._K2=0.014,this._kA=0.049019607843137254}},UM=class extends HM{_setDefaults(){this._Kl=1,this._K1=0.045,this._K2=0.015,this._kA=0.09803921568627451}},K6=class extends d1{_setDefaults(){}static _calculatehp($,J){let X=Math.atan2($,J);if(X>=0)return X;return X+K6._deg360InRad}static _calculateRT($,J){let X=J**7,K=2*Math.sqrt(X/(X+K6._pow25to7)),q=K6._deg30InRad*Math.exp(-((($-K6._deg275InRad)/K6._deg25InRad)**2));return-Math.sin(2*q)*K}static _calculateT($){return 1-0.17*Math.cos($-K6._deg30InRad)+0.24*Math.cos($*2)+0.32*Math.cos($*3+K6._deg6InRad)-0.2*Math.cos($*4-K6._deg63InRad)}static _calculate_ahp($,J,X,K){let q=X+K;if($===0)return q;if(J<=K6._deg180InRad)return q/2;if(q<K6._deg360InRad)return(q+K6._deg360InRad)/2;return(q-K6._deg360InRad)/2}static _calculate_dHp($,J,X,K){let q;if($===0)q=0;else if(J<=K6._deg180InRad)q=X-K;else if(X<=K)q=X-K+K6._deg360InRad;else q=X-K-K6._deg360InRad;return 2*Math.sqrt($)*Math.sin(q/2)}calculateRaw($,J,X,K,q,Y,W,Q){let N=x9(u6($*this._whitePoint.r),u6(J*this._whitePoint.g),u6(X*this._whitePoint.b)),M=x9(u6(q*this._whitePoint.r),u6(Y*this._whitePoint.g),u6(W*this._whitePoint.b)),V=(Q-K)*this._whitePoint.a*K6._kA,G=this.calculateRawInLab(N,M);return Math.sqrt(G+V*V)}calculateRawInLab($,J){let{L:X,a:K,b:q}=$,Y=J.L,W=J.a,Q=J.b,N=Math.sqrt(K*K+q*q),M=Math.sqrt(W*W+Q*Q),V=((N+M)/2)**7,G=0.5*(1-Math.sqrt(V/(V+K6._pow25to7))),H=(1+G)*K,O=(1+G)*W,L=Math.sqrt(H*H+q*q),j=Math.sqrt(O*O+Q*Q),E=L*j,B=K6._calculatehp(q,H),S=K6._calculatehp(Q,O),A=Math.abs(B-S),z=Y-X,P=j-L,R=K6._calculate_dHp(E,A,S,B),U=K6._calculate_ahp(E,A,B,S),C=K6._calculateT(U),k=(L+j)/2,h=((X+Y)/2-50)**2,F=1+0.015*h/Math.sqrt(20+h),v=1+0.045*k,D=1+0.015*C*k,w=K6._calculateRT(U,k),x=z/F,y=P/v,b=R/D;return x**2+y**2+b**2+w*y*b}},j8=K6;n(j8,"_kA",0.09803921568627451);n(j8,"_pow25to7",6103515625);n(j8,"_deg360InRad",A1(360));n(j8,"_deg180InRad",A1(180));n(j8,"_deg30InRad",A1(30));n(j8,"_deg6InRad",A1(6));n(j8,"_deg63InRad",A1(63));n(j8,"_deg275InRad",A1(275));n(j8,"_deg25InRad",A1(25));var LM=class extends d1{calculateRaw($,J,X,K,q,Y,W,Q){let N=($+q)/2*this._whitePoint.r,M=($-q)*this._whitePoint.r,V=(J-Y)*this._whitePoint.g,G=(X-W)*this._whitePoint.b,H=((512+N)*M*M>>8)+4*V*V+((767-N)*G*G>>8),O=(Q-K)*this._whitePoint.a;return Math.sqrt(H+O*O)}_setDefaults(){}},t$=class extends d1{calculateRaw($,J,X,K,q,Y,W,Q){let N=q-$,M=Y-J,V=W-X,G=Q-K;return Math.sqrt(this._kR*N*N+this._kG*M*M+this._kB*V*V+this._kA*G*G)}},EM=class extends t${_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},jM=class extends t${_setDefaults(){this._kR=0.2126,this._kG=0.7152,this._kB=0.0722,this._kA=1}},RM=class extends t${_setDefaults(){this._kR=0.2126,this._kG=0.7152,this._kB=0.0722,this._kA=0}},e$=class extends d1{calculateRaw($,J,X,K,q,Y,W,Q){let N=q-$,M=Y-J,V=W-X,G=Q-K;if(N<0)N=0-N;if(M<0)M=0-M;if(V<0)V=0-V;if(G<0)G=0-G;return this._kR*N+this._kG*M+this._kB*V+this._kA*G}},BM=class extends e${_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},PM=class extends e${_setDefaults(){this._kR=0.4984,this._kG=0.8625,this._kB=0.2979,this._kA=1}},SM=class extends e${_setDefaults(){this._kR=0.2126,this._kG=0.7152,this._kB=0.0722,this._kA=1}},AM=class extends d1{calculateRaw($,J,X,K,q,Y,W,Q){let N=(Q-K)*this._whitePoint.a;return this._colordifferenceCh($*this._whitePoint.r,q*this._whitePoint.r,N)+this._colordifferenceCh(J*this._whitePoint.g,Y*this._whitePoint.g,N)+this._colordifferenceCh(X*this._whitePoint.b,W*this._whitePoint.b,N)}_colordifferenceCh($,J,X){let K=$-J,q=K+X;return K*K+q*q}_setDefaults(){}},IB={};t8(IB,{AbstractPaletteQuantizer:()=>h9,ColorHistogram:()=>f9,NeuQuant:()=>Q6,NeuQuantFloat:()=>N6,RGBQuant:()=>vM,WuColorCube:()=>CM,WuQuant:()=>m5});var h9=class{quantizeSync(){for(let $ of this.quantize())if($.palette)return $.palette;throw Error("unreachable")}},l6=class{constructor(){n(this,"r"),n(this,"g"),n(this,"b"),n(this,"a"),n(this,"uint32"),n(this,"rgba"),this.uint32=4294967295,this.r=this.g=this.b=this.a=0,this.rgba=[,,,,],this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}static createByQuadruplet($){let J=new l6;return J.r=$[0]|0,J.g=$[1]|0,J.b=$[2]|0,J.a=$[3]|0,J._loadUINT32(),J._loadQuadruplet(),J}static createByRGBA($,J,X,K){let q=new l6;return q.r=$|0,q.g=J|0,q.b=X|0,q.a=K|0,q._loadUINT32(),q._loadQuadruplet(),q}static createByUint32($){let J=new l6;return J.uint32=$>>>0,J._loadRGBA(),J._loadQuadruplet(),J}from($){this.r=$.r,this.g=$.g,this.b=$.b,this.a=$.a,this.uint32=$.uint32,this.rgba[0]=$.r,this.rgba[1]=$.g,this.rgba[2]=$.b,this.rgba[3]=$.a}getLuminosity($){let J=this.r,X=this.g,K=this.b;if($)J=Math.min(255,255-this.a+this.a*J/255),X=Math.min(255,255-this.a+this.a*X/255),K=Math.min(255,255-this.a+this.a*K/255);return J*0.2126+X*0.7152+K*0.0722}_loadUINT32(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0}_loadRGBA(){this.r=this.uint32&255,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255}_loadQuadruplet(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a}},a8=class{constructor(){n(this,"_pointArray"),n(this,"_width"),n(this,"_height"),this._width=0,this._height=0,this._pointArray=[]}getWidth(){return this._width}getHeight(){return this._height}setWidth($){this._width=$}setHeight($){this._height=$}getPointArray(){return this._pointArray}clone(){let $=new a8;$._width=this._width,$._height=this._height;for(let J=0,X=this._pointArray.length;J<X;J++)$._pointArray[J]=l6.createByUint32(this._pointArray[J].uint32|0);return $}toUint32Array(){let $=this._pointArray.length,J=new Uint32Array($);for(let X=0;X<$;X++)J[X]=this._pointArray[X].uint32;return J}toUint8Array(){return new Uint8Array(this.toUint32Array().buffer)}static fromHTMLImageElement($){let{naturalWidth:J,naturalHeight:X}=$,K=document.createElement("canvas");return K.width=J,K.height=X,K.getContext("2d").drawImage($,0,0,J,X,0,0,J,X),a8.fromHTMLCanvasElement(K)}static fromHTMLCanvasElement($){let{width:J,height:X}=$,q=$.getContext("2d").getImageData(0,0,J,X);return a8.fromImageData(q)}static fromImageData($){let{width:J,height:X}=$;return a8.fromUint8Array($.data,J,X)}static fromUint8Array($,J,X){switch(Object.prototype.toString.call($)){case"[object Uint8ClampedArray]":case"[object Uint8Array]":break;default:$=new Uint8Array($)}let K=new Uint32Array($.buffer);return a8.fromUint32Array(K,J,X)}static fromUint32Array($,J,X){let K=new a8;K._width=J,K._height=X;for(let q=0,Y=$.length;q<Y;q++)K._pointArray[q]=l6.createByUint32($[q]|0);return K}static fromBuffer($,J,X){let K=new Uint32Array($.buffer,$.byteOffset,$.byteLength/Uint32Array.BYTES_PER_ELEMENT);return a8.fromUint32Array(K,J,X)}},aN=10;function j4($,J){let K=360/J,q=K/2;for(let Y=1,W=K-q;Y<J;Y++,W+=K)if($>=W&&$<W+K)return Y;return 0}var g9=class{constructor(){n(this,"_pointContainer"),n(this,"_pointArray",[]),n(this,"_i32idx",{}),this._pointContainer=new a8,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}add($){this._pointArray.push($),this._pointContainer.setWidth(this._pointArray.length)}has($){for(let J=this._pointArray.length-1;J>=0;J--)if($.uint32===this._pointArray[J].uint32)return!0;return!1}getNearestColor($,J){return this._pointArray[this._getNearestIndex($,J)|0]}getPointContainer(){return this._pointContainer}_nearestPointFromCache($){return typeof this._i32idx[$]==="number"?this._i32idx[$]:-1}_getNearestIndex($,J){let X=this._nearestPointFromCache(""+J.uint32);if(X>=0)return X;let K=Number.MAX_VALUE;X=0;for(let q=0,Y=this._pointArray.length;q<Y;q++){let W=this._pointArray[q],Q=$.calculateRaw(J.r,J.g,J.b,J.a,W.r,W.g,W.b,W.a);if(Q<K)K=Q,X=q}return this._i32idx[J.uint32]=X,X}sort(){this._i32idx={},this._pointArray.sort(($,J)=>{let X=a$($.r,$.g,$.b),K=a$(J.r,J.g,J.b),q=$.r===$.g&&$.g===$.b?0:1+j4(X.h,aN),W=(J.r===J.g&&J.g===J.b?0:1+j4(K.h,aN))-q;if(W)return-W;let Q=$.getLuminosity(!0),N=J.getLuminosity(!0);if(N-Q!==0)return N-Q;let M=(K.s*100|0)-(X.s*100|0);if(M)return-M;return 0})}},B4={};t8(B4,{HueStatistics:()=>FM,Palette:()=>g9,Point:()=>l6,PointContainer:()=>a8,ProgressTracker:()=>e8,arithmetic:()=>WM});var _B=class{constructor(){n(this,"num",0),n(this,"cols",[])}},FM=class{constructor($,J){n(this,"_numGroups"),n(this,"_minCols"),n(this,"_stats"),n(this,"_groupsFull"),this._numGroups=$,this._minCols=J,this._stats=[];for(let X=0;X<=$;X++)this._stats[X]=new _B;this._groupsFull=0}check($){if(this._groupsFull===this._numGroups+1)this.check=()=>{};let J=$&255,X=$>>>8&255,K=$>>>16&255,q=J===X&&X===K?0:1+j4(a$(J,X,K).h,this._numGroups),Y=this._stats[q],W=this._minCols;if(Y.num++,Y.num>W)return;if(Y.num===W)this._groupsFull++;if(Y.num<=W)this._stats[q].cols.push($)}injectIntoDictionary($){for(let J=0;J<=this._numGroups;J++)if(this._stats[J].num<=this._minCols)this._stats[J].cols.forEach((X)=>{if(!$[X])$[X]=1;else $[X]++})}injectIntoArray($){for(let J=0;J<=this._numGroups;J++)if(this._stats[J].num<=this._minCols)this._stats[J].cols.forEach((X)=>{if($.indexOf(X)===-1)$.push(X)})}},zM=class{constructor($,J){n(this,"progress"),n(this,"_step"),n(this,"_range"),n(this,"_last"),n(this,"_progressRange"),this._range=$,this._progressRange=J,this._step=Math.max(1,this._range/(zM.steps+1)|0),this._last=-this._step,this.progress=0}shouldNotify($){if($-this._last>=this._step)return this._last=$,this.progress=Math.min(this._progressRange*this._last/this._range,this._progressRange),!0;return!1}},e8=zM;n(e8,"steps",100);var D6=3,yB=class{constructor($){n(this,"r"),n(this,"g"),n(this,"b"),n(this,"a"),this.r=this.g=this.b=this.a=$}toPoint(){return l6.createByRGBA(this.r>>D6,this.g>>D6,this.b>>D6,this.a>>D6)}subtract($,J,X,K){this.r-=$|0,this.g-=J|0,this.b-=X|0,this.a-=K|0}},u0=class extends h9{constructor($,J=256){super();n(this,"_pointArray"),n(this,"_networkSize"),n(this,"_network"),n(this,"_sampleFactor"),n(this,"_radPower"),n(this,"_freq"),n(this,"_bias"),n(this,"_distance"),this._distance=$,this._pointArray=[],this._sampleFactor=1,this._networkSize=J,this._distance.setWhitePoint(255<<D6,255<<D6,255<<D6,255<<D6)}sample($){this._pointArray=this._pointArray.concat($.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let $=0;$<this._networkSize;$++)this._network[$]=new yB(($<<D6+8)/this._networkSize|0),this._freq[$]=u0._initialBias/this._networkSize|0,this._bias[$]=0}*_learn(){let $=this._sampleFactor,J=this._pointArray.length;if(J<u0._minpicturebytes)$=1;let X=30+($-1)/3|0,K=J/$|0,q=K/u0._nCycles|0,Y=u0._initAlpha,W=(this._networkSize>>3)*u0._radiusBias,Q=W>>u0._radiusBiasShift;if(Q<=1)Q=0;for(let V=0;V<Q;V++)this._radPower[V]=Y*((Q*Q-V*V)*u0._radBias/(Q*Q))>>>0;let N;if(J<u0._minpicturebytes)N=1;else if(J%u0._prime1!==0)N=u0._prime1;else if(J%u0._prime2!==0)N=u0._prime2;else if(J%u0._prime3!==0)N=u0._prime3;else N=u0._prime4;let M=new e8(K,99);for(let V=0,G=0;V<K;){if(M.shouldNotify(V))yield{progress:M.progress};let H=this._pointArray[G],O=H.b<<D6,L=H.g<<D6,j=H.r<<D6,E=H.a<<D6,B=this._contest(O,L,j,E);if(this._alterSingle(Y,B,O,L,j,E),Q!==0)this._alterNeighbour(Q,B,O,L,j,E);if(G+=N,G>=J)G-=J;if(V++,q===0)q=1;if(V%q===0){if(Y-=Y/X|0,W-=W/u0._radiusDecrease|0,Q=W>>u0._radiusBiasShift,Q<=1)Q=0;for(let S=0;S<Q;S++)this._radPower[S]=Y*((Q*Q-S*S)*u0._radBias/(Q*Q))>>>0}}}_buildPalette(){let $=new g9;return this._network.forEach((J)=>{$.add(J.toPoint())}),$.sort(),$}_alterNeighbour($,J,X,K,q,Y){let W=J-$;if(W<-1)W=-1;let Q=J+$;if(Q>this._networkSize)Q=this._networkSize;let N=J+1,M=J-1,V=1;while(N<Q||M>W){let G=this._radPower[V++]/u0._alphaRadBias;if(N<Q){let H=this._network[N++];H.subtract(G*(H.r-q),G*(H.g-K),G*(H.b-X),G*(H.a-Y))}if(M>W){let H=this._network[M--];H.subtract(G*(H.r-q),G*(H.g-K),G*(H.b-X),G*(H.a-Y))}}}_alterSingle($,J,X,K,q,Y){$/=u0._initAlpha;let W=this._network[J];W.subtract($*(W.r-q),$*(W.g-K),$*(W.b-X),$*(W.a-Y))}_contest($,J,X,K){let q=1020<<D6,Y=2147483647,W=Y,Q=-1,N=Q;for(let M=0;M<this._networkSize;M++){let V=this._network[M],G=this._distance.calculateNormalized(V,{r:X,g:J,b:$,a:K})*q|0;if(G<Y)Y=G,Q=M;let H=G-(this._bias[M]>>u0._initialBiasShift-D6);if(H<W)W=H,N=M;let O=this._freq[M]>>u0._betaShift;this._freq[M]-=O,this._bias[M]+=O<<u0._gammaShift}return this._freq[Q]+=u0._beta,this._bias[Q]-=u0._betaGamma,N}},Q6=u0;n(Q6,"_prime1",499);n(Q6,"_prime2",491);n(Q6,"_prime3",487);n(Q6,"_prime4",503);n(Q6,"_minpicturebytes",u0._prime4);n(Q6,"_nCycles",100);n(Q6,"_initialBiasShift",16);n(Q6,"_initialBias",1<<u0._initialBiasShift);n(Q6,"_gammaShift",10);n(Q6,"_betaShift",10);n(Q6,"_beta",u0._initialBias>>u0._betaShift);n(Q6,"_betaGamma",u0._initialBias<<u0._gammaShift-u0._betaShift);n(Q6,"_radiusBiasShift",6);n(Q6,"_radiusBias",1<<u0._radiusBiasShift);n(Q6,"_radiusDecrease",30);n(Q6,"_alphaBiasShift",10);n(Q6,"_initAlpha",1<<u0._alphaBiasShift);n(Q6,"_radBiasShift",8);n(Q6,"_radBias",1<<u0._radBiasShift);n(Q6,"_alphaRadBiasShift",u0._alphaBiasShift+u0._radBiasShift);n(Q6,"_alphaRadBias",1<<u0._alphaRadBiasShift);var k6=3,xB=class{constructor($){n(this,"r"),n(this,"g"),n(this,"b"),n(this,"a"),this.r=this.g=this.b=this.a=$}toPoint(){return l6.createByRGBA(this.r>>k6,this.g>>k6,this.b>>k6,this.a>>k6)}subtract($,J,X,K){this.r-=$,this.g-=J,this.b-=X,this.a-=K}},l0=class extends h9{constructor($,J=256){super();n(this,"_pointArray"),n(this,"_networkSize"),n(this,"_network"),n(this,"_sampleFactor"),n(this,"_radPower"),n(this,"_freq"),n(this,"_bias"),n(this,"_distance"),this._distance=$,this._pointArray=[],this._sampleFactor=1,this._networkSize=J,this._distance.setWhitePoint(255<<k6,255<<k6,255<<k6,255<<k6)}sample($){this._pointArray=this._pointArray.concat($.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let $=0;$<this._networkSize;$++)this._network[$]=new xB(($<<k6+8)/this._networkSize),this._freq[$]=l0._initialBias/this._networkSize,this._bias[$]=0}*_learn(){let $=this._sampleFactor,J=this._pointArray.length;if(J<l0._minpicturebytes)$=1;let X=30+($-1)/3,K=J/$,q=K/l0._nCycles|0,Y=l0._initAlpha,W=(this._networkSize>>3)*l0._radiusBias,Q=W>>l0._radiusBiasShift;if(Q<=1)Q=0;for(let V=0;V<Q;V++)this._radPower[V]=Y*((Q*Q-V*V)*l0._radBias/(Q*Q));let N;if(J<l0._minpicturebytes)N=1;else if(J%l0._prime1!==0)N=l0._prime1;else if(J%l0._prime2!==0)N=l0._prime2;else if(J%l0._prime3!==0)N=l0._prime3;else N=l0._prime4;let M=new e8(K,99);for(let V=0,G=0;V<K;){if(M.shouldNotify(V))yield{progress:M.progress};let H=this._pointArray[G],O=H.b<<k6,L=H.g<<k6,j=H.r<<k6,E=H.a<<k6,B=this._contest(O,L,j,E);if(this._alterSingle(Y,B,O,L,j,E),Q!==0)this._alterNeighbour(Q,B,O,L,j,E);if(G+=N,G>=J)G-=J;if(V++,q===0)q=1;if(V%q===0){if(Y-=Y/X,W-=W/l0._radiusDecrease,Q=W>>l0._radiusBiasShift,Q<=1)Q=0;for(let S=0;S<Q;S++)this._radPower[S]=Y*((Q*Q-S*S)*l0._radBias/(Q*Q))}}}_buildPalette(){let $=new g9;return this._network.forEach((J)=>{$.add(J.toPoint())}),$.sort(),$}_alterNeighbour($,J,X,K,q,Y){let W=J-$;if(W<-1)W=-1;let Q=J+$;if(Q>this._networkSize)Q=this._networkSize;let N=J+1,M=J-1,V=1;while(N<Q||M>W){let G=this._radPower[V++]/l0._alphaRadBias;if(N<Q){let H=this._network[N++];H.subtract(G*(H.r-q),G*(H.g-K),G*(H.b-X),G*(H.a-Y))}if(M>W){let H=this._network[M--];H.subtract(G*(H.r-q),G*(H.g-K),G*(H.b-X),G*(H.a-Y))}}}_alterSingle($,J,X,K,q,Y){$/=l0._initAlpha;let W=this._network[J];W.subtract($*(W.r-q),$*(W.g-K),$*(W.b-X),$*(W.a-Y))}_contest($,J,X,K){let q=1020<<k6,Y=2147483647,W=Y,Q=-1,N=Q;for(let M=0;M<this._networkSize;M++){let V=this._network[M],G=this._distance.calculateNormalized(V,{r:X,g:J,b:$,a:K})*q;if(G<Y)Y=G,Q=M;let H=G-(this._bias[M]>>l0._initialBiasShift-k6);if(H<W)W=H,N=M;let O=this._freq[M]>>l0._betaShift;this._freq[M]-=O,this._bias[M]+=O<<l0._gammaShift}return this._freq[Q]+=l0._beta,this._bias[Q]-=l0._betaGamma,N}},N6=l0;n(N6,"_prime1",499);n(N6,"_prime2",491);n(N6,"_prime3",487);n(N6,"_prime4",503);n(N6,"_minpicturebytes",l0._prime4);n(N6,"_nCycles",100);n(N6,"_initialBiasShift",16);n(N6,"_initialBias",1<<l0._initialBiasShift);n(N6,"_gammaShift",10);n(N6,"_betaShift",10);n(N6,"_beta",l0._initialBias>>l0._betaShift);n(N6,"_betaGamma",l0._initialBias<<l0._gammaShift-l0._betaShift);n(N6,"_radiusBiasShift",6);n(N6,"_radiusBias",1<<l0._radiusBiasShift);n(N6,"_radiusDecrease",30);n(N6,"_alphaBiasShift",10);n(N6,"_initAlpha",1<<l0._alphaBiasShift);n(N6,"_radBiasShift",8);n(N6,"_radBias",1<<l0._radBiasShift);n(N6,"_alphaRadBiasShift",l0._alphaBiasShift+l0._radBiasShift);n(N6,"_alphaRadBias",1<<l0._alphaRadBiasShift);var y9=class{constructor($,J){n(this,"_method"),n(this,"_hueStats"),n(this,"_histogram"),n(this,"_initColors"),n(this,"_minHueCols"),this._method=$,this._minHueCols=J<<2,this._initColors=J<<2,this._hueStats=new FM(y9._hueGroups,this._minHueCols),this._histogram=Object.create(null)}sample($){switch(this._method){case 1:this._colorStats1D($);break;case 2:this._colorStats2D($);break}}getImportanceSortedColorsIDXI32(){let $=R4(Object.keys(this._histogram),(X,K)=>this._histogram[K]-this._histogram[X]);if($.length===0)return[];let J;switch(this._method){case 1:let X=Math.min($.length,this._initColors),K=$[X-1],q=this._histogram[K];J=$.slice(0,X);let Y=X,W=$.length;while(Y<W&&this._histogram[$[Y]]===q)J.push($[Y++]);this._hueStats.injectIntoArray(J);break;case 2:J=$;break;default:throw Error("Incorrect method")}return J.map((X)=>+X)}_colorStats1D($){let J=this._histogram,X=$.getPointArray(),K=X.length;for(let q=0;q<K;q++){let Y=X[q].uint32;if(this._hueStats.check(Y),Y in J)J[Y]++;else J[Y]=1}}_colorStats2D($){let J=$.getWidth(),X=$.getHeight(),K=$.getPointArray(),q=y9._boxSize[0],Y=y9._boxSize[1],W=q*Y,Q=this._makeBoxes(J,X,q,Y),N=this._histogram;Q.forEach((M)=>{let V=Math.round(M.w*M.h/W)*y9._boxPixels;if(V<2)V=2;let G={};this._iterateBox(M,J,(H)=>{let O=K[H].uint32;if(this._hueStats.check(O),O in N)N[O]++;else if(O in G){if(++G[O]>=V)N[O]=G[O]}else G[O]=1})}),this._hueStats.injectIntoDictionary(N)}_iterateBox($,J,X){let K=$,q=K.y*J+K.x,Y=(K.y+K.h-1)*J+(K.x+K.w-1),W=J-K.w+1,Q=0,N=q;do X.call(this,N),N+=++Q%K.w===0?W:1;while(N<=Y)}_makeBoxes($,J,X,K){let q=$%X,Y=J%K,W=$-q,Q=J-Y,N=[];for(let M=0;M<J;M+=K)for(let V=0;V<$;V+=X)N.push({x:V,y:M,w:V===W?q:X,h:M===Q?Y:K});return N}},f9=y9;n(f9,"_boxSize",[64,64]);n(f9,"_boxPixels",2);n(f9,"_hueGroups",10);var hB=class{constructor($,J,X){n(this,"index"),n(this,"color"),n(this,"distance"),this.index=$,this.color=J,this.distance=X}},vM=class extends h9{constructor($,J=256,X=2){super();n(this,"_colors"),n(this,"_initialDistance"),n(this,"_distanceIncrement"),n(this,"_histogram"),n(this,"_distance"),this._distance=$,this._colors=J,this._histogram=new f9(X,J),this._initialDistance=0.01,this._distanceIncrement=0.005}sample($){this._histogram.sample($)}*quantize(){let $=this._histogram.getImportanceSortedColorsIDXI32();if($.length===0)throw Error("No colors in image");yield*this._buildPalette($)}*_buildPalette($){let J=new g9,X=J.getPointContainer().getPointArray(),K=Array($.length);for(let V=0;V<$.length;V++)X.push(l6.createByUint32($[V])),K[V]=1;let q=X.length,Y=[],W=q,Q=this._initialDistance,N=new e8(W-this._colors,99);while(W>this._colors){Y.length=0;for(let V=0;V<q;V++){if(N.shouldNotify(q-W))yield{progress:N.progress};if(K[V]===0)continue;let G=X[V];for(let H=V+1;H<q;H++){if(K[H]===0)continue;let O=X[H],L=this._distance.calculateNormalized(G,O);if(L<Q)Y.push(new hB(H,O,L)),K[H]=0,W--}}Q+=W>this._colors*3?this._initialDistance:this._distanceIncrement}if(W<this._colors){R4(Y,(G,H)=>H.distance-G.distance);let V=0;while(W<this._colors&&V<Y.length){let G=Y[V];K[G.index]=1,W++,V++}}let M=X.length;for(let V=M-1;V>=0;V--)if(K[V]===0){if(V!==M-1)X[V]=X[M-1];--M}X.length=M,J.sort(),yield{palette:J,progress:100}}};function x5($){let J=[];for(let X=0;X<$;X++)J[X]=0;return J}function h5($,J,X,K){let q=Array($);for(let Y=0;Y<$;Y++){q[Y]=Array(J);for(let W=0;W<J;W++){q[Y][W]=Array(X);for(let Q=0;Q<X;Q++){q[Y][W][Q]=Array(K);for(let N=0;N<K;N++)q[Y][W][Q][N]=0}}}return q}function g5($,J,X){let K=Array($);for(let q=0;q<$;q++){K[q]=Array(J);for(let Y=0;Y<J;Y++){K[q][Y]=Array(X);for(let W=0;W<X;W++)K[q][Y][W]=0}}return K}function f5($,J,X,K,q){for(let Y=0;Y<J;Y++){$[Y]=[];for(let W=0;W<X;W++){$[Y][W]=[];for(let Q=0;Q<K;Q++)$[Y][W][Q]=q}}}function b5($,J,X){for(let K=0;K<J;K++)$[K]=X}var CM=class{constructor(){n(this,"redMinimum"),n(this,"redMaximum"),n(this,"greenMinimum"),n(this,"greenMaximum"),n(this,"blueMinimum"),n(this,"blueMaximum"),n(this,"volume"),n(this,"alphaMinimum"),n(this,"alphaMaximum")}},w0=class extends h9{constructor($,J=256,X=5){super();n(this,"_reds"),n(this,"_greens"),n(this,"_blues"),n(this,"_alphas"),n(this,"_sums"),n(this,"_weights"),n(this,"_momentsRed"),n(this,"_momentsGreen"),n(this,"_momentsBlue"),n(this,"_momentsAlpha"),n(this,"_moments"),n(this,"_table"),n(this,"_pixels"),n(this,"_cubes"),n(this,"_colors"),n(this,"_significantBitsPerChannel"),n(this,"_maxSideIndex"),n(this,"_alphaMaxSideIndex"),n(this,"_sideSize"),n(this,"_alphaSideSize"),n(this,"_distance"),this._distance=$,this._setQuality(X),this._initialize(J)}sample($){let J=$.getPointArray();for(let X=0,K=J.length;X<K;X++)this._addColor(J[X]);this._pixels=this._pixels.concat(J)}*quantize(){yield*this._preparePalette();let $=new g9;for(let J=0;J<this._colors;J++)if(this._sums[J]>0){let X=this._sums[J],K=this._reds[J]/X,q=this._greens[J]/X,Y=this._blues[J]/X,W=this._alphas[J]/X,Q=l6.createByRGBA(K|0,q|0,Y|0,W|0);$.add(Q)}$.sort(),yield{palette:$,progress:100}}*_preparePalette(){yield*this._calculateMoments();let $=0,J=x5(this._colors);for(let W=1;W<this._colors;++W){if(this._cut(this._cubes[$],this._cubes[W]))J[$]=this._cubes[$].volume>1?this._calculateVariance(this._cubes[$]):0,J[W]=this._cubes[W].volume>1?this._calculateVariance(this._cubes[W]):0;else J[$]=0,W--;$=0;let Q=J[0];for(let N=1;N<=W;++N)if(J[N]>Q)Q=J[N],$=N;if(Q<=0){this._colors=W+1;break}}let X=[],K=[],q=[],Y=[];for(let W=0;W<this._colors;++W){let Q=w0._volume(this._cubes[W],this._weights);if(Q>0)X[W]=w0._volume(this._cubes[W],this._momentsRed)/Q|0,K[W]=w0._volume(this._cubes[W],this._momentsGreen)/Q|0,q[W]=w0._volume(this._cubes[W],this._momentsBlue)/Q|0,Y[W]=w0._volume(this._cubes[W],this._momentsAlpha)/Q|0;else X[W]=0,K[W]=0,q[W]=0,Y[W]=0}this._reds=x5(this._colors+1),this._greens=x5(this._colors+1),this._blues=x5(this._colors+1),this._alphas=x5(this._colors+1),this._sums=x5(this._colors+1);for(let W=0,Q=this._pixels.length;W<Q;W++){let N=this._pixels[W],M=-1,V=-1,G=Number.MAX_VALUE;for(let H=0;H<this._colors;H++){let O=X[H],L=K[H],j=q[H],E=Y[H],B=this._distance.calculateRaw(O,L,j,E,N.r,N.g,N.b,N.a);if(B<G)G=B,V=H}this._reds[V]+=N.r,this._greens[V]+=N.g,this._blues[V]+=N.b,this._alphas[V]+=N.a,this._sums[V]++}}_addColor($){let J=8-this._significantBitsPerChannel,X=($.r>>J)+1,K=($.g>>J)+1,q=($.b>>J)+1,Y=($.a>>J)+1;this._weights[Y][X][K][q]++,this._momentsRed[Y][X][K][q]+=$.r,this._momentsGreen[Y][X][K][q]+=$.g,this._momentsBlue[Y][X][K][q]+=$.b,this._momentsAlpha[Y][X][K][q]+=$.a,this._moments[Y][X][K][q]+=this._table[$.r]+this._table[$.g]+this._table[$.b]+this._table[$.a]}*_calculateMoments(){let $=[],J=[],X=[],K=[],q=[],Y=[],W=g5(this._sideSize,this._sideSize,this._sideSize),Q=g5(this._sideSize,this._sideSize,this._sideSize),N=g5(this._sideSize,this._sideSize,this._sideSize),M=g5(this._sideSize,this._sideSize,this._sideSize),V=g5(this._sideSize,this._sideSize,this._sideSize),G=g5(this._sideSize,this._sideSize,this._sideSize),H=0,O=new e8(this._alphaMaxSideIndex*this._maxSideIndex,99);for(let L=1;L<=this._alphaMaxSideIndex;++L){f5(W,this._sideSize,this._sideSize,this._sideSize,0),f5(Q,this._sideSize,this._sideSize,this._sideSize,0),f5(N,this._sideSize,this._sideSize,this._sideSize,0),f5(M,this._sideSize,this._sideSize,this._sideSize,0),f5(V,this._sideSize,this._sideSize,this._sideSize,0),f5(G,this._sideSize,this._sideSize,this._sideSize,0);for(let j=1;j<=this._maxSideIndex;++j,++H){if(O.shouldNotify(H))yield{progress:O.progress};b5($,this._sideSize,0),b5(J,this._sideSize,0),b5(X,this._sideSize,0),b5(K,this._sideSize,0),b5(q,this._sideSize,0),b5(Y,this._sideSize,0);for(let E=1;E<=this._maxSideIndex;++E){let B=0,S=0,A=0,z=0,P=0,R=0;for(let U=1;U<=this._maxSideIndex;++U)B+=this._weights[L][j][E][U],S+=this._momentsRed[L][j][E][U],A+=this._momentsGreen[L][j][E][U],z+=this._momentsBlue[L][j][E][U],P+=this._momentsAlpha[L][j][E][U],R+=this._moments[L][j][E][U],$[U]+=B,J[U]+=S,X[U]+=A,K[U]+=z,q[U]+=P,Y[U]+=R,W[j][E][U]=W[j-1][E][U]+$[U],Q[j][E][U]=Q[j-1][E][U]+J[U],N[j][E][U]=N[j-1][E][U]+X[U],M[j][E][U]=M[j-1][E][U]+K[U],V[j][E][U]=V[j-1][E][U]+q[U],G[j][E][U]=G[j-1][E][U]+Y[U],this._weights[L][j][E][U]=this._weights[L-1][j][E][U]+W[j][E][U],this._momentsRed[L][j][E][U]=this._momentsRed[L-1][j][E][U]+Q[j][E][U],this._momentsGreen[L][j][E][U]=this._momentsGreen[L-1][j][E][U]+N[j][E][U],this._momentsBlue[L][j][E][U]=this._momentsBlue[L-1][j][E][U]+M[j][E][U],this._momentsAlpha[L][j][E][U]=this._momentsAlpha[L-1][j][E][U]+V[j][E][U],this._moments[L][j][E][U]=this._moments[L-1][j][E][U]+G[j][E][U]}}}}static _volumeFloat($,J){return J[$.alphaMaximum][$.redMaximum][$.greenMaximum][$.blueMaximum]-J[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMaximum]-J[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMaximum]+J[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMaximum]-J[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMaximum]+J[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMaximum]+J[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMaximum]-J[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMaximum]-(J[$.alphaMaximum][$.redMaximum][$.greenMaximum][$.blueMinimum]-J[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMinimum]-J[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMinimum]+J[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMinimum]-J[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMinimum]+J[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMinimum]+J[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMinimum]-J[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum])}static _volume($,J){return w0._volumeFloat($,J)|0}static _top($,J,X,K){let q;switch(J){case w0._alpha:q=K[X][$.redMaximum][$.greenMaximum][$.blueMaximum]-K[X][$.redMaximum][$.greenMinimum][$.blueMaximum]-K[X][$.redMinimum][$.greenMaximum][$.blueMaximum]+K[X][$.redMinimum][$.greenMinimum][$.blueMaximum]-(K[X][$.redMaximum][$.greenMaximum][$.blueMinimum]-K[X][$.redMaximum][$.greenMinimum][$.blueMinimum]-K[X][$.redMinimum][$.greenMaximum][$.blueMinimum]+K[X][$.redMinimum][$.greenMinimum][$.blueMinimum]);break;case w0._red:q=K[$.alphaMaximum][X][$.greenMaximum][$.blueMaximum]-K[$.alphaMaximum][X][$.greenMinimum][$.blueMaximum]-K[$.alphaMinimum][X][$.greenMaximum][$.blueMaximum]+K[$.alphaMinimum][X][$.greenMinimum][$.blueMaximum]-(K[$.alphaMaximum][X][$.greenMaximum][$.blueMinimum]-K[$.alphaMaximum][X][$.greenMinimum][$.blueMinimum]-K[$.alphaMinimum][X][$.greenMaximum][$.blueMinimum]+K[$.alphaMinimum][X][$.greenMinimum][$.blueMinimum]);break;case w0._green:q=K[$.alphaMaximum][$.redMaximum][X][$.blueMaximum]-K[$.alphaMaximum][$.redMinimum][X][$.blueMaximum]-K[$.alphaMinimum][$.redMaximum][X][$.blueMaximum]+K[$.alphaMinimum][$.redMinimum][X][$.blueMaximum]-(K[$.alphaMaximum][$.redMaximum][X][$.blueMinimum]-K[$.alphaMaximum][$.redMinimum][X][$.blueMinimum]-K[$.alphaMinimum][$.redMaximum][X][$.blueMinimum]+K[$.alphaMinimum][$.redMinimum][X][$.blueMinimum]);break;case w0._blue:q=K[$.alphaMaximum][$.redMaximum][$.greenMaximum][X]-K[$.alphaMaximum][$.redMaximum][$.greenMinimum][X]-K[$.alphaMaximum][$.redMinimum][$.greenMaximum][X]+K[$.alphaMaximum][$.redMinimum][$.greenMinimum][X]-(K[$.alphaMinimum][$.redMaximum][$.greenMaximum][X]-K[$.alphaMinimum][$.redMaximum][$.greenMinimum][X]-K[$.alphaMinimum][$.redMinimum][$.greenMaximum][X]+K[$.alphaMinimum][$.redMinimum][$.greenMinimum][X]);break;default:throw Error("impossible")}return q|0}static _bottom($,J,X){switch(J){case w0._alpha:return-X[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMaximum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMaximum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMaximum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMaximum]-(-X[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMinimum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMinimum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMinimum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum]);case w0._red:return-X[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMaximum]+X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMaximum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMaximum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMaximum]-(-X[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMinimum]+X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMinimum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMinimum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum]);case w0._green:return-X[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMaximum]+X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMaximum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMaximum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMaximum]-(-X[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMinimum]+X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMinimum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMinimum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum]);case w0._blue:return-X[$.alphaMaximum][$.redMaximum][$.greenMaximum][$.blueMinimum]+X[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMinimum]+X[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMinimum]-X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMinimum]-(-X[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMinimum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMinimum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMinimum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum]);default:return 0}}_calculateVariance($){let J=w0._volume($,this._momentsRed),X=w0._volume($,this._momentsGreen),K=w0._volume($,this._momentsBlue),q=w0._volume($,this._momentsAlpha),Y=w0._volumeFloat($,this._moments),W=w0._volume($,this._weights),Q=J*J+X*X+K*K+q*q;return Y-Q/W}_maximize($,J,X,K,q,Y,W,Q,N){let M=w0._bottom($,J,this._momentsRed)|0,V=w0._bottom($,J,this._momentsGreen)|0,G=w0._bottom($,J,this._momentsBlue)|0,H=w0._bottom($,J,this._momentsAlpha)|0,O=w0._bottom($,J,this._weights)|0,L=0,j=-1;for(let E=X;E<K;++E){let B=M+w0._top($,J,E,this._momentsRed),S=V+w0._top($,J,E,this._momentsGreen),A=G+w0._top($,J,E,this._momentsBlue),z=H+w0._top($,J,E,this._momentsAlpha),P=O+w0._top($,J,E,this._weights);if(P!==0){let R=B*B+S*S+A*A+z*z,U=R/P;if(B=q-B,S=Y-S,A=W-A,z=Q-z,P=N-P,P!==0){if(R=B*B+S*S+A*A+z*z,U+=R/P,U>L)L=U,j=E}}}return{max:L,position:j}}_cut($,J){let X,K=w0._volume($,this._momentsRed),q=w0._volume($,this._momentsGreen),Y=w0._volume($,this._momentsBlue),W=w0._volume($,this._momentsAlpha),Q=w0._volume($,this._weights),N=this._maximize($,w0._red,$.redMinimum+1,$.redMaximum,K,q,Y,W,Q),M=this._maximize($,w0._green,$.greenMinimum+1,$.greenMaximum,K,q,Y,W,Q),V=this._maximize($,w0._blue,$.blueMinimum+1,$.blueMaximum,K,q,Y,W,Q),G=this._maximize($,w0._alpha,$.alphaMinimum+1,$.alphaMaximum,K,q,Y,W,Q);if(G.max>=N.max&&G.max>=M.max&&G.max>=V.max){if(X=w0._alpha,G.position<0)return!1}else if(N.max>=G.max&&N.max>=M.max&&N.max>=V.max)X=w0._red;else if(M.max>=G.max&&M.max>=N.max&&M.max>=V.max)X=w0._green;else X=w0._blue;switch(J.redMaximum=$.redMaximum,J.greenMaximum=$.greenMaximum,J.blueMaximum=$.blueMaximum,J.alphaMaximum=$.alphaMaximum,X){case w0._red:J.redMinimum=$.redMaximum=N.position,J.greenMinimum=$.greenMinimum,J.blueMinimum=$.blueMinimum,J.alphaMinimum=$.alphaMinimum;break;case w0._green:J.greenMinimum=$.greenMaximum=M.position,J.redMinimum=$.redMinimum,J.blueMinimum=$.blueMinimum,J.alphaMinimum=$.alphaMinimum;break;case w0._blue:J.blueMinimum=$.blueMaximum=V.position,J.redMinimum=$.redMinimum,J.greenMinimum=$.greenMinimum,J.alphaMinimum=$.alphaMinimum;break;case w0._alpha:J.alphaMinimum=$.alphaMaximum=G.position,J.blueMinimum=$.blueMinimum,J.redMinimum=$.redMinimum,J.greenMinimum=$.greenMinimum;break}return $.volume=($.redMaximum-$.redMinimum)*($.greenMaximum-$.greenMinimum)*($.blueMaximum-$.blueMinimum)*($.alphaMaximum-$.alphaMinimum),J.volume=(J.redMaximum-J.redMinimum)*(J.greenMaximum-J.greenMinimum)*(J.blueMaximum-J.blueMinimum)*(J.alphaMaximum-J.alphaMinimum),!0}_initialize($){this._colors=$,this._cubes=[];for(let J=0;J<$;J++)this._cubes[J]=new CM;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=h5(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=h5(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=h5(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=h5(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=h5(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=h5(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(let J=0;J<256;++J)this._table[J]=J*J;this._pixels=[]}_setQuality($=5){this._significantBitsPerChannel=$,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1}},m5=w0;n(m5,"_alpha",3);n(m5,"_red",2);n(m5,"_green",1);n(m5,"_blue",0);var gB={};t8(gB,{AbstractImageQuantizer:()=>$7,ErrorDiffusionArray:()=>y8,ErrorDiffusionArrayKernel:()=>DM,ErrorDiffusionRiemersma:()=>P4,NearestColor:()=>ZM});var $7=class{quantizeSync($,J){for(let X of this.quantize($,J))if(X.pointContainer)return X.pointContainer;throw Error("unreachable")}},ZM=class extends $7{constructor($){super();n(this,"_distance"),this._distance=$}*quantize($,J){let X=$.getPointArray(),K=$.getWidth(),q=$.getHeight(),Y=new e8(q,99);for(let W=0;W<q;W++){if(Y.shouldNotify(W))yield{progress:Y.progress};for(let Q=0,N=W*K;Q<K;Q++,N++){let M=X[N];M.from(J.getNearestColor(this._distance,M))}}yield{pointContainer:$,progress:100}}},DM=(($)=>{return $[$.FloydSteinberg=0]="FloydSteinberg",$[$.FalseFloydSteinberg=1]="FalseFloydSteinberg",$[$.Stucki=2]="Stucki",$[$.Atkinson=3]="Atkinson",$[$.Jarvis=4]="Jarvis",$[$.Burkes=5]="Burkes",$[$.Sierra=6]="Sierra",$[$.TwoSierra=7]="TwoSierra",$[$.SierraLite=8]="SierraLite",$})(DM||{}),y8=class extends $7{constructor($,J,X=!0,K=0,q=!1){super();n(this,"_minColorDistance"),n(this,"_serpentine"),n(this,"_kernel"),n(this,"_calculateErrorLikeGIMP"),n(this,"_distance"),this._setKernel(J),this._distance=$,this._minColorDistance=K,this._serpentine=X,this._calculateErrorLikeGIMP=q}*quantize($,J){let X=$.getPointArray(),K=new l6,q=$.getWidth(),Y=$.getHeight(),W=[],Q=1,N=1;for(let V of this._kernel){let G=V[2]+1;if(N<G)N=G}for(let V=0;V<N;V++)this._fillErrorLine(W[V]=[],q);let M=new e8(Y,99);for(let V=0;V<Y;V++){if(M.shouldNotify(V))yield{progress:M.progress};if(this._serpentine)Q*=-1;let G=V*q,H=Q===1?0:q-1,O=Q===1?q:-1;this._fillErrorLine(W[0],q),W.push(W.shift());let L=W[0];for(let j=H,E=G+H;j!==O;j+=Q,E+=Q){let B=X[E],S=L[j];K.from(B);let A=l6.createByRGBA(J8(B.r+S[0]),J8(B.g+S[1]),J8(B.b+S[2]),J8(B.a+S[3])),z=J.getNearestColor(this._distance,A);if(B.from(z),this._minColorDistance){if(this._distance.calculateNormalized(K,z)<this._minColorDistance)continue}let P,R,U,C;if(this._calculateErrorLikeGIMP)P=A.r-z.r,R=A.g-z.g,U=A.b-z.b,C=A.a-z.a;else P=K.r-z.r,R=K.g-z.g,U=K.b-z.b,C=K.a-z.a;let k=Q===1?0:this._kernel.length-1,h=Q===1?this._kernel.length:-1;for(let F=k;F!==h;F+=Q){let v=this._kernel[F][1]*Q,D=this._kernel[F][2];if(v+j>=0&&v+j<q&&D+V>=0&&D+V<Y){let w=this._kernel[F][0],x=W[D][v+j];x[0]+=P*w,x[1]+=R*w,x[2]+=U*w,x[3]+=C*w}}}}yield{pointContainer:$,progress:100}}_fillErrorLine($,J){if($.length>J)$.length=J;let X=$.length;for(let K=0;K<X;K++){let q=$[K];q[0]=q[1]=q[2]=q[3]=0}for(let K=X;K<J;K++)$[K]=[0,0,0,0]}_setKernel($){switch($){case 0:this._kernel=[[0.4375,1,0],[0.1875,-1,1],[0.3125,0,1],[0.0625,1,1]];break;case 1:this._kernel=[[0.375,1,0],[0.375,0,1],[0.25,1,1]];break;case 2:this._kernel=[[0.19047619047619047,1,0],[0.09523809523809523,2,0],[0.047619047619047616,-2,1],[0.09523809523809523,-1,1],[0.19047619047619047,0,1],[0.09523809523809523,1,1],[0.047619047619047616,2,1],[0.023809523809523808,-2,2],[0.047619047619047616,-1,2],[0.09523809523809523,0,2],[0.047619047619047616,1,2],[0.023809523809523808,2,2]];break;case 3:this._kernel=[[0.125,1,0],[0.125,2,0],[0.125,-1,1],[0.125,0,1],[0.125,1,1],[0.125,0,2]];break;case 4:this._kernel=[[0.14583333333333334,1,0],[0.10416666666666667,2,0],[0.0625,-2,1],[0.10416666666666667,-1,1],[0.14583333333333334,0,1],[0.10416666666666667,1,1],[0.0625,2,1],[0.020833333333333332,-2,2],[0.0625,-1,2],[0.10416666666666667,0,2],[0.0625,1,2],[0.020833333333333332,2,2]];break;case 5:this._kernel=[[0.25,1,0],[0.125,2,0],[0.0625,-2,1],[0.125,-1,1],[0.25,0,1],[0.125,1,1],[0.0625,2,1]];break;case 6:this._kernel=[[0.15625,1,0],[0.09375,2,0],[0.0625,-2,1],[0.125,-1,1],[0.15625,0,1],[0.125,1,1],[0.0625,2,1],[0.0625,-1,2],[0.09375,0,2],[0.0625,1,2]];break;case 7:this._kernel=[[0.25,1,0],[0.1875,2,0],[0.0625,-2,1],[0.125,-1,1],[0.1875,0,1],[0.125,1,1],[0.0625,2,1]];break;case 8:this._kernel=[[0.5,1,0],[0.25,-1,1],[0.25,0,1]];break;default:throw Error(`ErrorDiffusionArray: unknown kernel = ${$}`)}}};function*fB($,J,X){let K=Math.max($,J),q=Math.floor(Math.log(K)/Math.log(2)+1),Y=new e8($*J,99),W={width:$,height:J,level:q,callback:X,tracker:Y,index:0,x:0,y:0};yield*B6(W,1),p6(W,0)}function*B6($,J){if($.level<1)return;if($.tracker.shouldNotify($.index))yield{progress:$.tracker.progress};switch($.level--,J){case 2:yield*B6($,1),p6($,3),yield*B6($,2),p6($,4),yield*B6($,2),p6($,2),yield*B6($,4);break;case 3:yield*B6($,4),p6($,2),yield*B6($,3),p6($,1),yield*B6($,3),p6($,3),yield*B6($,1);break;case 1:yield*B6($,2),p6($,4),yield*B6($,1),p6($,3),yield*B6($,1),p6($,1),yield*B6($,3);break;case 4:yield*B6($,3),p6($,1),yield*B6($,4),p6($,2),yield*B6($,4),p6($,4),yield*B6($,2);break;default:break}$.level++}function p6($,J){if($.x>=0&&$.x<$.width&&$.y>=0&&$.y<$.height)$.callback($.x,$.y),$.index++;switch(J){case 2:$.x--;break;case 3:$.x++;break;case 1:$.y--;break;case 4:$.y++;break}}var P4=class extends $7{constructor($,J=16,X=1){super();n(this,"_distance"),n(this,"_weights"),n(this,"_errorQueueSize"),this._distance=$,this._errorQueueSize=J,this._weights=P4._createWeights(X,J)}*quantize($,J){let X=$.getPointArray(),K=$.getWidth(),q=$.getHeight(),Y=[],W=0;for(let Q=0;Q<this._errorQueueSize;Q++)Y[Q]={r:0,g:0,b:0,a:0};yield*fB(K,q,(Q,N)=>{let M=X[Q+N*K],{r:V,g:G,b:H,a:O}=M;for(let B=0;B<this._errorQueueSize;B++){let S=this._weights[B],A=Y[(B+W)%this._errorQueueSize];V+=A.r*S,G+=A.g*S,H+=A.b*S,O+=A.a*S}let L=l6.createByRGBA(J8(V),J8(G),J8(H),J8(O)),j=J.getNearestColor(this._distance,L);W=(W+1)%this._errorQueueSize;let E=(W+this._errorQueueSize-1)%this._errorQueueSize;Y[E].r=M.r-j.r,Y[E].g=M.g-j.g,Y[E].b=M.b-j.b,Y[E].a=M.a-j.a,M.from(j)}),yield{pointContainer:$,progress:100}}static _createWeights($,J){let X=[],K=Math.exp(Math.log(J)/(J-1));for(let q=0,Y=1;q<J;q++)X[q]=(Y+0.5|0)/J*$,Y*=K;return X}},bB={};t8(bB,{ssim:()=>uB});var mB=0.01,pB=0.03;function uB($,J){if($.getHeight()!==J.getHeight()||$.getWidth()!==J.getWidth())throw Error("Images have different sizes!");let K=255,q=(mB*K)**2,Y=(pB*K)**2,W=0,Q=0;return lB($,J,(N,M,V,G)=>{let H=0,O=0,L=0;for(let A=0;A<N.length;A++)O+=(N[A]-V)**2,L+=(M[A]-G)**2,H+=(N[A]-V)*(M[A]-G);let j=N.length-1;O/=j,L/=j,H/=j;let E=(2*V*G+q)*(2*H+Y),B=(V**2+G**2+q)*(O+L+Y),S=E/B;Q+=S,W++}),Q/W}function lB($,J,X){let q=$.getWidth(),Y=$.getHeight();for(let W=0;W<Y;W+=8)for(let Q=0;Q<q;Q+=8){let N=Math.min(8,q-Q),M=Math.min(8,Y-W),V=tN($,Q,W,N,M),G=tN(J,Q,W,N,M),H=eN(V),O=eN(G);X(V,G,H,O)}}function tN($,J,X,K,q){let Y=$.getPointArray(),W=[],Q=0;for(let N=X;N<X+q;N++){let M=N*$.getWidth();for(let V=J;V<J+K;V++){let G=Y[M+V];W[Q]=G.r*0.2126+G.g*0.7152+G.b*0.0722,Q++}}return W}function eN($){let J=0;for(let X of $)J+=X;return J/$.length}var cv=typeof setImmediate==="function"?setImmediate:typeof process<"u"&&typeof(process==null?void 0:process.nextTick)==="function"?($)=>process.nextTick($):($)=>setTimeout($,0);function kM($,{colorDistanceFormula:J,paletteQuantization:X,colors:K}={}){let q=TM(J),Y=dB(q,X,K);return $.forEach((W)=>Y.sample(W)),Y.quantizeSync()}function wM($,J,{colorDistanceFormula:X,imageQuantization:K}={}){let q=TM(X);return cB(q,K).quantizeSync($,J)}function TM($="euclidean-bt709"){switch($){case"cie94-graphic-arts":return new UM;case"cie94-textiles":return new OM;case"ciede2000":return new j8;case"color-metric":return new LM;case"euclidean":return new EM;case"euclidean-bt709":return new jM;case"euclidean-bt709-noalpha":return new RM;case"manhattan":return new BM;case"manhattan-bt709":return new SM;case"manhattan-nommyde":return new PM;case"pngquant":return new AM;default:throw Error(`Unknown colorDistanceFormula ${$}`)}}function cB($,J="floyd-steinberg"){switch(J){case"nearest":return new ZM($);case"riemersma":return new P4($);case"floyd-steinberg":return new y8($,0);case"false-floyd-steinberg":return new y8($,1);case"stucki":return new y8($,2);case"atkinson":return new y8($,3);case"jarvis":return new y8($,4);case"burkes":return new y8($,5);case"sierra":return new y8($,6);case"two-sierra":return new y8($,7);case"sierra-lite":return new y8($,8);default:throw Error(`Unknown imageQuantization ${J}`)}}function dB($,J="wuquant",X=256){switch(J){case"neuquant":return new Q6($,X);case"rgbquant":return new vM($,X);case"wuquant":return new m5($,X);case"neuquant-float":return new N6($,X);default:throw Error(`Unknown paletteQuantization ${J}`)}}var nB=r0.object({colors:r0.number().optional(),colorDistanceFormula:r0.union([r0.literal("cie94-textiles"),r0.literal("cie94-graphic-arts"),r0.literal("ciede2000"),r0.literal("color-metric"),r0.literal("euclidean"),r0.literal("euclidean-bt709-noalpha"),r0.literal("euclidean-bt709"),r0.literal("manhattan"),r0.literal("manhattan-bt709"),r0.literal("manhattan-nommyde"),r0.literal("pngquant")]).optional(),paletteQuantization:r0.union([r0.literal("neuquant"),r0.literal("neuquant-float"),r0.literal("rgbquant"),r0.literal("wuquant")]).optional(),imageQuantization:r0.union([r0.literal("nearest"),r0.literal("riemersma"),r0.literal("floyd-steinberg"),r0.literal("false-floyd-steinberg"),r0.literal("stucki"),r0.literal("atkinson"),r0.literal("jarvis"),r0.literal("burkes"),r0.literal("sierra"),r0.literal("two-sierra"),r0.literal("sierra-lite")]).optional()}),IM={quantize($,J){let{colors:X,colorDistanceFormula:K,paletteQuantization:q,imageQuantization:Y}=nB.parse(J),W=B4.PointContainer.fromUint8Array($.bitmap.data,$.bitmap.width,$.bitmap.height),Q=kM([W],{colors:X,colorDistanceFormula:K,paletteQuantization:q}),N=wM(W,Q,{colorDistanceFormula:K,imageQuantization:Y});return $.bitmap.data=Buffer.from(N.toUint8Array()),$}};var rB=[D5,pW,uW,k5,TN,IN,_5,_N,yN,xN,hN,cN,dN,nN,E8,iN,sN,IM],iB=[J$,yX,H$,U$,j$,y$],xC={bmp:J$().mime,gif:H$().mime,jpeg:U$().mime,png:j$().mime,tiff:y$().mime},_M=kN({formats:iB,plugins:rB});import{ptr as xM}from"bun:ffi";function S4($){let J=(X)=>X.toString(16).padStart(2,"0");return`#${J($.r)}${J($.g)}${J($.b)}`.toUpperCase()}function A4($){let J=$.replace("#","");return{r:parseInt(J.substring(0,2),16),g:parseInt(J.substring(2,4),16),b:parseInt(J.substring(4,6),16)}}function yM($,J){return Math.sqrt(Math.pow($.r-J.r,2)+Math.pow($.g-J.g,2)+Math.pow($.b-J.b,2))}function F4($,J,X){return yM($,J)<=X}function sB($,J){return $.x>=J.left&&$.x<=J.right&&$.y>=J.top&&$.y<=J.bottom}var aB={rgbToHex:S4,hexToRgb:A4,colorDistance:yM,isColorSimilar:F4,pointInRect:sB};var p5=null,hM=0;function tB(){if(p5&&Date.now()-hM<1000)return p5;if(p5)G0.symbols.ReleaseDC(null,p5);return p5=G0.symbols.GetDC(null),hM=Date.now(),p5}function u5(){return{width:G0.symbols.GetSystemMetrics(0),height:G0.symbols.GetSystemMetrics(1)}}function b9($,J){let X=tB();if(!X)return null;let K=c6.symbols.GetPixel(X,$,J);return{r:K&255,g:K>>8&255,b:K>>16&255}}function gM($,J){let X=b9($,J);if(!X)return null;return S4(X)}function m9($,J,X,K=0){let q=b9($,J);if(!q)return!1;return F4(q,X,K)}function fM($,J,X,K=0,q){return new Promise((Y)=>{let W=0,Q=setInterval(()=>{if(m9($,J,X,K)){clearInterval(Q),Y(!0);return}if(q&&(W+=50)>=q)clearInterval(Q),Y(!1)},50)})}function bM($){return $.map((J)=>b9(J.x,J.y))}function mM($){return $.every((J)=>m9(J.x,J.y,J.target,J.tolerance??0))}function pM($,J){return new Promise((X)=>{let K=0,q=setInterval(()=>{for(let Y=0;Y<$.length;Y++){let W=$[Y];if(m9(W.x,W.y,W.target,W.tolerance??0)){clearInterval(q),X(Y);return}}if(J&&(K+=50)>=J)clearInterval(q),X(-1)},50)})}function uM($,J,X,K,q,Y=0){let W=Math.min($,X),Q=Math.min(J,K),N=Math.max($,X),M=Math.max(J,K),V=N-W+1,G=M-Q+1,H=J7(W,Q,V,G);if(!H)return null;let O;if(typeof q==="string")O=A4(q);else if(typeof q==="number")O={r:q>>16&255,g:q>>8&255,b:q&255};else O=q;for(let L=0;L<G;L++)for(let j=0;j<V;j++){let E=(L*V+j)*4,B=H[E],S=H[E+1],A=H[E+2];if(Y===0){if(A===O.r&&S===O.g&&B===O.b)return{x:W+j,y:Q+L}}else if(Math.abs(A-O.r)<=Y&&Math.abs(S-O.g)<=Y&&Math.abs(B-O.b)<=Y)return{x:W+j,y:Q+L}}return null}async function eB($){try{let J=await _M.read($),X=J.bitmap.width,K=J.bitmap.height,q=J.bitmap.data,Y=X*K*4,W=new Uint8Array(Y);for(let Q=0;Q<Y;Q+=4)W[Q]=q[Q+2],W[Q+1]=q[Q+1],W[Q+2]=q[Q],W[Q+3]=q[Q+3];return{width:X,height:K,data:W}}catch(J){return console.error(`Failed to load image: ${$}`,J),null}}async function lM($,J,X,K,q,Y=0){let W=await eB(q);if(!W)return null;let Q=Math.min($,X),N=Math.min(J,K),M=Math.max($,X),V=Math.max(J,K),G=M-Q+1,H=V-N+1,O=J7(Q,N,G,H);if(!O)return null;let{width:L,height:j}=W,E=G,B=H;if(L>E||j>B)return null;let S=(A,z,P,R,U,C)=>{if(Y===0)return A===R&&z===U&&P===C;return Math.abs(A-R)<=Y&&Math.abs(z-U)<=Y&&Math.abs(P-C)<=Y};for(let A=0;A<=B-j;A++)for(let z=0;z<=E-L;z++){let P=(A*E+z)*4,R=0;if(!S(O[P+2],O[P+1],O[P],W.data[R+2],W.data[R+1],W.data[R]))continue;let U=!0;for(let C=0;C<j;C++){for(let k=0;k<L;k++){if(C===0&&k===0)continue;if(P=((A+C)*E+(z+k))*4,R=(C*L+k)*4,!S(O[P+2],O[P+1],O[P],W.data[R+2],W.data[R+1],W.data[R])){U=!1;break}}if(!U)break}if(U)return{x:Q+z,y:N+A}}return null}function J7($=0,J=0,X,K){let q=X||G0.symbols.GetSystemMetrics(0),Y=K||G0.symbols.GetSystemMetrics(1),W=G0.symbols.GetDC(null);if(!W)return null;let Q=c6.symbols.CreateCompatibleDC(W);if(!Q)return G0.symbols.ReleaseDC(null,W),null;let N=c6.symbols.CreateCompatibleBitmap(W,q,Y);if(!N)return G0.symbols.ReleaseDC(null,W),c6.symbols.DeleteDC(Q),null;let M=c6.symbols.SelectObject(Q,N),V=c6.symbols.BitBlt(Q,0,0,q,Y,W,$,J,13369376),G=null;if(V){let H=q*Y*4;G=new Uint8Array(H);let O=new Uint8Array(40),L=new DataView(O.buffer);if(L.setInt32(0,40,!0),L.setInt32(4,q,!0),L.setInt32(8,-Y,!0),L.setInt16(12,1,!0),L.setInt16(14,32,!0),L.setInt32(16,0,!0),c6.symbols.GetDIBits(Q,N,0,Y,xM(G),xM(O),0)===0)G=null}if(M)c6.symbols.SelectObject(Q,M);return c6.symbols.DeleteObject(N),c6.symbols.DeleteDC(Q),G0.symbols.ReleaseDC(null,W),G}function cM(){let $=G0.symbols.GetSystemMetrics(78),J=G0.symbols.GetSystemMetrics(79),X=G0.symbols.GetSystemMetrics(76),K=G0.symbols.GetSystemMetrics(77);return[{rect:{left:X,top:K,right:X+$,bottom:K+J},isPrimary:!0}]}var JP=6,XP=1,KP=0,qP=1,YP=4,WP=256,QP=4096,NP=3,MP=9,VP=0,GP=5,HP=16,OP=-16,dM=-20,UP=524288;var LP=2,EP=-1,jP=-2,z4=2,v4=1;var X7=new TextDecoder("utf-16le"),oM=new TextDecoder("ascii");function C4(){let $=G0.symbols.GetForegroundWindow();if(!$)return null;let J=new Uint16Array(256),X=G0.symbols.GetWindowTextW($,P6(J),256),K=X>0?X7.decode(J.subarray(0,X)):"",q=new Int32Array(4);if(!G0.symbols.GetWindowRect($,P6(q)))return null;let Y={left:q[0],top:q[1],right:q[2],bottom:q[3]},W=u5(),Q=Y.left===0&&Y.top===0&&Y.right-Y.left===W.width&&Y.bottom-Y.top===W.height&&(G0.symbols.GetWindowLongW($,-16)&12845056)===0;return{hwnd:$,title:K,rect:Y,isFullscreen:Q}}function rM($){let J=$!==void 0?BigInt($):G0.symbols.GetForegroundWindow();if(!J)return"";let X=new Uint16Array(256),K=G0.symbols.GetWindowTextW(J,P6(X),256);return K>0?X7.decode(X.subarray(0,K)):""}function K7($){let J=new Int32Array(4);if(!G0.symbols.GetWindowRect(BigInt($),P6(J)))return null;return{left:J[0],top:J[1],right:J[2],bottom:J[3]}}function iM($){return G0.symbols.IsWindowVisible(BigInt($))}function Z4($){return G0.symbols.SetForegroundWindow(BigInt($))}function D4($){let J=new TextEncoder().encode($+"\x00"),X=G0.symbols.FindWindowA(null,P6(J));return X?X:null}function sM($,J){return new Promise((X)=>{let K=0,q=setInterval(()=>{let Y=D4($);if(Y){clearInterval(q),X(Y);return}if(J&&(K+=100)>=J)clearInterval(q),X(null)},100)})}function k4($){let J=new Uint32Array(1);return G0.symbols.GetWindowThreadProcessId(BigInt($),P6(J)),J[0]}function aM($){let J=new Uint8Array(256),X=G0.symbols.GetClassNameA(BigInt($),P6(J),256);return X>0?oM.decode(J.subarray(0,X)):""}function tM($){return G0.symbols.IsIconic(BigInt($))}function eM($){return G0.symbols.IsZoomed(BigInt($))}function $V($){return G0.symbols.ShowWindow(BigInt($),JP)}function JV($){return G0.symbols.ShowWindow(BigInt($),NP)}function XV($){return G0.symbols.ShowWindow(BigInt($),MP)}function KV($){return G0.symbols.ShowWindow(BigInt($),GP)}function qV($){return G0.symbols.ShowWindow(BigInt($),VP)}function YV($){return G0.symbols.PostMessageA(BigInt($),HP,null,null)}function w4($,J,X,K,q,Y=!0){return G0.symbols.MoveWindow(BigInt($),J,X,K,q,Y)}function WV($){let J=K7($);if(!J)return!1;let X=J.right-J.left,K=J.bottom-J.top,q=u5(),Y=Math.floor((q.width-X)/2),W=Math.floor((q.height-K)/2);return w4($,Y,W,X,K,!0)}function T4($){let J=new Int32Array(4);if(!G0.symbols.GetClientRect(BigInt($),P6(J)))return null;return{left:J[0],top:J[1],right:J[2],bottom:J[3]}}function QV($){let J=K7($);if(!J)return null;return{width:J.right-J.left,height:J.bottom-J.top}}function NV($){let J=T4($);if(!J)return null;return{width:J.right-J.left,height:J.bottom-J.top}}function q7($){return G0.symbols.IsWindow(BigInt($))}function I4($){if(!q7($))return null;let J=BigInt($),X=new Uint16Array(256),K=G0.symbols.GetWindowTextW(J,P6(X),256),q=K>0?X7.decode(X.subarray(0,K)):"",Y=new Int32Array(4);if(!G0.symbols.GetWindowRect(J,P6(Y)))return null;let W={left:Y[0],top:Y[1],right:Y[2],bottom:Y[3]},Q=u5(),N=W.left===0&&W.top===0&&W.right-W.left===Q.width&&W.bottom-W.top===Q.height&&(G0.symbols.GetWindowLongW(J,OP)&12845056)===0,M=new Uint32Array(1);G0.symbols.GetWindowThreadProcessId(J,P6(M));let V=new Uint8Array(256),G=G0.symbols.GetClassNameA(J,P6(V),256),H=G>0?oM.decode(V.subarray(0,G)):"";return{hwnd:J,title:q,rect:W,isFullscreen:N,processId:M[0],isVisible:G0.symbols.IsWindowVisible(J),isMinimized:G0.symbols.IsIconic(J),isMaximized:G0.symbols.IsZoomed(J),className:H}}function MV($,J){return new Promise((X)=>{let K=0,q=setInterval(()=>{if(!q7($)){clearInterval(q),X(!0);return}if(J&&(K+=100)>=J)clearInterval(q),X(!1)},100)})}async function VV($,J=1000){Z4($);let X=0;while(X<J){let K=C4();if(K&&K.hwnd===BigInt($))return!0;await Bun.sleep(50),X+=50}return!1}function GV(){let $=[],J=new nM((X,K)=>{let q=I4(X);if(q&&q.isVisible&&q.title)$.push(q);return!0},{args:["u64","i64"],returns:"bool"});return G0.symbols.EnumWindows(J.ptr,0),J.close(),$}function HV($){let J=[],X=new nM((K,q)=>{return J.push(K),!0},{args:["u64","i64"],returns:"bool"});return G0.symbols.EnumChildWindows(BigInt($),X.ptr,0),X.close(),J}function OV($,J=!0){return G0.symbols.FlashWindow(BigInt($),J)}function UV($,J){let X=BigInt($),K=G0.symbols.GetWindowLongW(X,dM);G0.symbols.SetWindowLongW(X,dM,K|UP);let q=Math.max(0,Math.min(255,Math.floor(J*255)));return G0.symbols.SetLayeredWindowAttributes(X,0,q,LP)}function LV($,J){return G0.symbols.SetWindowPos(BigInt($),BigInt(J?EP:jP),0,0,0,0,z4|v4)}function EV($,J){let X=new Uint16Array(J.length+1),K=new TextEncoder().encodeInto(J,new Uint8Array(X.buffer)),q=Buffer.from(J+"\x00","utf16le");return G0.symbols.SetWindowTextW(BigInt($),P6(q))}function jV($,J){return G0.symbols.EnableWindow(BigInt($),J)}function RV($){return G0.symbols.RedrawWindow(BigInt($),null,0n,qP|YP|WP)}function BV($){return G0.symbols.SetWindowPos(BigInt($),BigInt(XP),0,0,0,0,z4|v4)}function PV($){return G0.symbols.SetWindowPos(BigInt($),BigInt(KP),0,0,0,0,z4|v4)}function SV($){let J=k4($);if(!J)return"";let X=d9.symbols.OpenProcess(QP,!1,J);if(!X)return"";try{let K=new Uint16Array(1024),q=new Uint32Array([1024]);if(d9.symbols.QueryFullProcessImageNameW(X,0,P6(K),P6(q)))return X7.decode(K.subarray(0,q[0]));return""}finally{d9.symbols.CloseHandle(X)}}function AV($,J,X){let K=new Int32Array([J,X]);if(G0.symbols.ClientToScreen(BigInt($),P6(K)))return{x:K[0],y:K[1]};return null}function FV($,J,X){let K=new Int32Array([J,X]);if(G0.symbols.ScreenToClient(BigInt($),P6(K)))return{x:K[0],y:K[1]};return null}class zV{getActiveWindow=C4;getWindowTitle=rM;getWindowRect=K7;getClientRect=T4;getWindowSize=QV;getClientSize=NV;isWindowVisible=iM;isWindowMinimized=tM;isWindowMaximized=eM;isWindow=q7;setForeground=Z4;focusWindow=VV;findWindow=D4;waitForWindow=sM;waitForWindowClose=MV;getWindowProcessId=k4;getClassName=aM;getExtendedWindowInfo=I4;minimizeWindow=$V;maximizeWindow=JV;restoreWindow=XV;showWindow=KV;hideWindow=qV;closeWindow=YV;moveWindow=w4;enumWindows=GV;enumChildWindows=HV;flashWindow=OV;setOpacity=UV;setTopmost=LV;center=WV;setTitle=EV;setEnabled=jV;redraw=RV;moveToBottom=BV;moveToTop=PV;getProcessPath=SV;clientToScreen=AV;screenToClient=FV}var dC=new zV;class vV{getScreenSize=u5;getMonitors=cM;capture=J7;getPixel=b9;getPixelHex=gM;checkPixel=m9;waitForPixel=fM;getMultiplePixels=bM;checkMultiplePixels=mM;waitForAnyPixel=pM;pixelSearch=uM;imageSearch=lM}var iC=new vV;export{dC as window,aB as utils,iC as screen,d6 as mouse,S8 as keyboard,a0 as config};
