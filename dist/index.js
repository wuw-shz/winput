// @bun
var oM=Object.create;var{getPrototypeOf:rM,defineProperty:G7,getOwnPropertyNames:iM}=Object;var sM=Object.prototype.hasOwnProperty;var h8=($,J,X)=>{X=$!=null?oM(rM($)):{};let K=J||!$||!$.__esModule?G7(X,"default",{value:$,enumerable:!0}):X;for(let q of iM($))if(!sM.call(K,q))G7(K,q,{get:()=>$[q],enumerable:!0});return K};var L0=($,J)=>()=>(J||$((J={exports:{}}).exports,J),J.exports);var o4=($,J)=>{for(var X in J)G7($,X,{get:J[X],enumerable:!0,configurable:!0,set:(K)=>J[X]=()=>K})};var O6=import.meta.require;var f7=L0((gH)=>{function yH($,J,X,Y){var q=0,Y=Y===void 0?{}:Y,W=Y.loop===void 0?null:Y.loop,Q=Y.palette===void 0?null:Y.palette;if(J<=0||X<=0||J>65535||X>65535)throw Error("Width/Height invalid.");function N(j){var B=j.length;if(B<2||B>256||B&B-1)throw Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return B}$[q++]=71,$[q++]=73,$[q++]=70,$[q++]=56,$[q++]=57,$[q++]=97;var V=0,M=0;if(Q!==null){var H=N(Q);while(H>>=1)++V;if(H=1<<V,--V,Y.background!==void 0){if(M=Y.background,M>=H)throw Error("Background index out of range.");if(M===0)throw Error("Background index explicitly passed as 0.")}}if($[q++]=J&255,$[q++]=J>>8&255,$[q++]=X&255,$[q++]=X>>8&255,$[q++]=(Q!==null?128:0)|V,$[q++]=M,$[q++]=0,Q!==null)for(var G=0,O=Q.length;G<O;++G){var L=Q[G];$[q++]=L>>16&255,$[q++]=L>>8&255,$[q++]=L&255}if(W!==null){if(W<0||W>65535)throw Error("Loop count invalid.");$[q++]=33,$[q++]=255,$[q++]=11,$[q++]=78,$[q++]=69,$[q++]=84,$[q++]=83,$[q++]=67,$[q++]=65,$[q++]=80,$[q++]=69,$[q++]=50,$[q++]=46,$[q++]=48,$[q++]=3,$[q++]=1,$[q++]=W&255,$[q++]=W>>8&255,$[q++]=0}var E=!1;this.addFrame=function(j,B,S,A,z,P){if(E===!0)--q,E=!1;if(P=P===void 0?{}:P,j<0||B<0||j>65535||B>65535)throw Error("x/y invalid.");if(S<=0||A<=0||S>65535||A>65535)throw Error("Width/Height invalid.");if(z.length<S*A)throw Error("Not enough pixels for the frame size.");var R=!0,U=P.palette;if(U===void 0||U===null)R=!1,U=Q;if(U===void 0||U===null)throw Error("Must supply either a local or global palette.");var Z=N(U),w=0;while(Z>>=1)++w;Z=1<<w;var h=P.delay===void 0?0:P.delay,F=P.disposal===void 0?0:P.disposal;if(F<0||F>3)throw Error("Disposal out of range.");var C=!1,D=0;if(P.transparent!==void 0&&P.transparent!==null){if(C=!0,D=P.transparent,D<0||D>=Z)throw Error("Transparent color index.")}if(F!==0||C||h!==0)$[q++]=33,$[q++]=249,$[q++]=4,$[q++]=F<<2|(C===!0?1:0),$[q++]=h&255,$[q++]=h>>8&255,$[q++]=D,$[q++]=0;if($[q++]=44,$[q++]=j&255,$[q++]=j>>8&255,$[q++]=B&255,$[q++]=B>>8&255,$[q++]=S&255,$[q++]=S>>8&255,$[q++]=A&255,$[q++]=A>>8&255,$[q++]=R===!0?128|w-1:0,R===!0)for(var T=0,x=U.length;T<x;++T){var y=U[T];$[q++]=y>>16&255,$[q++]=y>>8&255,$[q++]=y&255}return q=xH($,q,w<2?2:w,z),q},this.end=function(){if(E===!1)$[q++]=59,E=!0;return q},this.getOutputBuffer=function(){return $},this.setOutputBuffer=function(j){$=j},this.getOutputBufferPosition=function(){return q},this.setOutputBufferPosition=function(j){q=j}}function xH($,J,X,K){$[J++]=X;var q=J++,Y=1<<X,W=Y-1,Q=Y+1,N=Q+1,V=X+1,M=0,H=0;function G(P){while(M>=P)if($[J++]=H&255,H>>=8,M-=8,J===q+256)$[q]=255,q=J++}function O(P){H|=P<<M,M+=V,G(8)}var L=K[0]&W,E={};O(Y);for(var j=1,B=K.length;j<B;++j){var S=K[j]&W,A=L<<8|S,z=E[A];if(z===void 0){H|=L<<M,M+=V;while(M>=8)if($[J++]=H&255,H>>=8,M-=8,J===q+256)$[q]=255,q=J++;if(N===4096)O(Y),N=Q+1,V=X+1,E={};else{if(N>=1<<V)++V;E[A]=N++}L=S}else L=z}if(O(L),O(Q),G(1),q+1===J)$[q]=0;else $[q]=J-q-1,$[J++]=0;return J}function hH($){var J=0;if($[J++]!==71||$[J++]!==73||$[J++]!==70||$[J++]!==56||($[J++]+1&253)!==56||$[J++]!==97)throw Error("Invalid GIF 87a/89a header.");var X=$[J++]|$[J++]<<8,K=$[J++]|$[J++]<<8,q=$[J++],Y=q>>7,W=q&7,Q=1<<W+1,N=$[J++];$[J++];var V=null,M=null;if(Y)V=J,M=Q,J+=Q*3;var H=!0,G=[],O=0,L=null,E=0,j=null;this.width=X,this.height=K;while(H&&J<$.length)switch($[J++]){case 33:switch($[J++]){case 255:if($[J]!==11||$[J+1]==78&&$[J+2]==69&&$[J+3]==84&&$[J+4]==83&&$[J+5]==67&&$[J+6]==65&&$[J+7]==80&&$[J+8]==69&&$[J+9]==50&&$[J+10]==46&&$[J+11]==48&&$[J+12]==3&&$[J+13]==1&&$[J+16]==0)J+=14,j=$[J++]|$[J++]<<8,J++;else{J+=12;while(!0){var B=$[J++];if(!(B>=0))throw Error("Invalid block size");if(B===0)break;J+=B}}break;case 249:if($[J++]!==4||$[J+4]!==0)throw Error("Invalid graphics extension block.");var S=$[J++];if(O=$[J++]|$[J++]<<8,L=$[J++],(S&1)===0)L=null;E=S>>2&7,J++;break;case 254:while(!0){var B=$[J++];if(!(B>=0))throw Error("Invalid block size");if(B===0)break;J+=B}break;default:throw Error("Unknown graphic control label: 0x"+$[J-1].toString(16))}break;case 44:var A=$[J++]|$[J++]<<8,z=$[J++]|$[J++]<<8,P=$[J++]|$[J++]<<8,R=$[J++]|$[J++]<<8,U=$[J++],Z=U>>7,w=U>>6&1,h=U&7,F=1<<h+1,C=V,D=M,T=!1;if(Z){var T=!0;C=J,D=F,J+=F*3}var x=J;J++;while(!0){var B=$[J++];if(!(B>=0))throw Error("Invalid block size");if(B===0)break;J+=B}G.push({x:A,y:z,width:P,height:R,has_local_palette:T,palette_offset:C,palette_size:D,data_offset:x,data_length:J-x,transparent_index:L,interlaced:!!w,delay:O,disposal:E});break;case 59:H=!1;break;default:throw Error("Unknown gif block: 0x"+$[J-1].toString(16))}this.numFrames=function(){return G.length},this.loopCount=function(){return j},this.frameInfo=function(y){if(y<0||y>=G.length)throw Error("Frame index out of range.");return G[y]},this.decodeAndBlitFrameBGRA=function(y,b){var _=this.frameInfo(y),m=_.width*_.height,t=new Uint8Array(m);cX($,_.data_offset,t,m);var{palette_offset:l,transparent_index:s}=_;if(s===null)s=256;var g=_.width,v=X-g,I=g,c=(_.y*X+_.x)*4,o=((_.y+_.height)*X+_.x)*4,$0=c,a=v*4;if(_.interlaced===!0)a+=X*4*7;var e=8;for(var r=0,p=t.length;r<p;++r){var i=t[r];if(I===0){if($0+=a,I=g,$0>=o)a=v*4+X*4*(e-1),$0=c+(g+v)*(e<<1),e>>=1}if(i===s)$0+=4;else{var X0=$[l+i*3],K0=$[l+i*3+1],U0=$[l+i*3+2];b[$0++]=U0,b[$0++]=K0,b[$0++]=X0,b[$0++]=255}--I}},this.decodeAndBlitFrameRGBA=function(y,b){var _=this.frameInfo(y),m=_.width*_.height,t=new Uint8Array(m);cX($,_.data_offset,t,m);var{palette_offset:l,transparent_index:s}=_;if(s===null)s=256;var g=_.width,v=X-g,I=g,c=(_.y*X+_.x)*4,o=((_.y+_.height)*X+_.x)*4,$0=c,a=v*4;if(_.interlaced===!0)a+=X*4*7;var e=8;for(var r=0,p=t.length;r<p;++r){var i=t[r];if(I===0){if($0+=a,I=g,$0>=o)a=v*4+X*4*(e-1),$0=c+(g+v)*(e<<1),e>>=1}if(i===s)$0+=4;else{var X0=$[l+i*3],K0=$[l+i*3+1],U0=$[l+i*3+2];b[$0++]=X0,b[$0++]=K0,b[$0++]=U0,b[$0++]=255}--I}}}function cX($,J,X,K){var q=$[J++],Y=1<<q,W=Y+1,Q=W+1,N=q+1,V=(1<<N)-1,M=0,H=0,G=0,O=$[J++],L=new Int32Array(4096),E=null;while(!0){while(M<16){if(O===0)break;if(H|=$[J++]<<M,M+=8,O===1)O=$[J++];else--O}if(M<N)break;var j=H&V;if(H>>=N,M-=N,j===Y){Q=W+1,N=q+1,V=(1<<N)-1,E=null;continue}else if(j===W)break;var B=j<Q?j:E,S=0,A=B;while(A>Y)A=L[A]>>8,++S;var z=A,P=G+S+(B!==j?1:0);if(P>K){console.log("Warning, gif stream longer than expected.");return}X[G++]=z,G+=S;var R=G;if(B!==j)X[G++]=z;A=B;while(S--)A=L[A],X[--R]=A&255,A>>=8;if(E!==null&&Q<4096){if(L[Q++]=E<<8|z,Q>=V+1&&N<12)++N,V=V<<1|1}E=j}if(G!==K)console.log("Warning, gif stream shorter than expected.");return X}try{gH.GifWriter=yH,gH.GifReader=hH}catch($){}});var K$=L0((eS,dX)=>{class e5{constructor(...$){if($.length===0)throw Error("constructor requires parameters");let J=$[0];if(J!==null&&typeof J==="object")if(J instanceof e5){let X=J.bitmap;this.bitmap={width:X.width,height:X.height,data:new Buffer(X.width*X.height*4)},X.data.copy(this.bitmap.data)}else if(J.width&&J.height&&J.data)this.bitmap=J;else throw Error("unrecognized constructor parameters");else if(typeof J==="number"&&typeof $[1]==="number"){let X=J,K=$[1],q=$[2];if(this.bitmap={width:X,height:K},Buffer.isBuffer(q))this.bitmap.data=q;else if(this.bitmap.data=new Buffer(X*K*4),typeof q==="number")this.fillRGBA(q)}else throw Error("unrecognized constructor parameters")}blit($,J,X,K,q,Y,W){if(K+Y>this.bitmap.width)throw Error("copy exceeds width of source bitmap");if(J+Y>$.bitmap.width)throw Error("copy exceeds width of target bitmap");if(q+W>this.bitmap.height)throw Error("copy exceeds height of source bitmap");if(X+W>$.bitmap.height)throw new Erro("copy exceeds height of target bitmap");let Q=this.bitmap.data,N=$.bitmap.data,V=this.bitmap.width*4,M=$.bitmap.width*4,H=Y*4,G=q*V+K*4,O=X*M+J*4;while(--W>=0)Q.copy(N,O,G,G+H),G+=V,O+=M;return this}fillRGBA($){let J=this.bitmap.data,X=this.bitmap.height*4,K=0;while(K<X)J.writeUInt32BE($,K),K+=4;while(K<J.length)J.copy(J,K,0,X),K+=X;return this}getRGBA($,J){let X=(J*this.bitmap.width+$)*4;return this.bitmap.data.readUInt32BE(X)}getRGBASet(){let $=new Set,J=this.bitmap.data;for(let X=0;X<J.length;X+=4)$.add(J.readUInt32BE(X,!0));return $}greyscale(){let $=this.bitmap.data;return this.scan(0,0,this.bitmap.width,this.bitmap.height,(J,X,K)=>{let q=Math.round(0.299*$[K]+0.587*$[K+1]+0.114*$[K+2]);$[K]=q,$[K+1]=q,$[K+2]=q}),this}reframe($,J,X,K,q){let Y=$<0?0:$,W=J<0?0:J,Q=X+Y>this.bitmap.width?this.bitmap.width-Y:X,N=K+W>this.bitmap.height?this.bitmap.height-W:K,V=$<0?-$:0,M=J<0?-J:0,H;if(q===void 0){if(Y!==$||W!=J||Q!==X||N!==K)throw new GifError("fillRGBA required for this reframing");H=new e5(X,K)}else H=new e5(X,K,q);return this.blit(H,V,M,Y,W,Q,N),this.bitmap=H.bitmap,this}scale($){if($===1)return;if(!Number.isInteger($)||$<1)throw Error("the scale must be an integer >= 1");let J=this.bitmap.width,X=this.bitmap.height,K=J*$*4,q=this.bitmap.data,Y=new Buffer(X*K*$),W=0,Q,N=0;for(let V=0;V<X;++V){Q=N;for(let M=0;M<J;++M){let H=q.readUInt32BE(W,!0);for(let G=0;G<$;++G)Y.writeUInt32BE(H,N),N+=4;W+=4}for(let M=1;M<$;++M)Y.copy(Y,N,Q,N),N+=K,Q+=K}return this.bitmap={width:J*$,height:X*$,data:Y},this}scanAllCoords($){let J=this.bitmap.width,X=this.bitmap.data.length,K=0,q=0;for(let Y=0;Y<X;Y+=4)if($(K,q,Y),++K===J)K=0,++q}scanAllIndexes($){let J=this.bitmap.data.length;for(let X=0;X<J;X+=4)$(X)}}dX.exports=e5});var J9=L0((fH)=>{class $9{constructor($,J,X){this.width=X.width,this.height=X.height,this.loops=X.loops,this.usesTransparency=X.usesTransparency,this.colorScope=X.colorScope,this.frames=J,this.buffer=$}}$9.GlobalColorsPreferred=0;$9.GlobalColorsOnly=1;$9.LocalColorsOnly=2;class nX extends Error{constructor($){super($);if($ instanceof Error)this.stack="Gif"+$.stack}}fH.Gif=$9;fH.GifError=nX});var xK=L0((JA,yK)=>{var{defineProperty:W$,getOwnPropertyDescriptor:pH,getOwnPropertyNames:uH}=Object,lH=Object.prototype.hasOwnProperty,cH=($,J,X)=>(J in $)?W$($,J,{enumerable:!0,configurable:!0,writable:!0,value:X}):$[J]=X,dH=($)=>W$($,"__esModule",{value:!0}),F8=($,J)=>{for(var X in J)W$($,X,{get:J[X],enumerable:!0})},nH=($,J,X,K)=>{if(J&&typeof J==="object"||typeof J==="function"){for(let q of uH(J))if(!lH.call($,q)&&(X||q!=="default"))W$($,q,{get:()=>J[q],enumerable:!(K=pH(J,q))||K.enumerable})}return $},oH=(($)=>{return(J,X)=>{return $&&$.get(J)||(X=nH(dH({}),J,1),$&&$.set(J,X),X)}})(typeof WeakMap<"u"?new WeakMap:0),d=($,J,X)=>{return cH($,typeof J!=="symbol"?J+"":J,X),X},sX={};F8(sX,{applyPalette:()=>UG,applyPaletteSync:()=>OG,buildPalette:()=>GG,buildPaletteSync:()=>HG,constants:()=>aX,conversion:()=>XK,distance:()=>MK,image:()=>DK,palette:()=>AK,quality:()=>TK,utils:()=>FK});var aX={};F8(aX,{bt709:()=>tX});var tX={};F8(tX,{Y:()=>eX,x:()=>$K,y:()=>JK});var eX=(($)=>{return $[$.RED=0.2126]="RED",$[$.GREEN=0.7152]="GREEN",$[$.BLUE=0.0722]="BLUE",$[$.WHITE=1]="WHITE",$})(eX||{}),$K=(($)=>{return $[$.RED=0.64]="RED",$[$.GREEN=0.3]="GREEN",$[$.BLUE=0.15]="BLUE",$[$.WHITE=0.3127]="WHITE",$})($K||{}),JK=(($)=>{return $[$.RED=0.33]="RED",$[$.GREEN=0.6]="GREEN",$[$.BLUE=0.06]="BLUE",$[$.WHITE=0.329]="WHITE",$})(JK||{}),XK={};F8(XK,{lab2rgb:()=>JG,lab2xyz:()=>NK,rgb2hsl:()=>q$,rgb2lab:()=>K9,rgb2xyz:()=>KK,xyz2lab:()=>QK,xyz2rgb:()=>VK});function b7($){return $>0.04045?(($+0.055)/1.055)**2.4:$/12.92}function KK($,J,X){return $=b7($/255),J=b7(J/255),X=b7(X/255),{x:$*0.4124+J*0.3576+X*0.1805,y:$*0.2126+J*0.7152+X*0.0722,z:$*0.0193+J*0.1192+X*0.9505}}var qK={};F8(qK,{degrees2radians:()=>X1,inRange0to255:()=>f6,inRange0to255Rounded:()=>r6,intInRange:()=>rH,max3:()=>YK,min3:()=>WK,stableSort:()=>c7});function X1($){return $*(Math.PI/180)}function YK($,J,X){let K=$;if(K<J)K=J;if(K<X)K=X;return K}function WK($,J,X){let K=$;if(K>J)K=J;if(K>X)K=X;return K}function rH($,J,X){if($>X)$=X;if($<J)$=J;return $|0}function r6($){if($=Math.round($),$>255)$=255;else if($<0)$=0;return $}function f6($){if($>255)$=255;else if($<0)$=0;return $}function c7($,J){let X=typeof $[0],K;if(X==="number"||X==="string"){let q=Object.create(null);for(let Y=0,W=$.length;Y<W;Y++){let Q=$[Y];if(q[Q]||q[Q]===0)continue;q[Q]=Y}K=$.sort((Y,W)=>J(Y,W)||q[Y]-q[W])}else{let q=$.slice(0);K=$.sort((Y,W)=>J(Y,W)||q.indexOf(Y)-q.indexOf(W))}return K}function q$($,J,X){let K=WK($,J,X),q=YK($,J,X),Y=q-K,W=(K+q)/510,Q=0;if(W>0&&W<1)Q=Y/(W<0.5?q+K:510-q-K);let N=0;if(Y>0){if(q===$)N=(J-X)/Y;else if(q===J)N=2+(X-$)/Y;else N=4+($-J)/Y;if(N*=60,N<0)N+=360}return{h:N,s:Q,l:W}}var iH=0.95047,sH=1,aH=1.08883;function m7($){return $>0.008856?$**0.3333333333333333:7.787*$+0.13793103448275862}function QK($,J,X){if($=m7($/iH),J=m7(J/sH),X=m7(X/aH),116*J-16<0)throw Error("xxx");return{L:Math.max(0,116*J-16),a:500*($-J),b:200*(J-X)}}function K9($,J,X){let K=KK($,J,X);return QK(K.x,K.y,K.z)}var tH=0.95047,eH=1,$G=1.08883;function p7($){return $>0.206893034?$**3:($-0.13793103448275862)/7.787}function NK($,J,X){let K=($+16)/116,q=J/500+K,Y=K-X/200;return{x:tH*p7(q),y:eH*p7(K),z:$G*p7(Y)}}function u7($){return $>0.0031308?1.055*$**0.4166666666666667-0.055:12.92*$}function VK($,J,X){let K=u7($*3.2406+J*-1.5372+X*-0.4986),q=u7($*-0.9689+J*1.8758+X*0.0415),Y=u7($*0.0557+J*-0.204+X*1.057);return{r:r6(K*255),g:r6(q*255),b:r6(Y*255)}}function JG($,J,X){let K=NK($,J,X);return VK(K.x,K.y,K.z)}var MK={};F8(MK,{AbstractDistanceCalculator:()=>T1,AbstractEuclidean:()=>Q$,AbstractManhattan:()=>N$,CIE94GraphicArts:()=>OK,CIE94Textiles:()=>GK,CIEDE2000:()=>Q8,CMetric:()=>UK,Euclidean:()=>LK,EuclideanBT709:()=>jK,EuclideanBT709NoAlpha:()=>EK,Manhattan:()=>RK,ManhattanBT709:()=>PK,ManhattanNommyde:()=>BK,PNGQuant:()=>SK});var T1=class{constructor(){d(this,"_maxDistance"),d(this,"_whitePoint"),this._setDefaults(),this.setWhitePoint(255,255,255,255)}setWhitePoint($,J,X,K){this._whitePoint={r:$>0?255/$:0,g:J>0?255/J:0,b:X>0?255/X:0,a:K>0?255/K:0},this._maxDistance=this.calculateRaw($,J,X,K,0,0,0,0)}calculateNormalized($,J){return this.calculateRaw($.r,$.g,$.b,$.a,J.r,J.g,J.b,J.a)/this._maxDistance}},HK=class extends T1{calculateRaw($,J,X,K,q,Y,W,Q){let N=K9(f6($*this._whitePoint.r),f6(J*this._whitePoint.g),f6(X*this._whitePoint.b)),V=K9(f6(q*this._whitePoint.r),f6(Y*this._whitePoint.g),f6(W*this._whitePoint.b)),M=N.L-V.L,H=N.a-V.a,G=N.b-V.b,O=Math.sqrt(N.a*N.a+N.b*N.b),L=Math.sqrt(V.a*V.a+V.b*V.b),E=O-L,j=H*H+G*G-E*E;j=j<0?0:Math.sqrt(j);let B=(Q-K)*this._whitePoint.a*this._kA;return Math.sqrt((M/this._Kl)**2+(E/(1+this._K1*O))**2+(j/(1+this._K2*O))**2+B**2)}},GK=class extends HK{_setDefaults(){this._Kl=2,this._K1=0.048,this._K2=0.014,this._kA=0.049019607843137254}},OK=class extends HK{_setDefaults(){this._Kl=1,this._K1=0.045,this._K2=0.015,this._kA=0.09803921568627451}},J6=class extends T1{_setDefaults(){}static _calculatehp($,J){let X=Math.atan2($,J);if(X>=0)return X;return X+J6._deg360InRad}static _calculateRT($,J){let X=J**7,K=2*Math.sqrt(X/(X+J6._pow25to7)),q=J6._deg30InRad*Math.exp(-((($-J6._deg275InRad)/J6._deg25InRad)**2));return-Math.sin(2*q)*K}static _calculateT($){return 1-0.17*Math.cos($-J6._deg30InRad)+0.24*Math.cos($*2)+0.32*Math.cos($*3+J6._deg6InRad)-0.2*Math.cos($*4-J6._deg63InRad)}static _calculate_ahp($,J,X,K){let q=X+K;if($===0)return q;if(J<=J6._deg180InRad)return q/2;if(q<J6._deg360InRad)return(q+J6._deg360InRad)/2;return(q-J6._deg360InRad)/2}static _calculate_dHp($,J,X,K){let q;if($===0)q=0;else if(J<=J6._deg180InRad)q=X-K;else if(X<=K)q=X-K+J6._deg360InRad;else q=X-K-J6._deg360InRad;return 2*Math.sqrt($)*Math.sin(q/2)}calculateRaw($,J,X,K,q,Y,W,Q){let N=K9(f6($*this._whitePoint.r),f6(J*this._whitePoint.g),f6(X*this._whitePoint.b)),V=K9(f6(q*this._whitePoint.r),f6(Y*this._whitePoint.g),f6(W*this._whitePoint.b)),M=(Q-K)*this._whitePoint.a*J6._kA,H=this.calculateRawInLab(N,V);return Math.sqrt(H+M*M)}calculateRawInLab($,J){let{L:X,a:K,b:q}=$,Y=J.L,W=J.a,Q=J.b,N=Math.sqrt(K*K+q*q),V=Math.sqrt(W*W+Q*Q),M=((N+V)/2)**7,H=0.5*(1-Math.sqrt(M/(M+J6._pow25to7))),G=(1+H)*K,O=(1+H)*W,L=Math.sqrt(G*G+q*q),E=Math.sqrt(O*O+Q*Q),j=L*E,B=J6._calculatehp(q,G),S=J6._calculatehp(Q,O),A=Math.abs(B-S),z=Y-X,P=E-L,R=J6._calculate_dHp(j,A,S,B),U=J6._calculate_ahp(j,A,B,S),Z=J6._calculateT(U),w=(L+E)/2,h=((X+Y)/2-50)**2,F=1+0.015*h/Math.sqrt(20+h),C=1+0.045*w,D=1+0.015*Z*w,T=J6._calculateRT(U,w),x=z/F,y=P/C,b=R/D;return x**2+y**2+b**2+T*y*b}},Q8=J6;d(Q8,"_kA",0.09803921568627451);d(Q8,"_pow25to7",6103515625);d(Q8,"_deg360InRad",X1(360));d(Q8,"_deg180InRad",X1(180));d(Q8,"_deg30InRad",X1(30));d(Q8,"_deg6InRad",X1(6));d(Q8,"_deg63InRad",X1(63));d(Q8,"_deg275InRad",X1(275));d(Q8,"_deg25InRad",X1(25));var UK=class extends T1{calculateRaw($,J,X,K,q,Y,W,Q){let N=($+q)/2*this._whitePoint.r,V=($-q)*this._whitePoint.r,M=(J-Y)*this._whitePoint.g,H=(X-W)*this._whitePoint.b,G=((512+N)*V*V>>8)+4*M*M+((767-N)*H*H>>8),O=(Q-K)*this._whitePoint.a;return Math.sqrt(G+O*O)}_setDefaults(){}},Q$=class extends T1{calculateRaw($,J,X,K,q,Y,W,Q){let N=q-$,V=Y-J,M=W-X,H=Q-K;return Math.sqrt(this._kR*N*N+this._kG*V*V+this._kB*M*M+this._kA*H*H)}},LK=class extends Q${_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},jK=class extends Q${_setDefaults(){this._kR=0.2126,this._kG=0.7152,this._kB=0.0722,this._kA=1}},EK=class extends Q${_setDefaults(){this._kR=0.2126,this._kG=0.7152,this._kB=0.0722,this._kA=0}},N$=class extends T1{calculateRaw($,J,X,K,q,Y,W,Q){let N=q-$,V=Y-J,M=W-X,H=Q-K;if(N<0)N=0-N;if(V<0)V=0-V;if(M<0)M=0-M;if(H<0)H=0-H;return this._kR*N+this._kG*V+this._kB*M+this._kA*H}},RK=class extends N${_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},BK=class extends N${_setDefaults(){this._kR=0.4984,this._kG=0.8625,this._kB=0.2979,this._kA=1}},PK=class extends N${_setDefaults(){this._kR=0.2126,this._kG=0.7152,this._kB=0.0722,this._kA=1}},SK=class extends T1{calculateRaw($,J,X,K,q,Y,W,Q){let N=(Q-K)*this._whitePoint.a;return this._colordifferenceCh($*this._whitePoint.r,q*this._whitePoint.r,N)+this._colordifferenceCh(J*this._whitePoint.g,Y*this._whitePoint.g,N)+this._colordifferenceCh(X*this._whitePoint.b,W*this._whitePoint.b,N)}_colordifferenceCh($,J,X){let K=$-J,q=K+X;return K*K+q*q}_setDefaults(){}},AK={};F8(AK,{AbstractPaletteQuantizer:()=>q9,ColorHistogram:()=>W9,NeuQuant:()=>q6,NeuQuantFloat:()=>Y6,RGBQuant:()=>ZK,WuColorCube:()=>vK,WuQuant:()=>J5});var q9=class{quantizeSync(){for(let $ of this.quantize())if($.palette)return $.palette;throw Error("unreachable")}},b6=class{constructor(){d(this,"r"),d(this,"g"),d(this,"b"),d(this,"a"),d(this,"uint32"),d(this,"rgba"),this.uint32=4294967295,this.r=this.g=this.b=this.a=0,this.rgba=[,,,,],this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}static createByQuadruplet($){let J=new b6;return J.r=$[0]|0,J.g=$[1]|0,J.b=$[2]|0,J.a=$[3]|0,J._loadUINT32(),J._loadQuadruplet(),J}static createByRGBA($,J,X,K){let q=new b6;return q.r=$|0,q.g=J|0,q.b=X|0,q.a=K|0,q._loadUINT32(),q._loadQuadruplet(),q}static createByUint32($){let J=new b6;return J.uint32=$>>>0,J._loadRGBA(),J._loadQuadruplet(),J}from($){this.r=$.r,this.g=$.g,this.b=$.b,this.a=$.a,this.uint32=$.uint32,this.rgba[0]=$.r,this.rgba[1]=$.g,this.rgba[2]=$.b,this.rgba[3]=$.a}getLuminosity($){let J=this.r,X=this.g,K=this.b;if($)J=Math.min(255,255-this.a+this.a*J/255),X=Math.min(255,255-this.a+this.a*X/255),K=Math.min(255,255-this.a+this.a*K/255);return J*0.2126+X*0.7152+K*0.0722}_loadUINT32(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0}_loadRGBA(){this.r=this.uint32&255,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255}_loadQuadruplet(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a}},p8=class{constructor(){d(this,"_pointArray"),d(this,"_width"),d(this,"_height"),this._width=0,this._height=0,this._pointArray=[]}getWidth(){return this._width}getHeight(){return this._height}setWidth($){this._width=$}setHeight($){this._height=$}getPointArray(){return this._pointArray}clone(){let $=new p8;$._width=this._width,$._height=this._height;for(let J=0,X=this._pointArray.length;J<X;J++)$._pointArray[J]=b6.createByUint32(this._pointArray[J].uint32|0);return $}toUint32Array(){let $=this._pointArray.length,J=new Uint32Array($);for(let X=0;X<$;X++)J[X]=this._pointArray[X].uint32;return J}toUint8Array(){return new Uint8Array(this.toUint32Array().buffer)}static fromHTMLImageElement($){let{naturalWidth:J,naturalHeight:X}=$,K=document.createElement("canvas");return K.width=J,K.height=X,K.getContext("2d").drawImage($,0,0,J,X,0,0,J,X),p8.fromHTMLCanvasElement(K)}static fromHTMLCanvasElement($){let{width:J,height:X}=$,q=$.getContext("2d").getImageData(0,0,J,X);return p8.fromImageData(q)}static fromImageData($){let{width:J,height:X}=$;return p8.fromUint8Array($.data,J,X)}static fromUint8Array($,J,X){switch(Object.prototype.toString.call($)){case"[object Uint8ClampedArray]":case"[object Uint8Array]":break;default:$=new Uint8Array($)}let K=new Uint32Array($.buffer);return p8.fromUint32Array(K,J,X)}static fromUint32Array($,J,X){let K=new p8;K._width=J,K._height=X;for(let q=0,Y=$.length;q<Y;q++)K._pointArray[q]=b6.createByUint32($[q]|0);return K}static fromBuffer($,J,X){let K=new Uint32Array($.buffer,$.byteOffset,$.byteLength/Uint32Array.BYTES_PER_ELEMENT);return p8.fromUint32Array(K,J,X)}},oX=10;function l7($,J){let K=360/J,q=K/2;for(let Y=1,W=K-q;Y<J;Y++,W+=K)if($>=W&&$<W+K)return Y;return 0}var Y9=class{constructor(){d(this,"_pointContainer"),d(this,"_pointArray",[]),d(this,"_i32idx",{}),this._pointContainer=new p8,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}add($){this._pointArray.push($),this._pointContainer.setWidth(this._pointArray.length)}has($){for(let J=this._pointArray.length-1;J>=0;J--)if($.uint32===this._pointArray[J].uint32)return!0;return!1}getNearestColor($,J){return this._pointArray[this._getNearestIndex($,J)|0]}getPointContainer(){return this._pointContainer}_nearestPointFromCache($){return typeof this._i32idx[$]==="number"?this._i32idx[$]:-1}_getNearestIndex($,J){let X=this._nearestPointFromCache(""+J.uint32);if(X>=0)return X;let K=Number.MAX_VALUE;X=0;for(let q=0,Y=this._pointArray.length;q<Y;q++){let W=this._pointArray[q],Q=$.calculateRaw(J.r,J.g,J.b,J.a,W.r,W.g,W.b,W.a);if(Q<K)K=Q,X=q}return this._i32idx[J.uint32]=X,X}sort(){this._i32idx={},this._pointArray.sort(($,J)=>{let X=q$($.r,$.g,$.b),K=q$(J.r,J.g,J.b),q=$.r===$.g&&$.g===$.b?0:1+l7(X.h,oX),W=(J.r===J.g&&J.g===J.b?0:1+l7(K.h,oX))-q;if(W)return-W;let Q=$.getLuminosity(!0),N=J.getLuminosity(!0);if(N-Q!==0)return N-Q;let V=(K.s*100|0)-(X.s*100|0);if(V)return-V;return 0})}},FK={};F8(FK,{HueStatistics:()=>zK,Palette:()=>Y9,Point:()=>b6,PointContainer:()=>p8,ProgressTracker:()=>u8,arithmetic:()=>qK});var XG=class{constructor(){d(this,"num",0),d(this,"cols",[])}},zK=class{constructor($,J){d(this,"_numGroups"),d(this,"_minCols"),d(this,"_stats"),d(this,"_groupsFull"),this._numGroups=$,this._minCols=J,this._stats=[];for(let X=0;X<=$;X++)this._stats[X]=new XG;this._groupsFull=0}check($){if(this._groupsFull===this._numGroups+1)this.check=()=>{};let J=$&255,X=$>>>8&255,K=$>>>16&255,q=J===X&&X===K?0:1+l7(q$(J,X,K).h,this._numGroups),Y=this._stats[q],W=this._minCols;if(Y.num++,Y.num>W)return;if(Y.num===W)this._groupsFull++;if(Y.num<=W)this._stats[q].cols.push($)}injectIntoDictionary($){for(let J=0;J<=this._numGroups;J++)if(this._stats[J].num<=this._minCols)this._stats[J].cols.forEach((X)=>{if(!$[X])$[X]=1;else $[X]++})}injectIntoArray($){for(let J=0;J<=this._numGroups;J++)if(this._stats[J].num<=this._minCols)this._stats[J].cols.forEach((X)=>{if($.indexOf(X)===-1)$.push(X)})}},CK=class{constructor($,J){d(this,"progress"),d(this,"_step"),d(this,"_range"),d(this,"_last"),d(this,"_progressRange"),this._range=$,this._progressRange=J,this._step=Math.max(1,this._range/(CK.steps+1)|0),this._last=-this._step,this.progress=0}shouldNotify($){if($-this._last>=this._step)return this._last=$,this.progress=Math.min(this._progressRange*this._last/this._range,this._progressRange),!0;return!1}},u8=CK;d(u8,"steps",100);var C6=3,KG=class{constructor($){d(this,"r"),d(this,"g"),d(this,"b"),d(this,"a"),this.r=this.g=this.b=this.a=$}toPoint(){return b6.createByRGBA(this.r>>C6,this.g>>C6,this.b>>C6,this.a>>C6)}subtract($,J,X,K){this.r-=$|0,this.g-=J|0,this.b-=X|0,this.a-=K|0}},b0=class extends q9{constructor($,J=256){super();d(this,"_pointArray"),d(this,"_networkSize"),d(this,"_network"),d(this,"_sampleFactor"),d(this,"_radPower"),d(this,"_freq"),d(this,"_bias"),d(this,"_distance"),this._distance=$,this._pointArray=[],this._sampleFactor=1,this._networkSize=J,this._distance.setWhitePoint(255<<C6,255<<C6,255<<C6,255<<C6)}sample($){this._pointArray=this._pointArray.concat($.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let $=0;$<this._networkSize;$++)this._network[$]=new KG(($<<C6+8)/this._networkSize|0),this._freq[$]=b0._initialBias/this._networkSize|0,this._bias[$]=0}*_learn(){let $=this._sampleFactor,J=this._pointArray.length;if(J<b0._minpicturebytes)$=1;let X=30+($-1)/3|0,K=J/$|0,q=K/b0._nCycles|0,Y=b0._initAlpha,W=(this._networkSize>>3)*b0._radiusBias,Q=W>>b0._radiusBiasShift;if(Q<=1)Q=0;for(let M=0;M<Q;M++)this._radPower[M]=Y*((Q*Q-M*M)*b0._radBias/(Q*Q))>>>0;let N;if(J<b0._minpicturebytes)N=1;else if(J%b0._prime1!==0)N=b0._prime1;else if(J%b0._prime2!==0)N=b0._prime2;else if(J%b0._prime3!==0)N=b0._prime3;else N=b0._prime4;let V=new u8(K,99);for(let M=0,H=0;M<K;){if(V.shouldNotify(M))yield{progress:V.progress};let G=this._pointArray[H],O=G.b<<C6,L=G.g<<C6,E=G.r<<C6,j=G.a<<C6,B=this._contest(O,L,E,j);if(this._alterSingle(Y,B,O,L,E,j),Q!==0)this._alterNeighbour(Q,B,O,L,E,j);if(H+=N,H>=J)H-=J;if(M++,q===0)q=1;if(M%q===0){if(Y-=Y/X|0,W-=W/b0._radiusDecrease|0,Q=W>>b0._radiusBiasShift,Q<=1)Q=0;for(let S=0;S<Q;S++)this._radPower[S]=Y*((Q*Q-S*S)*b0._radBias/(Q*Q))>>>0}}}_buildPalette(){let $=new Y9;return this._network.forEach((J)=>{$.add(J.toPoint())}),$.sort(),$}_alterNeighbour($,J,X,K,q,Y){let W=J-$;if(W<-1)W=-1;let Q=J+$;if(Q>this._networkSize)Q=this._networkSize;let N=J+1,V=J-1,M=1;while(N<Q||V>W){let H=this._radPower[M++]/b0._alphaRadBias;if(N<Q){let G=this._network[N++];G.subtract(H*(G.r-q),H*(G.g-K),H*(G.b-X),H*(G.a-Y))}if(V>W){let G=this._network[V--];G.subtract(H*(G.r-q),H*(G.g-K),H*(G.b-X),H*(G.a-Y))}}}_alterSingle($,J,X,K,q,Y){$/=b0._initAlpha;let W=this._network[J];W.subtract($*(W.r-q),$*(W.g-K),$*(W.b-X),$*(W.a-Y))}_contest($,J,X,K){let q=1020<<C6,Y=2147483647,W=Y,Q=-1,N=Q;for(let V=0;V<this._networkSize;V++){let M=this._network[V],H=this._distance.calculateNormalized(M,{r:X,g:J,b:$,a:K})*q|0;if(H<Y)Y=H,Q=V;let G=H-(this._bias[V]>>b0._initialBiasShift-C6);if(G<W)W=G,N=V;let O=this._freq[V]>>b0._betaShift;this._freq[V]-=O,this._bias[V]+=O<<b0._gammaShift}return this._freq[Q]+=b0._beta,this._bias[Q]-=b0._betaGamma,N}},q6=b0;d(q6,"_prime1",499);d(q6,"_prime2",491);d(q6,"_prime3",487);d(q6,"_prime4",503);d(q6,"_minpicturebytes",b0._prime4);d(q6,"_nCycles",100);d(q6,"_initialBiasShift",16);d(q6,"_initialBias",1<<b0._initialBiasShift);d(q6,"_gammaShift",10);d(q6,"_betaShift",10);d(q6,"_beta",b0._initialBias>>b0._betaShift);d(q6,"_betaGamma",b0._initialBias<<b0._gammaShift-b0._betaShift);d(q6,"_radiusBiasShift",6);d(q6,"_radiusBias",1<<b0._radiusBiasShift);d(q6,"_radiusDecrease",30);d(q6,"_alphaBiasShift",10);d(q6,"_initAlpha",1<<b0._alphaBiasShift);d(q6,"_radBiasShift",8);d(q6,"_radBias",1<<b0._radBiasShift);d(q6,"_alphaRadBiasShift",b0._alphaBiasShift+b0._radBiasShift);d(q6,"_alphaRadBias",1<<b0._alphaRadBiasShift);var Z6=3,qG=class{constructor($){d(this,"r"),d(this,"g"),d(this,"b"),d(this,"a"),this.r=this.g=this.b=this.a=$}toPoint(){return b6.createByRGBA(this.r>>Z6,this.g>>Z6,this.b>>Z6,this.a>>Z6)}subtract($,J,X,K){this.r-=$,this.g-=J,this.b-=X,this.a-=K}},m0=class extends q9{constructor($,J=256){super();d(this,"_pointArray"),d(this,"_networkSize"),d(this,"_network"),d(this,"_sampleFactor"),d(this,"_radPower"),d(this,"_freq"),d(this,"_bias"),d(this,"_distance"),this._distance=$,this._pointArray=[],this._sampleFactor=1,this._networkSize=J,this._distance.setWhitePoint(255<<Z6,255<<Z6,255<<Z6,255<<Z6)}sample($){this._pointArray=this._pointArray.concat($.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let $=0;$<this._networkSize;$++)this._network[$]=new qG(($<<Z6+8)/this._networkSize),this._freq[$]=m0._initialBias/this._networkSize,this._bias[$]=0}*_learn(){let $=this._sampleFactor,J=this._pointArray.length;if(J<m0._minpicturebytes)$=1;let X=30+($-1)/3,K=J/$,q=K/m0._nCycles|0,Y=m0._initAlpha,W=(this._networkSize>>3)*m0._radiusBias,Q=W>>m0._radiusBiasShift;if(Q<=1)Q=0;for(let M=0;M<Q;M++)this._radPower[M]=Y*((Q*Q-M*M)*m0._radBias/(Q*Q));let N;if(J<m0._minpicturebytes)N=1;else if(J%m0._prime1!==0)N=m0._prime1;else if(J%m0._prime2!==0)N=m0._prime2;else if(J%m0._prime3!==0)N=m0._prime3;else N=m0._prime4;let V=new u8(K,99);for(let M=0,H=0;M<K;){if(V.shouldNotify(M))yield{progress:V.progress};let G=this._pointArray[H],O=G.b<<Z6,L=G.g<<Z6,E=G.r<<Z6,j=G.a<<Z6,B=this._contest(O,L,E,j);if(this._alterSingle(Y,B,O,L,E,j),Q!==0)this._alterNeighbour(Q,B,O,L,E,j);if(H+=N,H>=J)H-=J;if(M++,q===0)q=1;if(M%q===0){if(Y-=Y/X,W-=W/m0._radiusDecrease,Q=W>>m0._radiusBiasShift,Q<=1)Q=0;for(let S=0;S<Q;S++)this._radPower[S]=Y*((Q*Q-S*S)*m0._radBias/(Q*Q))}}}_buildPalette(){let $=new Y9;return this._network.forEach((J)=>{$.add(J.toPoint())}),$.sort(),$}_alterNeighbour($,J,X,K,q,Y){let W=J-$;if(W<-1)W=-1;let Q=J+$;if(Q>this._networkSize)Q=this._networkSize;let N=J+1,V=J-1,M=1;while(N<Q||V>W){let H=this._radPower[M++]/m0._alphaRadBias;if(N<Q){let G=this._network[N++];G.subtract(H*(G.r-q),H*(G.g-K),H*(G.b-X),H*(G.a-Y))}if(V>W){let G=this._network[V--];G.subtract(H*(G.r-q),H*(G.g-K),H*(G.b-X),H*(G.a-Y))}}}_alterSingle($,J,X,K,q,Y){$/=m0._initAlpha;let W=this._network[J];W.subtract($*(W.r-q),$*(W.g-K),$*(W.b-X),$*(W.a-Y))}_contest($,J,X,K){let q=1020<<Z6,Y=2147483647,W=Y,Q=-1,N=Q;for(let V=0;V<this._networkSize;V++){let M=this._network[V],H=this._distance.calculateNormalized(M,{r:X,g:J,b:$,a:K})*q;if(H<Y)Y=H,Q=V;let G=H-(this._bias[V]>>m0._initialBiasShift-Z6);if(G<W)W=G,N=V;let O=this._freq[V]>>m0._betaShift;this._freq[V]-=O,this._bias[V]+=O<<m0._gammaShift}return this._freq[Q]+=m0._beta,this._bias[Q]-=m0._betaGamma,N}},Y6=m0;d(Y6,"_prime1",499);d(Y6,"_prime2",491);d(Y6,"_prime3",487);d(Y6,"_prime4",503);d(Y6,"_minpicturebytes",m0._prime4);d(Y6,"_nCycles",100);d(Y6,"_initialBiasShift",16);d(Y6,"_initialBias",1<<m0._initialBiasShift);d(Y6,"_gammaShift",10);d(Y6,"_betaShift",10);d(Y6,"_beta",m0._initialBias>>m0._betaShift);d(Y6,"_betaGamma",m0._initialBias<<m0._gammaShift-m0._betaShift);d(Y6,"_radiusBiasShift",6);d(Y6,"_radiusBias",1<<m0._radiusBiasShift);d(Y6,"_radiusDecrease",30);d(Y6,"_alphaBiasShift",10);d(Y6,"_initAlpha",1<<m0._alphaBiasShift);d(Y6,"_radBiasShift",8);d(Y6,"_radBias",1<<m0._radBiasShift);d(Y6,"_alphaRadBiasShift",m0._alphaBiasShift+m0._radBiasShift);d(Y6,"_alphaRadBias",1<<m0._alphaRadBiasShift);var X9=class{constructor($,J){d(this,"_method"),d(this,"_hueStats"),d(this,"_histogram"),d(this,"_initColors"),d(this,"_minHueCols"),this._method=$,this._minHueCols=J<<2,this._initColors=J<<2,this._hueStats=new zK(X9._hueGroups,this._minHueCols),this._histogram=Object.create(null)}sample($){switch(this._method){case 1:this._colorStats1D($);break;case 2:this._colorStats2D($);break}}getImportanceSortedColorsIDXI32(){let $=c7(Object.keys(this._histogram),(X,K)=>this._histogram[K]-this._histogram[X]);if($.length===0)return[];let J;switch(this._method){case 1:let X=Math.min($.length,this._initColors),K=$[X-1],q=this._histogram[K];J=$.slice(0,X);let Y=X,W=$.length;while(Y<W&&this._histogram[$[Y]]===q)J.push($[Y++]);this._hueStats.injectIntoArray(J);break;case 2:J=$;break;default:throw Error("Incorrect method")}return J.map((X)=>+X)}_colorStats1D($){let J=this._histogram,X=$.getPointArray(),K=X.length;for(let q=0;q<K;q++){let Y=X[q].uint32;if(this._hueStats.check(Y),Y in J)J[Y]++;else J[Y]=1}}_colorStats2D($){let J=$.getWidth(),X=$.getHeight(),K=$.getPointArray(),q=X9._boxSize[0],Y=X9._boxSize[1],W=q*Y,Q=this._makeBoxes(J,X,q,Y),N=this._histogram;Q.forEach((V)=>{let M=Math.round(V.w*V.h/W)*X9._boxPixels;if(M<2)M=2;let H={};this._iterateBox(V,J,(G)=>{let O=K[G].uint32;if(this._hueStats.check(O),O in N)N[O]++;else if(O in H){if(++H[O]>=M)N[O]=H[O]}else H[O]=1})}),this._hueStats.injectIntoDictionary(N)}_iterateBox($,J,X){let K=$,q=K.y*J+K.x,Y=(K.y+K.h-1)*J+(K.x+K.w-1),W=J-K.w+1,Q=0,N=q;do X.call(this,N),N+=++Q%K.w===0?W:1;while(N<=Y)}_makeBoxes($,J,X,K){let q=$%X,Y=J%K,W=$-q,Q=J-Y,N=[];for(let V=0;V<J;V+=K)for(let M=0;M<$;M+=X)N.push({x:M,y:V,w:M===W?q:X,h:V===Q?Y:K});return N}},W9=X9;d(W9,"_boxSize",[64,64]);d(W9,"_boxPixels",2);d(W9,"_hueGroups",10);var YG=class{constructor($,J,X){d(this,"index"),d(this,"color"),d(this,"distance"),this.index=$,this.color=J,this.distance=X}},ZK=class extends q9{constructor($,J=256,X=2){super();d(this,"_colors"),d(this,"_initialDistance"),d(this,"_distanceIncrement"),d(this,"_histogram"),d(this,"_distance"),this._distance=$,this._colors=J,this._histogram=new W9(X,J),this._initialDistance=0.01,this._distanceIncrement=0.005}sample($){this._histogram.sample($)}*quantize(){let $=this._histogram.getImportanceSortedColorsIDXI32();if($.length===0)throw Error("No colors in image");yield*this._buildPalette($)}*_buildPalette($){let J=new Y9,X=J.getPointContainer().getPointArray(),K=Array($.length);for(let M=0;M<$.length;M++)X.push(b6.createByUint32($[M])),K[M]=1;let q=X.length,Y=[],W=q,Q=this._initialDistance,N=new u8(W-this._colors,99);while(W>this._colors){Y.length=0;for(let M=0;M<q;M++){if(N.shouldNotify(q-W))yield{progress:N.progress};if(K[M]===0)continue;let H=X[M];for(let G=M+1;G<q;G++){if(K[G]===0)continue;let O=X[G],L=this._distance.calculateNormalized(H,O);if(L<Q)Y.push(new YG(G,O,L)),K[G]=0,W--}}Q+=W>this._colors*3?this._initialDistance:this._distanceIncrement}if(W<this._colors){c7(Y,(H,G)=>G.distance-H.distance);let M=0;while(W<this._colors&&M<Y.length){let H=Y[M];K[H.index]=1,W++,M++}}let V=X.length;for(let M=V-1;M>=0;M--)if(K[M]===0){if(M!==V-1)X[M]=X[V-1];--V}X.length=V,J.sort(),yield{palette:J,progress:100}}};function s1($){let J=[];for(let X=0;X<$;X++)J[X]=0;return J}function a1($,J,X,K){let q=Array($);for(let Y=0;Y<$;Y++){q[Y]=Array(J);for(let W=0;W<J;W++){q[Y][W]=Array(X);for(let Q=0;Q<X;Q++){q[Y][W][Q]=Array(K);for(let N=0;N<K;N++)q[Y][W][Q][N]=0}}}return q}function t1($,J,X){let K=Array($);for(let q=0;q<$;q++){K[q]=Array(J);for(let Y=0;Y<J;Y++){K[q][Y]=Array(X);for(let W=0;W<X;W++)K[q][Y][W]=0}}return K}function e1($,J,X,K,q){for(let Y=0;Y<J;Y++){$[Y]=[];for(let W=0;W<X;W++){$[Y][W]=[];for(let Q=0;Q<K;Q++)$[Y][W][Q]=q}}}function $5($,J,X){for(let K=0;K<J;K++)$[K]=X}var vK=class{constructor(){d(this,"redMinimum"),d(this,"redMaximum"),d(this,"greenMinimum"),d(this,"greenMaximum"),d(this,"blueMinimum"),d(this,"blueMaximum"),d(this,"volume"),d(this,"alphaMinimum"),d(this,"alphaMaximum")}},k0=class extends q9{constructor($,J=256,X=5){super();d(this,"_reds"),d(this,"_greens"),d(this,"_blues"),d(this,"_alphas"),d(this,"_sums"),d(this,"_weights"),d(this,"_momentsRed"),d(this,"_momentsGreen"),d(this,"_momentsBlue"),d(this,"_momentsAlpha"),d(this,"_moments"),d(this,"_table"),d(this,"_pixels"),d(this,"_cubes"),d(this,"_colors"),d(this,"_significantBitsPerChannel"),d(this,"_maxSideIndex"),d(this,"_alphaMaxSideIndex"),d(this,"_sideSize"),d(this,"_alphaSideSize"),d(this,"_distance"),this._distance=$,this._setQuality(X),this._initialize(J)}sample($){let J=$.getPointArray();for(let X=0,K=J.length;X<K;X++)this._addColor(J[X]);this._pixels=this._pixels.concat(J)}*quantize(){yield*this._preparePalette();let $=new Y9;for(let J=0;J<this._colors;J++)if(this._sums[J]>0){let X=this._sums[J],K=this._reds[J]/X,q=this._greens[J]/X,Y=this._blues[J]/X,W=this._alphas[J]/X,Q=b6.createByRGBA(K|0,q|0,Y|0,W|0);$.add(Q)}$.sort(),yield{palette:$,progress:100}}*_preparePalette(){yield*this._calculateMoments();let $=0,J=s1(this._colors);for(let W=1;W<this._colors;++W){if(this._cut(this._cubes[$],this._cubes[W]))J[$]=this._cubes[$].volume>1?this._calculateVariance(this._cubes[$]):0,J[W]=this._cubes[W].volume>1?this._calculateVariance(this._cubes[W]):0;else J[$]=0,W--;$=0;let Q=J[0];for(let N=1;N<=W;++N)if(J[N]>Q)Q=J[N],$=N;if(Q<=0){this._colors=W+1;break}}let X=[],K=[],q=[],Y=[];for(let W=0;W<this._colors;++W){let Q=k0._volume(this._cubes[W],this._weights);if(Q>0)X[W]=k0._volume(this._cubes[W],this._momentsRed)/Q|0,K[W]=k0._volume(this._cubes[W],this._momentsGreen)/Q|0,q[W]=k0._volume(this._cubes[W],this._momentsBlue)/Q|0,Y[W]=k0._volume(this._cubes[W],this._momentsAlpha)/Q|0;else X[W]=0,K[W]=0,q[W]=0,Y[W]=0}this._reds=s1(this._colors+1),this._greens=s1(this._colors+1),this._blues=s1(this._colors+1),this._alphas=s1(this._colors+1),this._sums=s1(this._colors+1);for(let W=0,Q=this._pixels.length;W<Q;W++){let N=this._pixels[W],V=-1,M=-1,H=Number.MAX_VALUE;for(let G=0;G<this._colors;G++){let O=X[G],L=K[G],E=q[G],j=Y[G],B=this._distance.calculateRaw(O,L,E,j,N.r,N.g,N.b,N.a);if(B<H)H=B,M=G}this._reds[M]+=N.r,this._greens[M]+=N.g,this._blues[M]+=N.b,this._alphas[M]+=N.a,this._sums[M]++}}_addColor($){let J=8-this._significantBitsPerChannel,X=($.r>>J)+1,K=($.g>>J)+1,q=($.b>>J)+1,Y=($.a>>J)+1;this._weights[Y][X][K][q]++,this._momentsRed[Y][X][K][q]+=$.r,this._momentsGreen[Y][X][K][q]+=$.g,this._momentsBlue[Y][X][K][q]+=$.b,this._momentsAlpha[Y][X][K][q]+=$.a,this._moments[Y][X][K][q]+=this._table[$.r]+this._table[$.g]+this._table[$.b]+this._table[$.a]}*_calculateMoments(){let $=[],J=[],X=[],K=[],q=[],Y=[],W=t1(this._sideSize,this._sideSize,this._sideSize),Q=t1(this._sideSize,this._sideSize,this._sideSize),N=t1(this._sideSize,this._sideSize,this._sideSize),V=t1(this._sideSize,this._sideSize,this._sideSize),M=t1(this._sideSize,this._sideSize,this._sideSize),H=t1(this._sideSize,this._sideSize,this._sideSize),G=0,O=new u8(this._alphaMaxSideIndex*this._maxSideIndex,99);for(let L=1;L<=this._alphaMaxSideIndex;++L){e1(W,this._sideSize,this._sideSize,this._sideSize,0),e1(Q,this._sideSize,this._sideSize,this._sideSize,0),e1(N,this._sideSize,this._sideSize,this._sideSize,0),e1(V,this._sideSize,this._sideSize,this._sideSize,0),e1(M,this._sideSize,this._sideSize,this._sideSize,0),e1(H,this._sideSize,this._sideSize,this._sideSize,0);for(let E=1;E<=this._maxSideIndex;++E,++G){if(O.shouldNotify(G))yield{progress:O.progress};$5($,this._sideSize,0),$5(J,this._sideSize,0),$5(X,this._sideSize,0),$5(K,this._sideSize,0),$5(q,this._sideSize,0),$5(Y,this._sideSize,0);for(let j=1;j<=this._maxSideIndex;++j){let B=0,S=0,A=0,z=0,P=0,R=0;for(let U=1;U<=this._maxSideIndex;++U)B+=this._weights[L][E][j][U],S+=this._momentsRed[L][E][j][U],A+=this._momentsGreen[L][E][j][U],z+=this._momentsBlue[L][E][j][U],P+=this._momentsAlpha[L][E][j][U],R+=this._moments[L][E][j][U],$[U]+=B,J[U]+=S,X[U]+=A,K[U]+=z,q[U]+=P,Y[U]+=R,W[E][j][U]=W[E-1][j][U]+$[U],Q[E][j][U]=Q[E-1][j][U]+J[U],N[E][j][U]=N[E-1][j][U]+X[U],V[E][j][U]=V[E-1][j][U]+K[U],M[E][j][U]=M[E-1][j][U]+q[U],H[E][j][U]=H[E-1][j][U]+Y[U],this._weights[L][E][j][U]=this._weights[L-1][E][j][U]+W[E][j][U],this._momentsRed[L][E][j][U]=this._momentsRed[L-1][E][j][U]+Q[E][j][U],this._momentsGreen[L][E][j][U]=this._momentsGreen[L-1][E][j][U]+N[E][j][U],this._momentsBlue[L][E][j][U]=this._momentsBlue[L-1][E][j][U]+V[E][j][U],this._momentsAlpha[L][E][j][U]=this._momentsAlpha[L-1][E][j][U]+M[E][j][U],this._moments[L][E][j][U]=this._moments[L-1][E][j][U]+H[E][j][U]}}}}static _volumeFloat($,J){return J[$.alphaMaximum][$.redMaximum][$.greenMaximum][$.blueMaximum]-J[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMaximum]-J[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMaximum]+J[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMaximum]-J[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMaximum]+J[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMaximum]+J[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMaximum]-J[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMaximum]-(J[$.alphaMaximum][$.redMaximum][$.greenMaximum][$.blueMinimum]-J[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMinimum]-J[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMinimum]+J[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMinimum]-J[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMinimum]+J[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMinimum]+J[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMinimum]-J[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum])}static _volume($,J){return k0._volumeFloat($,J)|0}static _top($,J,X,K){let q;switch(J){case k0._alpha:q=K[X][$.redMaximum][$.greenMaximum][$.blueMaximum]-K[X][$.redMaximum][$.greenMinimum][$.blueMaximum]-K[X][$.redMinimum][$.greenMaximum][$.blueMaximum]+K[X][$.redMinimum][$.greenMinimum][$.blueMaximum]-(K[X][$.redMaximum][$.greenMaximum][$.blueMinimum]-K[X][$.redMaximum][$.greenMinimum][$.blueMinimum]-K[X][$.redMinimum][$.greenMaximum][$.blueMinimum]+K[X][$.redMinimum][$.greenMinimum][$.blueMinimum]);break;case k0._red:q=K[$.alphaMaximum][X][$.greenMaximum][$.blueMaximum]-K[$.alphaMaximum][X][$.greenMinimum][$.blueMaximum]-K[$.alphaMinimum][X][$.greenMaximum][$.blueMaximum]+K[$.alphaMinimum][X][$.greenMinimum][$.blueMaximum]-(K[$.alphaMaximum][X][$.greenMaximum][$.blueMinimum]-K[$.alphaMaximum][X][$.greenMinimum][$.blueMinimum]-K[$.alphaMinimum][X][$.greenMaximum][$.blueMinimum]+K[$.alphaMinimum][X][$.greenMinimum][$.blueMinimum]);break;case k0._green:q=K[$.alphaMaximum][$.redMaximum][X][$.blueMaximum]-K[$.alphaMaximum][$.redMinimum][X][$.blueMaximum]-K[$.alphaMinimum][$.redMaximum][X][$.blueMaximum]+K[$.alphaMinimum][$.redMinimum][X][$.blueMaximum]-(K[$.alphaMaximum][$.redMaximum][X][$.blueMinimum]-K[$.alphaMaximum][$.redMinimum][X][$.blueMinimum]-K[$.alphaMinimum][$.redMaximum][X][$.blueMinimum]+K[$.alphaMinimum][$.redMinimum][X][$.blueMinimum]);break;case k0._blue:q=K[$.alphaMaximum][$.redMaximum][$.greenMaximum][X]-K[$.alphaMaximum][$.redMaximum][$.greenMinimum][X]-K[$.alphaMaximum][$.redMinimum][$.greenMaximum][X]+K[$.alphaMaximum][$.redMinimum][$.greenMinimum][X]-(K[$.alphaMinimum][$.redMaximum][$.greenMaximum][X]-K[$.alphaMinimum][$.redMaximum][$.greenMinimum][X]-K[$.alphaMinimum][$.redMinimum][$.greenMaximum][X]+K[$.alphaMinimum][$.redMinimum][$.greenMinimum][X]);break;default:throw Error("impossible")}return q|0}static _bottom($,J,X){switch(J){case k0._alpha:return-X[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMaximum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMaximum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMaximum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMaximum]-(-X[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMinimum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMinimum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMinimum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum]);case k0._red:return-X[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMaximum]+X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMaximum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMaximum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMaximum]-(-X[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMinimum]+X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMinimum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMinimum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum]);case k0._green:return-X[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMaximum]+X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMaximum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMaximum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMaximum]-(-X[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMinimum]+X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMinimum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMinimum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum]);case k0._blue:return-X[$.alphaMaximum][$.redMaximum][$.greenMaximum][$.blueMinimum]+X[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMinimum]+X[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMinimum]-X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMinimum]-(-X[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMinimum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMinimum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMinimum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum]);default:return 0}}_calculateVariance($){let J=k0._volume($,this._momentsRed),X=k0._volume($,this._momentsGreen),K=k0._volume($,this._momentsBlue),q=k0._volume($,this._momentsAlpha),Y=k0._volumeFloat($,this._moments),W=k0._volume($,this._weights),Q=J*J+X*X+K*K+q*q;return Y-Q/W}_maximize($,J,X,K,q,Y,W,Q,N){let V=k0._bottom($,J,this._momentsRed)|0,M=k0._bottom($,J,this._momentsGreen)|0,H=k0._bottom($,J,this._momentsBlue)|0,G=k0._bottom($,J,this._momentsAlpha)|0,O=k0._bottom($,J,this._weights)|0,L=0,E=-1;for(let j=X;j<K;++j){let B=V+k0._top($,J,j,this._momentsRed),S=M+k0._top($,J,j,this._momentsGreen),A=H+k0._top($,J,j,this._momentsBlue),z=G+k0._top($,J,j,this._momentsAlpha),P=O+k0._top($,J,j,this._weights);if(P!==0){let R=B*B+S*S+A*A+z*z,U=R/P;if(B=q-B,S=Y-S,A=W-A,z=Q-z,P=N-P,P!==0){if(R=B*B+S*S+A*A+z*z,U+=R/P,U>L)L=U,E=j}}}return{max:L,position:E}}_cut($,J){let X,K=k0._volume($,this._momentsRed),q=k0._volume($,this._momentsGreen),Y=k0._volume($,this._momentsBlue),W=k0._volume($,this._momentsAlpha),Q=k0._volume($,this._weights),N=this._maximize($,k0._red,$.redMinimum+1,$.redMaximum,K,q,Y,W,Q),V=this._maximize($,k0._green,$.greenMinimum+1,$.greenMaximum,K,q,Y,W,Q),M=this._maximize($,k0._blue,$.blueMinimum+1,$.blueMaximum,K,q,Y,W,Q),H=this._maximize($,k0._alpha,$.alphaMinimum+1,$.alphaMaximum,K,q,Y,W,Q);if(H.max>=N.max&&H.max>=V.max&&H.max>=M.max){if(X=k0._alpha,H.position<0)return!1}else if(N.max>=H.max&&N.max>=V.max&&N.max>=M.max)X=k0._red;else if(V.max>=H.max&&V.max>=N.max&&V.max>=M.max)X=k0._green;else X=k0._blue;switch(J.redMaximum=$.redMaximum,J.greenMaximum=$.greenMaximum,J.blueMaximum=$.blueMaximum,J.alphaMaximum=$.alphaMaximum,X){case k0._red:J.redMinimum=$.redMaximum=N.position,J.greenMinimum=$.greenMinimum,J.blueMinimum=$.blueMinimum,J.alphaMinimum=$.alphaMinimum;break;case k0._green:J.greenMinimum=$.greenMaximum=V.position,J.redMinimum=$.redMinimum,J.blueMinimum=$.blueMinimum,J.alphaMinimum=$.alphaMinimum;break;case k0._blue:J.blueMinimum=$.blueMaximum=M.position,J.redMinimum=$.redMinimum,J.greenMinimum=$.greenMinimum,J.alphaMinimum=$.alphaMinimum;break;case k0._alpha:J.alphaMinimum=$.alphaMaximum=H.position,J.blueMinimum=$.blueMinimum,J.redMinimum=$.redMinimum,J.greenMinimum=$.greenMinimum;break}return $.volume=($.redMaximum-$.redMinimum)*($.greenMaximum-$.greenMinimum)*($.blueMaximum-$.blueMinimum)*($.alphaMaximum-$.alphaMinimum),J.volume=(J.redMaximum-J.redMinimum)*(J.greenMaximum-J.greenMinimum)*(J.blueMaximum-J.blueMinimum)*(J.alphaMaximum-J.alphaMinimum),!0}_initialize($){this._colors=$,this._cubes=[];for(let J=0;J<$;J++)this._cubes[J]=new vK;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=a1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=a1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=a1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=a1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=a1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=a1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(let J=0;J<256;++J)this._table[J]=J*J;this._pixels=[]}_setQuality($=5){this._significantBitsPerChannel=$,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1}},J5=k0;d(J5,"_alpha",3);d(J5,"_red",2);d(J5,"_green",1);d(J5,"_blue",0);var DK={};F8(DK,{AbstractImageQuantizer:()=>V$,ErrorDiffusionArray:()=>A8,ErrorDiffusionArrayKernel:()=>wK,ErrorDiffusionRiemersma:()=>d7,NearestColor:()=>kK});var V$=class{quantizeSync($,J){for(let X of this.quantize($,J))if(X.pointContainer)return X.pointContainer;throw Error("unreachable")}},kK=class extends V${constructor($){super();d(this,"_distance"),this._distance=$}*quantize($,J){let X=$.getPointArray(),K=$.getWidth(),q=$.getHeight(),Y=new u8(q,99);for(let W=0;W<q;W++){if(Y.shouldNotify(W))yield{progress:Y.progress};for(let Q=0,N=W*K;Q<K;Q++,N++){let V=X[N];V.from(J.getNearestColor(this._distance,V))}}yield{pointContainer:$,progress:100}}},wK=(($)=>{return $[$.FloydSteinberg=0]="FloydSteinberg",$[$.FalseFloydSteinberg=1]="FalseFloydSteinberg",$[$.Stucki=2]="Stucki",$[$.Atkinson=3]="Atkinson",$[$.Jarvis=4]="Jarvis",$[$.Burkes=5]="Burkes",$[$.Sierra=6]="Sierra",$[$.TwoSierra=7]="TwoSierra",$[$.SierraLite=8]="SierraLite",$})(wK||{}),A8=class extends V${constructor($,J,X=!0,K=0,q=!1){super();d(this,"_minColorDistance"),d(this,"_serpentine"),d(this,"_kernel"),d(this,"_calculateErrorLikeGIMP"),d(this,"_distance"),this._setKernel(J),this._distance=$,this._minColorDistance=K,this._serpentine=X,this._calculateErrorLikeGIMP=q}*quantize($,J){let X=$.getPointArray(),K=new b6,q=$.getWidth(),Y=$.getHeight(),W=[],Q=1,N=1;for(let M of this._kernel){let H=M[2]+1;if(N<H)N=H}for(let M=0;M<N;M++)this._fillErrorLine(W[M]=[],q);let V=new u8(Y,99);for(let M=0;M<Y;M++){if(V.shouldNotify(M))yield{progress:V.progress};if(this._serpentine)Q*=-1;let H=M*q,G=Q===1?0:q-1,O=Q===1?q:-1;this._fillErrorLine(W[0],q),W.push(W.shift());let L=W[0];for(let E=G,j=H+G;E!==O;E+=Q,j+=Q){let B=X[j],S=L[E];K.from(B);let A=b6.createByRGBA(r6(B.r+S[0]),r6(B.g+S[1]),r6(B.b+S[2]),r6(B.a+S[3])),z=J.getNearestColor(this._distance,A);if(B.from(z),this._minColorDistance){if(this._distance.calculateNormalized(K,z)<this._minColorDistance)continue}let P,R,U,Z;if(this._calculateErrorLikeGIMP)P=A.r-z.r,R=A.g-z.g,U=A.b-z.b,Z=A.a-z.a;else P=K.r-z.r,R=K.g-z.g,U=K.b-z.b,Z=K.a-z.a;let w=Q===1?0:this._kernel.length-1,h=Q===1?this._kernel.length:-1;for(let F=w;F!==h;F+=Q){let C=this._kernel[F][1]*Q,D=this._kernel[F][2];if(C+E>=0&&C+E<q&&D+M>=0&&D+M<Y){let T=this._kernel[F][0],x=W[D][C+E];x[0]+=P*T,x[1]+=R*T,x[2]+=U*T,x[3]+=Z*T}}}}yield{pointContainer:$,progress:100}}_fillErrorLine($,J){if($.length>J)$.length=J;let X=$.length;for(let K=0;K<X;K++){let q=$[K];q[0]=q[1]=q[2]=q[3]=0}for(let K=X;K<J;K++)$[K]=[0,0,0,0]}_setKernel($){switch($){case 0:this._kernel=[[0.4375,1,0],[0.1875,-1,1],[0.3125,0,1],[0.0625,1,1]];break;case 1:this._kernel=[[0.375,1,0],[0.375,0,1],[0.25,1,1]];break;case 2:this._kernel=[[0.19047619047619047,1,0],[0.09523809523809523,2,0],[0.047619047619047616,-2,1],[0.09523809523809523,-1,1],[0.19047619047619047,0,1],[0.09523809523809523,1,1],[0.047619047619047616,2,1],[0.023809523809523808,-2,2],[0.047619047619047616,-1,2],[0.09523809523809523,0,2],[0.047619047619047616,1,2],[0.023809523809523808,2,2]];break;case 3:this._kernel=[[0.125,1,0],[0.125,2,0],[0.125,-1,1],[0.125,0,1],[0.125,1,1],[0.125,0,2]];break;case 4:this._kernel=[[0.14583333333333334,1,0],[0.10416666666666667,2,0],[0.0625,-2,1],[0.10416666666666667,-1,1],[0.14583333333333334,0,1],[0.10416666666666667,1,1],[0.0625,2,1],[0.020833333333333332,-2,2],[0.0625,-1,2],[0.10416666666666667,0,2],[0.0625,1,2],[0.020833333333333332,2,2]];break;case 5:this._kernel=[[0.25,1,0],[0.125,2,0],[0.0625,-2,1],[0.125,-1,1],[0.25,0,1],[0.125,1,1],[0.0625,2,1]];break;case 6:this._kernel=[[0.15625,1,0],[0.09375,2,0],[0.0625,-2,1],[0.125,-1,1],[0.15625,0,1],[0.125,1,1],[0.0625,2,1],[0.0625,-1,2],[0.09375,0,2],[0.0625,1,2]];break;case 7:this._kernel=[[0.25,1,0],[0.1875,2,0],[0.0625,-2,1],[0.125,-1,1],[0.1875,0,1],[0.125,1,1],[0.0625,2,1]];break;case 8:this._kernel=[[0.5,1,0],[0.25,-1,1],[0.25,0,1]];break;default:throw Error(`ErrorDiffusionArray: unknown kernel = ${$}`)}}};function*WG($,J,X){let K=Math.max($,J),q=Math.floor(Math.log(K)/Math.log(2)+1),Y=new u8($*J,99),W={width:$,height:J,level:q,callback:X,tracker:Y,index:0,x:0,y:0};yield*R6(W,1),g6(W,0)}function*R6($,J){if($.level<1)return;if($.tracker.shouldNotify($.index))yield{progress:$.tracker.progress};switch($.level--,J){case 2:yield*R6($,1),g6($,3),yield*R6($,2),g6($,4),yield*R6($,2),g6($,2),yield*R6($,4);break;case 3:yield*R6($,4),g6($,2),yield*R6($,3),g6($,1),yield*R6($,3),g6($,3),yield*R6($,1);break;case 1:yield*R6($,2),g6($,4),yield*R6($,1),g6($,3),yield*R6($,1),g6($,1),yield*R6($,3);break;case 4:yield*R6($,3),g6($,1),yield*R6($,4),g6($,2),yield*R6($,4),g6($,4),yield*R6($,2);break;default:break}$.level++}function g6($,J){if($.x>=0&&$.x<$.width&&$.y>=0&&$.y<$.height)$.callback($.x,$.y),$.index++;switch(J){case 2:$.x--;break;case 3:$.x++;break;case 1:$.y--;break;case 4:$.y++;break}}var d7=class extends V${constructor($,J=16,X=1){super();d(this,"_distance"),d(this,"_weights"),d(this,"_errorQueueSize"),this._distance=$,this._errorQueueSize=J,this._weights=d7._createWeights(X,J)}*quantize($,J){let X=$.getPointArray(),K=$.getWidth(),q=$.getHeight(),Y=[],W=0;for(let Q=0;Q<this._errorQueueSize;Q++)Y[Q]={r:0,g:0,b:0,a:0};yield*WG(K,q,(Q,N)=>{let V=X[Q+N*K],{r:M,g:H,b:G,a:O}=V;for(let B=0;B<this._errorQueueSize;B++){let S=this._weights[B],A=Y[(B+W)%this._errorQueueSize];M+=A.r*S,H+=A.g*S,G+=A.b*S,O+=A.a*S}let L=b6.createByRGBA(r6(M),r6(H),r6(G),r6(O)),E=J.getNearestColor(this._distance,L);W=(W+1)%this._errorQueueSize;let j=(W+this._errorQueueSize-1)%this._errorQueueSize;Y[j].r=V.r-E.r,Y[j].g=V.g-E.g,Y[j].b=V.b-E.b,Y[j].a=V.a-E.a,V.from(E)}),yield{pointContainer:$,progress:100}}static _createWeights($,J){let X=[],K=Math.exp(Math.log(J)/(J-1));for(let q=0,Y=1;q<J;q++)X[q]=(Y+0.5|0)/J*$,Y*=K;return X}},TK={};F8(TK,{ssim:()=>VG});var QG=0.01,NG=0.03;function VG($,J){if($.getHeight()!==J.getHeight()||$.getWidth()!==J.getWidth())throw Error("Images have different sizes!");let K=255,q=(QG*K)**2,Y=(NG*K)**2,W=0,Q=0;return MG($,J,(N,V,M,H)=>{let G=0,O=0,L=0;for(let A=0;A<N.length;A++)O+=(N[A]-M)**2,L+=(V[A]-H)**2,G+=(N[A]-M)*(V[A]-H);let E=N.length-1;O/=E,L/=E,G/=E;let j=(2*M*H+q)*(2*G+Y),B=(M**2+H**2+q)*(O+L+Y),S=j/B;Q+=S,W++}),Q/W}function MG($,J,X){let q=$.getWidth(),Y=$.getHeight();for(let W=0;W<Y;W+=8)for(let Q=0;Q<q;Q+=8){let N=Math.min(8,q-Q),V=Math.min(8,Y-W),M=rX($,Q,W,N,V),H=rX(J,Q,W,N,V),G=iX(M),O=iX(H);X(M,H,G,O)}}function rX($,J,X,K,q){let Y=$.getPointArray(),W=[],Q=0;for(let N=X;N<X+q;N++){let V=N*$.getWidth();for(let M=J;M<J+K;M++){let H=Y[V+M];W[Q]=H.r*0.2126+H.g*0.7152+H.b*0.0722,Q++}}return W}function iX($){let J=0;for(let X of $)J+=X;return J/$.length}var Y$=typeof setImmediate==="function"?setImmediate:typeof process<"u"&&typeof(process==null?void 0:process.nextTick)==="function"?($)=>process.nextTick($):($)=>setTimeout($,0);function HG($,{colorDistanceFormula:J,paletteQuantization:X,colors:K}={}){let q=M$(J),Y=_K(q,X,K);return $.forEach((W)=>Y.sample(W)),Y.quantizeSync()}async function GG($,{colorDistanceFormula:J,paletteQuantization:X,colors:K,onProgress:q}={}){return new Promise((Y,W)=>{let Q=M$(J),N=_K(Q,X,K);$.forEach((G)=>N.sample(G));let V,M=N.quantize(),H=()=>{try{let G=M.next();if(G.done)Y(V);else{if(G.value.palette)V=G.value.palette;if(q)q(G.value.progress);Y$(H)}}catch(G){W(G)}};Y$(H)})}function OG($,J,{colorDistanceFormula:X,imageQuantization:K}={}){let q=M$(X);return IK(q,K).quantizeSync($,J)}async function UG($,J,{colorDistanceFormula:X,imageQuantization:K,onProgress:q}={}){return new Promise((Y,W)=>{let Q=M$(X),N=IK(Q,K),V,M=N.quantize($,J),H=()=>{try{let G=M.next();if(G.done)Y(V);else{if(G.value.pointContainer)V=G.value.pointContainer;if(q)q(G.value.progress);Y$(H)}}catch(G){W(G)}};Y$(H)})}function M$($="euclidean-bt709"){switch($){case"cie94-graphic-arts":return new OK;case"cie94-textiles":return new GK;case"ciede2000":return new Q8;case"color-metric":return new UK;case"euclidean":return new LK;case"euclidean-bt709":return new jK;case"euclidean-bt709-noalpha":return new EK;case"manhattan":return new RK;case"manhattan-bt709":return new PK;case"manhattan-nommyde":return new BK;case"pngquant":return new SK;default:throw Error(`Unknown colorDistanceFormula ${$}`)}}function IK($,J="floyd-steinberg"){switch(J){case"nearest":return new kK($);case"riemersma":return new d7($);case"floyd-steinberg":return new A8($,0);case"false-floyd-steinberg":return new A8($,1);case"stucki":return new A8($,2);case"atkinson":return new A8($,3);case"jarvis":return new A8($,4);case"burkes":return new A8($,5);case"sierra":return new A8($,6);case"two-sierra":return new A8($,7);case"sierra-lite":return new A8($,8);default:throw Error(`Unknown imageQuantization ${J}`)}}function _K($,J="wuquant",X=256){switch(J){case"neuquant":return new q6($,X);case"rgbquant":return new ZK($,X);case"wuquant":return new J5($,X);case"neuquant-float":return new Y6($,X);default:throw Error(`Unknown paletteQuantization ${J}`)}}yK.exports=oH(sX)});var H$=L0((LG)=>{var hK=K$(),{GifError:gA}=J9();class K1 extends hK{constructor(...$){super(...$);if($[0]instanceof K1){let J=$[0];this.xOffset=J.xOffset,this.yOffset=J.yOffset,this.disposalMethod=J.disposalMethod,this.delayCentisecs=J.delayCentisecs,this.interlaced=J.interlaced}else{let J=$[$.length-1],X={};if(typeof J==="object"&&!(J instanceof hK))X=J;this.xOffset=X.xOffset||0,this.yOffset=X.yOffset||0,this.disposalMethod=X.disposalMethod!==void 0?X.disposalMethod:K1.DisposeToBackgroundColor,this.delayCentisecs=X.delayCentisecs||8,this.interlaced=X.interlaced||!1}}getPalette(){let $=new Set,J=this.bitmap.data,X=0,K=!1;while(X<J.length){if(J[X+3]===0)K=!0;else{let Q=J.readUInt32BE(X,!0)>>8&16777215;$.add(Q)}X+=4}let q=Array($.size),Y=$.values();for(X=0;X<q.length;++X)q[X]=Y.next().value;q.sort((Q,N)=>Q-N);let W=q.length;if(K)++W;return{colors:q,usesTransparency:K,indexCount:W}}}K1.DisposeToAnything=0;K1.DisposeNothing=1;K1.DisposeToBackgroundColor=2;K1.DisposeToPrevious=3;LG.GifFrame=K1});var o7=L0((zG)=>{var gK=O6("fs"),X5=xK(),EG=K$(),{GifFrame:RG}=H$(),{GifError:BG}=J9(),{GifCodec:PG}=r7(),SG=[".jpg",".jpeg",".png",".bmp"],fK=new PG;zG.cloneFrames=function($){let J=[];return $.forEach((X)=>{J.push(new RG(X))}),J};zG.getColorInfo=function($,J){let X=!1,K=[];for(let N=0;N<$.length;++N){let V=$[N].getPalette();if(V.usesTransparency)X=!0;if(V.indexCount>256)throw new BG(`Frame ${N} uses more than 256 color indexes`);K.push(V)}if(J===0)return{usesTransparency:X,palettes:K};let q=new Set;K.forEach((N)=>{N.colors.forEach((V)=>{q.add(V)})});let Y=q.size;if(X)++Y;if(J&&Y>J)return{usesTransparency:X,palettes:K};let W=Array(q.size),Q=q.values();for(let N=0;N<W.length;++N)W[N]=Q.next().value;return W.sort((N,V)=>N-V),{colors:W,indexCount:Y,usesTransparency:X,palettes:K}};zG.copyAsJimp=function($,J){return zG.shareAsJimp($,new EG(J))};zG.getMaxDimensions=function($){let J=0,X=0;return $.forEach((K)=>{let q=K.xOffset+K.bitmap.width;if(q>J)J=q;let Y=K.yOffset+K.bitmap.height;if(Y>X)X=Y}),{maxWidth:J,maxHeight:X}};zG.quantizeDekker=function($,J,X){J=J||256,n7($,"NeuQuantFloat",J,0,X)};zG.quantizeSorokin=function($,J,X,K){J=J||256,X=X||"min-pop";let q;switch(X){case"min-pop":q=2;break;case"top-pop":q=1;break;default:throw Error(`Invalid quantizeSorokin histogram '${X}'`)}n7($,"RGBQuant",J,q,K)};zG.quantizeWu=function($,J,X,K){if(J=J||256,X=X||5,X<1||X>8)throw Error("Invalid quantization quality");n7($,"WuQuant",J,X,K)};zG.read=function($,J){if(J=J||fK,Buffer.isBuffer($))return J.decodeGif($);return AG($).then((X)=>{return J.decodeGif(X)})};zG.shareAsJimp=function($,J){let X=new $(J.bitmap.width,J.bitmap.height,0);return X.bitmap.data=J.bitmap.data,X};zG.write=function($,J,X,K){K=K||fK;let q=$.match(/\.[a-zA-Z]+$/);if(q!==null&&SG.includes(q[0].toLowerCase()))throw Error(`GIF '${$}' has an unexpected suffix`);return K.encodeGif(J,X).then((Y)=>{return FG($,Y.buffer).then(()=>{return Y})})};function n7($,J,X,K,q){let Y=Array.isArray($)?$:[$],W=["FloydSteinberg","FalseFloydSteinberg","Stucki","Atkinson","Jarvis","Burkes","Sierra","TwoSierra","SierraLite"];if(q){if(W.indexOf(q.ditherAlgorithm)<0)throw Error(`Invalid ditherAlgorithm '${q.ditherAlgorithm}'`);if(q.serpentine===void 0)q.serpentine=!0;if(q.minimumColorDistanceToDither===void 0)q.minimumColorDistanceToDither=0;if(q.calculateErrorLikeGIMP===void 0)q.calculateErrorLikeGIMP=!1}let Q=new X5.distance.Euclidean,N=new X5.palette[J](Q,X,K),V;if(q)V=new X5.image.ErrorDiffusionArray(Q,X5.image.ErrorDiffusionArrayKernel[q.ditherAlgorithm],q.serpentine,q.minimumColorDistanceToDither,q.calculateErrorLikeGIMP);else V=new X5.image.NearestColor(Q);let M=[];Y.forEach((G)=>{let O=G.bitmap.data,L=new ArrayBuffer(O.length),E=new Uint32Array(L);for(let B=0,S=0;B<O.length;B+=4,++S)E[S]=O.readUInt32LE(B,!0);let j=X5.utils.PointContainer.fromUint32Array(E,G.bitmap.width,G.bitmap.height);N.sample(j),M.push(j)});let H=N.quantizeSync();for(let G=0;G<Y.length;++G){let O=Y[G].bitmap.data,E=V.quantizeSync(M[G],H).toUint32Array();for(let j=0,B=0;j<O.length;j+=4,++B)O.writeUInt32LE(E[B],j)}}function AG($){return new Promise((J,X)=>{gK.readFile($,(K,q)=>{if(K)return X(K);return J(q)})})}function FG($,J){return new Promise((X,K)=>{gK.writeFile($,J,(q)=>{if(q)return K(q);return X()})})}});var r7=L0((uG)=>{var i7=f7(),{Gif:q1,GifError:l8}=J9();function G$(){let $=o7();return G$=function(){return $},$}var{GifFrame:xG}=H$(),bK=200,hG=100;class uK{constructor($={}){if(this._transparentRGB=null,typeof $.transparentRGB==="number"&&$.transparentRGB!==0)this._transparentRGBA=$.transparentRGB*256;this._testInitialBufferSize=0}decodeGif($){try{let J;try{J=new i7.GifReader($)}catch(Y){throw new l8(Y)}let X=J.numFrames(),K=[],q={width:J.width,height:J.height,loops:J.loopCount()};q.usesTransparency=!1;for(let Y=0;Y<X;++Y){let W=this._decodeFrame(J,Y,q.usesTransparency);if(K.push(W.frame),W.usesTransparency)q.usesTransparency=!0}return Promise.resolve(new q1($,K,q))}catch(J){return Promise.reject(J)}}encodeGif($,J={}){try{if($===null||$.length===0)throw new l8("there are no frames");let X=G$().getMaxDimensions($);if(J=Object.assign({},J),J.width=X.maxWidth,J.height=X.maxHeight,J.loops===void 0)J.loops=0;return J.colorScope=J.colorScope||q1.GlobalColorsPreferred,Promise.resolve(this._encodeGif($,J))}catch(X){return Promise.reject(X)}}_decodeFrame($,J,X){let K,q;try{if(K=$.frameInfo(J),q=new Buffer($.width*$.height*4),$.decodeAndBlitFrameRGBA(J,q),K.width!==$.width||K.height!==$.height){if(K.y)q=q.slice(K.y*$.width*4);if($.width>K.width)for(let Q=0;Q<K.height;++Q)q.copy(q,Q*K.width*4,(K.x+Q*$.width)*4,(K.x+Q*$.width)*4+K.width*4);q=q.slice(0,K.width*K.height*4)}}catch(Q){throw new l8(Q)}let Y=!1;if(this._transparentRGBA===null){if(!X){for(let Q=3;Q<q.length;Q+=4)if(q[Q]===0)Y=!0,Q=q.length}}else for(let Q=3;Q<q.length;Q+=4)if(q[Q]===0)q.writeUInt32BE(this._transparentRGBA,Q-3),Y=!0;return{frame:new xG(K.width,K.height,q,{xOffset:K.x,yOffset:K.y,disposalMethod:K.disposal,interlaced:K.interlaced,delayCentisecs:K.delay}),usesTransparency:Y}}_encodeGif($,J){let X;if(J.colorScope===q1.LocalColorsOnly)X=G$().getColorInfo($,0);else if(X=G$().getColorInfo($,256),!X.colors){if(J.colorScope===q1.GlobalColorsOnly)throw new l8("Too many color indexes for global color table");J.colorScope=q1.LocalColorsOnly}J.usesTransparency=X.usesTransparency;let K=X.palettes;if(J.colorScope===q1.LocalColorsOnly)return mG($,J,2000,K);return bG($,J,2000,X)}_getSizeEstimateGlobal($,J){if(this._testInitialBufferSize>0)return this._testInitialBufferSize;let X=bK+768,K=pK($);return J.forEach((q)=>{X+=mK(q,K)}),X}_getSizeEstimateLocal($,J){if(this._testInitialBufferSize>0)return this._testInitialBufferSize;let X=bK;for(let K=0;K<J.length;++K){let q=$[K],Y=pK(q);X+=mK(J[K],Y)}return X}}uG.GifCodec=uK;function gG($,J){let X=$.indexOf(J);return X===-1?null:X}function fG($,J){var X=0,K=$.length-1,q;while(X<=K)if(q=Math.floor((X+K)/2),$[q]>J)K=q-1;else if($[q]<J)X=q+1;else return q;return null}function bG($,J,X,K){let q={colors:K.colors.slice(),usesTransparency:K.usesTransparency};lK(q);let Y={palette:q.colors,loop:J.loops},W=new Buffer(X),Q;try{Q=new i7.GifWriter(W,J.width,J.height,Y)}catch(N){throw new l8(N)}for(let N=0;N<$.length;++N)W=cK(Q,N,$[N],K,!1);return new q1(W.slice(0,Q.end()),$,J)}function mG($,J,X,K){let q={loop:J.loops},Y=new Buffer(X),W;try{W=new i7.GifWriter(Y,J.width,J.height,q)}catch(Q){throw new l8(Q)}for(let Q=0;Q<$.length;++Q)Y=cK(W,Q,$[Q],K[Q],!0);return new q1(Y.slice(0,W.end()),$,J)}function lK($){let J=$.colors;if($.usesTransparency)J.push(0);let X=J.length,K=2;while(X>K)K<<=1;J.length=K,J.fill(0,X)}function mK($,J){let X=$.bitmap.width*$.bitmap.height;return X=Math.ceil(X*J/8),X+=Math.ceil(X/255),hG+X+768}function pG($,J,X){let K=X.colors,q=K.length<=8?gG:fG,Y=J.bitmap.data,W=new Buffer(Y.length/4),Q=K.length,N=0,V=0;while(N<Y.length){if(Y[N+3]!==0){let M=Y.readUInt32BE(N,!0)>>8&16777215;W[V]=q(K,M)}else W[V]=Q;N+=4,++V}if(X.usesTransparency){if(Q===256)throw new l8(`Frame ${$} already has 256 colorsand so can't use transparency`)}else Q=null;return{buffer:W,transparentIndex:Q}}function pK($){let J=$.indexCount,X=0;--J;while(J)++X,J>>=1;return X>0?X:1}function cK($,J,X,K,q){if(X.interlaced)throw new l8("writing interlaced GIFs is not supported");let Y=pG(J,X,K),W={delay:X.delayCentisecs,disposal:X.disposalMethod,transparent:Y.transparentIndex};if(q)lK(K),W.palette=K.colors;try{let Q=$.getOutputBuffer(),N=$.getOutputBufferPosition(),V,M=!0;while(M)if(V=$.addFrame(X.xOffset,X.yOffset,X.bitmap.width,X.bitmap.height,Y.buffer,W),M=!1,V>=Q.length-1){let H=new Buffer(Q.length*1.5);Q.copy(H),$.setOutputBuffer(H),$.setOutputBufferPosition(N),Q=H,M=!0}return Q}catch(Q){throw new l8(Q)}}});var nK=L0((pA,dK)=>{var cG=K$(),{Gif:dG,GifError:nG}=J9(),{GifCodec:oG}=r7(),{GifFrame:rG}=H$(),iG=o7();dK.exports={BitmapImage:cG,Gif:dG,GifCodec:oG,GifFrame:rG,GifUtil:iG,GifError:nG}});var sK=L0((lA,U$)=>{var iK=iK||function($){return Buffer.from($).toString("base64")};function sG($){var J=this,X=Math.round,K=Math.floor,q=Array(64),Y=Array(64),W=Array(64),Q=Array(64),N,V,M,H,G=Array(65535),O=Array(65535),L=Array(64),E=Array(64),j=[],B=0,S=7,A=Array(64),z=Array(64),P=Array(64),R=Array(256),U=Array(2048),Z,w=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],h=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],F=[0,1,2,3,4,5,6,7,8,9,10,11],C=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],D=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],x=[0,1,2,3,4,5,6,7,8,9,10,11],y=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],b=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function _(u){var M0=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99];for(var q0=0;q0<64;q0++){var H0=K((M0[q0]*u+50)/100);if(H0<1)H0=1;else if(H0>255)H0=255;q[w[q0]]=H0}var O0=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99];for(var E0=0;E0<64;E0++){var F0=K((O0[E0]*u+50)/100);if(F0<1)F0=1;else if(F0>255)F0=255;Y[w[E0]]=F0}var C0=[1,1.387039845,1.306562965,1.175875602,1,0.785694958,0.5411961,0.275899379],A0=0;for(var T0=0;T0<8;T0++)for(var Y0=0;Y0<8;Y0++)W[A0]=1/(q[w[A0]]*C0[T0]*C0[Y0]*8),Q[A0]=1/(Y[w[A0]]*C0[T0]*C0[Y0]*8),A0++}function m(u,M0){var q0=0,H0=0,O0=[];for(var E0=1;E0<=16;E0++){for(var F0=1;F0<=u[E0];F0++)O0[M0[H0]]=[],O0[M0[H0]][0]=q0,O0[M0[H0]][1]=E0,H0++,q0++;q0*=2}return O0}function t(){N=m(h,F),V=m(T,x),M=m(C,D),H=m(y,b)}function l(){var u=1,M0=2;for(var q0=1;q0<=15;q0++){for(var H0=u;H0<M0;H0++)O[32767+H0]=q0,G[32767+H0]=[],G[32767+H0][1]=q0,G[32767+H0][0]=H0;for(var O0=-(M0-1);O0<=-u;O0++)O[32767+O0]=q0,G[32767+O0]=[],G[32767+O0][1]=q0,G[32767+O0][0]=M0-1+O0;u<<=1,M0<<=1}}function s(){for(var u=0;u<256;u++)U[u]=19595*u,U[u+256>>0]=38470*u,U[u+512>>0]=7471*u+32768,U[u+768>>0]=-11059*u,U[u+1024>>0]=-21709*u,U[u+1280>>0]=32768*u+8421375,U[u+1536>>0]=-27439*u,U[u+1792>>0]=-5329*u}function g(u){var M0=u[0],q0=u[1]-1;while(q0>=0){if(M0&1<<q0)B|=1<<S;if(q0--,S--,S<0){if(B==255)v(255),v(0);else v(B);S=7,B=0}}}function v(u){j.push(u)}function I(u){v(u>>8&255),v(u&255)}function c(u,M0){var q0,H0,O0,E0,F0,C0,A0,T0,Y0=0,J0,V0=8,g0=64;for(J0=0;J0<V0;++J0){q0=u[Y0],H0=u[Y0+1],O0=u[Y0+2],E0=u[Y0+3],F0=u[Y0+4],C0=u[Y0+5],A0=u[Y0+6],T0=u[Y0+7];var z0=q0+T0,I0=q0-T0,d0=H0+A0,Q0=H0-A0,R0=O0+C0,v0=O0-C0,_0=E0+F0,f0=E0-F0,s0=z0+_0,y0=z0-_0,i0=d0+R0,t0=d0-R0;u[Y0]=s0+i0,u[Y0+4]=s0-i0;var z6=(t0+y0)*0.707106781;u[Y0+2]=y0+z6,u[Y0+6]=y0-z6,s0=f0+v0,i0=v0+Q0,t0=Q0+I0;var j6=(s0-t0)*0.382683433,T6=0.5411961*s0+j6,X8=1.306562965*t0+j6,R8=i0*0.707106781,x8=I0+R8,B8=I0-R8;u[Y0+5]=B8+T6,u[Y0+3]=B8-T6,u[Y0+1]=x8+X8,u[Y0+7]=x8-X8,Y0+=8}Y0=0;for(J0=0;J0<V0;++J0){q0=u[Y0],H0=u[Y0+8],O0=u[Y0+16],E0=u[Y0+24],F0=u[Y0+32],C0=u[Y0+40],A0=u[Y0+48],T0=u[Y0+56];var c5=q0+T0,d5=q0-T0,l9=H0+A0,c9=H0-A0,d9=O0+C0,K8=O0-C0,F1=E0+F0,H7=E0-F0,z1=c5+F1,o1=c5-F1,C1=l9+d9,Z1=l9-d9;u[Y0]=z1+C1,u[Y0+32]=z1-C1;var n5=(Z1+o1)*0.707106781;u[Y0+16]=o1+n5,u[Y0+48]=o1-n5,z1=H7+K8,C1=K8+c9,Z1=c9+d5;var o5=(z1-Z1)*0.382683433,u4=0.5411961*z1+o5,l4=1.306562965*Z1+o5,c4=C1*0.707106781,d4=d5+c4,n4=d5-c4;u[Y0+40]=n4+u4,u[Y0+24]=n4-u4,u[Y0+8]=d4+l4,u[Y0+56]=d4-l4,Y0++}var n9;for(J0=0;J0<g0;++J0)n9=u[J0]*M0[J0],L[J0]=n9>0?n9+0.5|0:n9-0.5|0;return L}function o(){I(65504),I(16),v(74),v(70),v(73),v(70),v(0),v(1),v(1),v(0),I(1),I(1),v(0),v(0)}function $0(u){if(!u)return;if(I(65505),u[0]===69&&u[1]===120&&u[2]===105&&u[3]===102)I(u.length+2);else I(u.length+5+2),v(69),v(120),v(105),v(102),v(0);for(var M0=0;M0<u.length;M0++)v(u[M0])}function a(u,M0){I(65472),I(17),v(8),I(M0),I(u),v(3),v(1),v(17),v(0),v(2),v(17),v(1),v(3),v(17),v(1)}function e(){I(65499),I(132),v(0);for(var u=0;u<64;u++)v(q[u]);v(1);for(var M0=0;M0<64;M0++)v(Y[M0])}function r(){I(65476),I(418),v(0);for(var u=0;u<16;u++)v(h[u+1]);for(var M0=0;M0<=11;M0++)v(F[M0]);v(16);for(var q0=0;q0<16;q0++)v(C[q0+1]);for(var H0=0;H0<=161;H0++)v(D[H0]);v(1);for(var O0=0;O0<16;O0++)v(T[O0+1]);for(var E0=0;E0<=11;E0++)v(x[E0]);v(17);for(var F0=0;F0<16;F0++)v(y[F0+1]);for(var C0=0;C0<=161;C0++)v(b[C0])}function p(u){if(typeof u>"u"||u.constructor!==Array)return;u.forEach((M0)=>{if(typeof M0!=="string")return;I(65534);var q0=M0.length;I(q0+2);var H0;for(H0=0;H0<q0;H0++)v(M0.charCodeAt(H0))})}function i(){I(65498),I(12),v(3),v(1),v(0),v(2),v(17),v(3),v(17),v(0),v(63),v(0)}function X0(u,M0,q0,H0,O0){var E0=O0[0],F0=O0[240],C0,A0=16,T0=63,Y0=64,J0=c(u,M0);for(var V0=0;V0<Y0;++V0)E[w[V0]]=J0[V0];var g0=E[0]-q0;if(q0=E[0],g0==0)g(H0[0]);else C0=32767+g0,g(H0[O[C0]]),g(G[C0]);var z0=63;for(;z0>0&&E[z0]==0;z0--);if(z0==0)return g(E0),q0;var I0=1,d0;while(I0<=z0){var Q0=I0;for(;E[I0]==0&&I0<=z0;++I0);var R0=I0-Q0;if(R0>=A0){d0=R0>>4;for(var v0=1;v0<=d0;++v0)g(F0);R0=R0&15}C0=32767+E[I0],g(O0[(R0<<4)+O[C0]]),g(G[C0]),I0++}if(z0!=T0)g(E0);return q0}function K0(){var u=String.fromCharCode;for(var M0=0;M0<256;M0++)R[M0]=u(M0)}this.encode=function(u,M0){var q0=new Date().getTime();if(M0)U0(M0);j=[],B=0,S=7,I(65496),o(),p(u.comments),$0(u.exifBuffer),e(),a(u.width,u.height),r(),i();var H0=0,O0=0,E0=0;B=0,S=7,this.encode.displayName="_encode_";var{data:F0,width:C0,height:A0}=u,T0=C0*4,Y0=C0*3,J0,V0=0,g0,z0,I0,d0,Q0,R0,v0,_0;while(V0<A0){J0=0;while(J0<T0){d0=T0*V0+J0,Q0=d0,R0=-1,v0=0;for(_0=0;_0<64;_0++){if(v0=_0>>3,R0=(_0&7)*4,Q0=d0+v0*T0+R0,V0+v0>=A0)Q0-=T0*(V0+1+v0-A0);if(J0+R0>=T0)Q0-=J0+R0-T0+4;g0=F0[Q0++],z0=F0[Q0++],I0=F0[Q0++],A[_0]=(U[g0]+U[z0+256>>0]+U[I0+512>>0]>>16)-128,z[_0]=(U[g0+768>>0]+U[z0+1024>>0]+U[I0+1280>>0]>>16)-128,P[_0]=(U[g0+1280>>0]+U[z0+1536>>0]+U[I0+1792>>0]>>16)-128}H0=X0(A,W,H0,N,M),O0=X0(z,Q,O0,V,H),E0=X0(P,Q,E0,V,H),J0+=32}V0+=8}if(S>=0){var f0=[];f0[1]=S+1,f0[0]=(1<<S+1)-1,g(f0)}if(I(65497),typeof U$>"u")return new Uint8Array(j);return Buffer.from(j);var s0,y0};function U0(u){if(u<=0)u=1;if(u>100)u=100;if(Z==u)return;var M0=0;if(u<50)M0=Math.floor(5000/u);else M0=Math.floor(200-u*2);_(M0),Z=u}function S0(){var u=new Date().getTime();if(!$)$=50;K0(),t(),l(),s(),U0($);var M0=new Date().getTime()-u}S0()}if(typeof U$<"u")U$.exports=rK;else if(typeof window<"u")window["jpeg-js"]=window["jpeg-js"]||{},window["jpeg-js"].encode=rK;function rK($,J){if(typeof J>"u")J=50;var X=new sG(J),K=X.encode($,J);return{data:K,width:$.width,height:$.height}}});var tK=L0((cA,a7)=>{var s7=function(){var J=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),X=4017,K=799,q=3406,Y=2276,W=1567,Q=3784,N=5793,V=2896;function M(){}function H(S,A){var z=0,P=[],R,U,Z=16;while(Z>0&&!S[Z-1])Z--;P.push({children:[],index:0});var w=P[0],h;for(R=0;R<Z;R++){for(U=0;U<S[R];U++){w=P.pop(),w.children[w.index]=A[z];while(w.index>0){if(P.length===0)throw Error("Could not recreate Huffman Table");w=P.pop()}w.index++,P.push(w);while(P.length<=R)P.push(h={children:[],index:0}),w.children[w.index]=h.children,w=h;z++}if(R+1<Z)P.push(h={children:[],index:0}),w.children[w.index]=h.children,w=h}return P[0].children}function G(S,A,z,P,R,U,Z,w,h,F){var{precision:C,samplesPerLine:D,scanLines:T,mcusPerLine:x,progressive:y,maxH:b,maxV:_}=z,m=A,t=0,l=0;function s(){if(l>0)return l--,t>>l&1;if(t=S[A++],t==255){var Y0=S[A++];if(Y0)throw Error("unexpected marker: "+(t<<8|Y0).toString(16))}return l=7,t>>>7}function g(Y0){var J0=Y0,V0;while((V0=s())!==null){if(J0=J0[V0],typeof J0==="number")return J0;if(typeof J0!=="object")throw Error("invalid huffman sequence")}return null}function v(Y0){var J0=0;while(Y0>0){var V0=s();if(V0===null)return;J0=J0<<1|V0,Y0--}return J0}function I(Y0){var J0=v(Y0);if(J0>=1<<Y0-1)return J0;return J0+(-1<<Y0)+1}function c(Y0,J0){var V0=g(Y0.huffmanTableDC),g0=V0===0?0:I(V0);J0[0]=Y0.pred+=g0;var z0=1;while(z0<64){var I0=g(Y0.huffmanTableAC),d0=I0&15,Q0=I0>>4;if(d0===0){if(Q0<15)break;z0+=16;continue}z0+=Q0;var R0=J[z0];J0[R0]=I(d0),z0++}}function o(Y0,J0){var V0=g(Y0.huffmanTableDC),g0=V0===0?0:I(V0)<<h;J0[0]=Y0.pred+=g0}function $0(Y0,J0){J0[0]|=s()<<h}var a=0;function e(Y0,J0){if(a>0){a--;return}var V0=U,g0=Z;while(V0<=g0){var z0=g(Y0.huffmanTableAC),I0=z0&15,d0=z0>>4;if(I0===0){if(d0<15){a=v(d0)+(1<<d0)-1;break}V0+=16;continue}V0+=d0;var Q0=J[V0];J0[Q0]=I(I0)*(1<<h),V0++}}var r=0,p;function i(Y0,J0){var V0=U,g0=Z,z0=0;while(V0<=g0){var I0=J[V0],d0=J0[I0]<0?-1:1;switch(r){case 0:var Q0=g(Y0.huffmanTableAC),R0=Q0&15,z0=Q0>>4;if(R0===0)if(z0<15)a=v(z0)+(1<<z0),r=4;else z0=16,r=1;else{if(R0!==1)throw Error("invalid ACn encoding");p=I(R0),r=z0?2:3}continue;case 1:case 2:if(J0[I0])J0[I0]+=(s()<<h)*d0;else if(z0--,z0===0)r=r==2?3:0;break;case 3:if(J0[I0])J0[I0]+=(s()<<h)*d0;else J0[I0]=p<<h,r=0;break;case 4:if(J0[I0])J0[I0]+=(s()<<h)*d0;break}V0++}if(r===4){if(a--,a===0)r=0}}function X0(Y0,J0,V0,g0,z0){var I0=V0/x|0,d0=V0%x,Q0=I0*Y0.v+g0,R0=d0*Y0.h+z0;if(Y0.blocks[Q0]===void 0&&F.tolerantDecoding)return;J0(Y0,Y0.blocks[Q0][R0])}function K0(Y0,J0,V0){var g0=V0/Y0.blocksPerLine|0,z0=V0%Y0.blocksPerLine;if(Y0.blocks[g0]===void 0&&F.tolerantDecoding)return;J0(Y0,Y0.blocks[g0][z0])}var U0=P.length,S0,u,M0,q0,H0,O0;if(y)if(U===0)O0=w===0?o:$0;else O0=w===0?e:i;else O0=c;var E0=0,F0,C0;if(U0==1)C0=P[0].blocksPerLine*P[0].blocksPerColumn;else C0=x*z.mcusPerColumn;if(!R)R=C0;var A0,T0;while(E0<C0){for(u=0;u<U0;u++)P[u].pred=0;if(a=0,U0==1){S0=P[0];for(H0=0;H0<R;H0++)K0(S0,O0,E0),E0++}else for(H0=0;H0<R;H0++){for(u=0;u<U0;u++){S0=P[u],A0=S0.h,T0=S0.v;for(M0=0;M0<T0;M0++)for(q0=0;q0<A0;q0++)X0(S0,O0,E0,M0,q0)}if(E0++,E0===C0)break}if(E0===C0)do{if(S[A]===255){if(S[A+1]!==0)break}A+=1}while(A<S.length-2);if(l=0,F0=S[A]<<8|S[A+1],F0<65280)throw Error("marker was not found");if(F0>=65488&&F0<=65495)A+=2;else break}return A-m}function O(S,A){var z=[],P=A.blocksPerLine,R=A.blocksPerColumn,U=P<<3,Z=new Int32Array(64),w=new Uint8Array(64);function h(m,t,l){var s=A.quantizationTable,g,v,I,c,o,$0,a,e,r,p=l,i;for(i=0;i<64;i++)p[i]=m[i]*s[i];for(i=0;i<8;++i){var X0=8*i;if(p[1+X0]==0&&p[2+X0]==0&&p[3+X0]==0&&p[4+X0]==0&&p[5+X0]==0&&p[6+X0]==0&&p[7+X0]==0){r=N*p[0+X0]+512>>10,p[0+X0]=r,p[1+X0]=r,p[2+X0]=r,p[3+X0]=r,p[4+X0]=r,p[5+X0]=r,p[6+X0]=r,p[7+X0]=r;continue}g=N*p[0+X0]+128>>8,v=N*p[4+X0]+128>>8,I=p[2+X0],c=p[6+X0],o=V*(p[1+X0]-p[7+X0])+128>>8,e=V*(p[1+X0]+p[7+X0])+128>>8,$0=p[3+X0]<<4,a=p[5+X0]<<4,r=g-v+1>>1,g=g+v+1>>1,v=r,r=I*Q+c*W+128>>8,I=I*W-c*Q+128>>8,c=r,r=o-a+1>>1,o=o+a+1>>1,a=r,r=e+$0+1>>1,$0=e-$0+1>>1,e=r,r=g-c+1>>1,g=g+c+1>>1,c=r,r=v-I+1>>1,v=v+I+1>>1,I=r,r=o*Y+e*q+2048>>12,o=o*q-e*Y+2048>>12,e=r,r=$0*K+a*X+2048>>12,$0=$0*X-a*K+2048>>12,a=r,p[0+X0]=g+e,p[7+X0]=g-e,p[1+X0]=v+a,p[6+X0]=v-a,p[2+X0]=I+$0,p[5+X0]=I-$0,p[3+X0]=c+o,p[4+X0]=c-o}for(i=0;i<8;++i){var K0=i;if(p[8+K0]==0&&p[16+K0]==0&&p[24+K0]==0&&p[32+K0]==0&&p[40+K0]==0&&p[48+K0]==0&&p[56+K0]==0){r=N*l[i+0]+8192>>14,p[0+K0]=r,p[8+K0]=r,p[16+K0]=r,p[24+K0]=r,p[32+K0]=r,p[40+K0]=r,p[48+K0]=r,p[56+K0]=r;continue}g=N*p[0+K0]+2048>>12,v=N*p[32+K0]+2048>>12,I=p[16+K0],c=p[48+K0],o=V*(p[8+K0]-p[56+K0])+2048>>12,e=V*(p[8+K0]+p[56+K0])+2048>>12,$0=p[24+K0],a=p[40+K0],r=g-v+1>>1,g=g+v+1>>1,v=r,r=I*Q+c*W+2048>>12,I=I*W-c*Q+2048>>12,c=r,r=o-a+1>>1,o=o+a+1>>1,a=r,r=e+$0+1>>1,$0=e-$0+1>>1,e=r,r=g-c+1>>1,g=g+c+1>>1,c=r,r=v-I+1>>1,v=v+I+1>>1,I=r,r=o*Y+e*q+2048>>12,o=o*q-e*Y+2048>>12,e=r,r=$0*K+a*X+2048>>12,$0=$0*X-a*K+2048>>12,a=r,p[0+K0]=g+e,p[56+K0]=g-e,p[8+K0]=v+a,p[48+K0]=v-a,p[16+K0]=I+$0,p[40+K0]=I-$0,p[24+K0]=c+o,p[32+K0]=c-o}for(i=0;i<64;++i){var U0=128+(p[i]+8>>4);t[i]=U0<0?0:U0>255?255:U0}}B(U*R*8);var F,C;for(var D=0;D<R;D++){var T=D<<3;for(F=0;F<8;F++)z.push(new Uint8Array(U));for(var x=0;x<P;x++){h(A.blocks[D][x],w,Z);var y=0,b=x<<3;for(C=0;C<8;C++){var _=z[T+C];for(F=0;F<8;F++)_[b+F]=w[y++]}}}return z}function L(S){return S<0?0:S>255?255:S}M.prototype={load:function(A){var z=new XMLHttpRequest;z.open("GET",A,!0),z.responseType="arraybuffer",z.onload=function(){var P=new Uint8Array(z.response||z.mozResponseArrayBuffer);if(this.parse(P),this.onload)this.onload()}.bind(this),z.send(null)},parse:function(A){var z=this.opts.maxResolutionInMP*1000*1000,P=0,R=A.length;function U(){var Q0=A[P]<<8|A[P+1];return P+=2,Q0}function Z(){var Q0=U(),R0=A.subarray(P,P+Q0-2);return P+=R0.length,R0}function w(Q0){var R0=1,v0=1,_0,f0;for(f0 in Q0.components)if(Q0.components.hasOwnProperty(f0)){if(_0=Q0.components[f0],R0<_0.h)R0=_0.h;if(v0<_0.v)v0=_0.v}var s0=Math.ceil(Q0.samplesPerLine/8/R0),y0=Math.ceil(Q0.scanLines/8/v0);for(f0 in Q0.components)if(Q0.components.hasOwnProperty(f0)){_0=Q0.components[f0];var i0=Math.ceil(Math.ceil(Q0.samplesPerLine/8)*_0.h/R0),t0=Math.ceil(Math.ceil(Q0.scanLines/8)*_0.v/v0),z6=s0*_0.h,j6=y0*_0.v,T6=j6*z6,X8=[];B(T6*256);for(var R8=0;R8<j6;R8++){var x8=[];for(var B8=0;B8<z6;B8++)x8.push(new Int32Array(64));X8.push(x8)}_0.blocksPerLine=i0,_0.blocksPerColumn=t0,_0.blocks=X8}Q0.maxH=R0,Q0.maxV=v0,Q0.mcusPerLine=s0,Q0.mcusPerColumn=y0}var h=null,F=null,C=null,D,T,x=[],y=[],b=[],_=[],m=U(),t=-1;if(this.comments=[],m!=65496)throw Error("SOI not found");m=U();while(m!=65497){var l,s,g;switch(m){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var v=Z();if(m===65534){var I=String.fromCharCode.apply(null,v);this.comments.push(I)}if(m===65504){if(v[0]===74&&v[1]===70&&v[2]===73&&v[3]===70&&v[4]===0)h={version:{major:v[5],minor:v[6]},densityUnits:v[7],xDensity:v[8]<<8|v[9],yDensity:v[10]<<8|v[11],thumbWidth:v[12],thumbHeight:v[13],thumbData:v.subarray(14,14+3*v[12]*v[13])}}if(m===65505){if(v[0]===69&&v[1]===120&&v[2]===105&&v[3]===102&&v[4]===0)this.exifBuffer=v.subarray(5,v.length)}if(m===65518){if(v[0]===65&&v[1]===100&&v[2]===111&&v[3]===98&&v[4]===101&&v[5]===0)F={version:v[6],flags0:v[7]<<8|v[8],flags1:v[9]<<8|v[10],transformCode:v[11]}}break;case 65499:var c=U(),o=c+P-2;while(P<o){var $0=A[P++];B(256);var a=new Int32Array(64);if($0>>4===0)for(s=0;s<64;s++){var e=J[s];a[e]=A[P++]}else if($0>>4===1)for(s=0;s<64;s++){var e=J[s];a[e]=U()}else throw Error("DQT: invalid table spec");x[$0&15]=a}break;case 65472:case 65473:case 65474:U(),D={},D.extended=m===65473,D.progressive=m===65474,D.precision=A[P++],D.scanLines=U(),D.samplesPerLine=U(),D.components={},D.componentsOrder=[];var r=D.scanLines*D.samplesPerLine;if(r>z){var p=Math.ceil((r-z)/1e6);throw Error(`maxResolutionInMP limit exceeded by ${p}MP`)}var i=A[P++],X0,K0=0,U0=0;for(l=0;l<i;l++){X0=A[P];var S0=A[P+1]>>4,u=A[P+1]&15,M0=A[P+2];if(S0<=0||u<=0)throw Error("Invalid sampling factor, expected values above 0");D.componentsOrder.push(X0),D.components[X0]={h:S0,v:u,quantizationIdx:M0},P+=3}w(D),y.push(D);break;case 65476:var q0=U();for(l=2;l<q0;){var H0=A[P++],O0=new Uint8Array(16),E0=0;for(s=0;s<16;s++,P++)E0+=O0[s]=A[P];B(16+E0);var F0=new Uint8Array(E0);for(s=0;s<E0;s++,P++)F0[s]=A[P];l+=17+E0,(H0>>4===0?_:b)[H0&15]=H(O0,F0)}break;case 65501:U(),T=U();break;case 65500:U(),U();break;case 65498:var C0=U(),A0=A[P++],T0=[],Y0;for(l=0;l<A0;l++){Y0=D.components[A[P++]];var J0=A[P++];Y0.huffmanTableDC=_[J0>>4],Y0.huffmanTableAC=b[J0&15],T0.push(Y0)}var V0=A[P++],g0=A[P++],z0=A[P++],I0=G(A,P,D,T0,T,V0,g0,z0>>4,z0&15,this.opts);P+=I0;break;case 65535:if(A[P]!==255)P--;break;default:if(A[P-3]==255&&A[P-2]>=192&&A[P-2]<=254){P-=3;break}else if(m===224||m==225){if(t!==-1)throw Error(`first unknown JPEG marker at offset ${t.toString(16)}, second unknown JPEG marker ${m.toString(16)} at offset ${(P-1).toString(16)}`);t=P-1;let Q0=U();if(A[P+Q0-2]===255){P+=Q0-2;break}}throw Error("unknown JPEG marker "+m.toString(16))}m=U()}if(y.length!=1)throw Error("only single frame JPEGs supported");for(var l=0;l<y.length;l++){var d0=y[l].components;for(var s in d0)d0[s].quantizationTable=x[d0[s].quantizationIdx],delete d0[s].quantizationIdx}this.width=D.samplesPerLine,this.height=D.scanLines,this.jfif=h,this.adobe=F,this.components=[];for(var l=0;l<D.componentsOrder.length;l++){var Y0=D.components[D.componentsOrder[l]];this.components.push({lines:O(D,Y0),scaleX:Y0.h/D.maxH,scaleY:Y0.v/D.maxV})}},getData:function(A,z){var P=this.width/A,R=this.height/z,U,Z,w,h,F,C,D,T,x,y,b=0,_,m,t,l,s,g,v,I,c,o,$0,a=A*z*this.components.length;B(a);var e=new Uint8Array(a);switch(this.components.length){case 1:U=this.components[0];for(y=0;y<z;y++){F=U.lines[0|y*U.scaleY*R];for(x=0;x<A;x++)_=F[0|x*U.scaleX*P],e[b++]=_}break;case 2:U=this.components[0],Z=this.components[1];for(y=0;y<z;y++){F=U.lines[0|y*U.scaleY*R],C=Z.lines[0|y*Z.scaleY*R];for(x=0;x<A;x++)_=F[0|x*U.scaleX*P],e[b++]=_,_=C[0|x*Z.scaleX*P],e[b++]=_}break;case 3:if($0=!0,this.adobe&&this.adobe.transformCode)$0=!0;else if(typeof this.opts.colorTransform<"u")$0=!!this.opts.colorTransform;U=this.components[0],Z=this.components[1],w=this.components[2];for(y=0;y<z;y++){F=U.lines[0|y*U.scaleY*R],C=Z.lines[0|y*Z.scaleY*R],D=w.lines[0|y*w.scaleY*R];for(x=0;x<A;x++){if(!$0)I=F[0|x*U.scaleX*P],c=C[0|x*Z.scaleX*P],o=D[0|x*w.scaleX*P];else _=F[0|x*U.scaleX*P],m=C[0|x*Z.scaleX*P],t=D[0|x*w.scaleX*P],I=L(_+1.402*(t-128)),c=L(_-0.3441363*(m-128)-0.71413636*(t-128)),o=L(_+1.772*(m-128));e[b++]=I,e[b++]=c,e[b++]=o}}break;case 4:if(!this.adobe)throw Error("Unsupported color mode (4 components)");if($0=!1,this.adobe&&this.adobe.transformCode)$0=!0;else if(typeof this.opts.colorTransform<"u")$0=!!this.opts.colorTransform;U=this.components[0],Z=this.components[1],w=this.components[2],h=this.components[3];for(y=0;y<z;y++){F=U.lines[0|y*U.scaleY*R],C=Z.lines[0|y*Z.scaleY*R],D=w.lines[0|y*w.scaleY*R],T=h.lines[0|y*h.scaleY*R];for(x=0;x<A;x++){if(!$0)s=F[0|x*U.scaleX*P],g=C[0|x*Z.scaleX*P],v=D[0|x*w.scaleX*P],l=T[0|x*h.scaleX*P];else _=F[0|x*U.scaleX*P],m=C[0|x*Z.scaleX*P],t=D[0|x*w.scaleX*P],l=T[0|x*h.scaleX*P],s=255-L(_+1.402*(t-128)),g=255-L(_-0.3441363*(m-128)-0.71413636*(t-128)),v=255-L(_+1.772*(m-128));e[b++]=255-s,e[b++]=255-g,e[b++]=255-v,e[b++]=255-l}}break;default:throw Error("Unsupported color mode")}return e},copyToImageData:function(A,z){var{width:P,height:R,data:U}=A,Z=this.getData(P,R),w=0,h=0,F,C,D,T,x,y,b,_,m;switch(this.components.length){case 1:for(C=0;C<R;C++)for(F=0;F<P;F++)if(D=Z[w++],U[h++]=D,U[h++]=D,U[h++]=D,z)U[h++]=255;break;case 3:for(C=0;C<R;C++)for(F=0;F<P;F++)if(b=Z[w++],_=Z[w++],m=Z[w++],U[h++]=b,U[h++]=_,U[h++]=m,z)U[h++]=255;break;case 4:for(C=0;C<R;C++)for(F=0;F<P;F++)if(x=Z[w++],y=Z[w++],D=Z[w++],T=Z[w++],b=255-L(x*(1-T/255)+T),_=255-L(y*(1-T/255)+T),m=255-L(D*(1-T/255)+T),U[h++]=b,U[h++]=_,U[h++]=m,z)U[h++]=255;break;default:throw Error("Unsupported color mode")}}};var E=0,j=0;function B(S=0){var A=E+S;if(A>j){var z=Math.ceil((A-j)/1024/1024);throw Error(`maxMemoryUsageInMB limit exceeded by at least ${z}MB`)}E=A}return M.resetMaxMemoryUsage=function(S){E=0,j=S},M.getBytesAllocated=function(){return E},M.requestMemoryAllocation=B,M}();if(typeof a7<"u")a7.exports=aK;else if(typeof window<"u")window["jpeg-js"]=window["jpeg-js"]||{},window["jpeg-js"].decode=aK;function aK($,J={}){var X={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512},K={...X,...J},q=new Uint8Array($),Y=new s7;Y.opts=K,s7.resetMaxMemoryUsage(K.maxMemoryUsageInMB*1024*1024),Y.parse(q);var W=K.formatAsRGBA?4:3,Q=Y.width*Y.height*W;try{s7.requestMemoryAllocation(Q);var N={width:Y.width,height:Y.height,exifBuffer:Y.exifBuffer,data:K.useTArray?new Uint8Array(Q):Buffer.alloc(Q)};if(Y.comments.length>0)N.comments=Y.comments}catch(V){if(V instanceof RangeError)throw Error("Could not allocate enough memory for the image. Required: "+Q);if(V instanceof ReferenceError){if(V.message==="Buffer is not defined")throw Error("Buffer is not globally defined in this environment. Consider setting useTArray to true")}throw V}return Y.copyToImageData(N,K.formatAsRGBA),N}});var $q=L0((dA,eK)=>{var aG=sK(),tG=tK();eK.exports={encode:aG,decode:tG}});var e7=L0((oA,Xq)=>{var eG=O6("util"),Jq=O6("stream"),N8=Xq.exports=function(){Jq.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};eG.inherits(N8,Jq);N8.prototype.read=function($,J){this._reads.push({length:Math.abs($),allowLess:$<0,func:J}),process.nextTick(function(){if(this._process(),this._paused&&this._reads&&this._reads.length>0)this._paused=!1,this.emit("drain")}.bind(this))};N8.prototype.write=function($,J){if(!this.writable)return this.emit("error",Error("Stream not writable")),!1;let X;if(Buffer.isBuffer($))X=$;else X=Buffer.from($,J||this._encoding);if(this._buffers.push(X),this._buffered+=X.length,this._process(),this._reads&&this._reads.length===0)this._paused=!0;return this.writable&&!this._paused};N8.prototype.end=function($,J){if($)this.write($,J);if(this.writable=!1,!this._buffers)return;if(this._buffers.length===0)this._end();else this._buffers.push(null),this._process()};N8.prototype.destroySoon=N8.prototype.end;N8.prototype._end=function(){if(this._reads.length>0)this.emit("error",Error("Unexpected end of input"));this.destroy()};N8.prototype.destroy=function(){if(!this._buffers)return;this.writable=!1,this._reads=null,this._buffers=null,this.emit("close")};N8.prototype._processReadAllowingLess=function($){this._reads.shift();let J=this._buffers[0];if(J.length>$.length)this._buffered-=$.length,this._buffers[0]=J.slice($.length),$.func.call(this,J.slice(0,$.length));else this._buffered-=J.length,this._buffers.shift(),$.func.call(this,J)};N8.prototype._processRead=function($){this._reads.shift();let J=0,X=0,K=Buffer.alloc($.length);while(J<$.length){let q=this._buffers[X++],Y=Math.min(q.length,$.length-J);if(q.copy(K,J,0,Y),J+=Y,Y!==q.length)this._buffers[--X]=q.slice(Y)}if(X>0)this._buffers.splice(0,X);this._buffered-=$.length,$.func.call(this,K)};N8.prototype._process=function(){try{while(this._buffered>0&&this._reads&&this._reads.length>0){let $=this._reads[0];if($.allowLess)this._processReadAllowingLess($);else if(this._buffered>=$.length)this._processRead($);else break}if(this._buffers&&!this.writable)this._end()}catch($){this.emit("error",$)}}});var $J=L0(($2)=>{var W1=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];$2.getImagePasses=function($,J){let X=[],K=$%8,q=J%8,Y=($-K)/8,W=(J-q)/8;for(let Q=0;Q<W1.length;Q++){let N=W1[Q],V=Y*N.x.length,M=W*N.y.length;for(let H=0;H<N.x.length;H++)if(N.x[H]<K)V++;else break;for(let H=0;H<N.y.length;H++)if(N.y[H]<q)M++;else break;if(V>0&&M>0)X.push({width:V,height:M,index:Q})}return X};$2.getInterlaceIterator=function($){return function(J,X,K){let q=J%W1[K].x.length,Y=(J-q)/W1[K].x.length*8+W1[K].x[q],W=X%W1[K].y.length,Q=(X-W)/W1[K].y.length*8+W1[K].y[W];return Y*4+Q*$*4}}});var JJ=L0((iA,Kq)=>{Kq.exports=function(J,X,K){let q=J+X-K,Y=Math.abs(q-J),W=Math.abs(q-X),Q=Math.abs(q-K);if(Y<=W&&Y<=Q)return J;if(W<=Q)return X;return K}});var XJ=L0((sA,Yq)=>{var K2=$J(),q2=JJ();function qq($,J,X){let K=$*J;if(X!==8)K=Math.ceil(K/(8/X));return K}var K5=Yq.exports=function($,J){let{width:X,height:K,interlace:q,bpp:Y,depth:W}=$;if(this.read=J.read,this.write=J.write,this.complete=J.complete,this._imageIndex=0,this._images=[],q){let Q=K2.getImagePasses(X,K);for(let N=0;N<Q.length;N++)this._images.push({byteWidth:qq(Q[N].width,Y,W),height:Q[N].height,lineIndex:0})}else this._images.push({byteWidth:qq(X,Y,W),height:K,lineIndex:0});if(W===8)this._xComparison=Y;else if(W===16)this._xComparison=Y*2;else this._xComparison=1};K5.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))};K5.prototype._unFilterType1=function($,J,X){let K=this._xComparison,q=K-1;for(let Y=0;Y<X;Y++){let W=$[1+Y],Q=Y>q?J[Y-K]:0;J[Y]=W+Q}};K5.prototype._unFilterType2=function($,J,X){let K=this._lastLine;for(let q=0;q<X;q++){let Y=$[1+q],W=K?K[q]:0;J[q]=Y+W}};K5.prototype._unFilterType3=function($,J,X){let K=this._xComparison,q=K-1,Y=this._lastLine;for(let W=0;W<X;W++){let Q=$[1+W],N=Y?Y[W]:0,V=W>q?J[W-K]:0,M=Math.floor((V+N)/2);J[W]=Q+M}};K5.prototype._unFilterType4=function($,J,X){let K=this._xComparison,q=K-1,Y=this._lastLine;for(let W=0;W<X;W++){let Q=$[1+W],N=Y?Y[W]:0,V=W>q?J[W-K]:0,M=W>q&&Y?Y[W-K]:0,H=q2(V,N,M);J[W]=Q+H}};K5.prototype._reverseFilterLine=function($){let J=$[0],X,K=this._images[this._imageIndex],q=K.byteWidth;if(J===0)X=$.slice(1,q+1);else switch(X=Buffer.alloc(q),J){case 1:this._unFilterType1($,X,q);break;case 2:this._unFilterType2($,X,q);break;case 3:this._unFilterType3($,X,q);break;case 4:this._unFilterType4($,X,q);break;default:throw Error("Unrecognised filter type - "+J)}if(this.write(X),K.lineIndex++,K.lineIndex>=K.height)this._lastLine=null,this._imageIndex++,K=this._images[this._imageIndex];else this._lastLine=X;if(K)this.read(K.byteWidth+1,this._reverseFilterLine.bind(this));else this._lastLine=null,this.complete()}});var Nq=L0((aA,Qq)=>{var Y2=O6("util"),Wq=e7(),W2=XJ(),Q2=Qq.exports=function($){Wq.call(this);let J=[],X=this;this._filter=new W2($,{read:this.read.bind(this),write:function(K){J.push(K)},complete:function(){X.emit("complete",Buffer.concat(J))}}),this._filter.start()};Y2.inherits(Q2,Wq)});var q5=L0((tA,Vq)=>{Vq.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}});var YJ=L0((eA,Mq)=>{var KJ=[];(function(){for(let $=0;$<256;$++){let J=$;for(let X=0;X<8;X++)if(J&1)J=3988292384^J>>>1;else J=J>>>1;KJ[$]=J}})();var qJ=Mq.exports=function(){this._crc=-1};qJ.prototype.write=function($){for(let J=0;J<$.length;J++)this._crc=KJ[(this._crc^$[J])&255]^this._crc>>>8;return!0};qJ.prototype.crc32=function(){return this._crc^-1};qJ.crc32=function($){let J=-1;for(let X=0;X<$.length;X++)J=KJ[(J^$[X])&255]^J>>>8;return J^-1}});var WJ=L0(($F,Hq)=>{var H6=q5(),N2=YJ(),U6=Hq.exports=function($,J){this._options=$,$.checkCRC=$.checkCRC!==!1,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[H6.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[H6.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[H6.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[H6.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[H6.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[H6.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=J.read,this.error=J.error,this.metadata=J.metadata,this.gamma=J.gamma,this.transColor=J.transColor,this.palette=J.palette,this.parsed=J.parsed,this.inflateData=J.inflateData,this.finished=J.finished,this.simpleTransparency=J.simpleTransparency,this.headersFinished=J.headersFinished||function(){}};U6.prototype.start=function(){this.read(H6.PNG_SIGNATURE.length,this._parseSignature.bind(this))};U6.prototype._parseSignature=function($){let J=H6.PNG_SIGNATURE;for(let X=0;X<J.length;X++)if($[X]!==J[X]){this.error(Error("Invalid file signature"));return}this.read(8,this._parseChunkBegin.bind(this))};U6.prototype._parseChunkBegin=function($){let J=$.readUInt32BE(0),X=$.readUInt32BE(4),K="";for(let Y=4;Y<8;Y++)K+=String.fromCharCode($[Y]);let q=Boolean($[4]&32);if(!this._hasIHDR&&X!==H6.TYPE_IHDR){this.error(Error("Expected IHDR on beggining"));return}if(this._crc=new N2,this._crc.write(Buffer.from(K)),this._chunks[X])return this._chunks[X](J);if(!q){this.error(Error("Unsupported critical chunk type "+K));return}this.read(J+4,this._skipChunk.bind(this))};U6.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))};U6.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))};U6.prototype._parseChunkEnd=function($){let J=$.readInt32BE(0),X=this._crc.crc32();if(this._options.checkCRC&&X!==J){this.error(Error("Crc error - "+J+" - "+X));return}if(!this._hasIEND)this.read(8,this._parseChunkBegin.bind(this))};U6.prototype._handleIHDR=function($){this.read($,this._parseIHDR.bind(this))};U6.prototype._parseIHDR=function($){this._crc.write($);let J=$.readUInt32BE(0),X=$.readUInt32BE(4),K=$[8],q=$[9],Y=$[10],W=$[11],Q=$[12];if(K!==8&&K!==4&&K!==2&&K!==1&&K!==16){this.error(Error("Unsupported bit depth "+K));return}if(!(q in H6.COLORTYPE_TO_BPP_MAP)){this.error(Error("Unsupported color type"));return}if(Y!==0){this.error(Error("Unsupported compression method"));return}if(W!==0){this.error(Error("Unsupported filter method"));return}if(Q!==0&&Q!==1){this.error(Error("Unsupported interlace method"));return}this._colorType=q;let N=H6.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:J,height:X,depth:K,interlace:Boolean(Q),palette:Boolean(q&H6.COLORTYPE_PALETTE),color:Boolean(q&H6.COLORTYPE_COLOR),alpha:Boolean(q&H6.COLORTYPE_ALPHA),bpp:N,colorType:q}),this._handleChunkEnd()};U6.prototype._handlePLTE=function($){this.read($,this._parsePLTE.bind(this))};U6.prototype._parsePLTE=function($){this._crc.write($);let J=Math.floor($.length/3);for(let X=0;X<J;X++)this._palette.push([$[X*3],$[X*3+1],$[X*3+2],255]);this.palette(this._palette),this._handleChunkEnd()};U6.prototype._handleTRNS=function($){this.simpleTransparency(),this.read($,this._parseTRNS.bind(this))};U6.prototype._parseTRNS=function($){if(this._crc.write($),this._colorType===H6.COLORTYPE_PALETTE_COLOR){if(this._palette.length===0){this.error(Error("Transparency chunk must be after palette"));return}if($.length>this._palette.length){this.error(Error("More transparent colors than palette size"));return}for(let J=0;J<$.length;J++)this._palette[J][3]=$[J];this.palette(this._palette)}if(this._colorType===H6.COLORTYPE_GRAYSCALE)this.transColor([$.readUInt16BE(0)]);if(this._colorType===H6.COLORTYPE_COLOR)this.transColor([$.readUInt16BE(0),$.readUInt16BE(2),$.readUInt16BE(4)]);this._handleChunkEnd()};U6.prototype._handleGAMA=function($){this.read($,this._parseGAMA.bind(this))};U6.prototype._parseGAMA=function($){this._crc.write($),this.gamma($.readUInt32BE(0)/H6.GAMMA_DIVISION),this._handleChunkEnd()};U6.prototype._handleIDAT=function($){if(!this._emittedHeadersFinished)this._emittedHeadersFinished=!0,this.headersFinished();this.read(-$,this._parseIDAT.bind(this,$))};U6.prototype._parseIDAT=function($,J){if(this._crc.write(J),this._colorType===H6.COLORTYPE_PALETTE_COLOR&&this._palette.length===0)throw Error("Expected palette not found");this.inflateData(J);let X=$-J.length;if(X>0)this._handleIDAT(X);else this._handleChunkEnd()};U6.prototype._handleIEND=function($){this.read($,this._parseIEND.bind(this))};U6.prototype._parseIEND=function($){if(this._crc.write($),this._hasIEND=!0,this._handleChunkEnd(),this.finished)this.finished()}});var QJ=L0((U2)=>{var Gq=$J(),V2=[function(){},function($,J,X,K){if(K===J.length)throw Error("Ran out of data");let q=J[K];$[X]=q,$[X+1]=q,$[X+2]=q,$[X+3]=255},function($,J,X,K){if(K+1>=J.length)throw Error("Ran out of data");let q=J[K];$[X]=q,$[X+1]=q,$[X+2]=q,$[X+3]=J[K+1]},function($,J,X,K){if(K+2>=J.length)throw Error("Ran out of data");$[X]=J[K],$[X+1]=J[K+1],$[X+2]=J[K+2],$[X+3]=255},function($,J,X,K){if(K+3>=J.length)throw Error("Ran out of data");$[X]=J[K],$[X+1]=J[K+1],$[X+2]=J[K+2],$[X+3]=J[K+3]}],M2=[function(){},function($,J,X,K){let q=J[0];$[X]=q,$[X+1]=q,$[X+2]=q,$[X+3]=K},function($,J,X){let K=J[0];$[X]=K,$[X+1]=K,$[X+2]=K,$[X+3]=J[1]},function($,J,X,K){$[X]=J[0],$[X+1]=J[1],$[X+2]=J[2],$[X+3]=K},function($,J,X){$[X]=J[0],$[X+1]=J[1],$[X+2]=J[2],$[X+3]=J[3]}];function H2($,J){let X=[],K=0;function q(){if(K===$.length)throw Error("Ran out of data");let Y=$[K];K++;let W,Q,N,V,M,H,G,O;switch(J){default:throw Error("unrecognised depth");case 16:G=$[K],K++,X.push((Y<<8)+G);break;case 4:G=Y&15,O=Y>>4,X.push(O,G);break;case 2:M=Y&3,H=Y>>2&3,G=Y>>4&3,O=Y>>6&3,X.push(O,G,H,M);break;case 1:W=Y&1,Q=Y>>1&1,N=Y>>2&1,V=Y>>3&1,M=Y>>4&1,H=Y>>5&1,G=Y>>6&1,O=Y>>7&1,X.push(O,G,H,M,V,N,Q,W);break}}return{get:function(Y){while(X.length<Y)q();let W=X.slice(0,Y);return X=X.slice(Y),W},resetAfterLine:function(){X.length=0},end:function(){if(K!==$.length)throw Error("extra data found")}}}function G2($,J,X,K,q,Y){let{width:W,height:Q,index:N}=$;for(let V=0;V<Q;V++)for(let M=0;M<W;M++){let H=X(M,V,N);V2[K](J,q,H,Y),Y+=K}return Y}function O2($,J,X,K,q,Y){let{width:W,height:Q,index:N}=$;for(let V=0;V<Q;V++){for(let M=0;M<W;M++){let H=q.get(K),G=X(M,V,N);M2[K](J,H,G,Y)}q.resetAfterLine()}}U2.dataToBitMap=function($,J){let{width:X,height:K,depth:q,bpp:Y,interlace:W}=J,Q;if(q!==8)Q=H2($,q);let N;if(q<=8)N=Buffer.alloc(X*K*4);else N=new Uint16Array(X*K*4);let V=Math.pow(2,q)-1,M=0,H,G;if(W)H=Gq.getImagePasses(X,K),G=Gq.getInterlaceIterator(X,K);else{let O=0;G=function(){let L=O;return O+=4,L},H=[{width:X,height:K}]}for(let O=0;O<H.length;O++)if(q===8)M=G2(H[O],N,G,Y,$,M);else O2(H[O],N,G,Y,Q,V);if(q===8){if(M!==$.length)throw Error("extra data found")}else Q.end();return N}});var NJ=L0((XF,Oq)=>{function j2($,J,X,K,q){let Y=0;for(let W=0;W<K;W++)for(let Q=0;Q<X;Q++){let N=q[$[Y]];if(!N)throw Error("index "+$[Y]+" not in palette");for(let V=0;V<4;V++)J[Y+V]=N[V];Y+=4}}function E2($,J,X,K,q){let Y=0;for(let W=0;W<K;W++)for(let Q=0;Q<X;Q++){let N=!1;if(q.length===1){if(q[0]===$[Y])N=!0}else if(q[0]===$[Y]&&q[1]===$[Y+1]&&q[2]===$[Y+2])N=!0;if(N)for(let V=0;V<4;V++)J[Y+V]=0;Y+=4}}function R2($,J,X,K,q){let Y=255,W=Math.pow(2,q)-1,Q=0;for(let N=0;N<K;N++)for(let V=0;V<X;V++){for(let M=0;M<4;M++)J[Q+M]=Math.floor($[Q+M]*Y/W+0.5);Q+=4}}Oq.exports=function($,J,X=!1){let{depth:K,width:q,height:Y,colorType:W,transColor:Q,palette:N}=J,V=$;if(W===3)j2($,V,q,Y,N);else{if(Q)E2($,V,q,Y,Q);if(K!==8&&!X){if(K===16)V=Buffer.alloc(q*Y*4);R2($,V,q,Y,K)}}return V}});var jq=L0((KF,Lq)=>{var B2=O6("util"),VJ=O6("zlib"),Uq=e7(),P2=Nq(),S2=WJ(),A2=QJ(),F2=NJ(),z8=Lq.exports=function($){Uq.call(this),this._parser=new S2($,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=$,this.writable=!0,this._parser.start()};B2.inherits(z8,Uq);z8.prototype._handleError=function($){if(this.emit("error",$),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy)this._inflate.destroy();if(this._filter)this._filter.destroy(),this._filter.on("error",function(){});this.errord=!0};z8.prototype._inflateData=function($){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=VJ.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{let X=((this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3)+1)*this._bitmapInfo.height,K=Math.max(X,VJ.Z_MIN_CHUNK);this._inflate=VJ.createInflate({chunkSize:K});let q=X,Y=this.emit.bind(this,"error");this._inflate.on("error",function(Q){if(!q)return;Y(Q)}),this._filter.on("complete",this._complete.bind(this));let W=this._filter.write.bind(this._filter);this._inflate.on("data",function(Q){if(!q)return;if(Q.length>q)Q=Q.slice(0,q);q-=Q.length,W(Q)}),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write($)};z8.prototype._handleMetaData=function($){this._metaData=$,this._bitmapInfo=Object.create($),this._filter=new P2(this._bitmapInfo)};z8.prototype._handleTransColor=function($){this._bitmapInfo.transColor=$};z8.prototype._handlePalette=function($){this._bitmapInfo.palette=$};z8.prototype._simpleTransparency=function(){this._metaData.alpha=!0};z8.prototype._headersFinished=function(){this.emit("metadata",this._metaData)};z8.prototype._finished=function(){if(this.errord)return;if(!this._inflate)this.emit("error","No Inflate block");else this._inflate.end()};z8.prototype._complete=function($){if(this.errord)return;let J;try{let X=A2.dataToBitMap($,this._bitmapInfo);J=F2(X,this._bitmapInfo,this._options.skipRescale),X=null}catch(X){this._handleError(X);return}this.emit("parsed",J)}});var Rq=L0((qF,Eq)=>{var i6=q5();Eq.exports=function($,J,X,K){let q=[i6.COLORTYPE_COLOR_ALPHA,i6.COLORTYPE_ALPHA].indexOf(K.colorType)!==-1;if(K.colorType===K.inputColorType){let L=function(){let E=new ArrayBuffer(2);return new DataView(E).setInt16(0,256,!0),new Int16Array(E)[0]!==256}();if(K.bitDepth===8||K.bitDepth===16&&L)return $}let Y=K.bitDepth!==16?$:new Uint16Array($.buffer),W=255,Q=i6.COLORTYPE_TO_BPP_MAP[K.inputColorType];if(Q===4&&!K.inputHasAlpha)Q=3;let N=i6.COLORTYPE_TO_BPP_MAP[K.colorType];if(K.bitDepth===16)W=65535,N*=2;let V=Buffer.alloc(J*X*N),M=0,H=0,G=K.bgColor||{};if(G.red===void 0)G.red=W;if(G.green===void 0)G.green=W;if(G.blue===void 0)G.blue=W;function O(){let L,E,j,B=W;switch(K.inputColorType){case i6.COLORTYPE_COLOR_ALPHA:B=Y[M+3],L=Y[M],E=Y[M+1],j=Y[M+2];break;case i6.COLORTYPE_COLOR:L=Y[M],E=Y[M+1],j=Y[M+2];break;case i6.COLORTYPE_ALPHA:B=Y[M+1],L=Y[M],E=L,j=L;break;case i6.COLORTYPE_GRAYSCALE:L=Y[M],E=L,j=L;break;default:throw Error("input color type:"+K.inputColorType+" is not supported at present")}if(K.inputHasAlpha){if(!q)B/=W,L=Math.min(Math.max(Math.round((1-B)*G.red+B*L),0),W),E=Math.min(Math.max(Math.round((1-B)*G.green+B*E),0),W),j=Math.min(Math.max(Math.round((1-B)*G.blue+B*j),0),W)}return{red:L,green:E,blue:j,alpha:B}}for(let L=0;L<X;L++)for(let E=0;E<J;E++){let j=O(Y,M);switch(K.colorType){case i6.COLORTYPE_COLOR_ALPHA:case i6.COLORTYPE_COLOR:if(K.bitDepth===8){if(V[H]=j.red,V[H+1]=j.green,V[H+2]=j.blue,q)V[H+3]=j.alpha}else if(V.writeUInt16BE(j.red,H),V.writeUInt16BE(j.green,H+2),V.writeUInt16BE(j.blue,H+4),q)V.writeUInt16BE(j.alpha,H+6);break;case i6.COLORTYPE_ALPHA:case i6.COLORTYPE_GRAYSCALE:{let B=(j.red+j.green+j.blue)/3;if(K.bitDepth===8){if(V[H]=B,q)V[H+1]=j.alpha}else if(V.writeUInt16BE(B,H),q)V.writeUInt16BE(j.alpha,H+2);break}default:throw Error("unrecognised color Type "+K.colorType)}M+=Q,H+=N}return V}});var Sq=L0((YF,Pq)=>{var Bq=JJ();function z2($,J,X,K,q){for(let Y=0;Y<X;Y++)K[q+Y]=$[J+Y]}function C2($,J,X){let K=0,q=J+X;for(let Y=J;Y<q;Y++)K+=Math.abs($[Y]);return K}function Z2($,J,X,K,q,Y){for(let W=0;W<X;W++){let Q=W>=Y?$[J+W-Y]:0,N=$[J+W]-Q;K[q+W]=N}}function v2($,J,X,K){let q=0;for(let Y=0;Y<X;Y++){let W=Y>=K?$[J+Y-K]:0,Q=$[J+Y]-W;q+=Math.abs(Q)}return q}function D2($,J,X,K,q){for(let Y=0;Y<X;Y++){let W=J>0?$[J+Y-X]:0,Q=$[J+Y]-W;K[q+Y]=Q}}function k2($,J,X){let K=0,q=J+X;for(let Y=J;Y<q;Y++){let W=J>0?$[Y-X]:0,Q=$[Y]-W;K+=Math.abs(Q)}return K}function w2($,J,X,K,q,Y){for(let W=0;W<X;W++){let Q=W>=Y?$[J+W-Y]:0,N=J>0?$[J+W-X]:0,V=$[J+W]-(Q+N>>1);K[q+W]=V}}function T2($,J,X,K){let q=0;for(let Y=0;Y<X;Y++){let W=Y>=K?$[J+Y-K]:0,Q=J>0?$[J+Y-X]:0,N=$[J+Y]-(W+Q>>1);q+=Math.abs(N)}return q}function I2($,J,X,K,q,Y){for(let W=0;W<X;W++){let Q=W>=Y?$[J+W-Y]:0,N=J>0?$[J+W-X]:0,V=J>0&&W>=Y?$[J+W-(X+Y)]:0,M=$[J+W]-Bq(Q,N,V);K[q+W]=M}}function _2($,J,X,K){let q=0;for(let Y=0;Y<X;Y++){let W=Y>=K?$[J+Y-K]:0,Q=J>0?$[J+Y-X]:0,N=J>0&&Y>=K?$[J+Y-(X+K)]:0,V=$[J+Y]-Bq(W,Q,N);q+=Math.abs(V)}return q}var y2={0:z2,1:Z2,2:D2,3:w2,4:I2},x2={0:C2,1:v2,2:k2,3:T2,4:_2};Pq.exports=function($,J,X,K,q){let Y;if(!("filterType"in K)||K.filterType===-1)Y=[0,1,2,3,4];else if(typeof K.filterType==="number")Y=[K.filterType];else throw Error("unrecognised filter types");if(K.bitDepth===16)q*=2;let W=J*q,Q=0,N=0,V=Buffer.alloc((W+1)*X),M=Y[0];for(let H=0;H<X;H++){if(Y.length>1){let G=1/0;for(let O=0;O<Y.length;O++){let L=x2[Y[O]]($,N,W,q);if(L<G)M=Y[O],G=L}}V[Q]=M,Q++,y2[M]($,N,W,V,Q,q),Q+=W,N+=W}return V}});var MJ=L0((WF,Aq)=>{var A6=q5(),h2=YJ(),g2=Rq(),f2=Sq(),b2=O6("zlib"),Q1=Aq.exports=function($){if(this._options=$,$.deflateChunkSize=$.deflateChunkSize||32768,$.deflateLevel=$.deflateLevel!=null?$.deflateLevel:9,$.deflateStrategy=$.deflateStrategy!=null?$.deflateStrategy:3,$.inputHasAlpha=$.inputHasAlpha!=null?$.inputHasAlpha:!0,$.deflateFactory=$.deflateFactory||b2.createDeflate,$.bitDepth=$.bitDepth||8,$.colorType=typeof $.colorType==="number"?$.colorType:A6.COLORTYPE_COLOR_ALPHA,$.inputColorType=typeof $.inputColorType==="number"?$.inputColorType:A6.COLORTYPE_COLOR_ALPHA,[A6.COLORTYPE_GRAYSCALE,A6.COLORTYPE_COLOR,A6.COLORTYPE_COLOR_ALPHA,A6.COLORTYPE_ALPHA].indexOf($.colorType)===-1)throw Error("option color type:"+$.colorType+" is not supported at present");if([A6.COLORTYPE_GRAYSCALE,A6.COLORTYPE_COLOR,A6.COLORTYPE_COLOR_ALPHA,A6.COLORTYPE_ALPHA].indexOf($.inputColorType)===-1)throw Error("option input color type:"+$.inputColorType+" is not supported at present");if($.bitDepth!==8&&$.bitDepth!==16)throw Error("option bit depth:"+$.bitDepth+" is not supported at present")};Q1.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}};Q1.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())};Q1.prototype.filterData=function($,J,X){let K=g2($,J,X,this._options),q=A6.COLORTYPE_TO_BPP_MAP[this._options.colorType];return f2(K,J,X,this._options,q)};Q1.prototype._packChunk=function($,J){let X=J?J.length:0,K=Buffer.alloc(X+12);if(K.writeUInt32BE(X,0),K.writeUInt32BE($,4),J)J.copy(K,8);return K.writeInt32BE(h2.crc32(K.slice(4,K.length-4)),K.length-4),K};Q1.prototype.packGAMA=function($){let J=Buffer.alloc(4);return J.writeUInt32BE(Math.floor($*A6.GAMMA_DIVISION),0),this._packChunk(A6.TYPE_gAMA,J)};Q1.prototype.packIHDR=function($,J){let X=Buffer.alloc(13);return X.writeUInt32BE($,0),X.writeUInt32BE(J,4),X[8]=this._options.bitDepth,X[9]=this._options.colorType,X[10]=0,X[11]=0,X[12]=0,this._packChunk(A6.TYPE_IHDR,X)};Q1.prototype.packIDAT=function($){return this._packChunk(A6.TYPE_IDAT,$)};Q1.prototype.packIEND=function(){return this._packChunk(A6.TYPE_IEND,null)}});var Zq=L0((QF,Cq)=>{var m2=O6("util"),Fq=O6("stream"),p2=q5(),u2=MJ(),zq=Cq.exports=function($){Fq.call(this);let J=$||{};this._packer=new u2(J),this._deflate=this._packer.createDeflate(),this.readable=!0};m2.inherits(zq,Fq);zq.prototype.pack=function($,J,X,K){if(this.emit("data",Buffer.from(p2.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(J,X)),K)this.emit("data",this._packer.packGAMA(K));let q=this._packer.filterData($,J,X);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",function(Y){this.emit("data",this._packer.packIDAT(Y))}.bind(this)),this._deflate.on("end",function(){this.emit("data",this._packer.packIEND()),this.emit("end")}.bind(this)),this._deflate.end(q)}});var Iq=L0((Q9,Tq)=>{var vq=O6("assert").ok,Y5=O6("zlib"),l2=O6("util"),Dq=O6("buffer").kMaxLength;function I1($){if(!(this instanceof I1))return new I1($);if($&&$.chunkSize<Y5.Z_MIN_CHUNK)$.chunkSize=Y5.Z_MIN_CHUNK;if(Y5.Inflate.call(this,$),this._offset=this._offset===void 0?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,$&&$.maxLength!=null)this._maxLength=$.maxLength}function c2($){return new I1($)}function kq($,J){if(J)process.nextTick(J);if(!$._handle)return;$._handle.close(),$._handle=null}I1.prototype._processChunk=function($,J,X){if(typeof X==="function")return Y5.Inflate._processChunk.call(this,$,J,X);let K=this,q=$&&$.length,Y=this._chunkSize-this._offset,W=this._maxLength,Q=0,N=[],V=0,M;this.on("error",function(L){M=L});function H(L,E){if(K._hadError)return;let j=Y-E;if(vq(j>=0,"have should not go down"),j>0){let B=K._buffer.slice(K._offset,K._offset+j);if(K._offset+=j,B.length>W)B=B.slice(0,W);if(N.push(B),V+=B.length,W-=B.length,W===0)return!1}if(E===0||K._offset>=K._chunkSize)Y=K._chunkSize,K._offset=0,K._buffer=Buffer.allocUnsafe(K._chunkSize);if(E===0)return Q+=q-L,q=L,!0;return!1}vq(this._handle,"zlib binding closed");let G;do G=this._handle.writeSync(J,$,Q,q,this._buffer,this._offset,Y),G=G||this._writeState;while(!this._hadError&&H(G[0],G[1]));if(this._hadError)throw M;if(V>=Dq)throw kq(this),RangeError("Cannot create final Buffer. It would be larger than 0x"+Dq.toString(16)+" bytes");let O=Buffer.concat(N,V);return kq(this),O};l2.inherits(I1,Y5.Inflate);function d2($,J){if(typeof J==="string")J=Buffer.from(J);if(!(J instanceof Buffer))throw TypeError("Not a string or buffer");let X=$._finishFlushFlag;if(X==null)X=Y5.Z_FINISH;return $._processChunk(J,X)}function wq($,J){return d2(new I1(J),$)}Tq.exports=Q9=wq;Q9.Inflate=I1;Q9.createInflate=c2;Q9.inflateSync=wq});var HJ=L0((NF,yq)=>{var _q=yq.exports=function($){this._buffer=$,this._reads=[]};_q.prototype.read=function($,J){this._reads.push({length:Math.abs($),allowLess:$<0,func:J})};_q.prototype.process=function(){while(this._reads.length>0&&this._buffer.length){let $=this._reads[0];if(this._buffer.length&&(this._buffer.length>=$.length||$.allowLess)){this._reads.shift();let J=this._buffer;this._buffer=J.slice($.length),$.func.call(this,J.slice(0,$.length))}else break}if(this._reads.length>0)throw Error("There are some read requests waitng on finished stream");if(this._buffer.length>0)throw Error("unrecognised content at end of stream")}});var xq=L0((r2)=>{var n2=HJ(),o2=XJ();r2.process=function($,J){let X=[],K=new n2($);return new o2(J,{read:K.read.bind(K),write:function(Y){X.push(Y)},complete:function(){}}).start(),K.process(),Buffer.concat(X)}});var bq=L0((MF,fq)=>{var hq=!0,gq=O6("zlib"),s2=Iq();if(!gq.deflateSync)hq=!1;var a2=HJ(),t2=xq(),e2=WJ(),$O=QJ(),JO=NJ();fq.exports=function($,J){if(!hq)throw Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let X;function K(z){X=z}let q;function Y(z){q=z}function W(z){q.transColor=z}function Q(z){q.palette=z}function N(){q.alpha=!0}let V;function M(z){V=z}let H=[];function G(z){H.push(z)}let O=new a2($);if(new e2(J,{read:O.read.bind(O),error:K,metadata:Y,gamma:M,palette:Q,transColor:W,inflateData:G,simpleTransparency:N}).start(),O.process(),X)throw X;let E=Buffer.concat(H);H.length=0;let j;if(q.interlace)j=gq.inflateSync(E);else{let P=((q.width*q.bpp*q.depth+7>>3)+1)*q.height;j=s2(E,{chunkSize:P,maxLength:P})}if(E=null,!j||!j.length)throw Error("bad png - invalid inflate data response");let B=t2.process(j,q);E=null;let S=$O.dataToBitMap(B,q);B=null;let A=JO(S,q,J.skipRescale);return q.data=A,q.gamma=V||0,q}});var lq=L0((HF,uq)=>{var mq=!0,pq=O6("zlib");if(!pq.deflateSync)mq=!1;var XO=q5(),KO=MJ();uq.exports=function($,J){if(!mq)throw Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let K=new KO(J||{}),q=[];if(q.push(Buffer.from(XO.PNG_SIGNATURE)),q.push(K.packIHDR($.width,$.height)),$.gamma)q.push(K.packGAMA($.gamma));let Y=K.filterData($.data,$.width,$.height),W=pq.deflateSync(Y,K.getDeflateOptions());if(Y=null,!W||!W.length)throw Error("bad png - invalid compressed data response");return q.push(K.packIDAT(W)),q.push(K.packIEND()),Buffer.concat(q)}});var cq=L0((WO)=>{var qO=bq(),YO=lq();WO.read=function($,J){return qO($,J||{})};WO.write=function($,J){return YO($,J)}});var nq=L0((OO)=>{var VO=O6("util"),dq=O6("stream"),MO=jq(),HO=Zq(),GO=cq(),v6=OO.PNG=function($){if(dq.call(this),$=$||{},this.width=$.width|0,this.height=$.height|0,this.data=this.width>0&&this.height>0?Buffer.alloc(4*this.width*this.height):null,$.fill&&this.data)this.data.fill(0);this.gamma=0,this.readable=this.writable=!0,this._parser=new MO($),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",function(J){this.data=J,this.emit("parsed",J)}.bind(this)),this._packer=new HO($),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};VO.inherits(v6,dq);v6.sync=GO;v6.prototype.pack=function(){if(!this.data||!this.data.length)return this.emit("error","No data provided"),this;return process.nextTick(function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}.bind(this)),this};v6.prototype.parse=function($,J){if(J){let X,K;X=function(q){this.removeListener("error",K),this.data=q,J(null,this)}.bind(this),K=function(q){this.removeListener("parsed",X),J(q,null)}.bind(this),this.once("parsed",X),this.once("error",K)}return this.end($),this};v6.prototype.write=function($){return this._parser.write($),!0};v6.prototype.end=function($){this._parser.end($)};v6.prototype._metadata=function($){this.width=$.width,this.height=$.height,this.emit("metadata",$)};v6.prototype._gamma=function($){this.gamma=$};v6.prototype._handleClose=function(){if(!this._parser.writable&&!this._packer.readable)this.emit("close")};v6.bitblt=function($,J,X,K,q,Y,W,Q){if(X|=0,K|=0,q|=0,Y|=0,W|=0,Q|=0,X>$.width||K>$.height||X+q>$.width||K+Y>$.height)throw Error("bitblt reading outside image");if(W>J.width||Q>J.height||W+q>J.width||Q+Y>J.height)throw Error("bitblt writing outside image");for(let N=0;N<Y;N++)$.data.copy(J.data,(Q+N)*J.width+W<<2,(K+N)*$.width+X<<2,(K+N)*$.width+X+q<<2)};v6.prototype.bitblt=function($,J,X,K,q,Y,W){return v6.bitblt(this,$,J,X,K,q,Y,W),this};v6.adjustGamma=function($){if($.gamma){for(let J=0;J<$.height;J++)for(let X=0;X<$.width;X++){let K=$.width*J+X<<2;for(let q=0;q<3;q++){let Y=$.data[K+q]/255;Y=Math.pow(Y,0.45454545454545453/$.gamma),$.data[K+q]=Math.round(Y*255)}}$.gamma=0}};v6.prototype.adjustGamma=function(){v6.adjustGamma(this)}});var c8=L0((GJ)=>{var EO=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function RO($,J){return Object.prototype.hasOwnProperty.call($,J)}GJ.assign=function($){var J=Array.prototype.slice.call(arguments,1);while(J.length){var X=J.shift();if(!X)continue;if(typeof X!=="object")throw TypeError(X+"must be non-object");for(var K in X)if(RO(X,K))$[K]=X[K]}return $};GJ.shrinkBuf=function($,J){if($.length===J)return $;if($.subarray)return $.subarray(0,J);return $.length=J,$};var BO={arraySet:function($,J,X,K,q){if(J.subarray&&$.subarray){$.set(J.subarray(X,X+K),q);return}for(var Y=0;Y<K;Y++)$[q+Y]=J[X+Y]},flattenChunks:function($){var J,X,K,q,Y,W;K=0;for(J=0,X=$.length;J<X;J++)K+=$[J].length;W=new Uint8Array(K),q=0;for(J=0,X=$.length;J<X;J++)Y=$[J],W.set(Y,q),q+=Y.length;return W}},PO={arraySet:function($,J,X,K,q){for(var Y=0;Y<K;Y++)$[q+Y]=J[X+Y]},flattenChunks:function($){return[].concat.apply([],$)}};GJ.setTyped=function($){if($)GJ.Buf8=Uint8Array,GJ.Buf16=Uint16Array,GJ.Buf32=Int32Array,GJ.assign(GJ,BO);else GJ.Buf8=Array,GJ.Buf16=Array,GJ.Buf32=Array,GJ.assign(GJ,PO)};GJ.setTyped(EO)});var jY=L0((lO)=>{var AO=c8(),FO=4,rq=0,iq=1,zO=2;function Q5($){var J=$.length;while(--J>=0)$[J]=0}var CO=0,JY=1,ZO=2,vO=3,DO=258,PJ=29,U9=256,M9=U9+1+PJ,W5=30,SJ=19,XY=2*M9+1,_1=15,UJ=16,kO=7,AJ=256,KY=16,qY=17,YY=18,RJ=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],B$=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],wO=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],WY=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],TO=512,d8=Array((M9+2)*2);Q5(d8);var V9=Array(W5*2);Q5(V9);var H9=Array(TO);Q5(H9);var G9=Array(DO-vO+1);Q5(G9);var FJ=Array(PJ);Q5(FJ);var P$=Array(W5);Q5(P$);function LJ($,J,X,K,q){this.static_tree=$,this.extra_bits=J,this.extra_base=X,this.elems=K,this.max_length=q,this.has_stree=$&&$.length}var QY,NY,VY;function jJ($,J){this.dyn_tree=$,this.max_code=0,this.stat_desc=J}function MY($){return $<256?H9[$]:H9[256+($>>>7)]}function O9($,J){$.pending_buf[$.pending++]=J&255,$.pending_buf[$.pending++]=J>>>8&255}function I6($,J,X){if($.bi_valid>UJ-X)$.bi_buf|=J<<$.bi_valid&65535,O9($,$.bi_buf),$.bi_buf=J>>UJ-$.bi_valid,$.bi_valid+=X-UJ;else $.bi_buf|=J<<$.bi_valid&65535,$.bi_valid+=X}function C8($,J,X){I6($,X[J*2],X[J*2+1])}function HY($,J){var X=0;do X|=$&1,$>>>=1,X<<=1;while(--J>0);return X>>>1}function IO($){if($.bi_valid===16)O9($,$.bi_buf),$.bi_buf=0,$.bi_valid=0;else if($.bi_valid>=8)$.pending_buf[$.pending++]=$.bi_buf&255,$.bi_buf>>=8,$.bi_valid-=8}function _O($,J){var{dyn_tree:X,max_code:K}=J,q=J.stat_desc.static_tree,Y=J.stat_desc.has_stree,W=J.stat_desc.extra_bits,Q=J.stat_desc.extra_base,N=J.stat_desc.max_length,V,M,H,G,O,L,E=0;for(G=0;G<=_1;G++)$.bl_count[G]=0;X[$.heap[$.heap_max]*2+1]=0;for(V=$.heap_max+1;V<XY;V++){if(M=$.heap[V],G=X[X[M*2+1]*2+1]+1,G>N)G=N,E++;if(X[M*2+1]=G,M>K)continue;if($.bl_count[G]++,O=0,M>=Q)O=W[M-Q];if(L=X[M*2],$.opt_len+=L*(G+O),Y)$.static_len+=L*(q[M*2+1]+O)}if(E===0)return;do{G=N-1;while($.bl_count[G]===0)G--;$.bl_count[G]--,$.bl_count[G+1]+=2,$.bl_count[N]--,E-=2}while(E>0);for(G=N;G!==0;G--){M=$.bl_count[G];while(M!==0){if(H=$.heap[--V],H>K)continue;if(X[H*2+1]!==G)$.opt_len+=(G-X[H*2+1])*X[H*2],X[H*2+1]=G;M--}}}function GY($,J,X){var K=Array(_1+1),q=0,Y,W;for(Y=1;Y<=_1;Y++)K[Y]=q=q+X[Y-1]<<1;for(W=0;W<=J;W++){var Q=$[W*2+1];if(Q===0)continue;$[W*2]=HY(K[Q]++,Q)}}function yO(){var $,J,X,K,q,Y=Array(_1+1);X=0;for(K=0;K<PJ-1;K++){FJ[K]=X;for($=0;$<1<<RJ[K];$++)G9[X++]=K}G9[X-1]=K,q=0;for(K=0;K<16;K++){P$[K]=q;for($=0;$<1<<B$[K];$++)H9[q++]=K}q>>=7;for(;K<W5;K++){P$[K]=q<<7;for($=0;$<1<<B$[K]-7;$++)H9[256+q++]=K}for(J=0;J<=_1;J++)Y[J]=0;$=0;while($<=143)d8[$*2+1]=8,$++,Y[8]++;while($<=255)d8[$*2+1]=9,$++,Y[9]++;while($<=279)d8[$*2+1]=7,$++,Y[7]++;while($<=287)d8[$*2+1]=8,$++,Y[8]++;GY(d8,M9+1,Y);for($=0;$<W5;$++)V9[$*2+1]=5,V9[$*2]=HY($,5);QY=new LJ(d8,RJ,U9+1,M9,_1),NY=new LJ(V9,B$,0,W5,_1),VY=new LJ([],wO,0,SJ,kO)}function OY($){var J;for(J=0;J<M9;J++)$.dyn_ltree[J*2]=0;for(J=0;J<W5;J++)$.dyn_dtree[J*2]=0;for(J=0;J<SJ;J++)$.bl_tree[J*2]=0;$.dyn_ltree[AJ*2]=1,$.opt_len=$.static_len=0,$.last_lit=$.matches=0}function UY($){if($.bi_valid>8)O9($,$.bi_buf);else if($.bi_valid>0)$.pending_buf[$.pending++]=$.bi_buf;$.bi_buf=0,$.bi_valid=0}function xO($,J,X,K){if(UY($),K)O9($,X),O9($,~X);AO.arraySet($.pending_buf,$.window,J,X,$.pending),$.pending+=X}function sq($,J,X,K){var q=J*2,Y=X*2;return $[q]<$[Y]||$[q]===$[Y]&&K[J]<=K[X]}function EJ($,J,X){var K=$.heap[X],q=X<<1;while(q<=$.heap_len){if(q<$.heap_len&&sq(J,$.heap[q+1],$.heap[q],$.depth))q++;if(sq(J,K,$.heap[q],$.depth))break;$.heap[X]=$.heap[q],X=q,q<<=1}$.heap[X]=K}function aq($,J,X){var K,q,Y=0,W,Q;if($.last_lit!==0)do if(K=$.pending_buf[$.d_buf+Y*2]<<8|$.pending_buf[$.d_buf+Y*2+1],q=$.pending_buf[$.l_buf+Y],Y++,K===0)C8($,q,J);else{if(W=G9[q],C8($,W+U9+1,J),Q=RJ[W],Q!==0)q-=FJ[W],I6($,q,Q);if(K--,W=MY(K),C8($,W,X),Q=B$[W],Q!==0)K-=P$[W],I6($,K,Q)}while(Y<$.last_lit);C8($,AJ,J)}function BJ($,J){var X=J.dyn_tree,K=J.stat_desc.static_tree,q=J.stat_desc.has_stree,Y=J.stat_desc.elems,W,Q,N=-1,V;$.heap_len=0,$.heap_max=XY;for(W=0;W<Y;W++)if(X[W*2]!==0)$.heap[++$.heap_len]=N=W,$.depth[W]=0;else X[W*2+1]=0;while($.heap_len<2)if(V=$.heap[++$.heap_len]=N<2?++N:0,X[V*2]=1,$.depth[V]=0,$.opt_len--,q)$.static_len-=K[V*2+1];J.max_code=N;for(W=$.heap_len>>1;W>=1;W--)EJ($,X,W);V=Y;do W=$.heap[1],$.heap[1]=$.heap[$.heap_len--],EJ($,X,1),Q=$.heap[1],$.heap[--$.heap_max]=W,$.heap[--$.heap_max]=Q,X[V*2]=X[W*2]+X[Q*2],$.depth[V]=($.depth[W]>=$.depth[Q]?$.depth[W]:$.depth[Q])+1,X[W*2+1]=X[Q*2+1]=V,$.heap[1]=V++,EJ($,X,1);while($.heap_len>=2);$.heap[--$.heap_max]=$.heap[1],_O($,J),GY(X,N,$.bl_count)}function tq($,J,X){var K,q=-1,Y,W=J[1],Q=0,N=7,V=4;if(W===0)N=138,V=3;J[(X+1)*2+1]=65535;for(K=0;K<=X;K++){if(Y=W,W=J[(K+1)*2+1],++Q<N&&Y===W)continue;else if(Q<V)$.bl_tree[Y*2]+=Q;else if(Y!==0){if(Y!==q)$.bl_tree[Y*2]++;$.bl_tree[KY*2]++}else if(Q<=10)$.bl_tree[qY*2]++;else $.bl_tree[YY*2]++;if(Q=0,q=Y,W===0)N=138,V=3;else if(Y===W)N=6,V=3;else N=7,V=4}}function eq($,J,X){var K,q=-1,Y,W=J[1],Q=0,N=7,V=4;if(W===0)N=138,V=3;for(K=0;K<=X;K++){if(Y=W,W=J[(K+1)*2+1],++Q<N&&Y===W)continue;else if(Q<V)do C8($,Y,$.bl_tree);while(--Q!==0);else if(Y!==0){if(Y!==q)C8($,Y,$.bl_tree),Q--;C8($,KY,$.bl_tree),I6($,Q-3,2)}else if(Q<=10)C8($,qY,$.bl_tree),I6($,Q-3,3);else C8($,YY,$.bl_tree),I6($,Q-11,7);if(Q=0,q=Y,W===0)N=138,V=3;else if(Y===W)N=6,V=3;else N=7,V=4}}function hO($){var J;tq($,$.dyn_ltree,$.l_desc.max_code),tq($,$.dyn_dtree,$.d_desc.max_code),BJ($,$.bl_desc);for(J=SJ-1;J>=3;J--)if($.bl_tree[WY[J]*2+1]!==0)break;return $.opt_len+=3*(J+1)+5+5+4,J}function gO($,J,X,K){var q;I6($,J-257,5),I6($,X-1,5),I6($,K-4,4);for(q=0;q<K;q++)I6($,$.bl_tree[WY[q]*2+1],3);eq($,$.dyn_ltree,J-1),eq($,$.dyn_dtree,X-1)}function fO($){var J=4093624447,X;for(X=0;X<=31;X++,J>>>=1)if(J&1&&$.dyn_ltree[X*2]!==0)return rq;if($.dyn_ltree[18]!==0||$.dyn_ltree[20]!==0||$.dyn_ltree[26]!==0)return iq;for(X=32;X<U9;X++)if($.dyn_ltree[X*2]!==0)return iq;return rq}var $Y=!1;function bO($){if(!$Y)yO(),$Y=!0;$.l_desc=new jJ($.dyn_ltree,QY),$.d_desc=new jJ($.dyn_dtree,NY),$.bl_desc=new jJ($.bl_tree,VY),$.bi_buf=0,$.bi_valid=0,OY($)}function LY($,J,X,K){I6($,(CO<<1)+(K?1:0),3),xO($,J,X,!0)}function mO($){I6($,JY<<1,3),C8($,AJ,d8),IO($)}function pO($,J,X,K){var q,Y,W=0;if($.level>0){if($.strm.data_type===zO)$.strm.data_type=fO($);if(BJ($,$.l_desc),BJ($,$.d_desc),W=hO($),q=$.opt_len+3+7>>>3,Y=$.static_len+3+7>>>3,Y<=q)q=Y}else q=Y=X+5;if(X+4<=q&&J!==-1)LY($,J,X,K);else if($.strategy===FO||Y===q)I6($,(JY<<1)+(K?1:0),3),aq($,d8,V9);else I6($,(ZO<<1)+(K?1:0),3),gO($,$.l_desc.max_code+1,$.d_desc.max_code+1,W+1),aq($,$.dyn_ltree,$.dyn_dtree);if(OY($),K)UY($)}function uO($,J,X){if($.pending_buf[$.d_buf+$.last_lit*2]=J>>>8&255,$.pending_buf[$.d_buf+$.last_lit*2+1]=J&255,$.pending_buf[$.l_buf+$.last_lit]=X&255,$.last_lit++,J===0)$.dyn_ltree[X*2]++;else $.matches++,J--,$.dyn_ltree[(G9[X]+U9+1)*2]++,$.dyn_dtree[MY(J)*2]++;return $.last_lit===$.lit_bufsize-1}lO._tr_init=bO;lO._tr_stored_block=LY;lO._tr_flush_block=pO;lO._tr_tally=uO;lO._tr_align=mO});var zJ=L0((SF,EY)=>{function iO($,J,X,K){var q=$&65535|0,Y=$>>>16&65535|0,W=0;while(X!==0){W=X>2000?2000:X,X-=W;do q=q+J[K++]|0,Y=Y+q|0;while(--W);q%=65521,Y%=65521}return q|Y<<16|0}EY.exports=iO});var CJ=L0((AF,RY)=>{function sO(){var $,J=[];for(var X=0;X<256;X++){$=X;for(var K=0;K<8;K++)$=$&1?3988292384^$>>>1:$>>>1;J[X]=$}return J}var aO=sO();function tO($,J,X,K){var q=aO,Y=K+X;$^=-1;for(var W=K;W<Y;W++)$=$>>>8^q[($^J[W])&255];return $^-1}RY.exports=tO});var S$=L0((FF,BY)=>{BY.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var DY=L0((TU)=>{var D6=c8(),s6=jY(),FY=zJ(),N1=CJ(),eO=S$(),g1=0,$U=1,JU=3,O1=4,PY=5,v8=0,SY=1,a6=-2,XU=-3,ZJ=-5,KU=-1,qU=1,A$=2,YU=3,WU=4,QU=0,NU=2,Z$=8,VU=9,MU=15,HU=8,GU=29,OU=256,DJ=OU+1+GU,UU=30,LU=19,jU=2*DJ+1,EU=15,n0=3,H1=258,V8=H1+n0+1,RU=32,v$=42,kJ=69,F$=73,z$=91,C$=103,y1=113,j9=666,G6=1,E9=2,x1=3,M5=4,BU=3;function G1($,J){return $.msg=eO[J],J}function AY($){return($<<1)-($>4?9:0)}function M1($){var J=$.length;while(--J>=0)$[J]=0}function V1($){var J=$.state,X=J.pending;if(X>$.avail_out)X=$.avail_out;if(X===0)return;if(D6.arraySet($.output,J.pending_buf,J.pending_out,X,$.next_out),$.next_out+=X,J.pending_out+=X,$.total_out+=X,$.avail_out-=X,J.pending-=X,J.pending===0)J.pending_out=0}function B6($,J){s6._tr_flush_block($,$.block_start>=0?$.block_start:-1,$.strstart-$.block_start,J),$.block_start=$.strstart,V1($.strm)}function o0($,J){$.pending_buf[$.pending++]=J}function L9($,J){$.pending_buf[$.pending++]=J>>>8&255,$.pending_buf[$.pending++]=J&255}function PU($,J,X,K){var q=$.avail_in;if(q>K)q=K;if(q===0)return 0;if($.avail_in-=q,D6.arraySet(J,$.input,$.next_in,q,X),$.state.wrap===1)$.adler=FY($.adler,J,q,X);else if($.state.wrap===2)$.adler=N1($.adler,J,q,X);return $.next_in+=q,$.total_in+=q,q}function zY($,J){var{max_chain_length:X,strstart:K}=$,q,Y,W=$.prev_length,Q=$.nice_match,N=$.strstart>$.w_size-V8?$.strstart-($.w_size-V8):0,V=$.window,M=$.w_mask,H=$.prev,G=$.strstart+H1,O=V[K+W-1],L=V[K+W];if($.prev_length>=$.good_match)X>>=2;if(Q>$.lookahead)Q=$.lookahead;do{if(q=J,V[q+W]!==L||V[q+W-1]!==O||V[q]!==V[K]||V[++q]!==V[K+1])continue;K+=2,q++;do;while(V[++K]===V[++q]&&V[++K]===V[++q]&&V[++K]===V[++q]&&V[++K]===V[++q]&&V[++K]===V[++q]&&V[++K]===V[++q]&&V[++K]===V[++q]&&V[++K]===V[++q]&&K<G);if(Y=H1-(G-K),K=G-H1,Y>W){if($.match_start=J,W=Y,Y>=Q)break;O=V[K+W-1],L=V[K+W]}}while((J=H[J&M])>N&&--X!==0);if(W<=$.lookahead)return W;return $.lookahead}function h1($){var J=$.w_size,X,K,q,Y,W;do{if(Y=$.window_size-$.lookahead-$.strstart,$.strstart>=J+(J-V8)){D6.arraySet($.window,$.window,J,J,0),$.match_start-=J,$.strstart-=J,$.block_start-=J,K=$.hash_size,X=K;do q=$.head[--X],$.head[X]=q>=J?q-J:0;while(--K);K=J,X=K;do q=$.prev[--X],$.prev[X]=q>=J?q-J:0;while(--K);Y+=J}if($.strm.avail_in===0)break;if(K=PU($.strm,$.window,$.strstart+$.lookahead,Y),$.lookahead+=K,$.lookahead+$.insert>=n0){W=$.strstart-$.insert,$.ins_h=$.window[W],$.ins_h=($.ins_h<<$.hash_shift^$.window[W+1])&$.hash_mask;while($.insert)if($.ins_h=($.ins_h<<$.hash_shift^$.window[W+n0-1])&$.hash_mask,$.prev[W&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=W,W++,$.insert--,$.lookahead+$.insert<n0)break}}while($.lookahead<V8&&$.strm.avail_in!==0)}function SU($,J){var X=65535;if(X>$.pending_buf_size-5)X=$.pending_buf_size-5;for(;;){if($.lookahead<=1){if(h1($),$.lookahead===0&&J===g1)return G6;if($.lookahead===0)break}$.strstart+=$.lookahead,$.lookahead=0;var K=$.block_start+X;if($.strstart===0||$.strstart>=K){if($.lookahead=$.strstart-K,$.strstart=K,B6($,!1),$.strm.avail_out===0)return G6}if($.strstart-$.block_start>=$.w_size-V8){if(B6($,!1),$.strm.avail_out===0)return G6}}if($.insert=0,J===O1){if(B6($,!0),$.strm.avail_out===0)return x1;return M5}if($.strstart>$.block_start){if(B6($,!1),$.strm.avail_out===0)return G6}return G6}function vJ($,J){var X,K;for(;;){if($.lookahead<V8){if(h1($),$.lookahead<V8&&J===g1)return G6;if($.lookahead===0)break}if(X=0,$.lookahead>=n0)$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+n0-1])&$.hash_mask,X=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart;if(X!==0&&$.strstart-X<=$.w_size-V8)$.match_length=zY($,X);if($.match_length>=n0)if(K=s6._tr_tally($,$.strstart-$.match_start,$.match_length-n0),$.lookahead-=$.match_length,$.match_length<=$.max_lazy_match&&$.lookahead>=n0){$.match_length--;do $.strstart++,$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+n0-1])&$.hash_mask,X=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart;while(--$.match_length!==0);$.strstart++}else $.strstart+=$.match_length,$.match_length=0,$.ins_h=$.window[$.strstart],$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+1])&$.hash_mask;else K=s6._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++;if(K){if(B6($,!1),$.strm.avail_out===0)return G6}}if($.insert=$.strstart<n0-1?$.strstart:n0-1,J===O1){if(B6($,!0),$.strm.avail_out===0)return x1;return M5}if($.last_lit){if(B6($,!1),$.strm.avail_out===0)return G6}return E9}function N5($,J){var X,K,q;for(;;){if($.lookahead<V8){if(h1($),$.lookahead<V8&&J===g1)return G6;if($.lookahead===0)break}if(X=0,$.lookahead>=n0)$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+n0-1])&$.hash_mask,X=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart;if($.prev_length=$.match_length,$.prev_match=$.match_start,$.match_length=n0-1,X!==0&&$.prev_length<$.max_lazy_match&&$.strstart-X<=$.w_size-V8){if($.match_length=zY($,X),$.match_length<=5&&($.strategy===qU||$.match_length===n0&&$.strstart-$.match_start>4096))$.match_length=n0-1}if($.prev_length>=n0&&$.match_length<=$.prev_length){q=$.strstart+$.lookahead-n0,K=s6._tr_tally($,$.strstart-1-$.prev_match,$.prev_length-n0),$.lookahead-=$.prev_length-1,$.prev_length-=2;do if(++$.strstart<=q)$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+n0-1])&$.hash_mask,X=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart;while(--$.prev_length!==0);if($.match_available=0,$.match_length=n0-1,$.strstart++,K){if(B6($,!1),$.strm.avail_out===0)return G6}}else if($.match_available){if(K=s6._tr_tally($,0,$.window[$.strstart-1]),K)B6($,!1);if($.strstart++,$.lookahead--,$.strm.avail_out===0)return G6}else $.match_available=1,$.strstart++,$.lookahead--}if($.match_available)K=s6._tr_tally($,0,$.window[$.strstart-1]),$.match_available=0;if($.insert=$.strstart<n0-1?$.strstart:n0-1,J===O1){if(B6($,!0),$.strm.avail_out===0)return x1;return M5}if($.last_lit){if(B6($,!1),$.strm.avail_out===0)return G6}return E9}function AU($,J){var X,K,q,Y,W=$.window;for(;;){if($.lookahead<=H1){if(h1($),$.lookahead<=H1&&J===g1)return G6;if($.lookahead===0)break}if($.match_length=0,$.lookahead>=n0&&$.strstart>0){if(q=$.strstart-1,K=W[q],K===W[++q]&&K===W[++q]&&K===W[++q]){Y=$.strstart+H1;do;while(K===W[++q]&&K===W[++q]&&K===W[++q]&&K===W[++q]&&K===W[++q]&&K===W[++q]&&K===W[++q]&&K===W[++q]&&q<Y);if($.match_length=H1-(Y-q),$.match_length>$.lookahead)$.match_length=$.lookahead}}if($.match_length>=n0)X=s6._tr_tally($,1,$.match_length-n0),$.lookahead-=$.match_length,$.strstart+=$.match_length,$.match_length=0;else X=s6._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++;if(X){if(B6($,!1),$.strm.avail_out===0)return G6}}if($.insert=0,J===O1){if(B6($,!0),$.strm.avail_out===0)return x1;return M5}if($.last_lit){if(B6($,!1),$.strm.avail_out===0)return G6}return E9}function FU($,J){var X;for(;;){if($.lookahead===0){if(h1($),$.lookahead===0){if(J===g1)return G6;break}}if($.match_length=0,X=s6._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++,X){if(B6($,!1),$.strm.avail_out===0)return G6}}if($.insert=0,J===O1){if(B6($,!0),$.strm.avail_out===0)return x1;return M5}if($.last_lit){if(B6($,!1),$.strm.avail_out===0)return G6}return E9}function Z8($,J,X,K,q){this.good_length=$,this.max_lazy=J,this.nice_length=X,this.max_chain=K,this.func=q}var V5;V5=[new Z8(0,0,0,0,SU),new Z8(4,4,8,4,vJ),new Z8(4,5,16,8,vJ),new Z8(4,6,32,32,vJ),new Z8(4,4,16,16,N5),new Z8(8,16,32,32,N5),new Z8(8,16,128,128,N5),new Z8(8,32,128,256,N5),new Z8(32,128,258,1024,N5),new Z8(32,258,258,4096,N5)];function zU($){$.window_size=2*$.w_size,M1($.head),$.max_lazy_match=V5[$.level].max_lazy,$.good_match=V5[$.level].good_length,$.nice_match=V5[$.level].nice_length,$.max_chain_length=V5[$.level].max_chain,$.strstart=0,$.block_start=0,$.lookahead=0,$.insert=0,$.match_length=$.prev_length=n0-1,$.match_available=0,$.ins_h=0}function CU(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z$,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new D6.Buf16(jU*2),this.dyn_dtree=new D6.Buf16((2*UU+1)*2),this.bl_tree=new D6.Buf16((2*LU+1)*2),M1(this.dyn_ltree),M1(this.dyn_dtree),M1(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new D6.Buf16(EU+1),this.heap=new D6.Buf16(2*DJ+1),M1(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new D6.Buf16(2*DJ+1),M1(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function CY($){var J;if(!$||!$.state)return G1($,a6);if($.total_in=$.total_out=0,$.data_type=NU,J=$.state,J.pending=0,J.pending_out=0,J.wrap<0)J.wrap=-J.wrap;return J.status=J.wrap?v$:y1,$.adler=J.wrap===2?0:1,J.last_flush=g1,s6._tr_init(J),v8}function ZY($){var J=CY($);if(J===v8)zU($.state);return J}function ZU($,J){if(!$||!$.state)return a6;if($.state.wrap!==2)return a6;return $.state.gzhead=J,v8}function vY($,J,X,K,q,Y){if(!$)return a6;var W=1;if(J===KU)J=6;if(K<0)W=0,K=-K;else if(K>15)W=2,K-=16;if(q<1||q>VU||X!==Z$||K<8||K>15||J<0||J>9||Y<0||Y>WU)return G1($,a6);if(K===8)K=9;var Q=new CU;return $.state=Q,Q.strm=$,Q.wrap=W,Q.gzhead=null,Q.w_bits=K,Q.w_size=1<<Q.w_bits,Q.w_mask=Q.w_size-1,Q.hash_bits=q+7,Q.hash_size=1<<Q.hash_bits,Q.hash_mask=Q.hash_size-1,Q.hash_shift=~~((Q.hash_bits+n0-1)/n0),Q.window=new D6.Buf8(Q.w_size*2),Q.head=new D6.Buf16(Q.hash_size),Q.prev=new D6.Buf16(Q.w_size),Q.lit_bufsize=1<<q+6,Q.pending_buf_size=Q.lit_bufsize*4,Q.pending_buf=new D6.Buf8(Q.pending_buf_size),Q.d_buf=1*Q.lit_bufsize,Q.l_buf=3*Q.lit_bufsize,Q.level=J,Q.strategy=Y,Q.method=X,ZY($)}function vU($,J){return vY($,J,Z$,MU,HU,QU)}function DU($,J){var X,K,q,Y;if(!$||!$.state||J>PY||J<0)return $?G1($,a6):a6;if(K=$.state,!$.output||!$.input&&$.avail_in!==0||K.status===j9&&J!==O1)return G1($,$.avail_out===0?ZJ:a6);if(K.strm=$,X=K.last_flush,K.last_flush=J,K.status===v$)if(K.wrap===2)if($.adler=0,o0(K,31),o0(K,139),o0(K,8),!K.gzhead)o0(K,0),o0(K,0),o0(K,0),o0(K,0),o0(K,0),o0(K,K.level===9?2:K.strategy>=A$||K.level<2?4:0),o0(K,BU),K.status=y1;else{if(o0(K,(K.gzhead.text?1:0)+(K.gzhead.hcrc?2:0)+(!K.gzhead.extra?0:4)+(!K.gzhead.name?0:8)+(!K.gzhead.comment?0:16)),o0(K,K.gzhead.time&255),o0(K,K.gzhead.time>>8&255),o0(K,K.gzhead.time>>16&255),o0(K,K.gzhead.time>>24&255),o0(K,K.level===9?2:K.strategy>=A$||K.level<2?4:0),o0(K,K.gzhead.os&255),K.gzhead.extra&&K.gzhead.extra.length)o0(K,K.gzhead.extra.length&255),o0(K,K.gzhead.extra.length>>8&255);if(K.gzhead.hcrc)$.adler=N1($.adler,K.pending_buf,K.pending,0);K.gzindex=0,K.status=kJ}else{var W=Z$+(K.w_bits-8<<4)<<8,Q=-1;if(K.strategy>=A$||K.level<2)Q=0;else if(K.level<6)Q=1;else if(K.level===6)Q=2;else Q=3;if(W|=Q<<6,K.strstart!==0)W|=RU;if(W+=31-W%31,K.status=y1,L9(K,W),K.strstart!==0)L9(K,$.adler>>>16),L9(K,$.adler&65535);$.adler=1}if(K.status===kJ)if(K.gzhead.extra){q=K.pending;while(K.gzindex<(K.gzhead.extra.length&65535)){if(K.pending===K.pending_buf_size){if(K.gzhead.hcrc&&K.pending>q)$.adler=N1($.adler,K.pending_buf,K.pending-q,q);if(V1($),q=K.pending,K.pending===K.pending_buf_size)break}o0(K,K.gzhead.extra[K.gzindex]&255),K.gzindex++}if(K.gzhead.hcrc&&K.pending>q)$.adler=N1($.adler,K.pending_buf,K.pending-q,q);if(K.gzindex===K.gzhead.extra.length)K.gzindex=0,K.status=F$}else K.status=F$;if(K.status===F$)if(K.gzhead.name){q=K.pending;do{if(K.pending===K.pending_buf_size){if(K.gzhead.hcrc&&K.pending>q)$.adler=N1($.adler,K.pending_buf,K.pending-q,q);if(V1($),q=K.pending,K.pending===K.pending_buf_size){Y=1;break}}if(K.gzindex<K.gzhead.name.length)Y=K.gzhead.name.charCodeAt(K.gzindex++)&255;else Y=0;o0(K,Y)}while(Y!==0);if(K.gzhead.hcrc&&K.pending>q)$.adler=N1($.adler,K.pending_buf,K.pending-q,q);if(Y===0)K.gzindex=0,K.status=z$}else K.status=z$;if(K.status===z$)if(K.gzhead.comment){q=K.pending;do{if(K.pending===K.pending_buf_size){if(K.gzhead.hcrc&&K.pending>q)$.adler=N1($.adler,K.pending_buf,K.pending-q,q);if(V1($),q=K.pending,K.pending===K.pending_buf_size){Y=1;break}}if(K.gzindex<K.gzhead.comment.length)Y=K.gzhead.comment.charCodeAt(K.gzindex++)&255;else Y=0;o0(K,Y)}while(Y!==0);if(K.gzhead.hcrc&&K.pending>q)$.adler=N1($.adler,K.pending_buf,K.pending-q,q);if(Y===0)K.status=C$}else K.status=C$;if(K.status===C$)if(K.gzhead.hcrc){if(K.pending+2>K.pending_buf_size)V1($);if(K.pending+2<=K.pending_buf_size)o0(K,$.adler&255),o0(K,$.adler>>8&255),$.adler=0,K.status=y1}else K.status=y1;if(K.pending!==0){if(V1($),$.avail_out===0)return K.last_flush=-1,v8}else if($.avail_in===0&&AY(J)<=AY(X)&&J!==O1)return G1($,ZJ);if(K.status===j9&&$.avail_in!==0)return G1($,ZJ);if($.avail_in!==0||K.lookahead!==0||J!==g1&&K.status!==j9){var N=K.strategy===A$?FU(K,J):K.strategy===YU?AU(K,J):V5[K.level].func(K,J);if(N===x1||N===M5)K.status=j9;if(N===G6||N===x1){if($.avail_out===0)K.last_flush=-1;return v8}if(N===E9){if(J===$U)s6._tr_align(K);else if(J!==PY){if(s6._tr_stored_block(K,0,0,!1),J===JU){if(M1(K.head),K.lookahead===0)K.strstart=0,K.block_start=0,K.insert=0}}if(V1($),$.avail_out===0)return K.last_flush=-1,v8}}if(J!==O1)return v8;if(K.wrap<=0)return SY;if(K.wrap===2)o0(K,$.adler&255),o0(K,$.adler>>8&255),o0(K,$.adler>>16&255),o0(K,$.adler>>24&255),o0(K,$.total_in&255),o0(K,$.total_in>>8&255),o0(K,$.total_in>>16&255),o0(K,$.total_in>>24&255);else L9(K,$.adler>>>16),L9(K,$.adler&65535);if(V1($),K.wrap>0)K.wrap=-K.wrap;return K.pending!==0?v8:SY}function kU($){var J;if(!$||!$.state)return a6;if(J=$.state.status,J!==v$&&J!==kJ&&J!==F$&&J!==z$&&J!==C$&&J!==y1&&J!==j9)return G1($,a6);return $.state=null,J===y1?G1($,XU):v8}function wU($,J){var X=J.length,K,q,Y,W,Q,N,V,M;if(!$||!$.state)return a6;if(K=$.state,W=K.wrap,W===2||W===1&&K.status!==v$||K.lookahead)return a6;if(W===1)$.adler=FY($.adler,J,X,0);if(K.wrap=0,X>=K.w_size){if(W===0)M1(K.head),K.strstart=0,K.block_start=0,K.insert=0;M=new D6.Buf8(K.w_size),D6.arraySet(M,J,X-K.w_size,K.w_size,0),J=M,X=K.w_size}Q=$.avail_in,N=$.next_in,V=$.input,$.avail_in=X,$.next_in=0,$.input=J,h1(K);while(K.lookahead>=n0){q=K.strstart,Y=K.lookahead-(n0-1);do K.ins_h=(K.ins_h<<K.hash_shift^K.window[q+n0-1])&K.hash_mask,K.prev[q&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=q,q++;while(--Y);K.strstart=q,K.lookahead=n0-1,h1(K)}return K.strstart+=K.lookahead,K.block_start=K.strstart,K.insert=K.lookahead,K.lookahead=0,K.match_length=K.prev_length=n0-1,K.match_available=0,$.next_in=N,$.input=V,$.avail_in=Q,K.wrap=W,v8}TU.deflateInit=vU;TU.deflateInit2=vY;TU.deflateReset=ZY;TU.deflateResetKeep=CY;TU.deflateSetHeader=ZU;TU.deflate=DU;TU.deflateEnd=kU;TU.deflateSetDictionary=wU;TU.deflateInfo="pako deflate (from Nodeca project)"});var wJ=L0((pU)=>{var D$=c8(),kY=!0,wY=!0;try{String.fromCharCode.apply(null,[0])}catch($){kY=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch($){wY=!1}var R9=new D$.Buf8(256);for(D8=0;D8<256;D8++)R9[D8]=D8>=252?6:D8>=248?5:D8>=240?4:D8>=224?3:D8>=192?2:1;var D8;R9[254]=R9[254]=1;pU.string2buf=function($){var J,X,K,q,Y,W=$.length,Q=0;for(q=0;q<W;q++){if(X=$.charCodeAt(q),(X&64512)===55296&&q+1<W){if(K=$.charCodeAt(q+1),(K&64512)===56320)X=65536+(X-55296<<10)+(K-56320),q++}Q+=X<128?1:X<2048?2:X<65536?3:4}J=new D$.Buf8(Q);for(Y=0,q=0;Y<Q;q++){if(X=$.charCodeAt(q),(X&64512)===55296&&q+1<W){if(K=$.charCodeAt(q+1),(K&64512)===56320)X=65536+(X-55296<<10)+(K-56320),q++}if(X<128)J[Y++]=X;else if(X<2048)J[Y++]=192|X>>>6,J[Y++]=128|X&63;else if(X<65536)J[Y++]=224|X>>>12,J[Y++]=128|X>>>6&63,J[Y++]=128|X&63;else J[Y++]=240|X>>>18,J[Y++]=128|X>>>12&63,J[Y++]=128|X>>>6&63,J[Y++]=128|X&63}return J};function TY($,J){if(J<65534){if($.subarray&&wY||!$.subarray&&kY)return String.fromCharCode.apply(null,D$.shrinkBuf($,J))}var X="";for(var K=0;K<J;K++)X+=String.fromCharCode($[K]);return X}pU.buf2binstring=function($){return TY($,$.length)};pU.binstring2buf=function($){var J=new D$.Buf8($.length);for(var X=0,K=J.length;X<K;X++)J[X]=$.charCodeAt(X);return J};pU.buf2string=function($,J){var X,K,q,Y,W=J||$.length,Q=Array(W*2);for(K=0,X=0;X<W;){if(q=$[X++],q<128){Q[K++]=q;continue}if(Y=R9[q],Y>4){Q[K++]=65533,X+=Y-1;continue}q&=Y===2?31:Y===3?15:7;while(Y>1&&X<W)q=q<<6|$[X++]&63,Y--;if(Y>1){Q[K++]=65533;continue}if(q<65536)Q[K++]=q;else q-=65536,Q[K++]=55296|q>>10&1023,Q[K++]=56320|q&1023}return TY(Q,K)};pU.utf8border=function($,J){var X;if(J=J||$.length,J>$.length)J=$.length;X=J-1;while(X>=0&&($[X]&192)===128)X--;if(X<0)return J;if(X===0)return J;return X+R9[$[X]]>J?X:J}});var TJ=L0((ZF,IY)=>{function oU(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}IY.exports=oU});var hY=L0((JL)=>{var B9=DY(),P9=c8(),_J=wJ(),yJ=S$(),rU=TJ(),xY=Object.prototype.toString,iU=0,IJ=4,H5=0,_Y=1,yY=2,sU=-1,aU=0,tU=8;function f1($){if(!(this instanceof f1))return new f1($);this.options=P9.assign({level:sU,method:tU,chunkSize:16384,windowBits:15,memLevel:8,strategy:aU,to:""},$||{});var J=this.options;if(J.raw&&J.windowBits>0)J.windowBits=-J.windowBits;else if(J.gzip&&J.windowBits>0&&J.windowBits<16)J.windowBits+=16;this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new rU,this.strm.avail_out=0;var X=B9.deflateInit2(this.strm,J.level,J.method,J.windowBits,J.memLevel,J.strategy);if(X!==H5)throw Error(yJ[X]);if(J.header)B9.deflateSetHeader(this.strm,J.header);if(J.dictionary){var K;if(typeof J.dictionary==="string")K=_J.string2buf(J.dictionary);else if(xY.call(J.dictionary)==="[object ArrayBuffer]")K=new Uint8Array(J.dictionary);else K=J.dictionary;if(X=B9.deflateSetDictionary(this.strm,K),X!==H5)throw Error(yJ[X]);this._dict_set=!0}}f1.prototype.push=function($,J){var X=this.strm,K=this.options.chunkSize,q,Y;if(this.ended)return!1;if(Y=J===~~J?J:J===!0?IJ:iU,typeof $==="string")X.input=_J.string2buf($);else if(xY.call($)==="[object ArrayBuffer]")X.input=new Uint8Array($);else X.input=$;X.next_in=0,X.avail_in=X.input.length;do{if(X.avail_out===0)X.output=new P9.Buf8(K),X.next_out=0,X.avail_out=K;if(q=B9.deflate(X,Y),q!==_Y&&q!==H5)return this.onEnd(q),this.ended=!0,!1;if(X.avail_out===0||X.avail_in===0&&(Y===IJ||Y===yY))if(this.options.to==="string")this.onData(_J.buf2binstring(P9.shrinkBuf(X.output,X.next_out)));else this.onData(P9.shrinkBuf(X.output,X.next_out))}while((X.avail_in>0||X.avail_out===0)&&q!==_Y);if(Y===IJ)return q=B9.deflateEnd(this.strm),this.onEnd(q),this.ended=!0,q===H5;if(Y===yY)return this.onEnd(H5),X.avail_out=0,!0;return!0};f1.prototype.onData=function($){this.chunks.push($)};f1.prototype.onEnd=function($){if($===H5)if(this.options.to==="string")this.result=this.chunks.join("");else this.result=P9.flattenChunks(this.chunks);this.chunks=[],this.err=$,this.msg=this.strm.msg};function xJ($,J){var X=new f1(J);if(X.push($,!0),X.err)throw X.msg||yJ[X.err];return X.result}function eU($,J){return J=J||{},J.raw=!0,xJ($,J)}function $L($,J){return J=J||{},J.gzip=!0,xJ($,J)}JL.Deflate=f1;JL.deflate=xJ;JL.deflateRaw=eU;JL.gzip=$L});var fY=L0((DF,gY)=>{var k$=30,WL=12;gY.exports=function(J,X){var K,q,Y,W,Q,N,V,M,H,G,O,L,E,j,B,S,A,z,P,R,U,Z,w,h,F;K=J.state,q=J.next_in,h=J.input,Y=q+(J.avail_in-5),W=J.next_out,F=J.output,Q=W-(X-J.avail_out),N=W+(J.avail_out-257),V=K.dmax,M=K.wsize,H=K.whave,G=K.wnext,O=K.window,L=K.hold,E=K.bits,j=K.lencode,B=K.distcode,S=(1<<K.lenbits)-1,A=(1<<K.distbits)-1;$:do{if(E<15)L+=h[q++]<<E,E+=8,L+=h[q++]<<E,E+=8;z=j[L&S];J:for(;;){if(P=z>>>24,L>>>=P,E-=P,P=z>>>16&255,P===0)F[W++]=z&65535;else if(P&16){if(R=z&65535,P&=15,P){if(E<P)L+=h[q++]<<E,E+=8;R+=L&(1<<P)-1,L>>>=P,E-=P}if(E<15)L+=h[q++]<<E,E+=8,L+=h[q++]<<E,E+=8;z=B[L&A];X:for(;;){if(P=z>>>24,L>>>=P,E-=P,P=z>>>16&255,P&16){if(U=z&65535,P&=15,E<P){if(L+=h[q++]<<E,E+=8,E<P)L+=h[q++]<<E,E+=8}if(U+=L&(1<<P)-1,U>V){J.msg="invalid distance too far back",K.mode=k$;break $}if(L>>>=P,E-=P,P=W-Q,U>P){if(P=U-P,P>H){if(K.sane){J.msg="invalid distance too far back",K.mode=k$;break $}}if(Z=0,w=O,G===0){if(Z+=M-P,P<R){R-=P;do F[W++]=O[Z++];while(--P);Z=W-U,w=F}}else if(G<P){if(Z+=M+G-P,P-=G,P<R){R-=P;do F[W++]=O[Z++];while(--P);if(Z=0,G<R){P=G,R-=P;do F[W++]=O[Z++];while(--P);Z=W-U,w=F}}}else if(Z+=G-P,P<R){R-=P;do F[W++]=O[Z++];while(--P);Z=W-U,w=F}while(R>2)F[W++]=w[Z++],F[W++]=w[Z++],F[W++]=w[Z++],R-=3;if(R){if(F[W++]=w[Z++],R>1)F[W++]=w[Z++]}}else{Z=W-U;do F[W++]=F[Z++],F[W++]=F[Z++],F[W++]=F[Z++],R-=3;while(R>2);if(R){if(F[W++]=F[Z++],R>1)F[W++]=F[Z++]}}}else if((P&64)===0){z=B[(z&65535)+(L&(1<<P)-1)];continue X}else{J.msg="invalid distance code",K.mode=k$;break $}break}}else if((P&64)===0){z=j[(z&65535)+(L&(1<<P)-1)];continue J}else if(P&32){K.mode=WL;break $}else{J.msg="invalid literal/length code",K.mode=k$;break $}break}}while(q<Y&&W<N);R=E>>3,q-=R,E-=R<<3,L&=(1<<E)-1,J.next_in=q,J.next_out=W,J.avail_in=q<Y?5+(Y-q):5-(q-Y),J.avail_out=W<N?257+(N-W):257-(W-N),K.hold=L,K.bits=E;return}});var dY=L0((kF,cY)=>{var bY=c8(),G5=15,mY=852,pY=592,uY=0,hJ=1,lY=2,QL=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],NL=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],VL=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],ML=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];cY.exports=function(J,X,K,q,Y,W,Q,N){var V=N.bits,M=0,H=0,G=0,O=0,L=0,E=0,j=0,B=0,S=0,A=0,z,P,R,U,Z,w=null,h=0,F,C=new bY.Buf16(G5+1),D=new bY.Buf16(G5+1),T=null,x=0,y,b,_;for(M=0;M<=G5;M++)C[M]=0;for(H=0;H<q;H++)C[X[K+H]]++;L=V;for(O=G5;O>=1;O--)if(C[O]!==0)break;if(L>O)L=O;if(O===0)return Y[W++]=20971520,Y[W++]=20971520,N.bits=1,0;for(G=1;G<O;G++)if(C[G]!==0)break;if(L<G)L=G;B=1;for(M=1;M<=G5;M++)if(B<<=1,B-=C[M],B<0)return-1;if(B>0&&(J===uY||O!==1))return-1;D[1]=0;for(M=1;M<G5;M++)D[M+1]=D[M]+C[M];for(H=0;H<q;H++)if(X[K+H]!==0)Q[D[X[K+H]]++]=H;if(J===uY)w=T=Q,F=19;else if(J===hJ)w=QL,h-=257,T=NL,x-=257,F=256;else w=VL,T=ML,F=-1;if(A=0,H=0,M=G,Z=W,E=L,j=0,R=-1,S=1<<L,U=S-1,J===hJ&&S>mY||J===lY&&S>pY)return 1;for(;;){if(y=M-j,Q[H]<F)b=0,_=Q[H];else if(Q[H]>F)b=T[x+Q[H]],_=w[h+Q[H]];else b=96,_=0;z=1<<M-j,P=1<<E,G=P;do P-=z,Y[Z+(A>>j)+P]=y<<24|b<<16|_|0;while(P!==0);z=1<<M-1;while(A&z)z>>=1;if(z!==0)A&=z-1,A+=z;else A=0;if(H++,--C[M]===0){if(M===O)break;M=X[K+Q[H]]}if(M>L&&(A&U)!==R){if(j===0)j=L;Z+=G,E=M-j,B=1<<E;while(E+j<O){if(B-=C[E+j],B<=0)break;E++,B<<=1}if(S+=1<<E,J===hJ&&S>mY||J===lY&&S>pY)return 1;R=A&U,Y[R]=L<<24|E<<16|Z-W|0}}if(A!==0)Y[Z+A]=M-j<<24|4194304|0;return N.bits=L,0}});var ZW=L0((kL)=>{var m6=c8(),uJ=zJ(),k8=CJ(),HL=fY(),S9=dY(),GL=0,EW=1,RW=2,nY=4,OL=5,w$=6,b1=0,UL=1,LL=2,t6=-2,BW=-3,lJ=-4,jL=-5,oY=8,PW=1,rY=2,iY=3,sY=4,aY=5,tY=6,eY=7,$W=8,JW=9,XW=10,_$=11,n8=12,gJ=13,KW=14,fJ=15,qW=16,YW=17,WW=18,QW=19,T$=20,I$=21,NW=22,VW=23,MW=24,HW=25,GW=26,bJ=27,OW=28,UW=29,X6=30,cJ=31,EL=32,RL=852,BL=592,PL=15,SL=PL;function LW($){return($>>>24&255)+($>>>8&65280)+(($&65280)<<8)+(($&255)<<24)}function AL(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new m6.Buf16(320),this.work=new m6.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function SW($){var J;if(!$||!$.state)return t6;if(J=$.state,$.total_in=$.total_out=J.total=0,$.msg="",J.wrap)$.adler=J.wrap&1;return J.mode=PW,J.last=0,J.havedict=0,J.dmax=32768,J.head=null,J.hold=0,J.bits=0,J.lencode=J.lendyn=new m6.Buf32(RL),J.distcode=J.distdyn=new m6.Buf32(BL),J.sane=1,J.back=-1,b1}function AW($){var J;if(!$||!$.state)return t6;return J=$.state,J.wsize=0,J.whave=0,J.wnext=0,SW($)}function FW($,J){var X,K;if(!$||!$.state)return t6;if(K=$.state,J<0)X=0,J=-J;else if(X=(J>>4)+1,J<48)J&=15;if(J&&(J<8||J>15))return t6;if(K.window!==null&&K.wbits!==J)K.window=null;return K.wrap=X,K.wbits=J,AW($)}function zW($,J){var X,K;if(!$)return t6;if(K=new AL,$.state=K,K.window=null,X=FW($,J),X!==b1)$.state=null;return X}function FL($){return zW($,SL)}var jW=!0,mJ,pJ;function zL($){if(jW){var J;mJ=new m6.Buf32(512),pJ=new m6.Buf32(32),J=0;while(J<144)$.lens[J++]=8;while(J<256)$.lens[J++]=9;while(J<280)$.lens[J++]=7;while(J<288)$.lens[J++]=8;S9(EW,$.lens,0,288,mJ,0,$.work,{bits:9}),J=0;while(J<32)$.lens[J++]=5;S9(RW,$.lens,0,32,pJ,0,$.work,{bits:5}),jW=!1}$.lencode=mJ,$.lenbits=9,$.distcode=pJ,$.distbits=5}function CW($,J,X,K){var q,Y=$.state;if(Y.window===null)Y.wsize=1<<Y.wbits,Y.wnext=0,Y.whave=0,Y.window=new m6.Buf8(Y.wsize);if(K>=Y.wsize)m6.arraySet(Y.window,J,X-Y.wsize,Y.wsize,0),Y.wnext=0,Y.whave=Y.wsize;else{if(q=Y.wsize-Y.wnext,q>K)q=K;if(m6.arraySet(Y.window,J,X-K,q,Y.wnext),K-=q,K)m6.arraySet(Y.window,J,X-K,K,0),Y.wnext=K,Y.whave=Y.wsize;else{if(Y.wnext+=q,Y.wnext===Y.wsize)Y.wnext=0;if(Y.whave<Y.wsize)Y.whave+=q}}return 0}function CL($,J){var X,K,q,Y,W,Q,N,V,M,H,G,O,L,E,j=0,B,S,A,z,P,R,U,Z,w=new m6.Buf8(4),h,F,C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!$||!$.state||!$.output||!$.input&&$.avail_in!==0)return t6;if(X=$.state,X.mode===n8)X.mode=gJ;W=$.next_out,q=$.output,N=$.avail_out,Y=$.next_in,K=$.input,Q=$.avail_in,V=X.hold,M=X.bits,H=Q,G=N,Z=b1;$:for(;;)switch(X.mode){case PW:if(X.wrap===0){X.mode=gJ;break}while(M<16){if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}if(X.wrap&2&&V===35615){X.check=0,w[0]=V&255,w[1]=V>>>8&255,X.check=k8(X.check,w,2,0),V=0,M=0,X.mode=rY;break}if(X.flags=0,X.head)X.head.done=!1;if(!(X.wrap&1)||(((V&255)<<8)+(V>>8))%31){$.msg="incorrect header check",X.mode=X6;break}if((V&15)!==oY){$.msg="unknown compression method",X.mode=X6;break}if(V>>>=4,M-=4,U=(V&15)+8,X.wbits===0)X.wbits=U;else if(U>X.wbits){$.msg="invalid window size",X.mode=X6;break}X.dmax=1<<U,$.adler=X.check=1,X.mode=V&512?XW:n8,V=0,M=0;break;case rY:while(M<16){if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}if(X.flags=V,(X.flags&255)!==oY){$.msg="unknown compression method",X.mode=X6;break}if(X.flags&57344){$.msg="unknown header flags set",X.mode=X6;break}if(X.head)X.head.text=V>>8&1;if(X.flags&512)w[0]=V&255,w[1]=V>>>8&255,X.check=k8(X.check,w,2,0);V=0,M=0,X.mode=iY;case iY:while(M<32){if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}if(X.head)X.head.time=V;if(X.flags&512)w[0]=V&255,w[1]=V>>>8&255,w[2]=V>>>16&255,w[3]=V>>>24&255,X.check=k8(X.check,w,4,0);V=0,M=0,X.mode=sY;case sY:while(M<16){if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}if(X.head)X.head.xflags=V&255,X.head.os=V>>8;if(X.flags&512)w[0]=V&255,w[1]=V>>>8&255,X.check=k8(X.check,w,2,0);V=0,M=0,X.mode=aY;case aY:if(X.flags&1024){while(M<16){if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}if(X.length=V,X.head)X.head.extra_len=V;if(X.flags&512)w[0]=V&255,w[1]=V>>>8&255,X.check=k8(X.check,w,2,0);V=0,M=0}else if(X.head)X.head.extra=null;X.mode=tY;case tY:if(X.flags&1024){if(O=X.length,O>Q)O=Q;if(O){if(X.head){if(U=X.head.extra_len-X.length,!X.head.extra)X.head.extra=Array(X.head.extra_len);m6.arraySet(X.head.extra,K,Y,O,U)}if(X.flags&512)X.check=k8(X.check,K,O,Y);Q-=O,Y+=O,X.length-=O}if(X.length)break $}X.length=0,X.mode=eY;case eY:if(X.flags&2048){if(Q===0)break $;O=0;do if(U=K[Y+O++],X.head&&U&&X.length<65536)X.head.name+=String.fromCharCode(U);while(U&&O<Q);if(X.flags&512)X.check=k8(X.check,K,O,Y);if(Q-=O,Y+=O,U)break $}else if(X.head)X.head.name=null;X.length=0,X.mode=$W;case $W:if(X.flags&4096){if(Q===0)break $;O=0;do if(U=K[Y+O++],X.head&&U&&X.length<65536)X.head.comment+=String.fromCharCode(U);while(U&&O<Q);if(X.flags&512)X.check=k8(X.check,K,O,Y);if(Q-=O,Y+=O,U)break $}else if(X.head)X.head.comment=null;X.mode=JW;case JW:if(X.flags&512){while(M<16){if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}if(V!==(X.check&65535)){$.msg="header crc mismatch",X.mode=X6;break}V=0,M=0}if(X.head)X.head.hcrc=X.flags>>9&1,X.head.done=!0;$.adler=X.check=0,X.mode=n8;break;case XW:while(M<32){if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}$.adler=X.check=LW(V),V=0,M=0,X.mode=_$;case _$:if(X.havedict===0)return $.next_out=W,$.avail_out=N,$.next_in=Y,$.avail_in=Q,X.hold=V,X.bits=M,LL;$.adler=X.check=1,X.mode=n8;case n8:if(J===OL||J===w$)break $;case gJ:if(X.last){V>>>=M&7,M-=M&7,X.mode=bJ;break}while(M<3){if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}switch(X.last=V&1,V>>>=1,M-=1,V&3){case 0:X.mode=KW;break;case 1:if(zL(X),X.mode=T$,J===w$){V>>>=2,M-=2;break $}break;case 2:X.mode=YW;break;case 3:$.msg="invalid block type",X.mode=X6}V>>>=2,M-=2;break;case KW:V>>>=M&7,M-=M&7;while(M<32){if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}if((V&65535)!==(V>>>16^65535)){$.msg="invalid stored block lengths",X.mode=X6;break}if(X.length=V&65535,V=0,M=0,X.mode=fJ,J===w$)break $;case fJ:X.mode=qW;case qW:if(O=X.length,O){if(O>Q)O=Q;if(O>N)O=N;if(O===0)break $;m6.arraySet(q,K,Y,O,W),Q-=O,Y+=O,N-=O,W+=O,X.length-=O;break}X.mode=n8;break;case YW:while(M<14){if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}if(X.nlen=(V&31)+257,V>>>=5,M-=5,X.ndist=(V&31)+1,V>>>=5,M-=5,X.ncode=(V&15)+4,V>>>=4,M-=4,X.nlen>286||X.ndist>30){$.msg="too many length or distance symbols",X.mode=X6;break}X.have=0,X.mode=WW;case WW:while(X.have<X.ncode){while(M<3){if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}X.lens[C[X.have++]]=V&7,V>>>=3,M-=3}while(X.have<19)X.lens[C[X.have++]]=0;if(X.lencode=X.lendyn,X.lenbits=7,h={bits:X.lenbits},Z=S9(GL,X.lens,0,19,X.lencode,0,X.work,h),X.lenbits=h.bits,Z){$.msg="invalid code lengths set",X.mode=X6;break}X.have=0,X.mode=QW;case QW:while(X.have<X.nlen+X.ndist){for(;;){if(j=X.lencode[V&(1<<X.lenbits)-1],B=j>>>24,S=j>>>16&255,A=j&65535,B<=M)break;if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}if(A<16)V>>>=B,M-=B,X.lens[X.have++]=A;else{if(A===16){F=B+2;while(M<F){if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}if(V>>>=B,M-=B,X.have===0){$.msg="invalid bit length repeat",X.mode=X6;break}U=X.lens[X.have-1],O=3+(V&3),V>>>=2,M-=2}else if(A===17){F=B+3;while(M<F){if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}V>>>=B,M-=B,U=0,O=3+(V&7),V>>>=3,M-=3}else{F=B+7;while(M<F){if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}V>>>=B,M-=B,U=0,O=11+(V&127),V>>>=7,M-=7}if(X.have+O>X.nlen+X.ndist){$.msg="invalid bit length repeat",X.mode=X6;break}while(O--)X.lens[X.have++]=U}}if(X.mode===X6)break;if(X.lens[256]===0){$.msg="invalid code -- missing end-of-block",X.mode=X6;break}if(X.lenbits=9,h={bits:X.lenbits},Z=S9(EW,X.lens,0,X.nlen,X.lencode,0,X.work,h),X.lenbits=h.bits,Z){$.msg="invalid literal/lengths set",X.mode=X6;break}if(X.distbits=6,X.distcode=X.distdyn,h={bits:X.distbits},Z=S9(RW,X.lens,X.nlen,X.ndist,X.distcode,0,X.work,h),X.distbits=h.bits,Z){$.msg="invalid distances set",X.mode=X6;break}if(X.mode=T$,J===w$)break $;case T$:X.mode=I$;case I$:if(Q>=6&&N>=258){if($.next_out=W,$.avail_out=N,$.next_in=Y,$.avail_in=Q,X.hold=V,X.bits=M,HL($,G),W=$.next_out,q=$.output,N=$.avail_out,Y=$.next_in,K=$.input,Q=$.avail_in,V=X.hold,M=X.bits,X.mode===n8)X.back=-1;break}X.back=0;for(;;){if(j=X.lencode[V&(1<<X.lenbits)-1],B=j>>>24,S=j>>>16&255,A=j&65535,B<=M)break;if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}if(S&&(S&240)===0){z=B,P=S,R=A;for(;;){if(j=X.lencode[R+((V&(1<<z+P)-1)>>z)],B=j>>>24,S=j>>>16&255,A=j&65535,z+B<=M)break;if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}V>>>=z,M-=z,X.back+=z}if(V>>>=B,M-=B,X.back+=B,X.length=A,S===0){X.mode=GW;break}if(S&32){X.back=-1,X.mode=n8;break}if(S&64){$.msg="invalid literal/length code",X.mode=X6;break}X.extra=S&15,X.mode=NW;case NW:if(X.extra){F=X.extra;while(M<F){if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}X.length+=V&(1<<X.extra)-1,V>>>=X.extra,M-=X.extra,X.back+=X.extra}X.was=X.length,X.mode=VW;case VW:for(;;){if(j=X.distcode[V&(1<<X.distbits)-1],B=j>>>24,S=j>>>16&255,A=j&65535,B<=M)break;if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}if((S&240)===0){z=B,P=S,R=A;for(;;){if(j=X.distcode[R+((V&(1<<z+P)-1)>>z)],B=j>>>24,S=j>>>16&255,A=j&65535,z+B<=M)break;if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}V>>>=z,M-=z,X.back+=z}if(V>>>=B,M-=B,X.back+=B,S&64){$.msg="invalid distance code",X.mode=X6;break}X.offset=A,X.extra=S&15,X.mode=MW;case MW:if(X.extra){F=X.extra;while(M<F){if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}X.offset+=V&(1<<X.extra)-1,V>>>=X.extra,M-=X.extra,X.back+=X.extra}if(X.offset>X.dmax){$.msg="invalid distance too far back",X.mode=X6;break}X.mode=HW;case HW:if(N===0)break $;if(O=G-N,X.offset>O){if(O=X.offset-O,O>X.whave){if(X.sane){$.msg="invalid distance too far back",X.mode=X6;break}}if(O>X.wnext)O-=X.wnext,L=X.wsize-O;else L=X.wnext-O;if(O>X.length)O=X.length;E=X.window}else E=q,L=W-X.offset,O=X.length;if(O>N)O=N;N-=O,X.length-=O;do q[W++]=E[L++];while(--O);if(X.length===0)X.mode=I$;break;case GW:if(N===0)break $;q[W++]=X.length,N--,X.mode=I$;break;case bJ:if(X.wrap){while(M<32){if(Q===0)break $;Q--,V|=K[Y++]<<M,M+=8}if(G-=N,$.total_out+=G,X.total+=G,G)$.adler=X.check=X.flags?k8(X.check,q,G,W-G):uJ(X.check,q,G,W-G);if(G=N,(X.flags?V:LW(V))!==X.check){$.msg="incorrect data check",X.mode=X6;break}V=0,M=0}X.mode=OW;case OW:if(X.wrap&&X.flags){while(M<32){if(Q===0)break $;Q--,V+=K[Y++]<<M,M+=8}if(V!==(X.total&4294967295)){$.msg="incorrect length check",X.mode=X6;break}V=0,M=0}X.mode=UW;case UW:Z=UL;break $;case X6:Z=BW;break $;case cJ:return lJ;case EL:default:return t6}if($.next_out=W,$.avail_out=N,$.next_in=Y,$.avail_in=Q,X.hold=V,X.bits=M,X.wsize||G!==$.avail_out&&X.mode<X6&&(X.mode<bJ||J!==nY)){if(CW($,$.output,$.next_out,G-$.avail_out))return X.mode=cJ,lJ}if(H-=$.avail_in,G-=$.avail_out,$.total_in+=H,$.total_out+=G,X.total+=G,X.wrap&&G)$.adler=X.check=X.flags?k8(X.check,q,G,$.next_out-G):uJ(X.check,q,G,$.next_out-G);if($.data_type=X.bits+(X.last?64:0)+(X.mode===n8?128:0)+(X.mode===T$||X.mode===fJ?256:0),(H===0&&G===0||J===nY)&&Z===b1)Z=jL;return Z}function ZL($){if(!$||!$.state)return t6;var J=$.state;if(J.window)J.window=null;return $.state=null,b1}function vL($,J){var X;if(!$||!$.state)return t6;if(X=$.state,(X.wrap&2)===0)return t6;return X.head=J,J.done=!1,b1}function DL($,J){var X=J.length,K,q,Y;if(!$||!$.state)return t6;if(K=$.state,K.wrap!==0&&K.mode!==_$)return t6;if(K.mode===_$){if(q=1,q=uJ(q,J,X,0),q!==K.check)return BW}if(Y=CW($,J,X,X),Y)return K.mode=cJ,lJ;return K.havedict=1,b1}kL.inflateReset=AW;kL.inflateReset2=FW;kL.inflateResetKeep=SW;kL.inflateInit=FL;kL.inflateInit2=zW;kL.inflate=CL;kL.inflateEnd=ZL;kL.inflateGetHeader=vL;kL.inflateSetDictionary=DL;kL.inflateInfo="pako inflate (from Nodeca project)"});var dJ=L0((TF,vW)=>{vW.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var kW=L0((IF,DW)=>{function mL(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}DW.exports=mL});var TW=L0((cL)=>{var O5=ZW(),A9=c8(),y$=wJ(),V6=dJ(),nJ=S$(),pL=TJ(),uL=kW(),wW=Object.prototype.toString;function m1($){if(!(this instanceof m1))return new m1($);this.options=A9.assign({chunkSize:16384,windowBits:0,to:""},$||{});var J=this.options;if(J.raw&&J.windowBits>=0&&J.windowBits<16){if(J.windowBits=-J.windowBits,J.windowBits===0)J.windowBits=-15}if(J.windowBits>=0&&J.windowBits<16&&!($&&$.windowBits))J.windowBits+=32;if(J.windowBits>15&&J.windowBits<48){if((J.windowBits&15)===0)J.windowBits|=15}this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new pL,this.strm.avail_out=0;var X=O5.inflateInit2(this.strm,J.windowBits);if(X!==V6.Z_OK)throw Error(nJ[X]);if(this.header=new uL,O5.inflateGetHeader(this.strm,this.header),J.dictionary){if(typeof J.dictionary==="string")J.dictionary=y$.string2buf(J.dictionary);else if(wW.call(J.dictionary)==="[object ArrayBuffer]")J.dictionary=new Uint8Array(J.dictionary);if(J.raw){if(X=O5.inflateSetDictionary(this.strm,J.dictionary),X!==V6.Z_OK)throw Error(nJ[X])}}}m1.prototype.push=function($,J){var X=this.strm,K=this.options.chunkSize,q=this.options.dictionary,Y,W,Q,N,V,M=!1;if(this.ended)return!1;if(W=J===~~J?J:J===!0?V6.Z_FINISH:V6.Z_NO_FLUSH,typeof $==="string")X.input=y$.binstring2buf($);else if(wW.call($)==="[object ArrayBuffer]")X.input=new Uint8Array($);else X.input=$;X.next_in=0,X.avail_in=X.input.length;do{if(X.avail_out===0)X.output=new A9.Buf8(K),X.next_out=0,X.avail_out=K;if(Y=O5.inflate(X,V6.Z_NO_FLUSH),Y===V6.Z_NEED_DICT&&q)Y=O5.inflateSetDictionary(this.strm,q);if(Y===V6.Z_BUF_ERROR&&M===!0)Y=V6.Z_OK,M=!1;if(Y!==V6.Z_STREAM_END&&Y!==V6.Z_OK)return this.onEnd(Y),this.ended=!0,!1;if(X.next_out){if(X.avail_out===0||Y===V6.Z_STREAM_END||X.avail_in===0&&(W===V6.Z_FINISH||W===V6.Z_SYNC_FLUSH))if(this.options.to==="string"){if(Q=y$.utf8border(X.output,X.next_out),N=X.next_out-Q,V=y$.buf2string(X.output,Q),X.next_out=N,X.avail_out=K-N,N)A9.arraySet(X.output,X.output,Q,N,0);this.onData(V)}else this.onData(A9.shrinkBuf(X.output,X.next_out))}if(X.avail_in===0&&X.avail_out===0)M=!0}while((X.avail_in>0||X.avail_out===0)&&Y!==V6.Z_STREAM_END);if(Y===V6.Z_STREAM_END)W=V6.Z_FINISH;if(W===V6.Z_FINISH)return Y=O5.inflateEnd(this.strm),this.onEnd(Y),this.ended=!0,Y===V6.Z_OK;if(W===V6.Z_SYNC_FLUSH)return this.onEnd(V6.Z_OK),X.avail_out=0,!0;return!0};m1.prototype.onData=function($){this.chunks.push($)};m1.prototype.onEnd=function($){if($===V6.Z_OK)if(this.options.to==="string")this.result=this.chunks.join("");else this.result=A9.flattenChunks(this.chunks);this.chunks=[],this.err=$,this.msg=this.strm.msg};function oJ($,J){var X=new m1(J);if(X.push($,!0),X.err)throw X.msg||nJ[X.err];return X.result}function lL($,J){return J=J||{},J.raw=!0,oJ($,J)}cL.Inflate=m1;cL.inflate=oJ;cL.inflateRaw=lL;cL.ungzip=oJ});var yW=L0((yF,_W)=>{var iL=c8().assign,sL=hY(),aL=TW(),tL=dJ(),IW={};iL(IW,sL,aL,tL);_W.exports=IW});var xW=L0((xF,rJ)=>{(function(){var $={};if(typeof rJ=="object")rJ.exports=$;else self.UTIF=$;var J=yW();function X(){console.log.apply(console,arguments)}(function(K,q){(function(){var Y=function(){function H(G){this.message="JPEG error: "+G}return H.prototype=Error(),H.prototype.name="JpegError",H.constructor=H,H}(),W=function(){var H=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),G=4017,O=799,L=3406,E=2276,j=1567,B=3784,S=5793,A=2896;function z(F){if(F==null)F={};if(F.w==null)F.w=-1;this.V=F.n,this.N=F.w}function P(F,C){var D=0,T=[],x,y,b=16,_;while(b>0&&!F[b-1])b--;T.push({children:[],index:0});var m=T[0];for(x=0;x<b;x++){for(y=0;y<F[x];y++){m=T.pop(),m.children[m.index]=C[D];while(m.index>0)m=T.pop();m.index++,T.push(m);while(T.length<=x)T.push(_={children:[],index:0}),m.children[m.index]=_.children,m=_;D++}if(x+1<b)T.push(_={children:[],index:0}),m.children[m.index]=_.children,m=_}return T[0].children}function R(F,C,D){return 64*((F.P+1)*C+D)}function U(F,C,D,T,x,y,b,_,m,t){if(t==null)t=!1;var{m:l,Z:s}=D,g=C,v=0,I=0,c=0,o=0,$0,a=0,e,r,p,i,X0,K0,U0=0,S0,u,M0,q0;function H0(){if(I>0)return I--,v>>I&1;if(v=F[C++],v===255){var Q0=F[C++];if(Q0){if(Q0===220&&t){C+=2;var R0=N(F,C);if(C+=2,R0>0&&R0!==D.s)throw new DNLMarkerError("Found DNL marker (0xFFDC) while parsing scan data",R0)}else if(Q0===217){if(t){var v0=a*8;if(v0>0&&v0<D.s/10)throw new DNLMarkerError("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",v0)}throw new EOIMarkerError("Found EOI marker (0xFFD9) while parsing scan data")}throw new Y("unexpected marker")}}return I=7,v>>>7}function O0(Q0){var R0=Q0;while(!0){switch(R0=R0[H0()],typeof R0){case"number":return R0;case"object":continue}throw new Y("invalid huffman sequence")}}function E0(Q0){var R0=0;while(Q0>0)R0=R0<<1|H0(),Q0--;return R0}function F0(Q0){if(Q0===1)return H0()===1?1:-1;var R0=E0(Q0);if(R0>=1<<Q0-1)return R0;return R0+(-1<<Q0)+1}function C0(Q0,R0){var v0=O0(Q0.J),_0=v0===0?0:F0(v0),f0=1;Q0.D[R0]=Q0.Q+=_0;while(f0<64){var s0=O0(Q0.i),y0=s0&15,i0=s0>>4;if(y0===0){if(i0<15)break;f0+=16;continue}f0+=i0;var t0=H[f0];Q0.D[R0+t0]=F0(y0),f0++}}function A0(Q0,R0){var v0=O0(Q0.J),_0=v0===0?0:F0(v0)<<m;Q0.D[R0]=Q0.Q+=_0}function T0(Q0,R0){Q0.D[R0]|=H0()<<m}function Y0(Q0,R0){if(c>0){c--;return}var v0=y,_0=b;while(v0<=_0){var f0=O0(Q0.i),s0=f0&15,y0=f0>>4;if(s0===0){if(y0<15){c=E0(y0)+(1<<y0)-1;break}v0+=16;continue}v0+=y0;var i0=H[v0];Q0.D[R0+i0]=F0(s0)*(1<<m),v0++}}function J0(Q0,R0){var v0=y,_0=b,f0=0,s0,y0;while(v0<=_0){var i0=R0+H[v0],t0=Q0.D[i0]<0?-1:1;switch(o){case 0:if(y0=O0(Q0.i),s0=y0&15,f0=y0>>4,s0===0)if(f0<15)c=E0(f0)+(1<<f0),o=4;else f0=16,o=1;else{if(s0!==1)throw new Y("invalid ACn encoding");$0=F0(s0),o=f0?2:3}continue;case 1:case 2:if(Q0.D[i0])Q0.D[i0]+=t0*(H0()<<m);else if(f0--,f0===0)o=o===2?3:0;break;case 3:if(Q0.D[i0])Q0.D[i0]+=t0*(H0()<<m);else Q0.D[i0]=$0<<m,o=0;break;case 4:if(Q0.D[i0])Q0.D[i0]+=t0*(H0()<<m);break}v0++}if(o===4){if(c--,c===0)o=0}}function V0(Q0,R0,v0,_0,f0){var s0=v0/l|0,y0=v0%l;a=s0*Q0.A+_0;var i0=y0*Q0.h+f0,t0=R(Q0,a,i0);R0(Q0,t0)}function g0(Q0,R0,v0){a=v0/Q0.P|0;var _0=v0%Q0.P,f0=R(Q0,a,_0);R0(Q0,f0)}var z0=T.length;if(s)if(y===0)K0=_===0?A0:T0;else K0=_===0?Y0:J0;else K0=C0;if(z0===1)u=T[0].P*T[0].c;else u=l*D.R;while(U0<=u){var I0=x?Math.min(u-U0,x):u;if(I0>0){for(r=0;r<z0;r++)T[r].Q=0;if(c=0,z0===1){e=T[0];for(X0=0;X0<I0;X0++)g0(e,K0,U0),U0++}else for(X0=0;X0<I0;X0++){for(r=0;r<z0;r++){e=T[r],M0=e.h,q0=e.A;for(p=0;p<q0;p++)for(i=0;i<M0;i++)V0(e,K0,U0,p,i)}U0++}}if(I=0,S0=h(F,C),!S0)break;if(S0.u){var d0=I0>0?"unexpected":"excessive";C=S0.offset}if(S0.M>=65488&&S0.M<=65495)C+=2;else break}return C-g}function Z(F,C,D){var{$:T,D:x}=F,y,b,_,m,t,l,s,g,v,I,c,o,$0,a,e,r,p;if(!T)throw new Y("missing required Quantization Table.");for(var i=0;i<64;i+=8){if(v=x[C+i],I=x[C+i+1],c=x[C+i+2],o=x[C+i+3],$0=x[C+i+4],a=x[C+i+5],e=x[C+i+6],r=x[C+i+7],v*=T[i],(I|c|o|$0|a|e|r)===0){p=S*v+512>>10,D[i]=p,D[i+1]=p,D[i+2]=p,D[i+3]=p,D[i+4]=p,D[i+5]=p,D[i+6]=p,D[i+7]=p;continue}I*=T[i+1],c*=T[i+2],o*=T[i+3],$0*=T[i+4],a*=T[i+5],e*=T[i+6],r*=T[i+7],y=S*v+128>>8,b=S*$0+128>>8,_=c,m=e,t=A*(I-r)+128>>8,g=A*(I+r)+128>>8,l=o<<4,s=a<<4,y=y+b+1>>1,b=y-b,p=_*B+m*j+128>>8,_=_*j-m*B+128>>8,m=p,t=t+s+1>>1,s=t-s,g=g+l+1>>1,l=g-l,y=y+m+1>>1,m=y-m,b=b+_+1>>1,_=b-_,p=t*E+g*L+2048>>12,t=t*L-g*E+2048>>12,g=p,p=l*O+s*G+2048>>12,l=l*G-s*O+2048>>12,s=p,D[i]=y+g,D[i+7]=y-g,D[i+1]=b+s,D[i+6]=b-s,D[i+2]=_+l,D[i+5]=_-l,D[i+3]=m+t,D[i+4]=m-t}for(var X0=0;X0<8;++X0){if(v=D[X0],I=D[X0+8],c=D[X0+16],o=D[X0+24],$0=D[X0+32],a=D[X0+40],e=D[X0+48],r=D[X0+56],(I|c|o|$0|a|e|r)===0){if(p=S*v+8192>>14,p<-2040)p=0;else if(p>=2024)p=255;else p=p+2056>>4;x[C+X0]=p,x[C+X0+8]=p,x[C+X0+16]=p,x[C+X0+24]=p,x[C+X0+32]=p,x[C+X0+40]=p,x[C+X0+48]=p,x[C+X0+56]=p;continue}if(y=S*v+2048>>12,b=S*$0+2048>>12,_=c,m=e,t=A*(I-r)+2048>>12,g=A*(I+r)+2048>>12,l=o,s=a,y=(y+b+1>>1)+4112,b=y-b,p=_*B+m*j+2048>>12,_=_*j-m*B+2048>>12,m=p,t=t+s+1>>1,s=t-s,g=g+l+1>>1,l=g-l,y=y+m+1>>1,m=y-m,b=b+_+1>>1,_=b-_,p=t*E+g*L+2048>>12,t=t*L-g*E+2048>>12,g=p,p=l*O+s*G+2048>>12,l=l*G-s*O+2048>>12,s=p,v=y+g,r=y-g,I=b+s,e=b-s,c=_+l,a=_-l,o=m+t,$0=m-t,v<16)v=0;else if(v>=4080)v=255;else v>>=4;if(I<16)I=0;else if(I>=4080)I=255;else I>>=4;if(c<16)c=0;else if(c>=4080)c=255;else c>>=4;if(o<16)o=0;else if(o>=4080)o=255;else o>>=4;if($0<16)$0=0;else if($0>=4080)$0=255;else $0>>=4;if(a<16)a=0;else if(a>=4080)a=255;else a>>=4;if(e<16)e=0;else if(e>=4080)e=255;else e>>=4;if(r<16)r=0;else if(r>=4080)r=255;else r>>=4;x[C+X0]=v,x[C+X0+8]=I,x[C+X0+16]=c,x[C+X0+24]=o,x[C+X0+32]=$0,x[C+X0+40]=a,x[C+X0+48]=e,x[C+X0+56]=r}}function w(F,C){var{P:D,c:T}=C,x=new Int16Array(64);for(var y=0;y<T;y++)for(var b=0;b<D;b++){var _=R(C,y,b);Z(C,_,x)}return C.D}function h(F,C,D){if(D==null)D=C;var T=F.length-1,x=D<C?D:C;if(C>=T)return null;var y=N(F,C);if(y>=65472&&y<=65534)return{u:null,M:y,offset:C};var b=N(F,x);while(!(b>=65472&&b<=65534)){if(++x>=T)return null;b=N(F,x)}return{u:y.toString(16),M:b,offset:x}}return z.prototype={parse(F,C){if(C==null)C={};var D=C.F,T=0,x=null,y=null,b,_,m=0;function t(){var y0=N(F,T);T+=2;var i0=T+y0-2,t0=h(F,i0,T);if(t0&&t0.u)i0=t0.offset;var z6=F.subarray(T,i0);return T+=z6.length,z6}function l(y0){var i0=Math.ceil(y0.o/8/y0.X),t0=Math.ceil(y0.s/8/y0.B);for(var z6=0;z6<y0.W.length;z6++){J0=y0.W[z6];var j6=Math.ceil(Math.ceil(y0.o/8)*J0.h/y0.X),T6=Math.ceil(Math.ceil(y0.s/8)*J0.A/y0.B),X8=i0*J0.h,R8=t0*J0.A,x8=64*R8*(X8+1);J0.D=new Int16Array(x8),J0.P=j6,J0.c=T6}y0.m=i0,y0.R=t0}var s=[],g=[],v=[],I=N(F,T);if(T+=2,I!==65496)throw new Y("SOI not found");I=N(F,T),T+=2;$:while(I!==65497){var c,o,$0;switch(I){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var a=t();if(I===65504){if(a[0]===74&&a[1]===70&&a[2]===73&&a[3]===70&&a[4]===0)x={version:{d:a[5],T:a[6]},K:a[7],j:a[8]<<8|a[9],H:a[10]<<8|a[11],S:a[12],I:a[13],C:a.subarray(14,14+3*a[12]*a[13])}}if(I===65518){if(a[0]===65&&a[1]===100&&a[2]===111&&a[3]===98&&a[4]===101)y={version:a[5]<<8|a[6],k:a[7]<<8|a[8],q:a[9]<<8|a[10],a:a[11]}}break;case 65499:var e=N(F,T),r;T+=2;var p=e+T-2;while(T<p){var i=F[T++],X0=new Uint16Array(64);if(i>>4===0)for(o=0;o<64;o++)r=H[o],X0[r]=F[T++];else if(i>>4===1)for(o=0;o<64;o++)r=H[o],X0[r]=N(F,T),T+=2;else throw new Y("DQT - invalid table spec");s[i&15]=X0}break;case 65472:case 65473:case 65474:if(b)throw new Y("Only single frame JPEGs supported");T+=2,b={},b.G=I===65473,b.Z=I===65474,b.precision=F[T++];var K0=N(F,T),U0,S0=0,u=0;T+=2,b.s=D||K0,b.o=N(F,T),T+=2,b.W=[],b._={};var M0=F[T++];for(c=0;c<M0;c++){U0=F[T];var q0=F[T+1]>>4,H0=F[T+1]&15;if(S0<q0)S0=q0;if(u<H0)u=H0;var O0=F[T+2];$0=b.W.push({h:q0,A:H0,L:O0,$:null}),b._[U0]=$0-1,T+=3}b.X=S0,b.B=u,l(b);break;case 65476:var E0=N(F,T);T+=2;for(c=2;c<E0;){var F0=F[T++],C0=new Uint8Array(16),A0=0;for(o=0;o<16;o++,T++)A0+=C0[o]=F[T];var T0=new Uint8Array(A0);for(o=0;o<A0;o++,T++)T0[o]=F[T];c+=17+A0,(F0>>4===0?v:g)[F0&15]=P(C0,T0)}break;case 65501:T+=2,_=N(F,T),T+=2;break;case 65498:var Y0=++m===1&&!D,J0;T+=2;var V0=F[T++],g0=[];for(c=0;c<V0;c++){var z0=F[T++],I0=b._[z0];J0=b.W[I0],J0.index=z0;var d0=F[T++];J0.J=v[d0>>4],J0.i=g[d0&15],g0.push(J0)}var Q0=F[T++],R0=F[T++],v0=F[T++];try{var _0=U(F,T,b,g0,_,Q0,R0,v0>>4,v0&15,Y0);T+=_0}catch(y0){if(y0 instanceof DNLMarkerError)return this.parse(F,{F:y0.s});else if(y0 instanceof EOIMarkerError)break $;throw y0}break;case 65500:T+=4;break;case 65535:if(F[T]!==255)T--;break;default:var f0=h(F,T-2,T-3);if(f0&&f0.u){T=f0.offset;break}if(T>=F.length-1)break $;throw new Y("JpegImage.parse - unknown marker: "+I.toString(16))}I=N(F,T),T+=2}this.width=b.o,this.height=b.s,this.g=x,this.b=y,this.W=[];for(c=0;c<b.W.length;c++){J0=b.W[c];var s0=s[J0.L];if(s0)J0.$=s0;this.W.push({index:J0.index,e:w(b,J0),l:J0.h/b.X,t:J0.A/b.B,P:J0.P,c:J0.c})}this.p=this.W.length;return},Y(F,C,D){if(D==null)D=!1;var T=this.width/F,x=this.height/C,y,b,_,m,t,l,s,g,v,I,c=0,o,$0=this.W.length,a=F*C*$0,e=new Uint8ClampedArray(a),r=new Uint32Array(F),p=4294967288,i;for(s=0;s<$0;s++){if(y=this.W[s],b=y.l*T,_=y.t*x,c=s,o=y.e,m=y.P+1<<3,b!==i){for(t=0;t<F;t++)g=0|t*b,r[t]=(g&p)<<3|g&7;i=b}for(l=0;l<C;l++){g=0|l*_,I=m*(g&p)|(g&7)<<3;for(t=0;t<F;t++)e[c]=o[I+r[t]],c+=$0}}var X0=this.V;if(!D&&$0===4&&!X0)X0=new Int32Array([-256,255,-256,255,-256,255,-256,255]);if(X0)for(s=0;s<a;)for(g=0,v=0;g<$0;g++,s++,v+=2)e[s]=(e[s]*X0[v]>>8)+X0[v+1];return e},get f(){if(this.b)return!!this.b.a;if(this.p===3){if(this.N===0)return!1;else if(this.W[0].index===82&&this.W[1].index===71&&this.W[2].index===66)return!1;return!0}if(this.N===1)return!0;return!1},z:function(C){var D,T,x;for(var y=0,b=C.length;y<b;y+=3)D=C[y],T=C[y+1],x=C[y+2],C[y]=D-179.456+1.402*x,C[y+1]=D+135.459-0.344*T-0.714*x,C[y+2]=D-226.816+1.772*T;return C},O:function(C){var D,T,x,y,b=0;for(var _=0,m=C.length;_<m;_+=4)D=C[_],T=C[_+1],x=C[_+2],y=C[_+3],C[b++]=-122.67195406894+T*(-0.0000660635669420364*T+0.000437130475926232*x-0.000054080610064599*D+0.00048449797120281*y-0.154362151871126)+x*(-0.000957964378445773*x+0.000817076911346625*D-0.00477271405408747*y+1.53380253221734)+D*(0.000961250184130688*D-0.00266257332283933*y+0.48357088451265)+y*(-0.000336197177618394*y+0.484791561490776),C[b++]=107.268039397724+T*(0.0000219927104525741*T-0.000640992018297945*x+0.000659397001245577*D+0.000426105652938837*y-0.176491792462875)+x*(-0.000778269941513683*x+0.00130872261408275*D+0.000770482631801132*y-0.151051492775562)+D*(0.00126935368114843*D-0.00265090189010898*y+0.25802910206845)+y*(-0.000318913117588328*y-0.213742400323665),C[b++]=-20.810012546947+T*(-0.000570115196973677*T-0.0000263409051004589*x+0.0020741088115012*D-0.00288260236853442*y+0.814272968359295)+x*(-0.0000153496057440975*x-0.000132689043961446*D+0.000560833691242812*y-0.195152027534049)+D*(0.00174418132927582*D-0.00255243321439347*y+0.116935020465145)+y*(-0.000343531996510555*y+0.24165260232407);return C.subarray(0,b)},r:function(C){var D,T,x;for(var y=0,b=C.length;y<b;y+=4)D=C[y],T=C[y+1],x=C[y+2],C[y]=434.456-D-1.402*x,C[y+1]=119.541-D+0.344*T+0.714*x,C[y+2]=481.816-D-1.772*T;return C},U:function(C){var D,T,x,y,b=0;for(var _=0,m=C.length;_<m;_+=4)D=C[_],T=C[_+1],x=C[_+2],y=C[_+3],C[b++]=255+D*(-0.00006747147073602441*D+0.0008379262121013727*T+0.0002894718188643294*x+0.003264231057537806*y-1.1185611867203937)+T*(0.000026374107616089405*T-0.00008626949158638572*x-0.0002748769067499491*y-0.02155688794978967)+x*(-0.00003878099212869363*x-0.0003267808279485286*y+0.0686742238595345)-y*(0.0003361971776183937*y+0.7430659151342254),C[b++]=255+D*(0.00013596372813588848*D+0.000924537132573585*T+0.00010567359618683593*x+0.0004791864687436512*y-0.3109689587515875)+T*(-0.00023545346108370344*T+0.0002702845253534714*x+0.0020200308977307156*y-0.7488052167015494)+x*(0.00006834815998235662*x+0.00015168452363460973*y-0.09751927774728933)-y*(0.0003189131175883281*y+0.7364883807733168),C[b++]=255+D*(0.000013598650411385307*D+0.00012423956175490851*T+0.0004751985097583589*x-0.0000036729317476630422*y-0.05562186980264034)+T*(0.00016141380598724676*T+0.0009692239130725186*x+0.0007782692450036253*y-0.44015232367526463)+x*(0.0000005068882914068769*x+0.0017778369011375071*y-0.7591454649749609)-y*(0.0003435319965105553*y+0.7063770186160144);return C.subarray(0,b)},getData:function(F){var{width:C,height:D,forceRGB:T,isSourcePDF:x}=F;if(this.p>4)throw new Y("Unsupported color mode");var y=this.Y(C,D,x);if(this.p===1&&T){var b=y.length,_=new Uint8ClampedArray(b*3),m=0;for(var t=0;t<b;t++){var l=y[t];_[m++]=l,_[m++]=l,_[m++]=l}return _}else if(this.p===3&&this.f)return this.z(y);else if(this.p===4){if(this.f){if(T)return this.O(y);return this.r(y)}else if(T)return this.U(y)}return y}},z}();function Q(M,H){return M[H]<<24>>24}function N(M,H){return M[H]<<8|M[H+1]}function V(M,H){return(M[H]<<24|M[H+1]<<16|M[H+2]<<8|M[H+3])>>>0}K.JpegDecoder=W})(),K.encodeImage=function(Y,W,Q,N){var V={t256:[W],t257:[Q],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1000],t277:[4],t278:[Q],t279:[W*Q*4],t282:[[72,1]],t283:[[72,1]],t284:[1],t286:[[0,1]],t287:[[0,1]],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(N)for(var M in N)V[M]=N[M];var H=new Uint8Array(K.encode([V])),G=new Uint8Array(Y),O=new Uint8Array(1000+W*Q*4);for(var M=0;M<H.length;M++)O[M]=H[M];for(var M=0;M<G.length;M++)O[1000+M]=G[M];return O.buffer},K.encode=function(Y){var W=!1,Q=new Uint8Array(20000),N=4,V=W?K._binLE:K._binBE;Q[0]=Q[1]=W?73:77,V.writeUshort(Q,2,42);var M=8;V.writeUint(Q,N,M),N+=4;for(var H=0;H<Y.length;H++){var G=K._writeIFD(V,K._types.basic,Q,M,Y[H]);if(M=G[1],H<Y.length-1){if((M&3)!=0)M+=4-(M&3);V.writeUint(Q,G[0],M)}}return Q.slice(0,M).buffer},K.decode=function(Y,W){if(W==null)W={parseMN:!0,debug:!1};var Q=new Uint8Array(Y),N=0,V=K._binBE.readASCII(Q,N,2);N+=2;var M=V=="II"?K._binLE:K._binBE,H=M.readUshort(Q,N);N+=2;var G=M.readUint(Q,N);N+=4;var O=[];while(!0){var L=M.readUshort(Q,G),E=M.readUshort(Q,G+4);if(L!=0){if(E<1||13<E){X("error in TIFF");break}}if(K._readIFD(M,Q,G,O,0,W),G=M.readUint(Q,G+2+L*12),G==0)break}return O},K.decodeImage=function(Y,W,Q){if(W.data)return;var N=new Uint8Array(Y),V=K._binBE.readASCII(N,0,2);if(W.t256==null)return;W.isLE=V=="II",W.width=W.t256[0],W.height=W.t257[0];var M=W.t259?W.t259[0]:1,H=W.t266?W.t266[0]:1;if(W.t284&&W.t284[0]==2)X("PlanarConfiguration 2 should not be used!");if(M==7&&W.t258&&W.t258.length>3)W.t258=W.t258.slice(0,3);var G=W.t277?W.t277[0]:1,O=W.t258?W.t258[0]:1,L=O*G;if(M==1&&W.t279!=null&&W.t278&&W.t262[0]==32803)L=Math.round(W.t279[0]*8/(W.width*W.t278[0]));if(W.t50885&&W.t50885[0]==4)L=W.t258[0]*3;var E=Math.ceil(W.width*L/8)*8,j=W.t273;if(j==null||W.t322)j=W.t324;var B=W.t279;if(M==1&&j.length==1)B=[W.height*(E>>>3)];if(B==null||W.t322)B=W.t325;var S=new Uint8Array(W.height*(E>>>3)),A=0;if(W.t322!=null){var z=W.t322[0],P=W.t323[0],R=Math.floor((W.width+z-1)/z),U=Math.floor((W.height+P-1)/P),Z=new Uint8Array(Math.ceil(z*P*L/8)|0);console.log("====",R,U);for(var w=0;w<U;w++)for(var h=0;h<R;h++){var F=w*R+h;if(Z.fill(0),K.decode._decompress(W,Q,N,j[F],B[F],M,Z,0,H,z,P),M==6)S=Z;else K._copyTile(Z,Math.ceil(z*L/8)|0,P,S,Math.ceil(W.width*L/8)|0,W.height,Math.ceil(h*z*L/8)|0,w*P)}A=S.length*8}else{if(j==null)return;var C=W.t278?W.t278[0]:W.height;C=Math.min(C,W.height);for(var F=0;F<j.length;F++)K.decode._decompress(W,Q,N,j[F],B[F],M,S,Math.ceil(A/8)|0,H,W.width,C),A+=E*C;A=Math.min(A,S.length*8)}W.data=new Uint8Array(S.buffer,0,Math.ceil(A/8)|0)},K.decode._decompress=function(Y,W,Q,N,V,M,H,G,O,L,E){if(Y.t271&&Y.t271[0]=="Panasonic"&&Y.t45&&Y.t45[0]==6)M=34316;if(M==1)for(var j=0;j<V;j++)H[G+j]=Q[N+j];else if(M==2)K.decode._decodeG2(Q,N,V,H,G,L,O);else if(M==3)K.decode._decodeG3(Q,N,V,H,G,L,O,Y.t292?(Y.t292[0]&1)==1:!1);else if(M==4)K.decode._decodeG4(Q,N,V,H,G,L,O);else if(M==5)K.decode._decodeLZW(Q,N,V,H,G,8);else if(M==6)K.decode._decodeOldJPEG(Y,Q,N,V,H,G);else if(M==7||M==34892)K.decode._decodeNewJPEG(Y,Q,N,V,H,G);else if(M==8||M==32946){var B=new Uint8Array(Q.buffer,N+2,V-6),S=q.inflateRaw(B);if(G+S.length<=H.length)H.set(S,G)}else if(M==9)K.decode._decodeVC5(Q,N,V,H,G,Y.t33422);else if(M==32767)K.decode._decodeARW(Y,Q,N,V,H,G);else if(M==32773)K.decode._decodePackBits(Q,N,V,H,G);else if(M==32809)K.decode._decodeThunder(Q,N,V,H,G);else if(M==34316)K.decode._decodePanasonic(Y,Q,N,V,H,G);else if(M==34713)K.decode._decodeNikon(Y,W,Q,N,V,H,G);else if(M==34676)K.decode._decodeLogLuv32(Y,Q,N,V,H,G);else X("Unknown compression",M);var A=Y.t258?Math.min(32,Y.t258[0]):1,z=Y.t277?Y.t277[0]:1,P=A*z>>>3,R=Math.ceil(A*z*L/8);if(A==16&&!Y.isLE&&Y.t33422==null)for(var U=0;U<E;U++){var Z=G+U*R;for(var w=1;w<R;w+=2){var h=H[Z+w];H[Z+w]=H[Z+w-1],H[Z+w-1]=h}}if(Y.t317&&Y.t317[0]==2)for(var U=0;U<E;U++){var F=G+U*R;if(A==16)for(var j=P;j<R;j+=2){var C=(H[F+j+1]<<8|H[F+j])+(H[F+j-P+1]<<8|H[F+j-P]);H[F+j]=C&255,H[F+j+1]=C>>>8&255}else if(z==3)for(var j=3;j<R;j+=3)H[F+j]=H[F+j]+H[F+j-3]&255,H[F+j+1]=H[F+j+1]+H[F+j-2]&255,H[F+j+2]=H[F+j+2]+H[F+j-1]&255;else for(var j=P;j<R;j++)H[F+j]=H[F+j]+H[F+j-P]&255}},K.decode._decodePanasonic=function(Y,W,Q,N,V,M){var H=W.buffer,G=Y.t2[0],O=Y.t3[0],L=Y.t10[0],E=Y.t45[0],j=0,B=0,S=0,A=0,z,P,R=E==6?new Uint32Array(18):new Uint8Array(16),U,Z,w,h=[0,0],F=[0,0],C,D=0,T,x,y,b,_=new Uint8Array(16384),m=new Uint16Array(V.buffer);function t(H0){if(S==0){var O0=new Uint8Array(H,Q+B+8184,8200),E0=new Uint8Array(H,Q+B,8184);_.set(O0),_.set(E0,O0.length),B+=16384}if(E==5)for(U=0;U<16;U++)R[U]=_[S++],S&=16383;else return S=S-H0&131071,A=S>>3^16368,(_[A]|_[A+1]<<8)>>(S&7)&~(-1<<H0)}function l(H0){return _[S+15-H0]}function s(){R[0]=l(0)<<6|l(1)>>2,R[1]=((l(1)&3)<<12|l(2)<<4|l(3)>>4)&16383,R[2]=l(3)>>2&3,R[3]=(l(3)&3)<<8|l(4),R[4]=l(5)<<2|l(6)>>6,R[5]=(l(6)&63)<<4|l(7)>>4,R[6]=l(7)>>2&3,R[7]=(l(7)&3)<<8|l(8),R[8]=l(9)<<2&1020|l(10)>>6,R[9]=(l(10)<<4|l(11)>>4)&1023,R[10]=l(11)>>2&3,R[11]=(l(11)&3)<<8|l(12),R[12]=(l(13)<<2&1020|l(14)>>6)&1023,R[13]=(l(14)<<4|l(15)>>4)&1023,S+=16,A=0}function g(){R[0]=l(0)<<4|l(1)>>4,R[1]=((l(1)&15)<<8|l(2))&4095,R[2]=l(3)>>6&3,R[3]=(l(3)&63)<<2|l(4)>>6,R[4]=(l(4)&63)<<2|l(5)>>6,R[5]=(l(5)&63)<<2|l(6)>>6,R[6]=l(6)>>4&3,R[7]=(l(6)&15)<<4|l(7)>>4,R[8]=(l(7)&15)<<4|l(8)>>4,R[9]=(l(8)&15)<<4|l(9)>>4,R[10]=l(9)>>2&3,R[11]=(l(9)&3)<<6|l(10)>>2,R[12]=(l(10)&3)<<6|l(11)>>2,R[13]=(l(11)&3)<<6|l(12)>>2,R[14]=l(12)&3,R[15]=l(13),R[16]=l(14),R[17]=l(15),S+=16,A=0}function v(){h[0]=0,h[1]=0,F[0]=0,F[1]=0}if(E==7)throw E;else if(E==6){var I=L==12,c=I?g:s,o=I?14:11,$0=I?128:512,a=I?2048:8192,e=I?16383:65535,r=I?4095:16383,p=G/o,i=p*16,X0=I?18:14;for(x=0;x<O-15;x+=16){var K0=Math.min(16,O-x),U0=i*K0;_=new Uint8Array(H,Q+j,U0),S=0,j+=U0;for(b=0,y=0;b<K0;b++,y=0){D=(x+b)*G;for(var S0=0;S0<p;S0++){c(),v(),w=0,T=0;for(U=0;U<o;U++){if(C=U&1,U%3==2){var u=A<X0?R[A++]:0;if(u==3)u=4;T=$0<<u,w=1<<u}var M0=A<X0?R[A++]:0;if(h[C]){if(M0*=w,T<a&&F[C]>T)M0+=F[C]-T;F[C]=M0}else if(h[C]=M0,M0)F[C]=M0;else M0=F[C];m[D+y++]=M0-15<=e?M0-15&e:M0+2147483633>>31&r}}}}}else if(E==5){var q0=L==12?10:9;for(x=0;x<O;x++)for(y=0;y<G;y+=q0)if(t(0),L==12)m[D++]=((R[1]&15)<<8)+R[0],m[D++]=16*R[2]+(R[1]>>4),m[D++]=((R[4]&15)<<8)+R[3],m[D++]=16*R[5]+(R[4]>>4),m[D++]=((R[7]&15)<<8)+R[6],m[D++]=16*R[8]+(R[7]>>4),m[D++]=((R[10]&15)<<8)+R[9],m[D++]=16*R[11]+(R[10]>>4),m[D++]=((R[13]&15)<<8)+R[12],m[D++]=16*R[14]+(R[13]>>4);else if(L==14)m[D++]=R[0]+((R[1]&63)<<8),m[D++]=(R[1]>>6)+4*R[2]+((R[3]&15)<<10),m[D++]=(R[3]>>4)+16*R[4]+((R[5]&3)<<12),m[D++]=((R[5]&252)>>2)+(R[6]<<6),m[D++]=R[7]+((R[8]&63)<<8),m[D++]=(R[8]>>6)+4*R[9]+((R[10]&15)<<10),m[D++]=(R[10]>>4)+16*R[11]+((R[12]&3)<<12),m[D++]=((R[12]&252)>>2)+(R[13]<<6),m[D++]=R[14]+((R[15]&63)<<8)}else if(E==4)for(x=0;x<O;x++)for(y=0;y<G;y++){if(U=y%14,C=U&1,U==0)v();if(U%3==2)w=4>>3-t(2);if(F[C]){if(Z=t(8),Z!=0){if(h[C]-=128<<w,h[C]<0||w==4)h[C]&=~(-1<<w);h[C]+=Z<<w}}else if(F[C]=t(8),F[C]||U>11)h[C]=F[C]<<4|t(4);m[D++]=h[y&1]}else throw E},K.decode._decodeVC5=function(){var Y=[1,0,1,0,2,2,1,1,3,7,1,2,5,25,1,3,6,48,1,4,6,54,1,5,7,111,1,8,7,99,1,6,7,105,12,0,7,107,1,7,8,209,20,0,8,212,1,9,8,220,1,10,9,393,1,11,9,394,32,0,9,416,1,12,9,427,1,13,10,887,1,18,10,784,1,14,10,790,1,15,10,835,60,0,10,852,1,16,10,885,1,17,11,1571,1,19,11,1668,1,20,11,1669,100,0,11,1707,1,21,11,1772,1,22,12,3547,1,29,12,3164,1,24,12,3166,1,25,12,3140,1,23,12,3413,1,26,12,3537,1,27,12,3539,1,28,13,7093,1,35,13,6283,1,30,13,6331,1,31,13,6335,180,0,13,6824,1,32,13,7072,1,33,13,7077,320,0,13,7076,1,34,14,12565,1,36,14,12661,1,37,14,12669,1,38,14,13651,1,39,14,14184,1,40,15,28295,1,46,15,28371,1,47,15,25320,1,42,15,25336,1,43,15,25128,1,41,15,27300,1,44,15,28293,1,45,16,50259,1,48,16,50643,1,49,16,50675,1,50,16,56740,1,53,16,56584,1,51,16,56588,1,52,17,113483,1,61,17,113482,1,60,17,101285,1,55,17,101349,1,56,17,109205,1,57,17,109207,1,58,17,100516,1,54,17,113171,1,59,18,202568,1,62,18,202696,1,63,18,218408,1,64,18,218412,1,65,18,226340,1,66,18,226356,1,67,18,226358,1,68,19,402068,1,69,19,405138,1,70,19,405394,1,71,19,436818,1,72,19,436826,1,73,19,452714,1,75,19,452718,1,76,19,452682,1,74,20,804138,1,77,20,810279,1,78,20,810790,1,79,20,873638,1,80,20,873654,1,81,20,905366,1,82,20,905430,1,83,20,905438,1,84,21,1608278,1,85,21,1620557,1,86,21,1621582,1,87,21,1621583,1,88,21,1747310,1,89,21,1810734,1,90,21,1810735,1,91,21,1810863,1,92,21,1810879,1,93,22,3621725,1,99,22,3621757,1,100,22,3241112,1,94,22,3494556,1,95,22,3494557,1,96,22,3494622,1,97,22,3494623,1,98,23,6482227,1,102,23,6433117,1,101,23,6989117,1,103,23,6989119,1,105,23,6989118,1,104,23,7243449,1,106,23,7243512,1,107,24,13978233,1,111,24,12964453,1,109,24,12866232,1,108,24,14486897,1,113,24,13978232,1,110,24,14486896,1,112,24,14487026,1,114,24,14487027,1,115,25,25732598,1,225,25,25732597,1,189,25,25732596,1,188,25,25732595,1,203,25,25732594,1,202,25,25732593,1,197,25,25732592,1,207,25,25732591,1,169,25,25732590,1,223,25,25732589,1,159,25,25732522,1,235,25,25732579,1,152,25,25732575,1,192,25,25732489,1,179,25,25732573,1,201,25,25732472,1,172,25,25732576,1,149,25,25732488,1,178,25,25732566,1,120,25,25732571,1,219,25,25732577,1,150,25,25732487,1,127,25,25732506,1,211,25,25732548,1,125,25,25732588,1,158,25,25732486,1,247,25,25732467,1,238,25,25732508,1,163,25,25732552,1,228,25,25732603,1,183,25,25732513,1,217,25,25732587,1,168,25,25732520,1,122,25,25732484,1,128,25,25732562,1,249,25,25732505,1,187,25,25732504,1,186,25,25732483,1,136,25,25928905,1,181,25,25732560,1,255,25,25732500,1,230,25,25732482,1,135,25,25732555,1,233,25,25732568,1,222,25,25732583,1,145,25,25732481,1,134,25,25732586,1,167,25,25732521,1,248,25,25732518,1,209,25,25732480,1,243,25,25732512,1,216,25,25732509,1,164,25,25732547,1,140,25,25732479,1,157,25,25732544,1,239,25,25732574,1,191,25,25732564,1,251,25,25732478,1,156,25,25732546,1,139,25,25732498,1,242,25,25732557,1,133,25,25732477,1,162,25,25732515,1,213,25,25732584,1,165,25,25732514,1,212,25,25732476,1,227,25,25732494,1,198,25,25732531,1,236,25,25732530,1,234,25,25732529,1,117,25,25732528,1,215,25,25732527,1,124,25,25732526,1,123,25,25732525,1,254,25,25732524,1,253,25,25732523,1,148,25,25732570,1,218,25,25732580,1,146,25,25732581,1,147,25,25732569,1,224,25,25732533,1,143,25,25732540,1,184,25,25732541,1,185,25,25732585,1,166,25,25732556,1,132,25,25732485,1,129,25,25732563,1,250,25,25732578,1,151,25,25732501,1,119,25,25732502,1,193,25,25732536,1,176,25,25732496,1,245,25,25732553,1,229,25,25732516,1,206,25,25732582,1,144,25,25732517,1,208,25,25732558,1,137,25,25732543,1,241,25,25732466,1,237,25,25732507,1,190,25,25732542,1,240,25,25732551,1,131,25,25732554,1,232,25,25732565,1,252,25,25732475,1,171,25,25732493,1,205,25,25732492,1,204,25,25732491,1,118,25,25732490,1,214,25,25928904,1,180,25,25732549,1,126,25,25732602,1,182,25,25732539,1,175,25,25732545,1,141,25,25732559,1,138,25,25732537,1,177,25,25732534,1,153,25,25732503,1,194,25,25732606,1,160,25,25732567,1,121,25,25732538,1,174,25,25732497,1,246,25,25732550,1,130,25,25732572,1,200,25,25732474,1,170,25,25732511,1,221,25,25732601,1,196,25,25732532,1,142,25,25732519,1,210,25,25732495,1,199,25,25732605,1,155,25,25732535,1,154,25,25732499,1,244,25,25732510,1,220,25,25732600,1,195,25,25732607,1,161,25,25732604,1,231,25,25732473,1,173,25,25732599,1,226,26,51465122,1,116,26,51465123,0,1],W,Q,N,V=[3,3,3,3,2,2,2,1,1,1],M=24576,H=16384,G=8192,O=H|G;function L(U){var Z=U[1],w=U[0][Z>>>3]>>>7-(Z&7)&1;return U[1]++,w}function E(U,Z){if(W==null){W={};for(var w=0;w<Y.length;w+=4)W[Y[w+1]]=Y.slice(w,w+4)}var h=L(U),F=W[h];while(F==null)h=h<<1|L(U),F=W[h];var C=F[3];if(C!=0)C=L(U)==0?C:-C;Z[0]=F[2],Z[1]=C}function j(U,Z){for(var w=0;w<Z;w++){if((U&1)==1)U++;U=U>>>1}return U}function B(U,Z){return U>>Z}function S(U,Z,w,h,F,C){Z[w]=B(B(11*U[F]-4*U[F+C]+U[F+C+C]+4,3)+U[h],1),Z[w+C]=B(B(5*U[F]+4*U[F+C]-U[F+C+C]+4,3)-U[h],1)}function A(U,Z,w,h,F,C){var D=U[F-C]-U[F+C],T=U[F],x=U[h];Z[w]=B(B(D+4,3)+T+x,1),Z[w+C]=B(B(-D+4,3)+T-x,1)}function z(U,Z,w,h,F,C){Z[w]=B(B(5*U[F]+4*U[F-C]-U[F-C-C]+4,3)+U[h],1),Z[w+C]=B(B(11*U[F]-4*U[F-C]+U[F-C-C]+4,3)-U[h],1)}function P(U){return U=U<0?0:U>4095?4095:U,U=N[U]>>>2,U}function R(U,Z,w,h,F,C){h=new Uint16Array(h.buffer);var D=Date.now(),T=K._binBE,x=Z+w,y,b,_,m,t,l,s,g,v,I,c,o,$0,a,e,r,p,i;Z+=4;var X0=C[0]==1;while(Z<x){var K0=T.readShort(U,Z),U0=T.readUshort(U,Z+2);if(Z+=4,K0==12)y=U0;else if(K0==20)b=U0;else if(K0==21)_=U0;else if(K0==48)m=U0;else if(K0==53)t=U0;else if(K0==35)l=U0;else if(K0==62)s=U0;else if(K0==101)g=U0;else if(K0==109)v=U0;else if(K0==84)I=U0;else if(K0==106)c=U0;else if(K0==107)o=U0;else if(K0==108)$0=U0;else if(K0==102)a=U0;else if(K0==104)e=U0;else if(K0==105)r=U0;else{var S0=K0<0?-K0:K0,u=S0&65280,M0=0;if(S0&O)if(S0&G)M0=U0&65535,M0+=(S0&255)<<16;else M0=U0&65535;if((S0&M)==M){if(p==null){p=[];for(var q0=0;q0<4;q0++)p[q0]=new Int16Array((b>>>1)*(_>>>1));i=new Int16Array((b>>>1)*(_>>>1)),Q=new Int16Array(1024);for(var q0=0;q0<1024;q0++){var H0=q0-512,O0=Math.abs(H0),y=Math.floor(768*O0*O0*O0/16581375)+O0;Q[q0]=Math.sign(H0)*y}N=new Uint16Array(4096);var E0=65535;for(var q0=0;q0<4096;q0++){var F0=q0,C0=E0*(Math.pow(113,F0/4095)-1)/112;N[q0]=Math.min(C0,E0)}}var A0=p[s],T0=j(b,1+V[m]),Y0=j(_,1+V[m]);if(m==0)for(var J0=0;J0<Y0;J0++)for(var V0=0;V0<T0;V0++){var g0=Z+(J0*T0+V0)*2;A0[J0*(b>>>1)+V0]=U[g0]<<8|U[g0+1]}else{var z0=[U,Z*8],I0=[],d0=0,Q0=T0*Y0,R0=[0,0],v0=0,U0=0;while(d0<Q0){E(z0,R0),v0=R0[0],U0=R0[1];while(v0>0)I0[d0++]=U0,v0--}var _0=(m-1)%3,f0=_0!=1?T0:0,s0=_0!=0?Y0:0;for(var J0=0;J0<Y0;J0++){var y0=(J0+s0)*(b>>>1)+f0,i0=J0*T0;for(var V0=0;V0<T0;V0++)A0[y0+V0]=Q[I0[i0+V0]+512]*t}if(_0==2){var e=b>>>1,t0=T0*2,z6=Y0*2;for(var J0=0;J0<Y0;J0++)for(var V0=0;V0<t0;V0++){var q0=J0*2*e+V0,j6=J0*e+V0,T6=Y0*e+j6;if(J0==0)S(A0,i,q0,T6,j6,e);else if(J0==Y0-1)z(A0,i,q0,T6,j6,e);else A(A0,i,q0,T6,j6,e)}var X8=A0;A0=i,i=X8;for(var J0=0;J0<z6;J0++)for(var V0=0;V0<T0;V0++){var q0=J0*e+2*V0,j6=J0*e+V0,T6=T0+j6;if(V0==0)S(A0,i,q0,T6,j6,1);else if(V0==T0-1)z(A0,i,q0,T6,j6,1);else A(A0,i,q0,T6,j6,1)}var X8=A0;A0=i,i=X8;var R8=[],x8=2-~~((m-1)/3);for(var B8=0;B8<3;B8++)R8[B8]=v>>14-B8*2&3;var c5=R8[x8];if(c5!=0)for(var J0=0;J0<z6;J0++)for(var V0=0;V0<t0;V0++){var q0=J0*e+V0;A0[q0]=A0[q0]<<c5}}}if(m==9&&s==3){var d5=p[0],l9=p[1],c9=p[2],d9=p[3];for(var J0=0;J0<_;J0+=2)for(var V0=0;V0<b;V0+=2){var K8=J0*b+V0,g0=(J0>>>1)*(b>>>1)+(V0>>>1),F1=d5[g0],H7=l9[g0]-2048,z1=c9[g0]-2048,o1=d9[g0]-2048,C1=(H7<<1)+F1,Z1=(z1<<1)+F1,n5=F1+o1,o5=F1-o1;if(X0)h[K8]=P(n5),h[K8+1]=P(Z1),h[K8+b]=P(C1),h[K8+b+1]=P(o5);else h[K8]=P(C1),h[K8+1]=P(n5),h[K8+b]=P(o5),h[K8+b+1]=P(Z1)}}Z+=M0*4}else if(S0==16388)Z+=M0*4;else if(u==8192||u==8448||u==9216);else throw S0.toString(16)}}console.log(Date.now()-D)}return R}(),K.decode._decodeLogLuv32=function(Y,W,Q,N,V,M){var H=Y.width,G=H*4,O=0,L=new Uint8Array(G);while(O<N){var E=0;while(E<G){var j=W[Q+O];if(O++,j<128){for(var B=0;B<j;B++)L[E+B]=W[Q+O+B];E+=j,O+=j}else{j=j-126;for(var B=0;B<j;B++)L[E+B]=W[Q+O];E+=j,O++}}for(var S=0;S<H;S++)V[M+0]=L[S],V[M+1]=L[S+H],V[M+2]=L[S+H*2],V[M+4]=L[S+H*3],M+=6}},K.decode._ljpeg_diff=function(Y,W,Q){var N=K.decode._getbithuff,V,M;if(V=N(Y,W,Q[0],Q),M=N(Y,W,V,0),(M&1<<V-1)==0)M-=(1<<V)-1;return M},K.decode._decodeARW=function(Y,W,Q,N,V,M){var H=Y.t256[0],G=Y.t257[0],O=Y.t258[0],L=Y.isLE?K._binLE:K._binBE,E=H*G==N||H*G*1.5==N;if(!E){G+=8;var j=[Q,0,0,0],B=new Uint16Array(32770),S=[3857,3856,3599,3342,3085,2828,2571,2314,2057,1800,1543,1286,1029,772,771,768,514,513],s,A,z,T,D,P=0,R=K.decode._ljpeg_diff;B[0]=15;for(z=s=0;s<18;s++){var U=32768>>>(S[s]>>>8);for(var A=0;A<U;A++)B[++z]=S[s]}for(T=H;T--;)for(D=0;D<G+1;D+=2){if(D==G)D=1;if(P+=R(W,j,B),D<G){var Z=P&4095;K.decode._putsF(V,(D*H+T)*O,Z<<16-O)}}return}if(H*G*1.5==N){for(var s=0;s<N;s+=3){var w=W[Q+s+0],h=W[Q+s+1],F=W[Q+s+2];V[M+s]=h<<4|w>>>4,V[M+s+1]=w<<4|F>>>4,V[M+s+2]=F<<4|h>>>4}return}var C=new Uint16Array(16),D,T,x,y,b,_,m,t,l,s,g,v=new Uint8Array(H+1);for(D=0;D<G;D++){for(var I=0;I<H;I++)v[I]=W[Q++];for(g=0,T=0;T<H-30;g+=16){y=2047&(x=L.readUint(v,g)),b=2047&x>>>11,_=15&x>>>22,m=15&x>>>26;for(t=0;t<4&&128<<t<=y-b;t++);for(l=30,s=0;s<16;s++)if(s==_)C[s]=y;else if(s==m)C[s]=b;else{if(C[s]=((L.readUshort(v,g+(l>>3))>>>(l&7)&127)<<t)+b,C[s]>2047)C[s]=2047;l+=7}for(s=0;s<16;s++,T+=2){var Z=C[s]<<1;K.decode._putsF(V,(D*H+T)*O,Z<<16-O)}T-=T&1?1:31}}},K.decode._decodeNikon=function(Y,W,Q,N,V,M,H){var G=[[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,5,4,3,6,2,7,1,0,8,9,11,10,12],[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,57,90,56,39,22,5,4,3,2,1,0,11,12,12],[0,0,1,4,2,3,1,2,0,0,0,0,0,0,0,0,0,5,4,6,3,7,2,8,1,9,0,10,11,12],[0,0,1,4,3,1,1,1,1,1,2,0,0,0,0,0,0,5,6,4,7,8,3,9,2,1,0,10,11,12,13,14],[0,0,1,5,1,1,1,1,1,1,1,2,0,0,0,0,0,8,92,75,58,41,7,6,5,4,3,2,1,0,13,14],[0,0,1,4,2,2,3,1,2,0,0,0,0,0,0,0,0,7,6,8,5,9,4,10,3,11,12,2,0,1,13,14]],O=Y.t256[0],L=Y.t257[0],E=Y.t258[0],j=0,B=0,S=K.decode._make_decoder,A=K.decode._getbithuff,z=W[0].exifIFD.makerNote,P=z.t150?z.t150:z.t140,R=0,U=P[R++],Z=P[R++];if(U==73||Z==88)R+=2110;if(U==70)j=2;if(E==14)j+=3;var w=[[0,0],[0,0]],h=Y.isLE?K._binLE:K._binBE;for(var x=0;x<2;x++)for(var F=0;F<2;F++)w[x][F]=h.readShort(P,R),R+=2;var C=1<<E&32767,D=0,T=h.readShort(P,R);if(R+=2,T>1)D=Math.floor(C/(T-1));if(U==68&&Z==32&&D>0)B=h.readShort(P,562);var x,y,b,_,m,t,l=0,s=[0,0],g=S(G[j]),v=[N,0,0,0];for(l=y=0;y<L;y++){if(B&&y==B)g=S(G[j+1]);for(b=0;b<O;b++){if(x=A(Q,v,g[0],g),_=x&15,m=x>>>4,t=(A(Q,v,_-m,0)<<1)+1<<m>>>1,(t&1<<_-1)==0)t-=(1<<_)-(m==0?1:0);if(b<2)s[b]=w[y&1][b]+=t;else s[b&1]+=t;var I=Math.min(Math.max(s[b&1],0),(1<<E)-1),c=(y*O+b)*E;K.decode._putsF(M,c,I<<16-E)}}},K.decode._putsF=function(Y,W,Q){Q=Q<<8-(W&7);var N=W>>>3;Y[N]|=Q>>>16,Y[N+1]|=Q>>>8,Y[N+2]|=Q},K.decode._getbithuff=function(Y,W,Q,N){var V=0,M=K.decode._get_byte,H,G=W[0],O=W[1],L=W[2],E=W[3];if(Q==0||L<0)return 0;while(!E&&L<Q&&(H=Y[G++])!=-1&&!(E=V&&H==255&&Y[G++]))O=(O<<8)+H,L+=8;if(H=O<<32-L>>>32-Q,N)L-=N[H+1]>>>8,H=N[H+1]&255;else L-=Q;if(L<0)throw"e";return W[0]=G,W[1]=O,W[2]=L,W[3]=E,H},K.decode._make_decoder=function(Y){var W,Q,N,V,M,H=[];for(W=16;W!=0&&!Y[W];W--);var G=17;H[0]=W;for(N=Q=1;Q<=W;Q++)for(V=0;V<Y[Q];V++,++G)for(M=0;M<1<<W-Q;M++)if(N<=1<<W)H[N++]=Q<<8|Y[G];return H},K.decode._decodeNewJPEG=function(Y,W,Q,N,V,M){N=Math.min(N,W.length-Q);var H=Y.t347,G=H?H.length:0,O=new Uint8Array(G+N);if(H){var L=216,E=217,j=0;for(var B=0;B<G-1;B++){if(H[B]==255&&H[B+1]==E)break;O[j++]=H[B]}var S=W[Q],A=W[Q+1];if(S!=255||A!=L)O[j++]=S,O[j++]=A;for(var B=2;B<N;B++)O[j++]=W[Q+B]}else for(var B=0;B<N;B++)O[B]=W[Q+B];if(Y.t262[0]==32803||Y.t259[0]==7&&Y.t262[0]==34892){var z=Y.t258[0],P=K.LosslessJpegDecode(O),R=P.length;if(z==16)if(Y.isLE)for(var B=0;B<R;B++)V[M+(B<<1)]=P[B]&255,V[M+(B<<1)+1]=P[B]>>>8;else for(var B=0;B<R;B++)V[M+(B<<1)]=P[B]>>>8,V[M+(B<<1)+1]=P[B]&255;else if(z==14||z==12||z==10){var U=16-z;for(var B=0;B<R;B++)K.decode._putsF(V,B*z,P[B]<<U)}else if(z==8)for(var B=0;B<R;B++)V[M+B]=P[B];else throw Error("unsupported bit depth "+z)}else{var Z=new K.JpegDecoder;Z.parse(O);var w=Z.getData({width:Z.width,height:Z.height,forceRGB:!0,isSourcePDF:!1});for(var B=0;B<w.length;B++)V[M+B]=w[B]}if(Y.t262[0]==6)Y.t262[0]=2},K.decode._decodeOldJPEGInit=function(Y,W,Q,N){var V=216,M=217,H=219,G=196,O=221,L=192,E=218,j=0,B=0,S,A,z=!1,P,R,U,Z=Y.t513,w=Z?Z[0]:0,h=Y.t514,F=h?h[0]:0,C=Y.t324||Y.t273||Z,D=Y.t530,T=0,x=0,y=Y.t277?Y.t277[0]:1,b=Y.t515;if(C)B=C[0],z=C.length>1;if(!z){if(W[Q]==255&&W[Q+1]==V)return{jpegOffset:Q};if(Z!=null){if(W[Q+w]==255&&W[Q+w+1]==V)j=Q+w;else X("JPEGInterchangeFormat does not point to SOI");if(h==null)X("JPEGInterchangeFormatLength field is missing");else if(w>=B||w+F<=B)X("JPEGInterchangeFormatLength field value is invalid");if(j!=null)return{jpegOffset:j}}}if(D!=null)T=D[0],x=D[1];if(Z!=null){if(h!=null)if(F>=2&&w+F<=B){if(W[Q+w+F-2]==255&&W[Q+w+F-1]==V)S=new Uint8Array(F-2);else S=new Uint8Array(F);for(P=0;P<S.length;P++)S[P]=W[Q+w+P];X("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else X("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile")}if(S==null){var _=0,m=[];m[_++]=255,m[_++]=V;var t=Y.t519;if(t==null)throw Error("JPEGQTables tag is missing");for(P=0;P<t.length;P++){m[_++]=255,m[_++]=H,m[_++]=0,m[_++]=67,m[_++]=P;for(R=0;R<64;R++)m[_++]=W[Q+t[P]+R]}for(U=0;U<2;U++){var l=Y[U==0?"t520":"t521"];if(l==null)throw Error((U==0?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(P=0;P<l.length;P++){m[_++]=255,m[_++]=G;var s=19;for(R=0;R<16;R++)s+=W[Q+l[P]+R];m[_++]=s>>>8,m[_++]=s&255,m[_++]=P|U<<4;for(R=0;R<16;R++)m[_++]=W[Q+l[P]+R];for(R=0;R<s;R++)m[_++]=W[Q+l[P]+16+R]}}if(m[_++]=255,m[_++]=L,m[_++]=0,m[_++]=8+3*y,m[_++]=8,m[_++]=Y.height>>>8&255,m[_++]=Y.height&255,m[_++]=Y.width>>>8&255,m[_++]=Y.width&255,m[_++]=y,y==1)m[_++]=1,m[_++]=17,m[_++]=0;else for(P=0;P<3;P++)m[_++]=P+1,m[_++]=P!=0?17:(T&15)<<4|x&15,m[_++]=P;if(b!=null&&b[0]!=0)m[_++]=255,m[_++]=O,m[_++]=0,m[_++]=4,m[_++]=b[0]>>>8&255,m[_++]=b[0]&255;S=new Uint8Array(m)}var g=-1;P=0;while(P<S.length-1){if(S[P]==255&&S[P+1]==L){g=P;break}P++}if(g==-1){var v=new Uint8Array(S.length+10+3*y);v.set(S);var I=S.length;if(g=S.length,S=v,S[I++]=255,S[I++]=L,S[I++]=0,S[I++]=8+3*y,S[I++]=8,S[I++]=Y.height>>>8&255,S[I++]=Y.height&255,S[I++]=Y.width>>>8&255,S[I++]=Y.width&255,S[I++]=y,y==1)S[I++]=1,S[I++]=17,S[I++]=0;else for(P=0;P<3;P++)S[I++]=P+1,S[I++]=P!=0?17:(T&15)<<4|x&15,S[I++]=P}if(W[B]==255&&W[B+1]==E){var c=W[B+2]<<8|W[B+3];A=new Uint8Array(c+2),A[0]=W[B],A[1]=W[B+1],A[2]=W[B+2],A[3]=W[B+3];for(P=0;P<c-2;P++)A[P+4]=W[B+P+4]}else{A=new Uint8Array(8+2*y);var o=0;if(A[o++]=255,A[o++]=E,A[o++]=0,A[o++]=6+2*y,A[o++]=y,y==1)A[o++]=1,A[o++]=0;else for(P=0;P<3;P++)A[o++]=P+1,A[o++]=P<<4|P;A[o++]=0,A[o++]=63,A[o++]=0}return{jpegOffset:Q,tables:S,sosMarker:A,sofPosition:g}},K.decode._decodeOldJPEG=function(Y,W,Q,N,V,M){var H,G,O,L,E,j=K.decode._decodeOldJPEGInit(Y,W,Q,N);if(j.jpegOffset!=null){G=Q+N-j.jpegOffset,L=new Uint8Array(G);for(H=0;H<G;H++)L[H]=W[j.jpegOffset+H]}else{if(O=j.tables.length,L=new Uint8Array(O+j.sosMarker.length+N+2),L.set(j.tables),E=O,L[j.sofPosition+5]=Y.height>>>8&255,L[j.sofPosition+6]=Y.height&255,L[j.sofPosition+7]=Y.width>>>8&255,L[j.sofPosition+8]=Y.width&255,W[Q]!=255||W[Q+1]!=SOS)L.set(j.sosMarker,E),E+=sosMarker.length;for(H=0;H<N;H++)L[E++]=W[Q+H];L[E++]=255,L[E++]=EOI}var B=new K.JpegDecoder;B.parse(L);var S=B.getData({width:B.width,height:B.height,forceRGB:!0,isSourcePDF:!1});for(var H=0;H<S.length;H++)V[M+H]=S[H];if(Y.t262&&Y.t262[0]==6)Y.t262[0]=2},K.decode._decodePackBits=function(Y,W,Q,N,V){var M=new Int8Array(Y.buffer),H=new Int8Array(N.buffer),G=W+Q;while(W<G){var O=M[W];if(W++,O>=0&&O<128)for(var L=0;L<O+1;L++)H[V]=M[W],V++,W++;if(O>=-127&&O<0){for(var L=0;L<-O+1;L++)H[V]=M[W],V++;W++}}return V},K.decode._decodeThunder=function(Y,W,Q,N,V){var M=[0,1,0,-1],H=[0,1,2,3,0,-3,-2,-1],G=W+Q,O=V*2,L=0;while(W<G){var E=Y[W],j=E>>>6,B=E&63;if(W++,j==3)L=B&15,N[O>>>1]|=L<<4*(1-O&1),O++;if(j==0)for(var S=0;S<B;S++)N[O>>>1]|=L<<4*(1-O&1),O++;if(j==2)for(var S=0;S<2;S++){var A=B>>>3*(1-S)&7;if(A!=4)L+=H[A],N[O>>>1]|=L<<4*(1-O&1),O++}if(j==1)for(var S=0;S<3;S++){var A=B>>>2*(2-S)&3;if(A!=2)L+=M[A],N[O>>>1]|=L<<4*(1-O&1),O++}}},K.decode._dmap={"1":0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},K.decode._lens=function(){var Y=function(O,L,E,j){for(var B=0;B<L.length;B++)O[L[B]]=E+B*j},W="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",Q="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",N="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",V="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",M="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";W=W.split(","),Q=Q.split(","),N=N.split(","),V=V.split(","),M=M.split(",");var H={},G={};return Y(H,W,0,1),Y(H,N,64,64),Y(H,M,1792,64),Y(G,Q,0,1),Y(G,V,64,64),Y(G,M,1792,64),[H,G]}(),K.decode._decodeG4=function(Y,W,Q,N,V,M,H){var G=K.decode,O=W<<3,L=0,E="",j=[],B=[];for(var S=0;S<M;S++)B.push(0);B=G._makeDiff(B);var A=0,z=0,P=0,R=0,U=0,Z=0,w=0,h="",F=0,C=Math.ceil(M/8)*8;while(O>>>3<W+Q){R=G._findDiff(B,A+(A==0?0:1),1-Z),U=G._findDiff(B,R,Z);var D=0;if(H==1)D=Y[O>>>3]>>>7-(O&7)&1;if(H==2)D=Y[O>>>3]>>>(O&7)&1;if(O++,E+=D,h=="H"){if(G._lens[Z][E]!=null){var T=G._lens[Z][E];if(E="",L+=T,T<64){if(G._addNtimes(j,L,Z),A+=L,Z=1-Z,L=0,F--,F==0)h=""}}}else{if(E=="0001")E="",G._addNtimes(j,U-A,Z),A=U;if(E=="001")E="",h="H",F=2;if(G._dmap[E]!=null)z=R+G._dmap[E],G._addNtimes(j,z-A,Z),A=z,E="",Z=1-Z}if(j.length==M&&h=="")G._writeBits(j,N,V*8+w*C),Z=0,w++,A=0,B=G._makeDiff(j),j=[]}},K.decode._findDiff=function(Y,W,Q){for(var N=0;N<Y.length;N+=2)if(Y[N]>=W&&Y[N+1]==Q)return Y[N]},K.decode._makeDiff=function(Y){var W=[];if(Y[0]==1)W.push(0,1);for(var Q=1;Q<Y.length;Q++)if(Y[Q-1]!=Y[Q])W.push(Q,Y[Q]);return W.push(Y.length,0,Y.length,1),W},K.decode._decodeG2=function(Y,W,Q,N,V,M,H){var G=K.decode,O=W<<3,L=0,E="",j=[],B=0,S=0,A=Math.ceil(M/8)*8;while(O>>>3<W+Q){var z=0;if(H==1)z=Y[O>>>3]>>>7-(O&7)&1;if(H==2)z=Y[O>>>3]>>>(O&7)&1;if(O++,E+=z,L=G._lens[B][E],L!=null){if(G._addNtimes(j,L,B),E="",L<64)B=1-B;if(j.length==M){if(G._writeBits(j,N,V*8+S*A),j=[],S++,B=0,(O&7)!=0)O+=8-(O&7);if(L>=64)O+=8}}}},K.decode._decodeG3=function(Y,W,Q,N,V,M,H,G){var O=K.decode,L=W<<3,E=0,j="",B=[],S=[];for(var A=0;A<M;A++)B.push(0);var z=0,P=0,R=0,U=0,Z=0,w=0,h=-1,F="",C=0,D=!0,T=Math.ceil(M/8)*8;while(L>>>3<W+Q){U=O._findDiff(S,z+(z==0?0:1),1-w),Z=O._findDiff(S,U,w);var x=0;if(H==1)x=Y[L>>>3]>>>7-(L&7)&1;if(H==2)x=Y[L>>>3]>>>(L&7)&1;if(L++,j+=x,D){if(O._lens[w][j]!=null){var y=O._lens[w][j];if(j="",E+=y,y<64)O._addNtimes(B,E,w),w=1-w,E=0}}else if(F=="H"){if(O._lens[w][j]!=null){var y=O._lens[w][j];if(j="",E+=y,y<64){if(O._addNtimes(B,E,w),z+=E,w=1-w,E=0,C--,C==0)F=""}}}else{if(j=="0001")j="",O._addNtimes(B,Z-z,w),z=Z;if(j=="001")j="",F="H",C=2;if(O._dmap[j]!=null)P=U+O._dmap[j],O._addNtimes(B,P-z,w),z=P,j="",w=1-w}if(j.endsWith("000000000001")){if(h>=0)O._writeBits(B,N,V*8+h*T);if(G){if(H==1)D=(Y[L>>>3]>>>7-(L&7)&1)==1;if(H==2)D=(Y[L>>>3]>>>(L&7)&1)==1;L++}j="",w=0,h++,z=0,S=O._makeDiff(B),B=[]}}if(B.length==M)O._writeBits(B,N,V*8+h*T)},K.decode._addNtimes=function(Y,W,Q){for(var N=0;N<W;N++)Y.push(Q)},K.decode._writeBits=function(Y,W,Q){for(var N=0;N<Y.length;N++)W[Q+N>>>3]|=Y[N]<<7-(Q+N&7)},K.decode._decodeLZW=K.decode._decodeLZW=function(){var Y,W,Q,N,V=0,M=0,H=0,G=0,O=function(){var P=Y>>>3,R=W[P]<<16|W[P+1]<<8|W[P+2],U=R>>>24-(Y&7)-M&(1<<M)-1;return Y+=M,U},L=new Uint32Array(16384),E=0,j=function(P){if(P==E)return;E=P,H=1<<P,G=H+1;for(var R=0;R<G+1;R++)L[4*R]=L[4*R+3]=R,L[4*R+1]=65535,L[4*R+2]=1},B=function(P){M=P+1,V=G+1},S=function(P){var R=P<<2,U=L[R+2],Z=N+U-1;while(R!=65535)Q[Z--]=L[R],R=L[R+1];N+=U},A=function(P,R){var U=V<<2,Z=P<<2;if(L[U]=L[(R<<2)+3],L[U+1]=Z,L[U+2]=L[Z+2]+1,L[U+3]=L[Z+3],V++,V+1==1<<M&&M!=12)M++},z=function(P,R,U,Z,w,h){Y=R<<3,W=P,Q=Z,N=w;var F=R+U<<3,C=0,D=0;j(h),B(h);while(Y<F&&(C=O())!=G){if(C==H){if(B(h),C=O(),C==G)break;S(C)}else if(C<V)S(C),A(D,C);else A(D,D),S(V-1);D=C}return N};return z}(),K.tags={},K._types=function(){var Y=Array(250);Y.fill(0),Y=Y.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);var W={33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7};return{basic:{main:Y,rest:W},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}}(),K._readIFD=function(Y,W,Q,N,V,M){var H=Y.readUshort(W,Q);Q+=2;var G={};if(M.debug)X("   ".repeat(V),N.length-1,">>>----------------");for(var O=0;O<H;O++){var L=Y.readUshort(W,Q);Q+=2;var E=Y.readUshort(W,Q);Q+=2;var j=Y.readUint(W,Q);Q+=4;var B=Y.readUint(W,Q);Q+=4;var S=[];if(E==1||E==7){var A=j<5?Q-4:B;if(A+j>W.buffer.byteLength)j=W.buffer.byteLength-A;S=new Uint8Array(W.buffer,A,j)}if(E==2){var z=j<5?Q-4:B,P=W[z],R=Math.max(0,Math.min(j-1,W.length-z));if(P<128||R==0)S.push(Y.readASCII(W,z,R));else S=new Uint8Array(W.buffer,z,R)}if(E==3)for(var U=0;U<j;U++)S.push(Y.readUshort(W,(j<3?Q-4:B)+2*U));if(E==4||E==13)for(var U=0;U<j;U++)S.push(Y.readUint(W,(j<2?Q-4:B)+4*U));if(E==5||E==10){var Z=E==5?Y.readUint:Y.readInt;for(var U=0;U<j;U++)S.push([Z(W,B+U*8),Z(W,B+U*8+4)])}if(E==8)for(var U=0;U<j;U++)S.push(Y.readShort(W,(j<3?Q-4:B)+2*U));if(E==9)for(var U=0;U<j;U++)S.push(Y.readInt(W,(j<2?Q-4:B)+4*U));if(E==11)for(var U=0;U<j;U++)S.push(Y.readFloat(W,B+U*4));if(E==12)for(var U=0;U<j;U++)S.push(Y.readDouble(W,B+U*8));if(j!=0&&S.length==0){if(X(L,"unknown TIFF tag type: ",E,"num:",j),O==0)return;continue}if(M.debug)X("   ".repeat(V),L,E,K.tags[L],S);if(G["t"+L]=S,L==330&&G.t272&&G.t272[0]=="DSLR-A100");else if(L==330||L==34665||L==34853||L==50740&&Y.readUshort(W,Y.readUint(S,0))<300||L==61440){var w=L==50740?[Y.readUint(S,0)]:S,h=[];for(var U=0;U<w.length;U++)K._readIFD(Y,W,w[U],h,V+1,M);if(L==330)G.subIFD=h;if(L==34665)G.exifIFD=h[0];if(L==34853)G.gpsiIFD=h[0];if(L==50740)G.dngPrvt=h[0];if(L==61440)G.fujiIFD=h[0]}if(L==37500&&M.parseMN){var F=S;if(Y.readASCII(F,0,5)=="Nikon")G.makerNote=K.decode(F.slice(10).buffer)[0];else if(Y.readASCII(F,0,5)=="OLYMP"||Y.readASCII(F,0,9)=="OM SYSTEM"){var C=[8208,8224,8240,8256,8272],D=[];K._readIFD(Y,F,F[1]==77?16:F[5]==85?12:8,D,V+1,M);var T=G.makerNote=D.pop();for(var U=0;U<C.length;U++){var x="t"+C[U];if(T[x]==null)continue;K._readIFD(Y,F,T[x][0],D,V+1,M),T[x]=D.pop()}if(T.t12288)K._readIFD(Y,T.t12288,0,D,V+1,M),T.t12288=D.pop()}else if(Y.readUshort(W,B)<300&&Y.readUshort(W,B+4)<=12){var D=[];K._readIFD(Y,W,B,D,V+1,M),G.makerNote=D[0]}}}if(N.push(G),M.debug)X("   ".repeat(V),"<<<---------------");return Q},K._writeIFD=function(Y,W,Q,N,V){var M=Object.keys(V),H=M.length;if(V.exifIFD)H--;if(V.gpsiIFD)H--;Y.writeUshort(Q,N,H),N+=2;var G=N+H*12+4;for(var O=0;O<M.length;O++){var L=M[O];if(L=="t34665"||L=="t34853")continue;if(L=="exifIFD")L="t34665";if(L=="gpsiIFD")L="t34853";var E=parseInt(L.slice(1)),j=W.main[E];if(j==null)j=W.rest[E];if(j==null||j==0)throw Error("unknown type of tag: "+E);var B=V[L];if(E==34665){var S=K._writeIFD(Y,W,Q,G,V.exifIFD);B=[G],G=S[1]}if(E==34853){var S=K._writeIFD(Y,K._types.gps,Q,G,V.gpsiIFD);B=[G],G=S[1]}if(j==2)B=B[0]+"\x00";var A=B.length;Y.writeUshort(Q,N,E),N+=2,Y.writeUshort(Q,N,j),N+=2,Y.writeUint(Q,N,A),N+=4;var z=[-1,1,1,2,4,8,0,1,0,4,8,0,8][j]*A,P=N;if(z>4)Y.writeUint(Q,N,G),P=G;if(j==1||j==7)for(var R=0;R<A;R++)Q[P+R]=B[R];else if(j==2)Y.writeASCII(Q,P,B);else if(j==3)for(var R=0;R<A;R++)Y.writeUshort(Q,P+2*R,B[R]);else if(j==4)for(var R=0;R<A;R++)Y.writeUint(Q,P+4*R,B[R]);else if(j==5||j==10){var U=j==5?Y.writeUint:Y.writeInt;for(var R=0;R<A;R++){var Z=B[R],w=Z[0],h=Z[1];if(w==null)throw"e";U(Q,P+8*R,w),U(Q,P+8*R+4,h)}}else if(j==9)for(var R=0;R<A;R++)Y.writeInt(Q,P+4*R,B[R]);else if(j==12)for(var R=0;R<A;R++)Y.writeDouble(Q,P+8*R,B[R]);else throw j;if(z>4)z+=z&1,G+=z;N+=4}return[N,G]},K.toRGBA8=function(Y,W){function Q(A0){return A0<0.0031308?12.92*A0:1.055*Math.pow(A0,0.4166666666666667)-0.055}var{width:N,height:V}=Y,M=N*V,H=M*4,G=Y.data,O=new Uint8Array(M*4),L=Y.t262?Y.t262[0]:2,E=Y.t258?Math.min(32,Y.t258[0]):1;if(Y.t262==null&&E==1)L=0;var j=Y.t277?Y.t277[0]:Y.t258?Y.t258.length:[1,1,3,1,1,4,3][L],B=Y.t339?Y.t339[0]:null;if(L==1&&E==32&&B!=3)throw"e";var S=Math.ceil(j*E*N/8);if(L==0){W=0.00390625;for(var A=0;A<V;A++){var z=A*S,P=A*N;if(E==1)for(var R=0;R<N;R++){var U=P+R<<2,Z=G[z+(R>>3)]>>7-(R&7)&1;O[U]=O[U+1]=O[U+2]=(1-Z)*255,O[U+3]=255}if(E==4)for(var R=0;R<N;R++){var U=P+R<<2,Z=G[z+(R>>1)]>>4-4*(R&1)&15;O[U]=O[U+1]=O[U+2]=(15-Z)*17,O[U+3]=255}if(E==8)for(var R=0;R<N;R++){var U=P+R<<2,Z=G[z+R];O[U]=O[U+1]=O[U+2]=255-Z,O[U+3]=255}if(E==16)for(var R=0;R<N;R++){var U=P+R<<2,w=z+2*R,Z=G[w+1]<<8|G[w];O[U]=O[U+1]=O[U+2]=Math.min(255,255-~~(Z*W)),O[U+3]=255}}}else if(L==1){if(W==null)W=0.00390625;var h=(G.length&3)==0?new Float32Array(G.buffer):null;for(var A=0;A<V;A++){var z=A*S,P=A*N;if(E==1)for(var R=0;R<N;R++){var U=P+R<<2,Z=G[z+(R>>3)]>>7-(R&7)&1;O[U]=O[U+1]=O[U+2]=Z*255,O[U+3]=255}if(E==2)for(var R=0;R<N;R++){var U=P+R<<2,Z=G[z+(R>>2)]>>6-2*(R&3)&3;O[U]=O[U+1]=O[U+2]=Z*85,O[U+3]=255}if(E==8)for(var R=0;R<N;R++){var U=P+R<<2,Z=G[z+R*j];O[U]=O[U+1]=O[U+2]=Z,O[U+3]=255}if(E==16)for(var R=0;R<N;R++){var U=P+R<<2,w=z+2*R,Z=G[w+1]<<8|G[w];O[U]=O[U+1]=O[U+2]=Math.min(255,~~(Z*W)),O[U+3]=255}if(E==32)for(var R=0;R<N;R++){var U=P+R<<2,w=(z>>>2)+R,Z=h[w];O[U]=O[U+1]=O[U+2]=~~(0.5+255*Z),O[U+3]=255}}}else if(L==2)if(E==8){if(j==1)for(var R=0;R<M;R++)O[4*R]=O[4*R+1]=O[4*R+2]=G[R],O[4*R+3]=255;if(j==3)for(var R=0;R<M;R++){var U=R<<2,F=R*3;O[U]=G[F],O[U+1]=G[F+1],O[U+2]=G[F+2],O[U+3]=255}if(j>=4)for(var R=0;R<M;R++){var U=R<<2,F=R*j;O[U]=G[F],O[U+1]=G[F+1],O[U+2]=G[F+2],O[U+3]=G[F+3]}}else if(E==16){if(j==4)for(var R=0;R<M;R++){var U=R<<2,F=R*8+1;O[U]=G[F],O[U+1]=G[F+2],O[U+2]=G[F+4],O[U+3]=G[F+6]}if(j==3)for(var R=0;R<M;R++){var U=R<<2,F=R*6+1;O[U]=G[F],O[U+1]=G[F+2],O[U+2]=G[F+4],O[U+3]=255}}else if(E==32){var C=new Float32Array(G.buffer),D=0;for(var R=0;R<C.length;R++)D=Math.min(D,C[R]);if(D<0)for(var R=0;R<G.length;R+=4){var T=G[R];G[R]=G[R+3],G[R+3]=T,T=G[R+1],G[R+1]=G[R+2],G[R+2]=T}var x=[];for(var R=0;R<65536;R++)x.push(Q(R/65535));for(var R=0;R<C.length;R++){var y=Math.max(0,Math.min(1,C[R]));C[R]=x[~~(0.5+y*65535)]}if(j==3)for(var R=0;R<M;R++){var U=R<<2,F=R*3;O[U]=~~(0.5+C[F]*255),O[U+1]=~~(0.5+C[F+1]*255),O[U+2]=~~(0.5+C[F+2]*255),O[U+3]=255}else if(j==4)for(var R=0;R<M;R++){var U=R<<2,F=R*4;O[U]=~~(0.5+C[F]*255),O[U+1]=~~(0.5+C[F+1]*255),O[U+2]=~~(0.5+C[F+2]*255),O[U+3]=~~(0.5+C[F+3]*255)}else throw j}else throw E;else if(L==3){var b=Y.t320,_=1<<E,m=E==8&&j>1&&Y.t338&&Y.t338[0]!=0;for(var A=0;A<V;A++)for(var t=0;t<N;t++){var R=A*N+t,U=R<<2,l=0,s=A*S;if(E==1)l=G[s+(t>>>3)]>>>7-(t&7)&1;else if(E==2)l=G[s+(t>>>2)]>>>6-2*(t&3)&3;else if(E==4)l=G[s+(t>>>1)]>>>4-4*(t&1)&15;else if(E==8)l=G[s+t*j];else throw E;O[U]=b[l]>>8,O[U+1]=b[_+l]>>8,O[U+2]=b[_+_+l]>>8,O[U+3]=m?G[s+t*j+1]:255}}else if(L==5){var g=j>4?1:0;for(var R=0;R<M;R++){var U=R<<2,v=R*j;if(window.UDOC){var I=G[v],c=G[v+1],o=G[v+2],$0=G[v+3],a=UDOC.C.cmykToRgb([I*0.00392156862745098,c*0.00392156862745098,o*0.00392156862745098,$0*0.00392156862745098]);O[U]=~~(0.5+255*a[0]),O[U+1]=~~(0.5+255*a[1]),O[U+2]=~~(0.5+255*a[2])}else{var I=255-G[v],c=255-G[v+1],o=255-G[v+2],$0=(255-G[v+3])*0.00392156862745098;O[U]=~~(I*$0+0.5),O[U+1]=~~(c*$0+0.5),O[U+2]=~~(o*$0+0.5)}O[U+3]=255*(1-g)+G[v+4]*g}}else if(L==6&&Y.t278){var e=Y.t278[0];for(var A=0;A<V;A+=e){var R=A*N,r=e*N;for(var p=0;p<r;p++){var U=4*(R+p),v=3*R+4*(p>>>1),o=G[v+(p&1)],i=G[v+2]-128,X0=G[v+3]-128,K0=o+((X0>>2)+(X0>>3)+(X0>>5)),U0=o-((i>>2)+(i>>4)+(i>>5))-((X0>>1)+(X0>>3)+(X0>>4)+(X0>>5)),S0=o+(i+(i>>1)+(i>>2)+(i>>6));O[U]=Math.max(0,Math.min(255,K0)),O[U+1]=Math.max(0,Math.min(255,U0)),O[U+2]=Math.max(0,Math.min(255,S0)),O[U+3]=255}}}else if(L==32845)for(var A=0;A<V;A++)for(var t=0;t<N;t++){var v=(A*N+t)*6,U=(A*N+t)*4,u=G[v+1]<<8|G[v],u=Math.pow(2,(u+0.5)/256-64),M0=(G[v+3]+0.5)/410,q0=(G[v+5]+0.5)/410,H0=9*M0/(6*M0-16*q0+12),O0=4*q0/(6*M0-16*q0+12),E0=u,F0=H0*E0/O0,o=E0,C0=(1-H0-O0)*E0/O0,K0=2.69*F0-1.276*o-0.414*C0,U0=-1.022*F0+1.978*o+0.044*C0,S0=0.061*F0-0.224*o+1.163*C0;O[U]=Q(Math.min(K0,1))*255,O[U+1]=Q(Math.min(U0,1))*255,O[U+2]=Q(Math.min(S0,1))*255,O[U+3]=255}else X("Unknown Photometric interpretation: "+L);return O},K.replaceIMG=function(Y){if(Y==null)Y=document.getElementsByTagName("img");var W=["tif","tiff","dng","cr2","nef"];for(var Q=0;Q<Y.length;Q++){var N=Y[Q],V=N.getAttribute("src");if(V==null)continue;var M=V.split(".").pop().toLowerCase();if(W.indexOf(M)==-1)continue;var H=new XMLHttpRequest;K._xhrs.push(H),K._imgs.push(N),H.open("GET",V),H.responseType="arraybuffer",H.onload=K._imgLoaded,H.send()}},K._xhrs=[],K._imgs=[],K._imgLoaded=function(Y){var W=K._xhrs.indexOf(Y.target),Q=K._imgs[W];K._xhrs.splice(W,1),K._imgs.splice(W,1),Q.setAttribute("src",K.bufferToURI(Y.target.response))},K.bufferToURI=function(Y){var W=K.decode(Y),Q=W,N=0,V=Q[0];if(W[0].subIFD)Q=Q.concat(W[0].subIFD);for(var M=0;M<Q.length;M++){var H=Q[M];if(H.t258==null||H.t258.length<3)continue;var G=H.t256*H.t257;if(G>N)N=G,V=H}K.decodeImage(Y,V,W);var O=K.toRGBA8(V),L=V.width,E=V.height,j=document.createElement("canvas");j.width=L,j.height=E;var B=j.getContext("2d"),S=new ImageData(new Uint8ClampedArray(O.buffer),L,E);return B.putImageData(S,0,0),j.toDataURL()},K._binBE={nextZero:function(Y,W){while(Y[W]!=0)W++;return W},readUshort:function(Y,W){return Y[W]<<8|Y[W+1]},readShort:function(Y,W){var Q=K._binBE.ui8;return Q[0]=Y[W+1],Q[1]=Y[W+0],K._binBE.i16[0]},readInt:function(Y,W){var Q=K._binBE.ui8;return Q[0]=Y[W+3],Q[1]=Y[W+2],Q[2]=Y[W+1],Q[3]=Y[W+0],K._binBE.i32[0]},readUint:function(Y,W){var Q=K._binBE.ui8;return Q[0]=Y[W+3],Q[1]=Y[W+2],Q[2]=Y[W+1],Q[3]=Y[W+0],K._binBE.ui32[0]},readASCII:function(Y,W,Q){var N="";for(var V=0;V<Q;V++)N+=String.fromCharCode(Y[W+V]);return N},readFloat:function(Y,W){var Q=K._binBE.ui8;for(var N=0;N<4;N++)Q[N]=Y[W+3-N];return K._binBE.fl32[0]},readDouble:function(Y,W){var Q=K._binBE.ui8;for(var N=0;N<8;N++)Q[N]=Y[W+7-N];return K._binBE.fl64[0]},writeUshort:function(Y,W,Q){Y[W]=Q>>8&255,Y[W+1]=Q&255},writeInt:function(Y,W,Q){var N=K._binBE.ui8;K._binBE.i32[0]=Q,Y[W+3]=N[0],Y[W+2]=N[1],Y[W+1]=N[2],Y[W+0]=N[3]},writeUint:function(Y,W,Q){Y[W]=Q>>24&255,Y[W+1]=Q>>16&255,Y[W+2]=Q>>8&255,Y[W+3]=Q>>0&255},writeASCII:function(Y,W,Q){for(var N=0;N<Q.length;N++)Y[W+N]=Q.charCodeAt(N)},writeDouble:function(Y,W,Q){K._binBE.fl64[0]=Q;for(var N=0;N<8;N++)Y[W+N]=K._binBE.ui8[7-N]}},K._binBE.ui8=new Uint8Array(8),K._binBE.i16=new Int16Array(K._binBE.ui8.buffer),K._binBE.i32=new Int32Array(K._binBE.ui8.buffer),K._binBE.ui32=new Uint32Array(K._binBE.ui8.buffer),K._binBE.fl32=new Float32Array(K._binBE.ui8.buffer),K._binBE.fl64=new Float64Array(K._binBE.ui8.buffer),K._binLE={nextZero:K._binBE.nextZero,readUshort:function(Y,W){return Y[W+1]<<8|Y[W]},readShort:function(Y,W){var Q=K._binBE.ui8;return Q[0]=Y[W+0],Q[1]=Y[W+1],K._binBE.i16[0]},readInt:function(Y,W){var Q=K._binBE.ui8;return Q[0]=Y[W+0],Q[1]=Y[W+1],Q[2]=Y[W+2],Q[3]=Y[W+3],K._binBE.i32[0]},readUint:function(Y,W){var Q=K._binBE.ui8;return Q[0]=Y[W+0],Q[1]=Y[W+1],Q[2]=Y[W+2],Q[3]=Y[W+3],K._binBE.ui32[0]},readASCII:K._binBE.readASCII,readFloat:function(Y,W){var Q=K._binBE.ui8;for(var N=0;N<4;N++)Q[N]=Y[W+N];return K._binBE.fl32[0]},readDouble:function(Y,W){var Q=K._binBE.ui8;for(var N=0;N<8;N++)Q[N]=Y[W+N];return K._binBE.fl64[0]},writeUshort:function(Y,W,Q){Y[W]=Q&255,Y[W+1]=Q>>8&255},writeInt:function(Y,W,Q){var N=K._binBE.ui8;K._binBE.i32[0]=Q,Y[W+0]=N[0],Y[W+1]=N[1],Y[W+2]=N[2],Y[W+3]=N[3]},writeUint:function(Y,W,Q){Y[W]=Q>>>0&255,Y[W+1]=Q>>>8&255,Y[W+2]=Q>>>16&255,Y[W+3]=Q>>>24&255},writeASCII:K._binBE.writeASCII},K._copyTile=function(Y,W,Q,N,V,M,H,G){var O=Math.min(W,V-H),L=Math.min(Q,M-G);for(var E=0;E<L;E++){var j=(G+E)*V+H,B=E*W;for(var S=0;S<O;S++)N[j+S]=Y[B+S]}},K.LosslessJpegDecode=function(){var Y,W;function Q(){return Y[W++]}function N(){return Y[W++]<<8|Y[W++]}function V(P){var R=Q(),U=[0,0,0,255],Z=[],w=8;for(var h=0;h<16;h++)Z[h]=Q();for(var h=0;h<16;h++)for(var F=0;F<Z[h];F++){var C=M(U,0,h+1,1);U[C+3]=Q()}var D=new Uint8Array(1<<w);P[R]=[new Uint8Array(U),D];for(var h=0;h<1<<w;h++){var T=w,x=h,y=0,b=0;while(U[y+3]==255&&T!=0)b=x>>--T&1,y=U[y+b];D[h]=y}}function M(P,R,U,Z){if(P[R+3]!=255)return 0;if(U==0)return R;for(var w=0;w<2;w++){if(P[R+w]==0)P[R+w]=P.length,P.push(0,0,Z,255);var h=M(P,P[R+w],U-1,Z+1);if(h!=0)return h}return 0}function H(P){var{b:R,f:U}=P;while(R<25&&P.a<P.d){var Z=P.data[P.a++];if(Z==255&&!P.c)P.a++;U=U<<8|Z,R+=8}if(R<0)throw"e";P.b=R,P.f=U}function G(P,R){if(R.b<P)H(R);return R.f>>(R.b-=P)&65535>>16-P}function O(P,R){var U=P[0],Z=0,w=255,h=0;if(R.b<16)H(R);var F=R.f>>R.b-8&255;Z=P[1][F],w=U[Z+3],R.b-=U[Z+2];while(w==255)h=R.f>>--R.b&1,Z=U[Z+h],w=U[Z+3];return w}function L(P,R){if(P<32768>>16-R)P+=-(1<<R)+1;return P}function E(P,R){var U=O(P,R);if(U==0)return 0;if(U==16)return-32768;var Z=G(U,R);return L(Z,U)}function j(P,R,U,Z,w,h){var F=0;for(var C=0;C<h;C++){var D=C*R;for(var T=0;T<R;T+=w){F++;for(var x=0;x<w;x++)P[D+T+x]=E(Z[x],U)}if(U.e!=0&&F%U.e==0&&C!=0){var{a:y,data:b}=U;while(b[y]!=255||!(208<=b[y+1]&&b[y+1]<=215))y--;U.a=y+2,U.f=0,U.b=0}}}function B(P,R){return L(G(P,R),P)}function S(P,R,U,Z,w){var h=Y.length-W;for(var F=0;F<h;F+=4){var C=Y[W+F];Y[W+F]=Y[W+F+3],Y[W+F+3]=C;var C=Y[W+F+1];Y[W+F+1]=Y[W+F+2],Y[W+F+2]=C}for(var D=0;D<w;D++){var T=32768,x=32768;for(var y=0;y<R;y+=2){var b=O(Z,U),_=O(Z,U);if(b!=0)T+=B(b,U);if(_!=0)x+=B(_,U);P[D*R+y]=T&65535,P[D*R+y+1]=x&65535}}}function A(P){if(Y=P,W=0,N()!=65496)throw"e";var R=[],U=0,Z=0,w=0,h=[],F=[],C=[],D=0,T=0,x=0;while(!0){var y=N();if(y==65535){W--;continue}var b=N();if(y==65475){Z=Q(),T=N(),x=N(),D=Q();for(var _=0;_<D;_++){var m=Q(),t=Q(),l=Q();if(l!=0)throw"e";R[m]=[_,t>>4,t&15]}}else if(y==65476){var s=W+b-2;while(W<s)V(F)}else if(y==65498){W++;for(var _=0;_<D;_++){var g=Q(),v=R[g];C[v[0]]=F[Q()>>>4],h[v[0]]=v.slice(1)}U=Q(),W+=2;break}else if(y==65501)w=N();else W+=b-2}var I=Z>8?Uint16Array:Uint8Array,c=new I(T*x*D),o={b:0,f:0,c:U==8,a:W,data:Y,d:Y.length,e:w};if(o.c)S(c,x*D,o,C[0],T);else{var $0=[],a=0,e=0;for(var _=0;_<D;_++){var r=h[_],p=r[0],i=r[1];if(p>a)a=p;if(i>e)e=i;$0.push(p*i)}if(a!=1||e!=1){if(D!=3||$0[1]!=1||$0[2]!=1)throw"e";if(a!=2||e!=1&&e!=2)throw"e";var X0=[],K0=0;for(var _=0;_<D;_++){for(var U0=0;U0<$0[_];U0++)X0.push(C[_]);K0+=$0[_]}var S0=x/a,u=T/e,M0=S0*u;j(c,S0*K0,o,X0,K0,u),z(c,U,S0,u,K0-2,K0,K0,Z);var q0=new Uint16Array(M0*$0[0]);if(a==2&&e==2){for(var _=0;_<M0;_++)q0[4*_]=c[6*_],q0[4*_+1]=c[6*_+1],q0[4*_+2]=c[6*_+2],q0[4*_+3]=c[6*_+3];z(q0,U,S0*4,u,0,1,1,Z);for(var _=0;_<M0;_++)c[6*_]=q0[4*_],c[6*_+1]=q0[4*_+1],c[6*_+2]=q0[4*_+2],c[6*_+3]=q0[4*_+3]}if(a==2&&e==1){for(var _=0;_<M0;_++)q0[2*_]=c[4*_],q0[2*_+1]=c[4*_+1];z(q0,U,S0*2,u,0,1,1,Z);for(var _=0;_<M0;_++)c[4*_]=q0[2*_],c[4*_+1]=q0[2*_+1]}var H0=c.slice(0);for(var i=0;i<T;i++)if(e==2)for(var p=0;p<x;p++){var O0=(i*x+p)*D,E0=((i>>>1)*S0+(p>>>1))*K0,F0=(i&1)*2+(p&1);c[O0]=H0[E0+F0],c[O0+1]=H0[E0+4],c[O0+2]=H0[E0+5]}else for(var p=0;p<x;p++){var O0=(i*x+p)*D,E0=(i*S0+(p>>>1))*K0,F0=p&1;c[O0]=H0[E0+F0],c[O0+1]=H0[E0+2],c[O0+2]=H0[E0+3]}}else if(j(c,x*D,o,C,D,T),w==0)z(c,U,x,T,0,D,D,Z);else{var C0=Math.floor(w/x);for(var i=0;i<T;i+=C0){var A0=c.slice(i*x*D,(i+C0)*x*D);z(A0,U,x,C0,0,D,D,Z),c.set(A0,i*x*D)}}}return c}function z(P,R,U,Z,w,h,F,C){var D=U*F;for(var T=w;T<h;T++)P[T]+=1<<C-1;for(var x=F;x<D;x+=F)for(var T=w;T<h;T++)P[x+T]+=P[x+T-F];for(var y=1;y<Z;y++){var b=y*D;for(var T=w;T<h;T++)P[b+T]+=P[b+T-D];for(var x=F;x<D;x+=F)for(var T=w;T<h;T++){var _=b+x+T,m=_-D,t=P[_-F],l=0;if(R==0)l=0;else if(R==1)l=t;else if(R==2)l=P[m];else if(R==3)l=P[m-F];else if(R==4)l=t+(P[m]-P[m-F]);else if(R==5)l=t+(P[m]-P[m-F]>>>1);else if(R==6)l=P[m]+(t-P[m-F]>>>1);else if(R==7)l=t+P[m]>>>1;else throw R;P[_]+=l}}}return A}(),function(){var Y=0,W=1,Q=2,N=3,V=4,M=5,H=6,G=7,O=8,L=9,E=10,j=11,B=12,S=13,A=14,z=15,P=16,R=17,U=18;function Z(g){var v=K._binBE.readUshort,I={b:v(g,0),i:g[2],C:g[3],u:g[4],q:v(g,5),k:v(g,7),e:v(g,9),l:v(g,11),s:g[13],d:v(g,14)};if(I.b!=18771||I.i>1||I.q<6||I.q%6||I.e<768||I.e%24||I.l!=768||I.k<I.l||I.k%I.l||I.k-I.e>=I.l||I.s>16||I.s!=I.k/I.l||I.s!=Math.ceil(I.e/I.l)||I.d!=I.q/6||I.u!=12&&I.u!=14&&I.u!=16||I.C!=16&&I.C!=0)throw"Invalid data";if(I.i==0)throw"Not implemented. We need this file!";return I.h=I.C==16,I.m=(I.h?I.l*2/3:I.l>>>1)|0,I.A=I.m+2,I.f=64,I.g=(1<<I.u)-1,I.n=4*I.u,I}function w(g,v){var I=Array(v.s),c=4*v.s,o=16+c;if(c&12)o+=16-(c&12);for(var $0=0,a=16;$0<v.s;a+=4){var e=K._binBE.readUint(g,a);I[$0]=g.slice(o,o+e),I[$0].j=0,I[$0].a=0,o+=e,$0++}if(o!=g.length)throw"Invalid data";return I}function h(g,v){for(var I=-v[4],c=0;I<=v[4];c++,I++)g[c]=I<=-v[3]?-4:I<=-v[2]?-3:I<=-v[1]?-2:I<-v[0]?-1:I<=v[0]?0:I<v[1]?1:I<v[2]?2:I<v[3]?3:4}function F(g,v,I){var c=[v,3*v+18,5*v+67,7*v+276,I];g.o=v,g.w=(c[4]+2*v)/(2*v+1)+1|0,g.v=Math.ceil(Math.log2(g.w)),g.t=9,h(g.c,c)}function C(g){var v={c:new Int8Array(2<<g.u)};return F(v,0,g.g),v}function D(g){var v=[[],[],[]],I=Math.max(2,g.w+32>>>6);for(var c=0;c<3;c++)for(var o=0;o<41;o++)v[c][o]=[I,1];return v}function T(g){for(var v=-1,I=0;!I;v++)if(I=g[g.j]>>>7-g.a&1,g.a++,g.a&=7,!g.a)g.j++;return v}function x(g,v){var I=0,c=8-g.a,o=g.j,$0=g.a;if(v){if(v>=c)do I<<=c,v-=c,I|=g[g.j]&(1<<c)-1,g.j++,c=8;while(v>=8);if(v)I<<=v,c-=v,I|=g[g.j]>>>c&(1<<v)-1;g.a=8-c}return I}function y(g,v){var I=0;if(v<g)while(I<=14&&v<<++I<g);return I}function b(g,v,I,c,o,$0,a,e){if(e==null)e=0;var r=$0+1,p=r%2,i=0,X0=0,K0=0,U0,S0,u=c[o],M0=c[o-1],q0=c[o-2][r],H0=M0[r-1],O0=M0[r],E0=M0[r+1],F0=u[r-1],C0=u[r+1],A0=Math.abs,T0,Y0,J0,V0;if(p)T0=A0(E0-O0),Y0=A0(q0-O0),J0=A0(H0-O0);if(p){if(V0=T0>J0&&Y0<T0?q0+H0:T0<J0&&Y0<J0?q0+E0:E0+H0,V0=V0+2*O0>>>2,e){u[r]=V0;return}U0=v.t*v.c[g.g+O0-q0]+v.c[g.g+H0-O0]}else V0=O0>H0&&O0>E0||O0<H0&&O0<E0?C0+F0+2*O0>>>2:F0+C0>>>1,U0=v.t*v.c[g.g+O0-H0]+v.c[g.g+H0-F0];S0=A0(U0);var g0=T(I);if(g0<g.n-v.v-1){var z0=y(a[S0][0],a[S0][1]);K0=x(I,z0)+(g0<<z0)}else K0=x(I,v.v)+1;if(K0=K0&1?-1-(K0>>>1):K0>>>1,a[S0][0]+=A0(K0),a[S0][1]==g.f)a[S0][0]>>>=1,a[S0][1]>>>=1;if(a[S0][1]++,V0=U0<0?V0-K0:V0+K0,g.i){if(V0<0)V0+=v.w;else if(V0>g.g)V0-=v.w}u[r]=V0>=0?Math.min(V0,g.g):0}function _(g,v,I){var c=g[0].length;for(var o=v;o<=I;o++)g[o][0]=g[o-1][1],g[o][c-1]=g[o-1][c-2]}function m(g){_(g,G,B),_(g,Q,V),_(g,z,R)}function t(g,v,I,c,o,$0,a,e,r,p,i,X0,K0){var U0=0,S0=1,u=o<S&&o>V;while(S0<g.m){if(U0<g.m)b(g,v,I,c,o,U0,a[r],g.h&&(u&&p||!u&&(i||(U0&X0)==K0))),b(g,v,I,c,$0,U0,a[r],g.h&&(!u&&p||u&&(i||(U0&X0)==K0))),U0+=2;if(U0>8)b(g,v,I,c,o,S0,e[r]),b(g,v,I,c,$0,S0,e[r]),S0+=2}m(c)}function l(g,v,I,c,o,$0){t(g,v,I,c,Q,G,o,$0,0,0,1,0,8),t(g,v,I,c,O,z,o,$0,1,0,1,0,8),t(g,v,I,c,N,L,o,$0,2,1,0,3,0),t(g,v,I,c,E,P,o,$0,0,0,0,3,2),t(g,v,I,c,V,j,o,$0,1,0,0,3,2),t(g,v,I,c,B,R,o,$0,2,1,0,3,0)}function s(g,v,I,c,o,$0){var a=$0.length,e=g.l;if(o+1==g.s)e=g.e-o*g.l;var r=6*g.e*c+o*g.l;for(var p=0;p<6;p++){for(var i=0;i<e;i++){var X0=$0[p%a][i%a],K0;if(X0==0)K0=Q+(p>>>1);else if(X0==2)K0=z+(p>>>1);else K0=G+p;var U0=g.h?(i*2/3&2147483646|i%3&1)+(i%3>>>1):i>>>1;v[r+i]=I[K0][U0+1]}r+=g.e}}K._decompressRAF=function(g,v){var I=Z(g),c=w(g,I),o=C(I),$0=new Int16Array(I.e*I.q);if(v==null)v=I.h?[[1,1,0,1,1,2],[1,1,2,1,1,0],[2,0,1,0,2,1],[1,1,2,1,1,0],[1,1,0,1,1,2],[0,2,1,2,0,1]]:[[0,1],[3,2]];var a=[[Y,N],[W,V],[M,j],[H,B],[S,P],[A,R]],e=[];for(var r=0;r<U;r++)e[r]=new Uint16Array(I.A);for(var p=0;p<I.s;p++){var i=D(o),X0=D(o);for(var r=0;r<U;r++)for(var K0=0;K0<I.A;K0++)e[r][K0]=0;for(var U0=0;U0<I.d;U0++){l(I,o,c[p],e,i,X0);for(var r=0;r<6;r++)for(var K0=0;K0<I.A;K0++)e[a[r][0]][K0]=e[a[r][1]][K0];s(I,$0,e,U0,p,v);for(var r=Q;r<U;r++)if([M,H,S,A].indexOf(r)==-1)for(var K0=0;K0<I.A;K0++)e[r][K0]=0;m(e)}}return $0}}()})($,J)})()});var $Q=L0((bE)=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */bE.read=function($,J,X,K,q){var Y,W,Q=q*8-K-1,N=(1<<Q)-1,V=N>>1,M=-7,H=X?q-1:0,G=X?-1:1,O=$[J+H];H+=G,Y=O&(1<<-M)-1,O>>=-M,M+=Q;for(;M>0;Y=Y*256+$[J+H],H+=G,M-=8);W=Y&(1<<-M)-1,Y>>=-M,M+=K;for(;M>0;W=W*256+$[J+H],H+=G,M-=8);if(Y===0)Y=1-V;else if(Y===N)return W?NaN:(O?-1:1)*(1/0);else W=W+Math.pow(2,K),Y=Y-V;return(O?-1:1)*W*Math.pow(2,Y-K)};bE.write=function($,J,X,K,q,Y){var W,Q,N,V=Y*8-q-1,M=(1<<V)-1,H=M>>1,G=q===23?Math.pow(2,-24)-Math.pow(2,-77):0,O=K?0:Y-1,L=K?1:-1,E=J<0||J===0&&1/J<0?1:0;if(J=Math.abs(J),isNaN(J)||J===1/0)Q=isNaN(J)?1:0,W=M;else{if(W=Math.floor(Math.log(J)/Math.LN2),J*(N=Math.pow(2,-W))<1)W--,N*=2;if(W+H>=1)J+=G/N;else J+=G*Math.pow(2,1-H);if(J*N>=2)W++,N/=2;if(W+H>=M)Q=0,W=M;else if(W+H>=1)Q=(J*N-1)*Math.pow(2,q),W=W+H;else Q=J*Math.pow(2,H-1)*Math.pow(2,q),W=0}for(;q>=8;$[X+O]=Q&255,O+=L,Q/=256,q-=8);W=W<<q|Q,V+=q;for(;V>0;$[X+O]=W&255,O+=L,W/=256,V-=8);$[X+O-L]|=E*128}});var VQ=L0((YQ)=>{Object.defineProperty(YQ,"__esModule",{value:!0});YQ.AnsiStringType=YQ.StringType=YQ.BufferType=YQ.Uint8ArrayType=YQ.IgnoreType=YQ.Float80_LE=YQ.Float80_BE=YQ.Float64_LE=YQ.Float64_BE=YQ.Float32_LE=YQ.Float32_BE=YQ.Float16_LE=YQ.Float16_BE=YQ.INT64_BE=YQ.UINT64_BE=YQ.INT64_LE=YQ.UINT64_LE=YQ.INT32_LE=YQ.INT32_BE=YQ.INT24_BE=YQ.INT24_LE=YQ.INT16_LE=YQ.INT16_BE=YQ.INT8=YQ.UINT32_BE=YQ.UINT32_LE=YQ.UINT24_BE=YQ.UINT24_LE=YQ.UINT16_BE=YQ.UINT16_LE=YQ.UINT8=void 0;var S1=$Q();function h0($){return new DataView($.buffer,$.byteOffset)}YQ.UINT8={len:1,get($,J){return h0($).getUint8(J)},put($,J,X){return h0($).setUint8(J,X),J+1}};YQ.UINT16_LE={len:2,get($,J){return h0($).getUint16(J,!0)},put($,J,X){return h0($).setUint16(J,X,!0),J+2}};YQ.UINT16_BE={len:2,get($,J){return h0($).getUint16(J)},put($,J,X){return h0($).setUint16(J,X),J+2}};YQ.UINT24_LE={len:3,get($,J){let X=h0($);return X.getUint8(J)+(X.getUint16(J+1,!0)<<8)},put($,J,X){let K=h0($);return K.setUint8(J,X&255),K.setUint16(J+1,X>>8,!0),J+3}};YQ.UINT24_BE={len:3,get($,J){let X=h0($);return(X.getUint16(J)<<8)+X.getUint8(J+2)},put($,J,X){let K=h0($);return K.setUint16(J,X>>8),K.setUint8(J+2,X&255),J+3}};YQ.UINT32_LE={len:4,get($,J){return h0($).getUint32(J,!0)},put($,J,X){return h0($).setUint32(J,X,!0),J+4}};YQ.UINT32_BE={len:4,get($,J){return h0($).getUint32(J)},put($,J,X){return h0($).setUint32(J,X),J+4}};YQ.INT8={len:1,get($,J){return h0($).getInt8(J)},put($,J,X){return h0($).setInt8(J,X),J+1}};YQ.INT16_BE={len:2,get($,J){return h0($).getInt16(J)},put($,J,X){return h0($).setInt16(J,X),J+2}};YQ.INT16_LE={len:2,get($,J){return h0($).getInt16(J,!0)},put($,J,X){return h0($).setInt16(J,X,!0),J+2}};YQ.INT24_LE={len:3,get($,J){let X=YQ.UINT24_LE.get($,J);return X>8388607?X-16777216:X},put($,J,X){let K=h0($);return K.setUint8(J,X&255),K.setUint16(J+1,X>>8,!0),J+3}};YQ.INT24_BE={len:3,get($,J){let X=YQ.UINT24_BE.get($,J);return X>8388607?X-16777216:X},put($,J,X){let K=h0($);return K.setUint16(J,X>>8),K.setUint8(J+2,X&255),J+3}};YQ.INT32_BE={len:4,get($,J){return h0($).getInt32(J)},put($,J,X){return h0($).setInt32(J,X),J+4}};YQ.INT32_LE={len:4,get($,J){return h0($).getInt32(J,!0)},put($,J,X){return h0($).setInt32(J,X,!0),J+4}};YQ.UINT64_LE={len:8,get($,J){return h0($).getBigUint64(J,!0)},put($,J,X){return h0($).setBigUint64(J,X,!0),J+8}};YQ.INT64_LE={len:8,get($,J){return h0($).getBigInt64(J,!0)},put($,J,X){return h0($).setBigInt64(J,X,!0),J+8}};YQ.UINT64_BE={len:8,get($,J){return h0($).getBigUint64(J)},put($,J,X){return h0($).setBigUint64(J,X),J+8}};YQ.INT64_BE={len:8,get($,J){return h0($).getBigInt64(J)},put($,J,X){return h0($).setBigInt64(J,X),J+8}};YQ.Float16_BE={len:2,get($,J){return S1.read($,J,!1,10,this.len)},put($,J,X){return S1.write($,X,J,!1,10,this.len),J+this.len}};YQ.Float16_LE={len:2,get($,J){return S1.read($,J,!0,10,this.len)},put($,J,X){return S1.write($,X,J,!0,10,this.len),J+this.len}};YQ.Float32_BE={len:4,get($,J){return h0($).getFloat32(J)},put($,J,X){return h0($).setFloat32(J,X),J+4}};YQ.Float32_LE={len:4,get($,J){return h0($).getFloat32(J,!0)},put($,J,X){return h0($).setFloat32(J,X,!0),J+4}};YQ.Float64_BE={len:8,get($,J){return h0($).getFloat64(J)},put($,J,X){return h0($).setFloat64(J,X),J+8}};YQ.Float64_LE={len:8,get($,J){return h0($).getFloat64(J,!0)},put($,J,X){return h0($).setFloat64(J,X,!0),J+8}};YQ.Float80_BE={len:10,get($,J){return S1.read($,J,!1,63,this.len)},put($,J,X){return S1.write($,X,J,!1,63,this.len),J+this.len}};YQ.Float80_LE={len:10,get($,J){return S1.read($,J,!0,63,this.len)},put($,J,X){return S1.write($,X,J,!0,63,this.len),J+this.len}};class JQ{constructor($){this.len=$}get($,J){}}YQ.IgnoreType=JQ;class XQ{constructor($){this.len=$}get($,J){return $.subarray(J,J+this.len)}}YQ.Uint8ArrayType=XQ;class KQ{constructor($){this.len=$}get($,J){return Buffer.from($.subarray(J,J+this.len))}}YQ.BufferType=KQ;class qQ{constructor($,J){this.len=$,this.encoding=J}get($,J){return Buffer.from($).toString(this.encoding,J,J+this.len)}}YQ.StringType=qQ;class P1{constructor($){this.len=$}static decode($,J,X){let K="";for(let q=J;q<X;++q)K+=P1.codePointToString(P1.singleByteDecoder($[q]));return K}static inRange($,J,X){return J<=$&&$<=X}static codePointToString($){if($<=65535)return String.fromCharCode($);else return $-=65536,String.fromCharCode(($>>10)+55296,($&1023)+56320)}static singleByteDecoder($){if(P1.inRange($,0,127))return $;let J=P1.windows1252[$-128];if(J===null)throw Error("invaliding encoding");return J}get($,J=0){return P1.decode($,J,J+this.len)}}YQ.AnsiStringType=P1;P1.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]});var p$=L0((HQ)=>{Object.defineProperty(HQ,"__esModule",{value:!0});HQ.EndOfStreamError=HQ.defaultMessages=void 0;HQ.defaultMessages="End-Of-Stream";class MQ extends Error{constructor(){super(HQ.defaultMessages)}}HQ.EndOfStreamError=MQ});var EQ=L0((LQ)=>{Object.defineProperty(LQ,"__esModule",{value:!0});LQ.Deferred=void 0;class UQ{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise(($,J)=>{this.reject=J,this.resolve=$})}}LQ.Deferred=UQ});var SQ=L0((X4)=>{Object.defineProperty(X4,"__esModule",{value:!0});X4.StreamReader=X4.EndOfStreamError=void 0;var RQ=p$(),jR=EQ(),ER=p$();Object.defineProperty(X4,"EndOfStreamError",{enumerable:!0,get:function(){return ER.EndOfStreamError}});var RR=1048576;class BQ{constructor($){if(this.s=$,this.deferred=null,this.endOfStream=!1,this.peekQueue=[],!$.read||!$.once)throw Error("Expected an instance of stream.Readable");this.s.once("end",()=>this.reject(new RQ.EndOfStreamError)),this.s.once("error",(J)=>this.reject(J)),this.s.once("close",()=>this.reject(Error("Stream closed")))}async peek($,J,X){let K=await this.read($,J,X);return this.peekQueue.push($.subarray(J,J+K)),K}async read($,J,X){if(X===0)return 0;if(this.peekQueue.length===0&&this.endOfStream)throw new RQ.EndOfStreamError;let K=X,q=0;while(this.peekQueue.length>0&&K>0){let Y=this.peekQueue.pop();if(!Y)throw Error("peekData should be defined");let W=Math.min(Y.length,K);if($.set(Y.subarray(0,W),J+q),q+=W,K-=W,W<Y.length)this.peekQueue.push(Y.subarray(W))}while(K>0&&!this.endOfStream){let Y=Math.min(K,RR),W=await this.readFromStream($,J+q,Y);if(q+=W,W<Y)break;K-=W}return q}async readFromStream($,J,X){let K=this.s.read(X);if(K)return $.set(K,J),K.length;else{let q={buffer:$,offset:J,length:X,deferred:new jR.Deferred};return this.deferred=q.deferred,this.s.once("readable",()=>{this.readDeferred(q)}),q.deferred.promise}}readDeferred($){let J=this.s.read($.length);if(J)$.buffer.set(J,$.offset),$.deferred.resolve(J.length),this.deferred=null;else this.s.once("readable",()=>{this.readDeferred($)})}reject($){if(this.endOfStream=!0,this.deferred)this.deferred.reject($),this.deferred=null}}X4.StreamReader=BQ});var T9=L0((u$)=>{Object.defineProperty(u$,"__esModule",{value:!0});u$.StreamReader=u$.EndOfStreamError=void 0;var BR=p$();Object.defineProperty(u$,"EndOfStreamError",{enumerable:!0,get:function(){return BR.EndOfStreamError}});var PR=SQ();Object.defineProperty(u$,"StreamReader",{enumerable:!0,get:function(){return PR.StreamReader}})});var K4=L0((FQ)=>{Object.defineProperty(FQ,"__esModule",{value:!0});FQ.AbstractTokenizer=void 0;var l$=T9();class AQ{constructor($){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=$?$:{}}async readToken($,J=this.position){let X=Buffer.alloc($.len);if(await this.readBuffer(X,{position:J})<$.len)throw new l$.EndOfStreamError;return $.get(X,0)}async peekToken($,J=this.position){let X=Buffer.alloc($.len);if(await this.peekBuffer(X,{position:J})<$.len)throw new l$.EndOfStreamError;return $.get(X,0)}async readNumber($){if(await this.readBuffer(this.numBuffer,{length:$.len})<$.len)throw new l$.EndOfStreamError;return $.get(this.numBuffer,0)}async peekNumber($){if(await this.peekBuffer(this.numBuffer,{length:$.len})<$.len)throw new l$.EndOfStreamError;return $.get(this.numBuffer,0)}async ignore($){if(this.fileInfo.size!==void 0){let J=this.fileInfo.size-this.position;if($>J)return this.position+=J,J}return this.position+=$,$}async close(){}normalizeOptions($,J){if(J&&J.position!==void 0&&J.position<this.position)throw Error("`options.position` must be equal or greater than `tokenizer.position`");if(J)return{mayBeLess:J.mayBeLess===!0,offset:J.offset?J.offset:0,length:J.length?J.length:$.length-(J.offset?J.offset:0),position:J.position?J.position:this.position};return{mayBeLess:!1,offset:0,length:$.length,position:this.position}}}FQ.AbstractTokenizer=AQ});var DQ=L0((ZQ)=>{Object.defineProperty(ZQ,"__esModule",{value:!0});ZQ.ReadStreamTokenizer=void 0;var AR=K4(),c$=T9(),FR=256000;class CQ extends AR.AbstractTokenizer{constructor($,J){super(J);this.streamReader=new c$.StreamReader($)}async getFileInfo(){return this.fileInfo}async readBuffer($,J){let X=this.normalizeOptions($,J),K=X.position-this.position;if(K>0)return await this.ignore(K),this.readBuffer($,J);else if(K<0)throw Error("`options.position` must be equal or greater than `tokenizer.position`");if(X.length===0)return 0;let q=await this.streamReader.read($,X.offset,X.length);if(this.position+=q,(!J||!J.mayBeLess)&&q<X.length)throw new c$.EndOfStreamError;return q}async peekBuffer($,J){let X=this.normalizeOptions($,J),K=0;if(X.position){let q=X.position-this.position;if(q>0){let Y=new Uint8Array(X.length+q);return K=await this.peekBuffer(Y,{mayBeLess:X.mayBeLess}),$.set(Y.subarray(q),X.offset),K-q}else if(q<0)throw Error("Cannot peek from a negative offset in a stream")}if(X.length>0){try{K=await this.streamReader.peek($,X.offset,X.length)}catch(q){if(J&&J.mayBeLess&&q instanceof c$.EndOfStreamError)return 0;throw q}if(!X.mayBeLess&&K<X.length)throw new c$.EndOfStreamError}return K}async ignore($){let J=Math.min(FR,$),X=new Uint8Array(J),K=0;while(K<$){let q=$-K,Y=await this.readBuffer(X,{length:Math.min(J,q)});if(Y<0)return Y;K+=Y}return K}}ZQ.ReadStreamTokenizer=CQ});var IQ=L0((wQ)=>{Object.defineProperty(wQ,"__esModule",{value:!0});wQ.BufferTokenizer=void 0;var zR=T9(),CR=K4();class kQ extends CR.AbstractTokenizer{constructor($,J){super(J);this.uint8Array=$,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:$.length}async readBuffer($,J){if(J&&J.position){if(J.position<this.position)throw Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=J.position}let X=await this.peekBuffer($,J);return this.position+=X,X}async peekBuffer($,J){let X=this.normalizeOptions($,J),K=Math.min(this.uint8Array.length-X.position,X.length);if(!X.mayBeLess&&K<X.length)throw new zR.EndOfStreamError;else return $.set(this.uint8Array.subarray(X.position,X.position+K),X.offset),K}async close(){}}wQ.BufferTokenizer=kQ});var yQ=L0((q4)=>{Object.defineProperty(q4,"__esModule",{value:!0});q4.fromBuffer=q4.fromStream=q4.EndOfStreamError=void 0;var ZR=DQ(),vR=IQ(),DR=T9();Object.defineProperty(q4,"EndOfStreamError",{enumerable:!0,get:function(){return DR.EndOfStreamError}});function kR($,J){return J=J?J:{},new ZR.ReadStreamTokenizer($,J)}q4.fromStream=kR;function wR($,J){return new vR.BufferTokenizer($,J)}q4.fromBuffer=wR});var xQ=L0((IR)=>{IR.stringToBytes=($)=>[...$].map((J)=>J.charCodeAt(0));IR.tarHeaderChecksumMatches=($,J=0)=>{let X=parseInt($.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(X))return!1;let K=256;for(let q=J;q<J+148;q++)K+=$[q];for(let q=J+156;q<J+512;q++)K+=$[q];return X===K};IR.uint32SyncSafeToken={get:($,J)=>{return $[J+3]&127|$[J+2]<<7|$[J+1]<<14|$[J]<<21},len:4}});var gQ=L0((fz,hQ)=>{hQ.exports={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]}});var pQ=L0((mQ,W4)=>{var s8=VQ(),d$=yQ(),{stringToBytes:hR,tarHeaderChecksumMatches:gR,uint32SyncSafeToken:fR}=xQ(),fQ=gQ(),bz=4100;async function bR($){let J=await d$.fromStream($);try{return await n$(J)}finally{await J.close()}}async function bQ($){if(!($ instanceof Uint8Array||$ instanceof ArrayBuffer||Buffer.isBuffer($)))throw TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof $}\``);let J=$ instanceof Buffer?$:Buffer.from($);if(!(J&&J.length>1))return;let X=d$.fromBuffer(J);return n$(X)}function _8($,J,X){X={offset:0,...X};for(let[K,q]of J.entries())if(X.mask){if(q!==(X.mask[K]&$[K+X.offset]))return!1}else if(q!==$[K+X.offset])return!1;return!0}async function n$($){try{return mR($)}catch(J){if(!(J instanceof d$.EndOfStreamError))throw J}}async function mR($){let J=Buffer.alloc(4100),X=12,K=(Y,W)=>_8(J,Y,W),q=(Y,W)=>K(hR(Y),W);if(!$.fileInfo.size)$.fileInfo.size=Number.MAX_SAFE_INTEGER;if(await $.peekBuffer(J,{length:X,mayBeLess:!0}),K([66,77]))return{ext:"bmp",mime:"image/bmp"};if(K([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(K([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(K([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(K([37,33])){if(await $.peekBuffer(J,{length:24,mayBeLess:!0}),q("PS-Adobe-",{offset:2})&&q(" EPSF-",{offset:14}))return{ext:"eps",mime:"application/eps"};return{ext:"ps",mime:"application/postscript"}}if(K([31,160])||K([31,157]))return{ext:"Z",mime:"application/x-compress"};if(K([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(K([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(K([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(K([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(q("ID3")){await $.ignore(6);let Y=await $.readToken(fR);if($.position+Y>$.fileInfo.size)return{ext:"mp3",mime:"audio/mpeg"};return await $.ignore(Y),n$($)}if(q("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((J[0]===67||J[0]===70)&&K([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(K([71,73,70]))return{ext:"gif",mime:"image/gif"};if(q("FLIF"))return{ext:"flif",mime:"image/flif"};if(q("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(q("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(q("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(q("FORM"))return{ext:"aif",mime:"audio/aiff"};if(q("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(K([80,75,3,4])){try{while($.position+30<$.fileInfo.size){await $.readBuffer(J,{length:30});let Y={compressedSize:J.readUInt32LE(18),uncompressedSize:J.readUInt32LE(22),filenameLength:J.readUInt16LE(26),extraFieldLength:J.readUInt16LE(28)};if(Y.filename=await $.readToken(new s8.StringType(Y.filenameLength,"utf-8")),await $.ignore(Y.extraFieldLength),Y.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(Y.filename.endsWith(".rels")||Y.filename.endsWith(".xml"))switch(Y.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};default:break}if(Y.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(Y.filename.startsWith("3D/")&&Y.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(Y.filename==="mimetype"&&Y.compressedSize===Y.uncompressedSize)switch(await $.readToken(new s8.StringType(Y.compressedSize,"utf-8"))){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};default:}if(Y.compressedSize===0){let W=-1;while(W<0&&$.position<$.fileInfo.size)await $.peekBuffer(J,{mayBeLess:!0}),W=J.indexOf("504B0304",0,"hex"),await $.ignore(W>=0?W:J.length)}else await $.ignore(Y.compressedSize)}}catch(Y){if(!(Y instanceof d$.EndOfStreamError))throw Y}return{ext:"zip",mime:"application/zip"}}if(q("OggS")){await $.ignore(28);let Y=Buffer.alloc(8);if(await $.readBuffer(Y),_8(Y,[79,112,117,115,72,101,97,100]))return{ext:"opus",mime:"audio/opus"};if(_8(Y,[128,116,104,101,111,114,97]))return{ext:"ogv",mime:"video/ogg"};if(_8(Y,[1,118,105,100,101,111,0]))return{ext:"ogm",mime:"video/ogg"};if(_8(Y,[127,70,76,65,67]))return{ext:"oga",mime:"audio/ogg"};if(_8(Y,[83,112,101,101,120,32,32]))return{ext:"spx",mime:"audio/ogg"};if(_8(Y,[1,118,111,114,98,105,115]))return{ext:"ogg",mime:"audio/ogg"};return{ext:"ogx",mime:"application/ogg"}}if(K([80,75])&&(J[2]===3||J[2]===5||J[2]===7)&&(J[3]===4||J[3]===6||J[3]===8))return{ext:"zip",mime:"application/zip"};if(q("ftyp",{offset:4})&&(J[8]&96)!==0){let Y=J.toString("binary",8,12).replace("\x00"," ").trim();switch(Y){case"avif":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:if(Y.startsWith("3g")){if(Y.startsWith("3g2"))return{ext:"3g2",mime:"video/3gpp2"};return{ext:"3gp",mime:"video/3gpp"}}return{ext:"mp4",mime:"video/mp4"}}}if(q("MThd"))return{ext:"mid",mime:"audio/midi"};if(q("wOFF")&&(K([0,1,0,0],{offset:4})||q("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(q("wOF2")&&(K([0,1,0,0],{offset:4})||q("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(K([212,195,178,161])||K([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(q("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(q("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(q("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(K([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(q("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(q("%PDF")){await $.ignore(1350);let Y=10485760,W=Buffer.alloc(Math.min(Y,$.fileInfo.size));if(await $.readBuffer(W,{mayBeLess:!0}),W.includes(Buffer.from("AIPrivateData")))return{ext:"ai",mime:"application/postscript"};return{ext:"pdf",mime:"application/pdf"}}if(K([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(K([73,73,42,0])){if(q("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(K([28,0,254,0],{offset:8})||K([31,0,11,0],{offset:8}))return{ext:"nef",mime:"image/x-nikon-nef"};if(K([8,0,0,0],{offset:4})&&(K([45,0,254,0],{offset:8})||K([39,0,254,0],{offset:8})))return{ext:"dng",mime:"image/x-adobe-dng"};if(J=Buffer.alloc(24),await $.peekBuffer(J),(K([16,251,134,1],{offset:4})||K([8,0,0,0],{offset:4}))&&K([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9}))return{ext:"arw",mime:"image/x-sony-arw"};return{ext:"tif",mime:"image/tiff"}}if(K([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(q("MAC "))return{ext:"ape",mime:"audio/ape"};if(K([26,69,223,163])){async function Y(){let M=await $.peekNumber(s8.UINT8),H=128,G=0;while((M&H)===0&&H!==0)++G,H>>=1;let O=Buffer.alloc(G+1);return await $.readBuffer(O),O}async function W(){let M=await Y(),H=await Y();H[0]^=128>>H.length-1;let G=Math.min(6,H.length);return{id:M.readUIntBE(0,M.length),len:H.readUIntBE(H.length-G,G)}}async function Q(M,H){while(H>0){let G=await W();if(G.id===17026)return $.readToken(new s8.StringType(G.len,"utf-8"));await $.ignore(G.len),--H}}let N=await W();switch(await Q(1,N.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(K([82,73,70,70])){if(K([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(K([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(K([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(q("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(K([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(q("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(q("MSCF")||q("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(K([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(K([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(K([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(K([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(q("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(q("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(K([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(q("IMPM"))return{ext:"it",mime:"audio/x-it"};if(q("-lh0-",{offset:2})||q("-lh1-",{offset:2})||q("-lh2-",{offset:2})||q("-lh3-",{offset:2})||q("-lh4-",{offset:2})||q("-lh5-",{offset:2})||q("-lh6-",{offset:2})||q("-lh7-",{offset:2})||q("-lzs-",{offset:2})||q("-lz4-",{offset:2})||q("-lz5-",{offset:2})||q("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(K([0,0,1,186])){if(K([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(K([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(q("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(K([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(q("<?xml "))return{ext:"xml",mime:"application/xml"};if(K([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(K([82,97,114,33,26,7])&&(J[6]===0||J[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(q("solid "))return{ext:"stl",mime:"model/stl"};if(q("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(q("!<arch>")){if(await $.ignore(8),await $.readToken(new s8.StringType(13,"ascii"))==="debian-binary")return{ext:"deb",mime:"application/x-deb"};return{ext:"ar",mime:"application/x-unix-archive"}}if(K([137,80,78,71,13,10,26,10])){await $.ignore(8);async function Y(){return{length:await $.readToken(s8.INT32_BE),type:await $.readToken(new s8.StringType(4,"binary"))}}do{let W=await Y();if(W.length<0)return;switch(W.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await $.ignore(W.length+4)}}while($.position+8<$.fileInfo.size);return{ext:"png",mime:"image/png"}}if(K([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(K([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(K([102,114,101,101],{offset:4})||K([109,100,97,116],{offset:4})||K([109,111,111,118],{offset:4})||K([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(K([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(q("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(K([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(K([48,38,178,117,142,102,207,17,166,217])){async function Y(){let W=Buffer.alloc(16);return await $.readBuffer(W),{id:W,size:Number(await $.readToken(s8.UINT64_LE))}}await $.ignore(30);while($.position+24<$.fileInfo.size){let W=await Y(),Q=W.size-24;if(_8(W.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){let N=Buffer.alloc(16);if(Q-=await $.readBuffer(N),_8(N,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_8(N,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await $.ignore(Q)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(K([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((K([126,16,4])||K([126,24,4]))&&K([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(K([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(K([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await $.ignore(20),await $.readToken(new s8.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(K([255,10])||K([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(K([0,0,1,186])||K([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(K([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(K([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(K([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(K([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await $.peekBuffer(J,{length:Math.min(256,$.fileInfo.size),mayBeLess:!0}),q("BEGIN:")){if(q("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(q("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(q("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(q("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(q("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(K([4,0,0,0])&&J.length>=16){let Y=J.readUInt32LE(12);if(Y>12&&J.length>=Y+16)try{let W=J.slice(16,Y+16).toString();if(JSON.parse(W).files)return{ext:"asar",mime:"application/x-asar"}}catch(W){}}if(K([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(q("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(K([71],{offset:4})&&(K([71],{offset:192})||K([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(K([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(K([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(K([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(K([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(K([76,80],{offset:34})&&(K([0,0,1],{offset:8})||K([1,0,2],{offset:8})||K([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(K([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await $.peekBuffer(J,{length:Math.min(512,$.fileInfo.size),mayBeLess:!0}),gR(J))return{ext:"tar",mime:"application/x-tar"};if(K([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(q("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(J.length>=2&&K([255,224],{offset:0,mask:[255,224]})){if(K([16],{offset:1,mask:[22]})){if(K([8],{offset:1,mask:[8]}))return{ext:"aac",mime:"audio/aac"};return{ext:"aac",mime:"audio/aac"}}if(K([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(K([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(K([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}var pR=(readableStream)=>new Promise((resolve,reject)=>{let stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",async()=>{let $=new stream.PassThrough,J;if(stream.pipeline)J=stream.pipeline(readableStream,$,()=>{});else J=readableStream.pipe($);let X=readableStream.read(4100)||readableStream.read()||Buffer.alloc(0);try{let K=await bQ(X);$.fileType=K}catch(K){reject(K)}resolve(J)})}),Y4={fromStream:bR,fromTokenizer:n$,fromBuffer:bQ,stream:pR};Object.defineProperty(Y4,"extensions",{get(){return new Set(fQ.extensions)}});Object.defineProperty(Y4,"mimeTypes",{get(){return new Set(fQ.mimeTypes)}});W4.exports=Y4});var oQ=L0((cz,nQ)=>{function o$(){this._types=Object.create(null),this._extensions=Object.create(null);for(let $=0;$<arguments.length;$++)this.define(arguments[$]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}o$.prototype.define=function($,J){for(let X in $){let K=$[X].map(function(q){return q.toLowerCase()});X=X.toLowerCase();for(let q=0;q<K.length;q++){let Y=K[q];if(Y[0]==="*")continue;if(!J&&Y in this._types)throw Error('Attempt to change mapping for "'+Y+'" extension from "'+this._types[Y]+'" to "'+X+'". Pass `force=true` to allow this, otherwise remove "'+Y+'" from the list of extensions for "'+X+'".');this._types[Y]=X}if(J||!this._extensions[X]){let q=K[0];this._extensions[X]=q[0]!=="*"?q:q.substr(1)}}};o$.prototype.getType=function($){$=String($);let J=$.replace(/^.*[/\\]/,"").toLowerCase(),X=J.replace(/^.*\./,"").toLowerCase(),K=J.length<$.length;return(X.length<J.length-1||!K)&&this._types[X]||null};o$.prototype.getExtension=function($){return $=/^\s*([^;\s]*)/.test($)&&RegExp.$1,$&&this._extensions[$.toLowerCase()]||null};nQ.exports=o$});var iQ=L0((dz,rQ)=>{rQ.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}});var aQ=L0((nz,sQ)=>{var uR=oQ();sQ.exports=new uR(iQ())});var MN=L0((tz,VN)=>{VN.exports={parseSections:function($,J){var X,K;$.setBigEndian(!0);while($.remainingLength()>0&&K!==218){if($.nextUInt8()!==255)throw Error("Invalid JPEG section offset");if(K=$.nextUInt8(),K>=208&&K<=217||K===218)X=0;else X=$.nextUInt16()-2;J(K,$.branch(0,X)),$.skip(X)}},getSizeFromSOFSection:function($){return $.skip(1),{height:$.nextUInt16(),width:$.nextUInt16()}},getSectionName:function($){var J,X;switch($){case 216:J="SOI";break;case 196:J="DHT";break;case 219:J="DQT";break;case 221:J="DRI";break;case 218:J="SOS";break;case 254:J="COM";break;case 217:J="EOI";break;default:if($>=224&&$<=239)J="APP",X=$-224;else if($>=192&&$<=207&&$!==196&&$!==200&&$!==204)J="SOF",X=$-192;else if($>=208&&$<=215)J="RST",X=$-208;break}var K={name:J};if(typeof X==="number")K.index=X;return K}}});var V4=L0((ez,HN)=>{function cR($,J){switch($){case 1:return J.nextUInt8();case 3:return J.nextUInt16();case 4:return J.nextUInt32();case 5:return[J.nextUInt32(),J.nextUInt32()];case 6:return J.nextInt8();case 8:return J.nextUInt16();case 9:return J.nextUInt32();case 10:return[J.nextInt32(),J.nextInt32()];case 11:return J.nextFloat();case 12:return J.nextDouble();default:throw Error("Invalid format while decoding: "+$)}}function dR($){switch($){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}}function nR($,J){var X=J.nextUInt16(),K=J.nextUInt16(),q=dR(K),Y=J.nextUInt32(),W=q*Y,Q,N,V;if(W>4)J=$.openWithOffset(J.nextUInt32());if(K===2){Q=J.nextString(Y);var M=Q.indexOf("\x00");if(M!==-1)Q=Q.substr(0,M)}else if(K===7)Q=J.nextBuffer(Y);else if(K!==0){Q=[];for(V=0;V<Y;++V)Q.push(cR(K,J))}if(W<4)J.skip(4-W);return[X,Q,K]}function I9($,J,X){var K=J.nextUInt16(),q,Y;for(Y=0;Y<K;++Y)q=nR($,J),X(q[0],q[1],q[2])}function oR($){var J=$.nextString(6);if(J!=="Exif\x00\x00")throw Error("Invalid EXIF header");var X=$.mark(),K=$.nextUInt16();if(K===18761)$.setBigEndian(!1);else if(K===19789)$.setBigEndian(!0);else throw Error("Invalid TIFF header");if($.nextUInt16()!==42)throw Error("Invalid TIFF data");return X}HN.exports={IFD0:1,IFD1:2,GPSIFD:3,SubIFD:4,InteropIFD:5,parseTags:function($,J){var X;try{X=oR($)}catch(L){return!1}var K,q,Y,W=X.openWithOffset($.nextUInt32()),Q=this.IFD0;I9(X,W,function(L,E,j){switch(L){case 34853:q=E[0];break;case 34665:K=E[0];break;default:J(Q,L,E,j);break}});var N=W.nextUInt32();if(N!==0){var V=X.openWithOffset(N);I9(X,V,J.bind(null,this.IFD1))}if(q){var M=X.openWithOffset(q);I9(X,M,J.bind(null,this.GPSIFD))}if(K){var H=X.openWithOffset(K),G=this.InteropIFD;I9(X,H,function(L,E,j){if(L===40965)Y=E[0];else J(G,L,E,j)})}if(Y){var O=X.openWithOffset(Y);I9(X,O,J.bind(null,this.InteropIFD))}return!0}}});var jN=L0(($C,LN)=>{function M4($){return parseInt($,10)}var rR=3600,iR=60;function GN($,J){$=$.map(M4),J=J.map(M4);var X=$[0],K=$[1]-1,q=$[2],Y=J[0],W=J[1],Q=J[2],N=Date.UTC(X,K,q,Y,W,Q,0),V=N/1000;return V}function ON($){var J=$.substr(0,10).split("-"),X=$.substr(11,8).split(":"),K=$.substr(19,6),q=K.split(":").map(M4),Y=q[0]*rR+q[1]*iR,W=GN(J,X);if(W-=Y,typeof W==="number"&&!isNaN(W))return W}function UN($){var J=$.split(" "),X=J[0].split(":"),K=J[1].split(":"),q=GN(X,K);if(typeof q==="number"&&!isNaN(q))return q}function sR($){var J=$.length===19&&$.charAt(4)===":",X=$.length===25&&$.charAt(10)==="T",K;if(X)return ON($);else if(J)return UN($)}LN.exports={parseDateWithSpecFormat:UN,parseDateWithTimezoneFormat:ON,parseExifDate:sR}});var RN=L0((JC,EN)=>{var I5=V4(),aR=jN(),tR=[{section:I5.GPSIFD,type:2,name:"GPSLatitude",refType:1,refName:"GPSLatitudeRef",posVal:"N"},{section:I5.GPSIFD,type:4,name:"GPSLongitude",refType:3,refName:"GPSLongitudeRef",posVal:"E"}],eR=[{section:I5.SubIFD,type:306,name:"ModifyDate"},{section:I5.SubIFD,type:36867,name:"DateTimeOriginal"},{section:I5.SubIFD,type:36868,name:"CreateDate"},{section:I5.SubIFD,type:306,name:"ModifyDate"}];EN.exports={castDegreeValues:function($,J){tR.forEach(function(X){var K=$(X);if(K){var q=$({section:X.section,type:X.refType,name:X.refName}),Y=q===X.posVal?1:-1,W=(K[0]+K[1]/60+K[2]/3600)*Y;J(X,W)}})},castDateValues:function($,J){eR.forEach(function(X){var K=$(X);if(K){var q=aR.parseExifDate(K);if(typeof q<"u")J(X,q)}})},simplifyValue:function($,J){if(Array.isArray($)){if($=$.map(function(X){if(J===10||J===5)return X[0]/X[1];return X}),$.length===1)$=$[0]}return $}}});var PN=L0((XC,BN)=>{BN.exports={exif:{1:"InteropIndex",2:"InteropVersion",11:"ProcessingSoftware",254:"SubfileType",255:"OldSubfileType",256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Thresholding",264:"CellWidth",265:"CellLength",266:"FillOrder",269:"DocumentName",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",285:"PageName",286:"XPosition",287:"YPosition",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",292:"T4Options",293:"T6Options",296:"ResolutionUnit",297:"PageNumber",300:"ColorResponseUnit",301:"TransferFunction",305:"Software",306:"ModifyDate",315:"Artist",316:"HostComputer",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",320:"ColorMap",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFD",332:"InkSet",333:"InkNames",334:"NumberofInks",336:"DotRange",337:"TargetPrinter",338:"ExtraSamples",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",435:"T82Options",437:"JPEGTables",512:"JPEGProc",513:"ThumbnailOffset",514:"ThumbnailLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"ApplicationNotes",999:"USPTOMiscellaneous",4096:"RelatedImageFileFormat",4097:"RelatedImageWidth",4098:"RelatedImageHeight",18246:"Rating",18247:"XP_DIP_XML",18248:"StitchInfo",18249:"RatingPercent",32781:"ImageID",32931:"WangTag1",32932:"WangAnnotation",32933:"WangTag3",32934:"WangTag4",32995:"Matteing",32996:"DataType",32997:"ImageDepth",32998:"TileDepth",33405:"Model2",33421:"CFARepeatPatternDim",33422:"CFAPattern2",33423:"BatteryLevel",33424:"KodakIFD",33432:"Copyright",33434:"ExposureTime",33437:"FNumber",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"PixelScale",33589:"AdventScale",33590:"AdventRevision",33628:"UIC1Tag",33629:"UIC2Tag",33630:"UIC3Tag",33631:"UIC4Tag",33723:"IPTC-NAA",33918:"IntergraphPacketData",33919:"IntergraphFlagRegisters",33920:"IntergraphMatrix",33921:"INGRReserved",33922:"ModelTiePoint",34016:"Site",34017:"ColorSequence",34018:"IT8Header",34019:"RasterPadding",34020:"BitsPerRunLength",34021:"BitsPerExtendedRunLength",34022:"ColorTable",34023:"ImageColorIndicator",34024:"BackgroundColorIndicator",34025:"ImageColorValue",34026:"BackgroundColorValue",34027:"PixelIntensityRange",34028:"TransparencyIndicator",34029:"ColorCharacterization",34030:"HCUsage",34031:"TrapIndicator",34032:"CMYKEquivalent",34118:"SEMInfo",34152:"AFCP_IPTC",34232:"PixelMagicJBIGOptions",34264:"ModelTransform",34306:"WB_GRGBLevels",34310:"LeafData",34377:"PhotoshopSettings",34665:"ExifOffset",34675:"ICC_Profile",34687:"TIFF_FXExtensions",34688:"MultiProfiles",34689:"SharedData",34690:"T88Options",34732:"ImageLayer",34735:"GeoTiffDirectory",34736:"GeoTiffDoubleParams",34737:"GeoTiffAsciiParams",34850:"ExposureProgram",34852:"SpectralSensitivity",34853:"GPSInfo",34855:"ISO",34856:"Opto-ElectricConvFactor",34857:"Interlace",34858:"TimeZoneOffset",34859:"SelfTimerMode",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",34908:"FaxRecvParams",34909:"FaxSubAddress",34910:"FaxRecvTime",34954:"LeafSubIFD",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"CreateDate",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureCompensation",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37387:"FlashEnergy",37388:"SpatialFrequencyResponse",37389:"Noise",37390:"FocalPlaneXResolution",37391:"FocalPlaneYResolution",37392:"FocalPlaneResolutionUnit",37393:"ImageNumber",37394:"SecurityClassification",37395:"ImageHistory",37396:"SubjectArea",37397:"ExposureIndex",37398:"TIFF-EPStandardID",37399:"SensingMethod",37434:"CIP3DataFile",37435:"CIP3Sheet",37436:"CIP3Side",37439:"StoNits",37500:"MakerNote",37510:"UserComment",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",37679:"MSDocumentText",37680:"MSPropertySetStorage",37681:"MSDocumentTextPosition",37724:"ImageSourceData",40091:"XPTitle",40092:"XPComment",40093:"XPAuthor",40094:"XPKeywords",40095:"XPSubject",40960:"FlashpixVersion",40961:"ColorSpace",40962:"ExifImageWidth",40963:"ExifImageHeight",40964:"RelatedSoundFile",40965:"InteropOffset",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41485:"Noise",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41489:"ImageNumber",41490:"SecurityClassification",41491:"ImageHistory",41492:"SubjectLocation",41493:"ExposureIndex",41494:"TIFF-EPStandardID",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFormat",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"OwnerName",42033:"SerialNumber",42034:"LensInfo",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42112:"GDALMetadata",42113:"GDALNoData",42240:"Gamma",44992:"ExpandSoftware",44993:"ExpandLens",44994:"ExpandFilm",44995:"ExpandFilterLens",44996:"ExpandScanner",44997:"ExpandFlashLamp",48129:"PixelFormat",48130:"Transformation",48131:"Uncompressed",48132:"ImageType",48256:"ImageWidth",48257:"ImageHeight",48258:"WidthResolution",48259:"HeightResolution",48320:"ImageOffset",48321:"ImageByteCount",48322:"AlphaOffset",48323:"AlphaByteCount",48324:"ImageDataDiscard",48325:"AlphaDataDiscard",50215:"OceScanjobDesc",50216:"OceApplicationSelector",50217:"OceIDNumber",50218:"OceImageLogic",50255:"Annotations",50341:"PrintIM",50560:"USPTOOriginalContentType",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"DNGLensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50739:"ShadowScale",50740:"DNGPrivateData",50741:"MakerNoteSafety",50752:"RawImageSegmentation",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50781:"RawDataUniqueID",50784:"AliasLayerMetadata",50827:"OriginalRawFileName",50828:"OriginalRawFileData",50829:"ActiveArea",50830:"MaskedAreas",50831:"AsShotICCProfile",50832:"AsShotPreProfileMatrix",50833:"CurrentICCProfile",50834:"CurrentPreProfileMatrix",50879:"ColorimetricReference",50898:"PanasonicTitle",50899:"PanasonicTitle2",50931:"CameraCalibrationSig",50932:"ProfileCalibrationSig",50933:"ProfileIFD",50934:"AsShotProfileName",50935:"NoiseReductionApplied",50936:"ProfileName",50937:"ProfileHueSatMapDims",50938:"ProfileHueSatMapData1",50939:"ProfileHueSatMapData2",50940:"ProfileToneCurve",50941:"ProfileEmbedPolicy",50942:"ProfileCopyright",50964:"ForwardMatrix1",50965:"ForwardMatrix2",50966:"PreviewApplicationName",50967:"PreviewApplicationVersion",50968:"PreviewSettingsName",50969:"PreviewSettingsDigest",50970:"PreviewColorSpace",50971:"PreviewDateTime",50972:"RawImageDigest",50973:"OriginalRawFileDigest",50974:"SubTileBlockSize",50975:"RowInterleaveFactor",50981:"ProfileLookTableDims",50982:"ProfileLookTableData",51008:"OpcodeList1",51009:"OpcodeList2",51022:"OpcodeList3",51041:"NoiseProfile",51043:"TimeCodes",51044:"FrameRate",51058:"TStop",51081:"ReelName",51089:"OriginalDefaultFinalSize",51090:"OriginalBestQualitySize",51091:"OriginalDefaultCropSize",51105:"CameraLabel",51107:"ProfileHueSatMapEncoding",51108:"ProfileLookTableEncoding",51109:"BaselineExposureOffset",51110:"DefaultBlackRender",51111:"NewRawImageDigest",51112:"RawToPreviewGain",51125:"DefaultUserCrop",59932:"Padding",59933:"OffsetSchema",65000:"OwnerName",65001:"SerialNumber",65002:"Lens",65024:"KDC_IFD",65100:"RawFile",65101:"Converter",65102:"WhiteBalance",65105:"Exposure",65106:"Shadows",65107:"Brightness",65108:"Contrast",65109:"Saturation",65110:"Sharpness",65111:"Smoothness",65112:"MoireFilter"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"}}});var CN=L0((KC,zN)=>{var _5=MN(),SN=V4(),H4=RN();function AN($,J,X,K,q,Y,W){this.startMarker=$,this.tags=J,this.imageSize=X,this.thumbnailOffset=K,this.thumbnailLength=q,this.thumbnailType=Y,this.app1Offset=W}AN.prototype={hasThumbnail:function($){if(!this.thumbnailOffset||!this.thumbnailLength)return!1;if(typeof $!=="string")return!0;if($.toLowerCase().trim()==="image/jpeg")return this.thumbnailType===6;if($.toLowerCase().trim()==="image/tiff")return this.thumbnailType===1;return!1},getThumbnailOffset:function(){return this.app1Offset+6+this.thumbnailOffset},getThumbnailLength:function(){return this.thumbnailLength},getThumbnailBuffer:function(){return this._getThumbnailStream().nextBuffer(this.thumbnailLength)},_getThumbnailStream:function(){return this.startMarker.openWithOffset(this.getThumbnailOffset())},getImageSize:function(){return this.imageSize},getThumbnailSize:function(){var $=this._getThumbnailStream(),J;return _5.parseSections($,function(X,K){if(_5.getSectionName(X).name==="SOF")J=_5.getSizeFromSOFSection(K)}),J}};function FN($){this.stream=$,this.flags={readBinaryTags:!1,resolveTagNames:!0,simplifyValues:!0,imageSize:!0,hidePointers:!0,returnTags:!0}}FN.prototype={enableBinaryFields:function($){return this.flags.readBinaryTags=!!$,this},enablePointers:function($){return this.flags.hidePointers=!$,this},enableTagNames:function($){return this.flags.resolveTagNames=!!$,this},enableImageSize:function($){return this.flags.imageSize=!!$,this},enableReturnTags:function($){return this.flags.returnTags=!!$,this},enableSimpleValues:function($){return this.flags.simplifyValues=!!$,this},parse:function(){var $=this.stream.mark(),J=$.openWithOffset(0),X=this.flags,K,q,Y,W,Q,N,V,M,H;if(X.resolveTagNames)V=PN();if(X.resolveTagNames)K={},M=function(G){return K[G.name]},H=function(G,O){K[G.name]=O};else K=[],M=function(G){var O;for(O=0;O<K.length;++O)if(K[O].type===G.type&&K[O].section===G.section)return K.value},H=function(G,O){var L;for(L=0;L<K.length;++L)if(K[L].type===G.type&&K[L].section===G.section){K.value=O;return}};if(_5.parseSections(J,function(G,O){var L,E=O.offsetFrom($);if(G===225){if(L=SN.parseTags(O,function(j,B,S,A){if(!X.readBinaryTags&&A===7)return;if(B===513){if(Y=S[0],X.hidePointers)return}else if(B===514){if(W=S[0],X.hidePointers)return}else if(B===259){if(Q=S[0],X.hidePointers)return}if(!X.returnTags)return;if(X.simplifyValues)S=H4.simplifyValue(S,A);if(X.resolveTagNames){var z=j===SN.GPSIFD?V.gps:V.exif,P=z[B];if(!P)P=V.exif[B];if(!K.hasOwnProperty(P))K[P]=S}else K.push({section:j,type:B,value:S})}),L)N=E}else if(X.imageSize&&_5.getSectionName(G).name==="SOF")q=_5.getSizeFromSOFSection(O)}),X.simplifyValues)H4.castDegreeValues(M,H),H4.castDateValues(M,H);return new AN($,K,q,Y,W,Q,N)}};zN.exports=FN});var vN=L0((qC,ZN)=>{function i$($,J,X,K,q,Y){this.global=q,J=J||0,X=X||$.byteLength-J,this.arrayBuffer=$.slice(J,J+X),this.view=new q.DataView(this.arrayBuffer,0,this.arrayBuffer.byteLength),this.setBigEndian(K),this.offset=0,this.parentOffset=(Y||0)+J}i$.prototype={setBigEndian:function($){this.littleEndian=!$},nextUInt8:function(){var $=this.view.getUint8(this.offset);return this.offset+=1,$},nextInt8:function(){var $=this.view.getInt8(this.offset);return this.offset+=1,$},nextUInt16:function(){var $=this.view.getUint16(this.offset,this.littleEndian);return this.offset+=2,$},nextUInt32:function(){var $=this.view.getUint32(this.offset,this.littleEndian);return this.offset+=4,$},nextInt16:function(){var $=this.view.getInt16(this.offset,this.littleEndian);return this.offset+=2,$},nextInt32:function(){var $=this.view.getInt32(this.offset,this.littleEndian);return this.offset+=4,$},nextFloat:function(){var $=this.view.getFloat32(this.offset,this.littleEndian);return this.offset+=4,$},nextDouble:function(){var $=this.view.getFloat64(this.offset,this.littleEndian);return this.offset+=8,$},nextBuffer:function($){var J=this.arrayBuffer.slice(this.offset,this.offset+$);return this.offset+=$,J},remainingLength:function(){return this.arrayBuffer.byteLength-this.offset},nextString:function($){var J=this.arrayBuffer.slice(this.offset,this.offset+$);return J=String.fromCharCode.apply(null,new this.global.Uint8Array(J)),this.offset+=$,J},mark:function(){var $=this;return{openWithOffset:function(J){return J=(J||0)+this.offset,new i$($.arrayBuffer,J,$.arrayBuffer.byteLength-J,!$.littleEndian,$.global,$.parentOffset)},offset:this.offset,getParentOffset:function(){return $.parentOffset}}},offsetFrom:function($){return this.parentOffset+this.offset-($.offset+$.getParentOffset())},skip:function($){this.offset+=$},branch:function($,J){return J=typeof J==="number"?J:this.arrayBuffer.byteLength-(this.offset+$),new i$(this.arrayBuffer,this.offset+$,J,!this.littleEndian,this.global,this.parentOffset)}};ZN.exports=i$});var kN=L0((YC,DN)=>{function s$($,J,X,K){this.buffer=$,this.offset=J||0,X=typeof X==="number"?X:$.length,this.endPosition=this.offset+X,this.setBigEndian(K)}s$.prototype={setBigEndian:function($){this.bigEndian=!!$},nextUInt8:function(){var $=this.buffer.readUInt8(this.offset);return this.offset+=1,$},nextInt8:function(){var $=this.buffer.readInt8(this.offset);return this.offset+=1,$},nextUInt16:function(){var $=this.bigEndian?this.buffer.readUInt16BE(this.offset):this.buffer.readUInt16LE(this.offset);return this.offset+=2,$},nextUInt32:function(){var $=this.bigEndian?this.buffer.readUInt32BE(this.offset):this.buffer.readUInt32LE(this.offset);return this.offset+=4,$},nextInt16:function(){var $=this.bigEndian?this.buffer.readInt16BE(this.offset):this.buffer.readInt16LE(this.offset);return this.offset+=2,$},nextInt32:function(){var $=this.bigEndian?this.buffer.readInt32BE(this.offset):this.buffer.readInt32LE(this.offset);return this.offset+=4,$},nextFloat:function(){var $=this.bigEndian?this.buffer.readFloatBE(this.offset):this.buffer.readFloatLE(this.offset);return this.offset+=4,$},nextDouble:function(){var $=this.bigEndian?this.buffer.readDoubleBE(this.offset):this.buffer.readDoubleLE(this.offset);return this.offset+=8,$},nextBuffer:function($){var J=this.buffer.slice(this.offset,this.offset+$);return this.offset+=$,J},remainingLength:function(){return this.endPosition-this.offset},nextString:function($){var J=this.buffer.toString("utf8",this.offset,this.offset+$);return this.offset+=$,J},mark:function(){var $=this;return{openWithOffset:function(J){return J=(J||0)+this.offset,new s$($.buffer,J,$.endPosition-J,$.bigEndian)},offset:this.offset}},offsetFrom:function($){return this.offset-$.offset},skip:function($){this.offset+=$},branch:function($,J){return J=typeof J==="number"?J:this.endPosition-(this.offset+$),new s$(this.buffer,this.offset+$,J,this.bigEndian)}};DN.exports=s$});var IN=L0((WC,TN)=>{var wN=CN();function $B(){return(0,eval)("this")}TN.exports={create:function($,J){if(J=J||$B(),$ instanceof J.ArrayBuffer){var X=vN();return new wN(new X($,0,$.byteLength,!0,J))}else{var K=kN();return new wN(new K($,0,$.length,!0))}}}});var oN=L0((uC,nN)=>{function L4($,J){if(!$||!J||!$.length||!J.length)throw Error("Bad alphabet");this.srcAlphabet=$,this.dstAlphabet=J}L4.prototype.convert=function($){var J,X,K,q={},Y=this.srcAlphabet.length,W=this.dstAlphabet.length,Q=$.length,N=typeof $==="string"?"":[];if(!this.isValid($))throw Error('Number "'+$+'" contains of non-alphabetic digits ('+this.srcAlphabet+")");if(this.srcAlphabet===this.dstAlphabet)return $;for(J=0;J<Q;J++)q[J]=this.srcAlphabet.indexOf($[J]);do{X=0,K=0;for(J=0;J<Q;J++)if(X=X*Y+q[J],X>=W)q[K++]=parseInt(X/W,10),X=X%W;else if(K>0)q[K++]=0;Q=K,N=this.dstAlphabet.slice(X,X+1).concat(N)}while(K!==0);return N};L4.prototype.isValid=function($){var J=0;for(;J<$.length;++J)if(this.srcAlphabet.indexOf($[J])===-1)return!1;return!0};nN.exports=L4});var iN=L0((lC,rN)=>{var AB=oN();function _9($,J){var X=new AB($,J);return function(K){return X.convert(K)}}_9.BIN="01";_9.OCT="01234567";_9.DEC="0123456789";_9.HEX="0123456789abcdef";rN.exports=_9});var a0={FAILSAFE:!1,FAILSAFE_POINTS:[[0,0]],PAUSE:!0,PAUSE_DELAY:0};import{dlopen as O7,FFIType as k,suffix as r4}from"bun:ffi";var W0=O7(`user32.${r4}`,{SendInput:{args:[k.u32,k.ptr,k.i32],returns:k.u32},MapVirtualKeyW:{args:[k.u32,k.u32],returns:k.u32},GetCursorPos:{args:[k.ptr],returns:k.bool},GetKeyState:{args:[k.i32],returns:k.i16},GetAsyncKeyState:{args:[k.i32],returns:k.i16},SetWindowsHookExW:{args:[k.i32,k.ptr,k.ptr,k.u32],returns:k.ptr},UnhookWindowsHookEx:{args:[k.ptr],returns:k.bool},CallNextHookEx:{args:[k.ptr,k.i32,k.ptr,k.ptr],returns:k.ptr},GetDC:{args:[k.ptr],returns:k.u64},ReleaseDC:{args:[k.u64,k.u64],returns:k.int},GetDesktopWindow:{args:[],returns:k.ptr},GetForegroundWindow:{args:[],returns:k.u64},GetWindowTextW:{args:[k.u64,k.ptr,k.int],returns:k.int},GetWindowRect:{args:[k.u64,k.ptr],returns:k.bool},GetSystemMetrics:{args:[k.int],returns:k.int},SetLayeredWindowAttributes:{args:[k.u64,k.uint32_t,k.int8_t,k.uint32_t],returns:k.bool},UpdateLayeredWindow:{args:[k.ptr,k.ptr,k.ptr,k.ptr,k.ptr,k.ptr,k.uint32_t,k.ptr,k.uint32_t],returns:k.bool},GetWindowLongW:{args:[k.u64,k.int],returns:k.int},SetWindowLongW:{args:[k.u64,k.int,k.int],returns:k.int},CreateWindowExW:{args:[k.uint32_t,k.ptr,k.ptr,k.uint32_t,k.int,k.int,k.int,k.int,k.ptr,k.ptr,k.ptr,k.ptr],returns:k.ptr},ShowWindow:{args:[k.u64,k.int],returns:k.bool},UpdateWindow:{args:[k.u64],returns:k.bool},SetWindowPos:{args:[k.u64,k.u64,k.int,k.int,k.int,k.int,k.uint32_t],returns:k.bool},FindWindowA:{args:[k.ptr,k.ptr],returns:k.u64},FillRect:{args:[k.ptr,k.ptr,k.ptr],returns:k.int},IsWindow:{args:[k.u64],returns:k.bool},SetForegroundWindow:{args:[k.u64],returns:k.bool},IsWindowVisible:{args:[k.u64],returns:k.bool},GetWindowThreadProcessId:{args:[k.u64,k.ptr],returns:k.u32},MoveWindow:{args:[k.u64,k.int,k.int,k.int,k.int,k.bool],returns:k.bool},GetClientRect:{args:[k.u64,k.ptr],returns:k.bool},PostMessageA:{args:[k.u64,k.u32,k.u64,k.u64],returns:k.bool},GetClassNameA:{args:[k.u64,k.ptr,k.int],returns:k.int},SetWindowTextW:{args:[k.u64,k.ptr],returns:k.bool},EnableWindow:{args:[k.u64,k.bool],returns:k.bool},RedrawWindow:{args:[k.u64,k.ptr,k.u64,k.u32],returns:k.bool},ClientToScreen:{args:[k.u64,k.ptr],returns:k.bool},ScreenToClient:{args:[k.u64,k.ptr],returns:k.bool},SendMessageA:{args:[k.u64,k.u32,k.u64,k.u64],returns:k.ptr},IsIconic:{args:[k.u64],returns:k.bool},IsZoomed:{args:[k.u64],returns:k.bool},EnumWindows:{args:[k.function,k.i64],returns:k.bool},EnumChildWindows:{args:[k.u64,k.function,k.i64],returns:k.bool},FlashWindow:{args:[k.u64,k.bool],returns:k.bool},PrintWindow:{args:[k.u64,k.u64,k.u32],returns:k.bool},GetWindowDC:{args:[k.u64],returns:k.u64},LoadImageW:{args:[k.u64,k.ptr,k.uint32_t,k.int,k.int,k.uint32_t],returns:k.u64},SetWindowRgn:{args:[k.u64,k.u64,k.bool],returns:k.int}}),E6=O7("gdi32.dll",{GetPixel:{args:[k.u64,k.int,k.int],returns:k.uint32_t},CreatePen:{args:[k.int,k.int,k.uint32_t],returns:k.u64},SelectObject:{args:[k.u64,k.u64],returns:k.u64},MoveToEx:{args:[k.u64,k.int,k.int,k.ptr],returns:k.bool},LineTo:{args:[k.u64,k.int,k.int],returns:k.bool},DeleteObject:{args:[k.u64],returns:k.bool},CreateCompatibleDC:{args:[k.u64],returns:k.u64},CreateDIBSection:{args:[k.ptr,k.ptr,k.uint32_t,k.ptr,k.ptr,k.uint32_t],returns:k.ptr},DeleteDC:{args:[k.u64],returns:k.bool},CreateSolidBrush:{args:[k.uint32_t],returns:k.u64},CreateCompatibleBitmap:{args:[k.u64,k.int,k.int],returns:k.u64},BitBlt:{args:[k.u64,k.int,k.int,k.int,k.int,k.u64,k.int,k.int,k.uint32_t],returns:k.bool},GetDIBits:{args:[k.u64,k.u64,k.u32,k.u32,k.ptr,k.ptr,k.u32],returns:k.int},GetObjectA:{args:[k.ptr,k.int,k.ptr],returns:k.int},CreateRectRgn:{args:[k.int,k.int,k.int,k.int],returns:k.u64},CreateEllipticRgn:{args:[k.int,k.int,k.int,k.int],returns:k.u64},CreateRoundRectRgn:{args:[k.int,k.int,k.int,k.int,k.int,k.int],returns:k.u64},CreatePolygonRgn:{args:[k.ptr,k.int,k.int],returns:k.u64}}),v1=O7(`kernel32.${r4}`,{GetLastError:{args:[],returns:k.u32},OpenProcess:{args:[k.u32,k.bool,k.u32],returns:k.u64},CloseHandle:{args:[k.u64],returns:k.bool},QueryFullProcessImageNameW:{args:[k.u64,k.u32,k.ptr,k.ptr],returns:k.bool},TerminateProcess:{args:[k.u64,k.u32],returns:k.bool}});var r5=process.arch==="x64"||process.arch==="arm64";class U7 extends Error{constructor($){super($);this.name="FailSafeException"}}var i4=r5?8:4;function s4($=0,J=0,X=0,K=0,q=0,Y=0n){let W=20+i4,Q=Buffer.alloc(W);if(Q.writeInt32LE($,0),Q.writeInt32LE(J,4),Q.writeUInt32LE(X>>>0,8),Q.writeUInt32LE(K>>>0,12),Q.writeUInt32LE(q>>>0,16),r5)Q.writeBigUInt64LE(BigInt(Y),20);else Q.writeUInt32LE(Number(Y)>>>0,20);return Q}function a4($=0,J=0,X=0,K=0,q=0n){let Y=12+i4,W=Buffer.alloc(Y);if(W.writeUInt16LE($&65535,0),W.writeUInt16LE(J&65535,2),W.writeUInt32LE(X>>>0,4),W.writeUInt32LE(K>>>0,8),r5)W.writeBigUInt64LE(BigInt(q),12);else W.writeUInt32LE(Number(q)>>>0,12);return r5?Buffer.concat([W,Buffer.alloc(32-W.length)]):W}function o9($,J){let X=r5?40:36,K=Buffer.alloc(X);return K.writeUInt32LE($>>>0,0),J.copy(K,8,0,Math.min(32,J.length)),K}import{ptr as aM}from"bun:ffi";function g8(){if(a0.FAILSAFE){let $=P8();for(let J of a0.FAILSAFE_POINTS)if($[0]===J[0]&&$[1]===J[1])throw new U7("fail-safe triggered from mouse moving to a corner of the screen. To disable this fail-safe, set config.FAILSAFE to false. DISABLING FAIL-SAFE IS NOT RECOMMENDED.")}}function y6($){if($&&a0.PAUSE_DELAY>0)Bun.sleepSync(a0.PAUSE_DELAY)}function t4($=0,J=0){let[X,K]=[W0.symbols.GetSystemMetrics(0),W0.symbols.GetSystemMetrics(1)],q=Math.round($*65535/(X-1)),Y=Math.round(J*65535/(K-1)),W=Math.max(0,Math.min(65535,q)),Q=Math.max(0,Math.min(65535,Y));return[W,Q]}function P8($,J){let X=new ArrayBuffer(8),K=new DataView(X);W0.symbols.GetCursorPos(aM(X));let q=K.getInt32(0,!0),Y=K.getInt32(4,!0);return[$??q,J??Y]}var D1={a:{scan:30},b:{scan:48},c:{scan:46},d:{scan:32},e:{scan:18},f:{scan:33},g:{scan:34},h:{scan:35},i:{scan:23},j:{scan:36},k:{scan:37},l:{scan:38},m:{scan:50},n:{scan:49},o:{scan:24},p:{scan:25},q:{scan:16},r:{scan:19},s:{scan:31},t:{scan:20},u:{scan:22},v:{scan:47},w:{scan:17},x:{scan:45},y:{scan:21},z:{scan:44},"0":{scan:11},"1":{scan:2},"2":{scan:3},"3":{scan:4},"4":{scan:5},"5":{scan:6},"6":{scan:7},"7":{scan:8},"8":{scan:9},"9":{scan:10},f1:{scan:59},f2:{scan:60},f3:{scan:61},f4:{scan:62},f5:{scan:63},f6:{scan:64},f7:{scan:65},f8:{scan:66},f9:{scan:67},f10:{scan:68},f11:{scan:87},f12:{scan:88},f13:{scan:100},f14:{scan:101},f15:{scan:102},f16:{scan:103},f17:{scan:104},f18:{scan:105},f19:{scan:106},f20:{scan:107},f21:{scan:108},f22:{scan:109},f23:{scan:110},f24:{scan:118},"-":{scan:12},minus:{scan:12},"=":{scan:13},equal:{scan:13},equals:{scan:13},"[":{scan:26},bracketleft:{scan:26},"]":{scan:27},bracketright:{scan:27},"\\":{scan:43},backslash:{scan:43},";":{scan:39},semicolon:{scan:39},"'":{scan:40},quote:{scan:40},apostrophe:{scan:40},"`":{scan:41},grave:{scan:41},backtick:{scan:41},",":{scan:51},comma:{scan:51},".":{scan:52},period:{scan:52},dot:{scan:52},"/":{scan:53},slash:{scan:53},forwardslash:{scan:53},space:{scan:57},enter:{scan:28},return:{scan:28},tab:{scan:15},backspace:{scan:14},escape:{scan:1},esc:{scan:1},shift:{scan:42},shiftleft:{scan:42},shiftright:{scan:54},ctrl:{scan:29},control:{scan:29},ctrlleft:{scan:29},controlleft:{scan:29},ctrlright:{scan:29,extended:!0},controlright:{scan:29,extended:!0},rctrl:{scan:29,extended:!0},alt:{scan:56},altleft:{scan:56},altright:{scan:56,extended:!0},ralt:{scan:56,extended:!0},altgr:{scan:56,extended:!0},win:{scan:91,extended:!0},winleft:{scan:91,extended:!0},windows:{scan:91,extended:!0},winright:{scan:92,extended:!0},windowsright:{scan:92,extended:!0},apps:{scan:93,extended:!0},menu:{scan:93,extended:!0},contextmenu:{scan:93,extended:!0},capslock:{scan:58},numlock:{scan:69},scrolllock:{scan:70},up:{scan:72,extended:!0},down:{scan:80,extended:!0},left:{scan:75,extended:!0},right:{scan:77,extended:!0},home:{scan:71,extended:!0},end:{scan:79,extended:!0},pageup:{scan:73,extended:!0},pagedown:{scan:81,extended:!0},insert:{scan:82,extended:!0},delete:{scan:83,extended:!0},del:{scan:83,extended:!0},numpad0:{scan:82},numpad1:{scan:79},numpad2:{scan:80},numpad3:{scan:81},numpad4:{scan:75},numpad5:{scan:76},numpad6:{scan:77},numpad7:{scan:71},numpad8:{scan:72},numpad9:{scan:73},numpaddecimal:{scan:83},numpadperiod:{scan:83},numpaddivide:{scan:53,extended:!0},numpadmultiply:{scan:55},numpadsubtract:{scan:74},numpadadd:{scan:78},numpadenter:{scan:28,extended:!0},volumeup:{scan:48,extended:!0},volumedown:{scan:46,extended:!0},volumemute:{scan:32,extended:!0},mute:{scan:32,extended:!0},playpause:{scan:34,extended:!0},stop:{scan:36,extended:!0},nexttrack:{scan:25,extended:!0},previoustrack:{scan:16,extended:!0},medianext:{scan:25,extended:!0},mediaprevious:{scan:16,extended:!0},mediaplaypause:{scan:34,extended:!0},mediastop:{scan:36,extended:!0},browserhome:{scan:50,extended:!0},browserback:{scan:106,extended:!0},browserforward:{scan:105,extended:!0},browserrefresh:{scan:103,extended:!0},browserstop:{scan:104,extended:!0},browsersearch:{scan:101,extended:!0},browserfavorites:{scan:102,extended:!0},mail:{scan:108,extended:!0},calculator:{scan:33,extended:!0},mycomputer:{scan:107,extended:!0},computer:{scan:107,extended:!0},printscreen:{scan:55,extended:!0},prtsc:{scan:55,extended:!0},pause:{scan:69,extended:!0},break:{scan:70},intl1:{scan:115},intl2:{scan:112},intl3:{scan:125},intl4:{scan:121},intl5:{scan:123},intl6:{scan:92},lang1:{scan:114},lang2:{scan:113},power:{scan:94,extended:!0},sleep:{scan:95,extended:!0},wake:{scan:99,extended:!0},help:{scan:59,extended:!0},undo:{scan:8,extended:!0},redo:{scan:7,extended:!0},cut:{scan:45,extended:!0},copy:{scan:46,extended:!0},paste:{scan:47,extended:!0},find:{scan:33,extended:!0},select:{scan:41,extended:!0},clear:{scan:76},num0:{scan:82},num1:{scan:79},num2:{scan:80},num3:{scan:81},num4:{scan:75},num5:{scan:76},num6:{scan:77},num7:{scan:71},num8:{scan:72},num9:{scan:73}},L7=new Map([["!","1"],["@","2"],["#","3"],["$","4"],["%","5"],["^","6"],["&","7"],["*","8"],["(","9"],[")","0"],["_","-"],["+","="],["{","["],["}","]"],["|","\\"],[":",";"],['"',"'"],["<",","],[">","."],["?","/"],["~","`"]]);var j7=1,e4=32768,E7=2,R7=4;var B7=8,P7=16;var S7=32,A7=64;var F7=128,z7=256,$X=1,JX=2,XX=1,KX=2,C7=8;function qX($,J,X,K=0){let q=X|(J?XX:0),Y=a4(0,$,q,K,0n),W=o9(1,Y);W0.symbols.SendInput(1,W,40)}function $1($,J=a0.PAUSE){let{scan:X,extended:K}=D1[$];if(qX(X,!!K,C7),J)y6(J);return S8}function f8($,J=a0.PAUSE){let{scan:X,extended:K}=D1[$],q=C7|KX;if(qX(X,!!K,q),J)y6(J);return S8}function r1($,J=a0.PAUSE){return $1($,J),f8($,J),S8}function YX($,J=1,X=0,K=a0.PAUSE){for(let q=0;q<J;q++)if($1($,K),f8($,K),X>0)Bun.sleepSync(X);return S8}function WX($,J=0,X=a0.PAUSE){for(let K of $){if(K>="A"&&K<="Z"){let q=K.toLowerCase();$1("shift",X),r1(q,X),f8("shift",X)}else if(L7.has(K)){let q=L7.get(K);$1("shift",X),r1(q,X),f8("shift",X)}else r1(K,X);if(J>0)Bun.sleepSync(J)}return S8}function k1($){let{scan:J}=D1[$],X;if(J>1024){let q=J-1024;X=W0.symbols.MapVirtualKeyW(q,1)}else X=W0.symbols.MapVirtualKeyW(J,1);return(W0.symbols.GetAsyncKeyState(X)&32768)!==0}function QX($){return $.some((J)=>k1(J))}function NX($){return $.every((J)=>k1(J))}function VX($,J=a0.PAUSE){for(let X of $)$1(X,J);for(let X=$.length-1;X>=0;X--)f8($[X],J);return S8}function MX($,J,X=a0.PAUSE){if($1($,!1),Bun.sleepSync(J),f8($,!1),X)y6(X);return S8}function HX($,J){return new Promise((X)=>{let q=0,Y=setInterval(()=>{if(k1($)){clearInterval(Y),X(!0);return}if(J){if(q+=8,q>=J)clearInterval(Y),X(!1)}},8)})}function GX($,J){return new Promise((X)=>{let q=0,Y=setInterval(()=>{if(!k1($)){clearInterval(Y),X(!0);return}if(J){if(q+=8,q>=J)clearInterval(Y),X(!1)}},8)})}function OX($,J=a0.PAUSE){return r1($,J),S8}function UX($){let{scan:J}=D1[$],X;if(J>1024){let Y=J-1024;X=W0.symbols.MapVirtualKeyW(Y,1)}else X=W0.symbols.MapVirtualKeyW(J,1);let K=W0.symbols.GetAsyncKeyState(X),q=W0.symbols.GetKeyState(X);return{isPressed:(K&32768)!==0,isToggled:(q&1)!==0}}function LX($=a0.PAUSE){let J=["shift","shiftleft","shiftright","ctrl","ctrlleft","ctrlright","alt","altleft","altright","win","winleft","winright"],X="abcdefghijklmnopqrstuvwxyz".split("");J.push(...X);for(let K of J)if(k1(K))f8(K,$);return S8}class i5{listeners=new Map;isRunning=!1;startPromise=null;on($,J){if(!this.listeners.has($))this.listeners.set($,new Set);this.listeners.get($).add(J)}off($,J){this.listeners.get($)?.delete(J)}once($,J){let X=(K)=>{try{J(K)}finally{this.off($,X)}};this.on($,X)}_emit($,J){this.listeners.get($)?.forEach((X)=>{try{X(J)}catch(K){console.error(`Listener error [${String($)}]:`,K)}})}async start($=8){if(this.isRunning)return console.warn("Listener already running"),this.startPromise??Promise.resolve();return this.isRunning=!0,this.startPromise=(async()=>{try{await this.run($)}catch(J){console.error("Listener run error:",J)}finally{this.isRunning=!1,this.startPromise=null}})(),this.startPromise}async stop(){if(this.isRunning=!1,this.startPromise)await this.startPromise}}var jX={};for(let[$,J]of Object.entries(D1))jX[J.scan&4095]=$;var eM=new Set([1,2,4,5,6]),$H={112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",13:"enter",16:"shift",17:"ctrl",18:"alt",9:"tab",20:"capslock",27:"escape",32:"space"};class Z7 extends i5{async run($=8){console.log("Keyboard listener started.");let J=Array(256).fill(!1),X=Array.from({length:256},(K,q)=>q);while(this.isRunning){for(let K of X){if(eM.has(K))continue;let q=W0.symbols.GetAsyncKeyState(K),Y=(q&32768)!==0,W=(q&1)!==0,Q=$H[K];if(!Q){let N=W0.symbols.MapVirtualKeyW(K,0);Q=jX[N]}if(!Q)if(K>=48&&K<=57)Q=String.fromCharCode(K);else if(K>=65&&K<=90)Q=String.fromCharCode(K).toLowerCase();else continue;if(Y!==J[K]){J[K]=Y;let N={event:Y?"down":"up",name:Q,vk_code:K,isKeyDown:Y};this._emit(Y?"down":"up",N)}else if(!Y&&W&&!J[K]){let N={event:"down",name:Q,vk_code:K,isKeyDown:!0},V={event:"up",name:Q,vk_code:K,isKeyDown:!1};this._emit("down",N),this._emit("up",V)}}await Bun.sleep($)}console.log("Keyboard listener stopped.")}}class EX{press=$1;release=f8;tap=r1;repeatTap=YX;write=WX;isPressed=k1;hotkey=VX;hold=MX;isAnyPressed=QX;areAllPressed=NX;waitForPress=HX;waitForRelease=GX;toggleKey=OX;getKeyState=UX;releaseAll=LX;listener=new Z7}var S8=new EX;var q8="left",r9="right",s5="middle",v7="x1",D7="x2";var JH=2048,XH=4096,KH=120,qH={[q8]:{down:E7,up:R7,data:0},[s5]:{down:S7,up:A7,data:0},[r9]:{down:B7,up:P7,data:0},[v7]:{down:F7,up:z7,data:$X},[D7]:{down:F7,up:z7,data:JX}};function RX($,J){let X=qH[$];if(!X)throw Error(`Invalid button: ${$}`);return{event:X[J],mouseData:X.data}}function YH($,J){if($!==void 0){if(!Number.isFinite($))throw Error(`Invalid x coordinate: ${$}`);if($<0)throw Error(`x coordinate must be non-negative: ${$}`)}if(J!==void 0){if(!Number.isFinite(J))throw Error(`Invalid y coordinate: ${J}`);if(J<0)throw Error(`y coordinate must be non-negative: ${J}`)}}function w1($,J,X,K,q=0){let Y=s4($,J,X,K,q,0n),W=o9(0,Y);W0.symbols.SendInput(1,W,40)}function i9($=q8,J=a0.PAUSE){try{let{event:X,mouseData:K}=RX($,"down");if(w1(0,0,K,X,0),J)y6(J);return d6}catch(X){throw console.error("[Mouse Press Error]",X),X}}function s9($=q8,J=a0.PAUSE){try{let{event:X,mouseData:K}=RX($,"up");if(w1(0,0,K,X,0),J)y6(J);return d6}catch(X){throw console.error("[Mouse Release Error]",X),X}}function k7($=q8,J=1,X=0,K=a0.PAUSE){if([q8,s5,r9].includes($)){let q=0,Y=0;if($===q8)q=E7,Y=R7;else if($===s5)q=S7,Y=A7;else q=B7,Y=P7;for(let W=0;W<J;W++)if(g8(),w1(0,0,0,q,0),w1(0,0,0,Y,0),X>0)Bun.sleepSync(Math.round(X*1000))}if(K)y6(K);return d6}function J1($,J,X=!1,K=a0.PAUSE){try{if(g8(),YH($,J),!X){let[q,Y]=P8($,J),[W,Q]=t4(q,Y);if(w1(W,Q,0,j7|e4,0),K)y6(K)}else w7($??0,J??0,!0,K);return d6}catch(q){throw console.error("[Mouse MoveTo Error]",q),q}}function w7($=0,J=0,X=!1,K=a0.PAUSE){if(g8(),!X){let[q,Y]=P8();J1(q+$,Y+J,!1,K)}else if(w1($,J,0,j7,0),K)y6(K);return d6}function a9($){let J;if($===q8)J=1;else if($===r9)J=2;else if($===s5)J=4;else if($===v7)J=5;else if($===D7)J=6;else throw Error(`Invalid button: ${$}`);return(W0.symbols.GetAsyncKeyState(J)&32768)!==0}function T7($,J,X=q8,K=0.5,q=a0.PAUSE){g8();let[Y,W]=P8();if(i9(X,q),K<=0)J1($,J,!1,q);else{let Q=Math.max(10,Math.floor(K*100)),N=K/Q;for(let V=1;V<=Q;V++){let M=V/Q,H=Math.round(Y+($-Y)*M),G=Math.round(W+(J-W)*M);J1(H,G,!1,!1),Bun.sleepSync(Math.round(N*1000))}}return s9(X,q),d6}function BX($,J,X=q8,K=0.5,q=a0.PAUSE){let[Y,W]=P8();return T7(Y+$,W+J,X,K,q)}function PX($,J="vertical",X=a0.PAUSE){g8();let K=$*KH;if(w1(0,0,K,J==="vertical"?JH:XH,0),X)y6(X);return d6}var WH={linear:($)=>$,easeInQuad:($)=>$*$,easeOutQuad:($)=>$*(2-$),easeInOutQuad:($)=>$<0.5?2*$*$:-1+(4-2*$)*$,easeInCubic:($)=>$*$*$,easeOutCubic:($)=>--$*$*$+1,easeInOutCubic:($)=>$<0.5?4*$*$*$:($-1)*(2*$-2)*(2*$-2)+1};async function SX($,J,X=0.5,K="easeOutQuad",q=a0.PAUSE){g8();let[Y,W]=P8(),Q=WH[K];if(X<=0)return J1($,J,!1,q),d6;let N=Math.max(10,Math.floor(X*100)),V=X/N;for(let M=1;M<=N;M++){let H=M/N,G=Q(H),O=Math.round(Y+($-Y)*G),L=Math.round(W+(J-W)*G);J1(O,L,!1,!1),Bun.sleepSync(Math.round(V*1000))}if(q)y6(q);return d6}function AX($,J,X=a0.PAUSE){if(g8(),i9($,!1),Bun.sleepSync(Math.round(J*1000)),s9($,!1),X)y6(X);return d6}function FX($,J,X=q8,K=a0.PAUSE){return g8(),J1($,J,!1,K),k7(X,1,0,K),d6}function I7($,J,X=0){let[K,q]=P8(),Y=Math.abs(K-$),W=Math.abs(q-J);return Y<=X&&W<=X}function zX($,J,X,K=0){return new Promise((q)=>{let W=0,Q=setInterval(()=>{if(I7($,J,K)){clearInterval(Q),q(!0);return}if(X!==void 0){if(W+=8,W>=X)clearInterval(Q),q(!1)}},8)})}async function CX($,J){return new Promise((X)=>{let q=0,Y=setInterval(()=>{if(a9($)){clearInterval(Y),X(!0);return}if(J!==void 0){if(q+=8,q>=J)clearInterval(Y),X(!1)}},8)})}async function ZX($,J){return new Promise((X)=>{let q=0,Y=setInterval(()=>{if(!a9($)){clearInterval(Y),X(!0);return}if(J!==void 0){if(q+=8,q>=J)clearInterval(Y),X(!1)}},8)})}import{ptr as NH}from"bun:ffi";class _7 extends i5{async run($=8){console.log("Mouse listener started.");let J=new ArrayBuffer(8),X=new DataView(J),K={x:0,y:0},q={left:!1,right:!1,middle:!1,x1:!1,x2:!1};while(this.isRunning){W0.symbols.GetCursorPos(NH(J));let Y=X.getInt32(0,!0),W=X.getInt32(4,!0);if(Y!==K.x||W!==K.y){let V={event:"move",x:Y,y:W,lastX:K.x,lastY:K.y,deltaX:Y-K.x,deltaY:W-K.y};this._emit("move",V),K.x=Y,K.y=W}let Q={left:W0.symbols.GetAsyncKeyState(1),right:W0.symbols.GetAsyncKeyState(2),middle:W0.symbols.GetAsyncKeyState(4),x1:W0.symbols.GetAsyncKeyState(5),x2:W0.symbols.GetAsyncKeyState(6)},N=Object.fromEntries(Object.entries(Q).map(([V,M])=>[V,(M&32768)!==0]));for(let V of Object.keys(q))if(N[V]!==q[V]){q[V]=N[V];let M={event:N[V]?"down":"up",button:V,x:K.x,y:K.y};this._emit(N[V]?"down":"up",M)}await Bun.sleep($)}console.log("Mouse listener stopped.")}}class vX{get position(){let $=P8();return{x:$[0],y:$[1]}}press=i9;release=s9;click=k7;moveTo=J1;moveRel=w7;isPressed=a9;dragTo=T7;dragRel=BX;scroll=PX;smoothMoveTo=SX;hold=AX;clickAt=FX;isAtPosition=I7;waitForPosition=zX;waitForPress=CX;waitForRelease=ZX;listener=new _7}var d6=new vX;import{ptr as L6,JSCallback as w4}from"bun:ffi";var y7;(function($){$[$.BITMAP_INFO_HEADER=40]="BITMAP_INFO_HEADER",$[$.BITMAP_V2_INFO_HEADER=52]="BITMAP_V2_INFO_HEADER",$[$.BITMAP_V3_INFO_HEADER=56]="BITMAP_V3_INFO_HEADER",$[$.BITMAP_V4_HEADER=108]="BITMAP_V4_HEADER",$[$.BITMAP_V5_HEADER=124]="BITMAP_V5_HEADER"})(y7||(y7={}));var n6=y7;function x7($,J,X,K){let q=~$+1&$,Y=~J+1&J,W=~X+1&X,Q=~K+1&K,N=$/q+1,V=J/Y+1,M=X/W+1,H=K/Q+1;return{shiftRed:(G)=>(G&$)/q*256/N,shiftGreen:(G)=>(G&J)/Y*256/V,shiftBlue:(G)=>(G&X)/W*256/M,shiftAlpha:K!==0?(G)=>(G&K)/Q*256/H:()=>255}}var b8;(function($){$[$.NONE=0]="NONE",$[$.BI_RLE8=1]="BI_RLE8",$[$.BI_RLE4=2]="BI_RLE4",$[$.BI_BIT_FIELDS=3]="BI_BIT_FIELDS",$[$.BI_ALPHA_BIT_FIELDS=6]="BI_ALPHA_BIT_FIELDS"})(b8||(b8={}));class t9{flag;fileSize;reserved1;reserved2;offset;headerSize;width;height;planes;bitPP;compression;rawSize;hr;vr;colors;importantColors;palette;data;maskRed;maskGreen;maskBlue;maskAlpha;toRGBA;pos;bottomUp;buffer;locRed;locGreen;locBlue;locAlpha;shiftRed;shiftGreen;shiftBlue;shiftAlpha;constructor($,{toRGBA:J}={toRGBA:!1}){if(this.buffer=$,this.toRGBA=!!J,this.pos=0,this.bottomUp=!0,this.flag=this.buffer.toString("utf-8",0,this.pos+=2),this.flag!=="BM")throw Error("Invalid BMP File");this.locRed=this.toRGBA?0:3,this.locGreen=this.toRGBA?1:2,this.locBlue=this.toRGBA?2:1,this.locAlpha=this.toRGBA?3:0,this.parseHeader(),this.parseRGBA()}parseHeader(){if(this.fileSize=this.readUInt32LE(),this.reserved1=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.reserved2=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.offset=this.readUInt32LE(),this.headerSize=this.readUInt32LE(),!(this.headerSize in n6))throw Error(`Unsupported BMP header size ${this.headerSize}`);if(this.width=this.readUInt32LE(),this.height=this.readUInt32LE(),this.height=this.height>2147483647?this.height-4294967296:this.height,this.planes=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.bitPP=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.compression=this.readUInt32LE(),this.rawSize=this.readUInt32LE(),this.hr=this.readUInt32LE(),this.vr=this.readUInt32LE(),this.colors=this.readUInt32LE(),this.importantColors=this.readUInt32LE(),this.bitPP===32)this.maskAlpha=0,this.maskRed=16711680,this.maskGreen=65280,this.maskBlue=255;else if(this.bitPP===16)this.maskAlpha=0,this.maskRed=31744,this.maskGreen=992,this.maskBlue=31;if(this.headerSize>n6.BITMAP_INFO_HEADER||this.compression===b8.BI_BIT_FIELDS||this.compression===b8.BI_ALPHA_BIT_FIELDS)this.maskRed=this.readUInt32LE(),this.maskGreen=this.readUInt32LE(),this.maskBlue=this.readUInt32LE();if(this.headerSize>n6.BITMAP_V2_INFO_HEADER||this.compression===b8.BI_ALPHA_BIT_FIELDS)this.maskAlpha=this.readUInt32LE();if(this.headerSize>n6.BITMAP_V3_INFO_HEADER)this.pos+=n6.BITMAP_V4_HEADER-n6.BITMAP_V3_INFO_HEADER;if(this.headerSize>n6.BITMAP_V4_HEADER)this.pos+=n6.BITMAP_V5_HEADER-n6.BITMAP_V4_HEADER;if(this.bitPP<=8||this.colors>0){let J=this.colors===0?1<<this.bitPP:this.colors;this.palette=Array(J);for(let X=0;X<J;X++){let K=this.buffer.readUInt8(this.pos++),q=this.buffer.readUInt8(this.pos++),Y=this.buffer.readUInt8(this.pos++),W=this.buffer.readUInt8(this.pos++);this.palette[X]={red:Y,green:q,blue:K,quad:W}}}if(this.height<0)this.height*=-1,this.bottomUp=!1;let $=x7(this.maskRed,this.maskGreen,this.maskBlue,this.maskAlpha);this.shiftRed=$.shiftRed,this.shiftGreen=$.shiftGreen,this.shiftBlue=$.shiftBlue,this.shiftAlpha=$.shiftAlpha}parseRGBA(){switch(this.data=Buffer.alloc(this.width*this.height*4),this.bitPP){case 1:this.bit1();break;case 4:this.bit4();break;case 8:this.bit8();break;case 16:this.bit16();break;case 24:this.bit24();break;default:this.bit32()}}bit1(){let $=Math.ceil(this.width/8),J=$%4,X=J!==0?4-J:0,K;this.scanImage(X,$,(q,Y)=>{if(Y!==K)K=Y;let W=this.buffer.readUInt8(this.pos++),Q=Y*this.width*4+q*8*4;for(let N=0;N<8;N++)if(q*8+N<this.width){let V=this.palette[W>>7-N&1];this.data[Q+N*this.locAlpha]=0,this.data[Q+N*4+this.locBlue]=V.blue,this.data[Q+N*4+this.locGreen]=V.green,this.data[Q+N*4+this.locRed]=V.red}else break})}bit4(){if(this.compression===b8.BI_RLE4){this.data.fill(0);let $=!1,J=this.bottomUp?this.height-1:0,X=0;while(X<this.data.length){let K=this.buffer.readUInt8(this.pos++),q=this.buffer.readUInt8(this.pos++);if(K===0){if(q===0){J+=this.bottomUp?-1:1,X=J*this.width*4,$=!1;continue}if(q===1)break;if(q===2){let Y=this.buffer.readUInt8(this.pos++),W=this.buffer.readUInt8(this.pos++);J+=this.bottomUp?-W:W,X+=W*this.width*4+Y*4}else{let Y=this.buffer.readUInt8(this.pos++);for(let W=0;W<q;W++){if(X=this.setPixelData(X,$?Y&15:(Y&240)>>4),W&1&&W+1<q)Y=this.buffer.readUInt8(this.pos++);$=!$}if((q+1>>1&1)===1)this.pos++}}else for(let Y=0;Y<K;Y++)X=this.setPixelData(X,$?q&15:(q&240)>>4),$=!$}}else{let $=Math.ceil(this.width/2),J=$%4,X=J!==0?4-J:0;this.scanImage(X,$,(K,q)=>{let Y=this.buffer.readUInt8(this.pos++),W=q*this.width*4+K*2*4,Q=Y>>4,N=this.palette[Q];if(this.data[W]=0,this.data[W+1]=N.blue,this.data[W+2]=N.green,this.data[W+3]=N.red,K*2+1>=this.width)return!1;let V=Y&15;N=this.palette[V],this.data[W+4]=0,this.data[W+4+1]=N.blue,this.data[W+4+2]=N.green,this.data[W+4+3]=N.red})}}bit8(){if(this.compression===b8.BI_RLE8){this.data.fill(0);let $=this.bottomUp?this.height-1:0,J=0;while(J<this.data.length){let X=this.buffer.readUInt8(this.pos++),K=this.buffer.readUInt8(this.pos++);if(X===0){if(K===0){$+=this.bottomUp?-1:1,J=$*this.width*4;continue}if(K===1)break;if(K===2){let q=this.buffer.readUInt8(this.pos++),Y=this.buffer.readUInt8(this.pos++);$+=this.bottomUp?-Y:Y,J+=Y*this.width*4+q*4}else{for(let Y=0;Y<K;Y++){let W=this.buffer.readUInt8(this.pos++);J=this.setPixelData(J,W)}if(K&!0)this.pos++}}else for(let q=0;q<X;q++)J=this.setPixelData(J,K)}}else{let $=this.width%4,J=$!==0?4-$:0;this.scanImage(J,this.width,(X,K)=>{let q=this.buffer.readUInt8(this.pos++),Y=K*this.width*4+X*4;if(q<this.palette.length){let W=this.palette[q];this.data[Y]=0,this.data[Y+1]=W.blue,this.data[Y+2]=W.green,this.data[Y+3]=W.red}else this.data[Y]=0,this.data[Y+1]=255,this.data[Y+2]=255,this.data[Y+3]=255})}}bit16(){let $=this.width%2*2;this.scanImage($,this.width,(J,X)=>{let K=X*this.width*4+J*4,q=this.buffer.readUInt16LE(this.pos);this.pos+=2,this.data[K+this.locRed]=this.shiftRed(q),this.data[K+this.locGreen]=this.shiftGreen(q),this.data[K+this.locBlue]=this.shiftBlue(q),this.data[K+this.locAlpha]=this.shiftAlpha(q)})}bit24(){let $=this.width%4;this.scanImage($,this.width,(J,X)=>{let K=X*this.width*4+J*4,q=this.buffer.readUInt8(this.pos++),Y=this.buffer.readUInt8(this.pos++),W=this.buffer.readUInt8(this.pos++);this.data[K+this.locRed]=W,this.data[K+this.locGreen]=Y,this.data[K+this.locBlue]=q,this.data[K+this.locAlpha]=0})}bit32(){this.scanImage(0,this.width,($,J)=>{let X=J*this.width*4+$*4,K=this.readUInt32LE();this.data[X+this.locRed]=this.shiftRed(K),this.data[X+this.locGreen]=this.shiftGreen(K),this.data[X+this.locBlue]=this.shiftBlue(K),this.data[X+this.locAlpha]=this.shiftAlpha(K)})}scanImage($=0,J=this.width,X){for(let K=this.height-1;K>=0;K--){let q=this.bottomUp?K:this.height-1-K;for(let Y=0;Y<J;Y++)if(X.call(this,Y,q)===!1)return;this.pos+=$}}readUInt32LE(){let $=this.buffer.readUInt32LE(this.pos);return this.pos+=4,$}setPixelData($,J){let{blue:X,green:K,red:q}=this.palette[J];return this.data[$+this.locAlpha]=0,this.data[$+1+this.locBlue]=X,this.data[$+2+this.locGreen]=K,this.data[$+3+this.locRed]=q,$+4}}function DX($){return $.reduce((J,X)=>J<<1|X,0)}function h7($){return $.quad<<24|$.red<<16|$.green<<8|$.blue}class e9{fileSize;reserved1;reserved2;offset;width;flag;height;planes;bitPP;compress;hr;vr;colors;importantColors;rawSize;headerSize;data;palette;extraBytes;buffer;bytesInColor;pos;constructor($){if(this.buffer=$.data,this.width=$.width,this.height=$.height,this.headerSize=n6.BITMAP_INFO_HEADER,this.flag="BM",this.bitPP=$.bitPP||24,this.offset=54,this.reserved1=$.reserved1||0,this.reserved2=$.reserved2||0,this.planes=1,this.compress=0,this.hr=$.hr||0,this.vr=$.vr||0,this.importantColors=$.importantColors||0,this.colors=Math.min(2**(this.bitPP-1||1),$.colors||1/0),this.palette=$.palette||[],this.colors&&this.bitPP<16)this.offset+=this.colors*4;else this.colors=0;switch(this.bitPP){case 32:this.bytesInColor=4;break;case 16:this.bytesInColor=2;break;case 8:this.bytesInColor=1;break;case 4:this.bytesInColor=0.5;break;case 1:this.bytesInColor=0.125;break;default:this.bytesInColor=3,this.bitPP=24}let J=this.width*this.bitPP/32,X=Math.ceil(J);this.extraBytes=(X-J)*4,this.rawSize=this.height*X*4+2,this.fileSize=this.rawSize+this.offset,this.data=Buffer.alloc(this.fileSize,1),this.pos=0,this.encode()}encode(){switch(this.pos=0,this.writeHeader(),this.bitPP){case 32:this.bit32();break;case 16:this.bit16();break;case 8:this.bit8();break;case 4:this.bit4();break;case 1:this.bit1();break;default:this.bit24()}}writeHeader(){this.data.write(this.flag,this.pos,2),this.pos+=2,this.writeUInt32LE(this.fileSize),this.writeUInt32LE(this.reserved1<<16|this.reserved2),this.writeUInt32LE(this.offset),this.writeUInt32LE(this.headerSize),this.writeUInt32LE(this.width),this.writeUInt32LE(this.height),this.data.writeUInt16LE(this.planes,this.pos),this.pos+=2,this.data.writeUInt16LE(this.bitPP,this.pos),this.pos+=2,this.writeUInt32LE(this.compress),this.writeUInt32LE(this.rawSize),this.writeUInt32LE(this.hr),this.writeUInt32LE(this.vr),this.writeUInt32LE(this.colors),this.writeUInt32LE(this.importantColors)}bit1(){if(this.palette.length&&this.colors===2)this.initColors(1);else this.writeUInt32LE(16777215),this.writeUInt32LE(0);this.pos+=1;let $=[];this.writeImage((J,X,K)=>{let q=X;q++;let Y=this.buffer[q++],W=this.buffer[q++],N=this.buffer[q++]*0.2126+W*0.7152+Y*0.0722;if($.push(N>127?0:1),(K+1)%8===0)this.data[J-1]=DX($),$=[];else if(K===this.width-1&&$.length>0)this.data[J-1]=DX($)<<4,$=[];return q})}bit4(){let $=this.initColors(4),J=[];this.writeImage((X,K,q)=>{let Y=K,W=h7({quad:this.buffer[Y++],blue:this.buffer[Y++],green:this.buffer[Y++],red:this.buffer[Y++]}),Q=$.findIndex((N)=>N===W);if(Q!==-1)J.push(Q);else J.push(0);if((q+1)%2===0)this.data[X]=J[0]<<4|J[1],J=[];return Y})}bit8(){let $=this.initColors(8);this.writeImage((J,X)=>{let K=X,q=h7({quad:this.buffer[K++],blue:this.buffer[K++],green:this.buffer[K++],red:this.buffer[K++]}),Y=$.findIndex((W)=>W===q);if(Y!==-1)this.data[J]=Y;else this.data[J]=0;return K})}bit16(){this.writeImage(($,J)=>{let X=J+1,K=this.buffer[X++]/8,q=this.buffer[X++]/8,W=this.buffer[X++]/8<<10|q<<5|K;return this.data[$]=W&255,this.data[$+1]=(W&65280)>>8,X})}bit24(){this.writeImage(($,J)=>{let X=J+1;return this.data[$]=this.buffer[X++],this.data[$+1]=this.buffer[X++],this.data[$+2]=this.buffer[X++],X})}bit32(){this.writeImage(($,J)=>{let X=J;return this.data[$+3]=this.buffer[X++],this.data[$]=this.buffer[X++],this.data[$+1]=this.buffer[X++],this.data[$+2]=this.buffer[X++],X})}writeImage($){let J=this.extraBytes+this.width*this.bytesInColor,X=0;for(let K=0;K<this.height;K++)for(let q=0;q<this.width;q++){let Y=Math.floor(this.pos+(this.height-1-K)*J+q*this.bytesInColor);X=$.call(this,Y,X,q,K)}}initColors($){let J=[];if(this.palette.length)for(let X=0;X<this.colors;X++){let K=h7(this.palette[X]);this.writeUInt32LE(K),J.push(K)}else throw Error(`To encode ${$}-bit BMPs a pallette is needed. Please choose up to ${this.colors} colors. Colors must be 32-bit integers.`);return J}writeUInt32LE($){this.data.writeUInt32LE($,this.pos),this.pos+=4}}function kX($,J){return new t9($,J)}function wX($){return new e9($)}function $$($){return $$=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(J){return typeof J}:function(J){return J&&typeof Symbol=="function"&&J.constructor===Symbol&&J!==Symbol.prototype?"symbol":typeof J},$$($)}var MH=/^\s+/,HH=/\s+$/;function B0($,J){if($=$?$:"",J=J||{},$ instanceof B0)return $;if(!(this instanceof B0))return new B0($,J);var X=GH($);if(this._originalInput=$,this._r=X.r,this._g=X.g,this._b=X.b,this._a=X.a,this._roundA=Math.round(100*this._a)/100,this._format=J.format||X.format,this._gradientType=J.gradientType,this._r<1)this._r=Math.round(this._r);if(this._g<1)this._g=Math.round(this._g);if(this._b<1)this._b=Math.round(this._b);this._ok=X.ok}B0.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var J=this.toRgb();return(J.r*299+J.g*587+J.b*114)/1000},getLuminance:function(){var J=this.toRgb(),X,K,q,Y,W,Q;if(X=J.r/255,K=J.g/255,q=J.b/255,X<=0.03928)Y=X/12.92;else Y=Math.pow((X+0.055)/1.055,2.4);if(K<=0.03928)W=K/12.92;else W=Math.pow((K+0.055)/1.055,2.4);if(q<=0.03928)Q=q/12.92;else Q=Math.pow((q+0.055)/1.055,2.4);return 0.2126*Y+0.7152*W+0.0722*Q},setAlpha:function(J){return this._a=gX(J),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var J=IX(this._r,this._g,this._b);return{h:J.h*360,s:J.s,v:J.v,a:this._a}},toHsvString:function(){var J=IX(this._r,this._g,this._b),X=Math.round(J.h*360),K=Math.round(J.s*100),q=Math.round(J.v*100);return this._a==1?"hsv("+X+", "+K+"%, "+q+"%)":"hsva("+X+", "+K+"%, "+q+"%, "+this._roundA+")"},toHsl:function(){var J=TX(this._r,this._g,this._b);return{h:J.h*360,s:J.s,l:J.l,a:this._a}},toHslString:function(){var J=TX(this._r,this._g,this._b),X=Math.round(J.h*360),K=Math.round(J.s*100),q=Math.round(J.l*100);return this._a==1?"hsl("+X+", "+K+"%, "+q+"%)":"hsla("+X+", "+K+"%, "+q+"%, "+this._roundA+")"},toHex:function(J){return _X(this._r,this._g,this._b,J)},toHexString:function(J){return"#"+this.toHex(J)},toHex8:function(J){return jH(this._r,this._g,this._b,this._a,J)},toHex8String:function(J){return"#"+this.toHex8(J)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(e0(this._r,255)*100)+"%",g:Math.round(e0(this._g,255)*100)+"%",b:Math.round(e0(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(e0(this._r,255)*100)+"%, "+Math.round(e0(this._g,255)*100)+"%, "+Math.round(e0(this._b,255)*100)+"%)":"rgba("+Math.round(e0(this._r,255)*100)+"%, "+Math.round(e0(this._g,255)*100)+"%, "+Math.round(e0(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){if(this._a===0)return"transparent";if(this._a<1)return!1;return DH[_X(this._r,this._g,this._b,!0)]||!1},toFilter:function(J){var X="#"+yX(this._r,this._g,this._b,this._a),K=X,q=this._gradientType?"GradientType = 1, ":"";if(J){var Y=B0(J);K="#"+yX(Y._r,Y._g,Y._b,Y._a)}return"progid:DXImageTransform.Microsoft.gradient("+q+"startColorstr="+X+",endColorstr="+K+")"},toString:function(J){var X=!!J;J=J||this._format;var K=!1,q=this._a<1&&this._a>=0,Y=!X&&q&&(J==="hex"||J==="hex6"||J==="hex3"||J==="hex4"||J==="hex8"||J==="name");if(Y){if(J==="name"&&this._a===0)return this.toName();return this.toRgbString()}if(J==="rgb")K=this.toRgbString();if(J==="prgb")K=this.toPercentageRgbString();if(J==="hex"||J==="hex6")K=this.toHexString();if(J==="hex3")K=this.toHexString(!0);if(J==="hex4")K=this.toHex8String(!0);if(J==="hex8")K=this.toHex8String();if(J==="name")K=this.toName();if(J==="hsl")K=this.toHslString();if(J==="hsv")K=this.toHsvString();return K||this.toHexString()},clone:function(){return B0(this.toString())},_applyModification:function(J,X){var K=J.apply(null,[this].concat([].slice.call(X)));return this._r=K._r,this._g=K._g,this._b=K._b,this.setAlpha(K._a),this},lighten:function(){return this._applyModification(PH,arguments)},brighten:function(){return this._applyModification(SH,arguments)},darken:function(){return this._applyModification(AH,arguments)},desaturate:function(){return this._applyModification(EH,arguments)},saturate:function(){return this._applyModification(RH,arguments)},greyscale:function(){return this._applyModification(BH,arguments)},spin:function(){return this._applyModification(FH,arguments)},_applyCombination:function(J,X){return J.apply(null,[this].concat([].slice.call(X)))},analogous:function(){return this._applyCombination(ZH,arguments)},complement:function(){return this._applyCombination(zH,arguments)},monochromatic:function(){return this._applyCombination(vH,arguments)},splitcomplement:function(){return this._applyCombination(CH,arguments)},triad:function(){return this._applyCombination(xX,[3])},tetrad:function(){return this._applyCombination(xX,[4])}};B0.fromRatio=function($,J){if($$($)=="object"){var X={};for(var K in $)if($.hasOwnProperty(K))if(K==="a")X[K]=$[K];else X[K]=a5($[K]);$=X}return B0($,J)};function GH($){var J={r:0,g:0,b:0},X=1,K=null,q=null,Y=null,W=!1,Q=!1;if(typeof $=="string")$=IH($);if($$($)=="object"){if(m8($.r)&&m8($.g)&&m8($.b))J=OH($.r,$.g,$.b),W=!0,Q=String($.r).substr(-1)==="%"?"prgb":"rgb";else if(m8($.h)&&m8($.s)&&m8($.v))K=a5($.s),q=a5($.v),J=LH($.h,K,q),W=!0,Q="hsv";else if(m8($.h)&&m8($.s)&&m8($.l))K=a5($.s),Y=a5($.l),J=UH($.h,K,Y),W=!0,Q="hsl";if($.hasOwnProperty("a"))X=$.a}return X=gX(X),{ok:W,format:$.format||Q,r:Math.min(255,Math.max(J.r,0)),g:Math.min(255,Math.max(J.g,0)),b:Math.min(255,Math.max(J.b,0)),a:X}}function OH($,J,X){return{r:e0($,255)*255,g:e0(J,255)*255,b:e0(X,255)*255}}function TX($,J,X){$=e0($,255),J=e0(J,255),X=e0(X,255);var K=Math.max($,J,X),q=Math.min($,J,X),Y,W,Q=(K+q)/2;if(K==q)Y=W=0;else{var N=K-q;switch(W=Q>0.5?N/(2-K-q):N/(K+q),K){case $:Y=(J-X)/N+(J<X?6:0);break;case J:Y=(X-$)/N+2;break;case X:Y=($-J)/N+4;break}Y/=6}return{h:Y,s:W,l:Q}}function UH($,J,X){var K,q,Y;$=e0($,360),J=e0(J,100),X=e0(X,100);function W(V,M,H){if(H<0)H+=1;if(H>1)H-=1;if(H<0.16666666666666666)return V+(M-V)*6*H;if(H<0.5)return M;if(H<0.6666666666666666)return V+(M-V)*(0.6666666666666666-H)*6;return V}if(J===0)K=q=Y=X;else{var Q=X<0.5?X*(1+J):X+J-X*J,N=2*X-Q;K=W(N,Q,$+0.3333333333333333),q=W(N,Q,$),Y=W(N,Q,$-0.3333333333333333)}return{r:K*255,g:q*255,b:Y*255}}function IX($,J,X){$=e0($,255),J=e0(J,255),X=e0(X,255);var K=Math.max($,J,X),q=Math.min($,J,X),Y,W,Q=K,N=K-q;if(W=K===0?0:N/K,K==q)Y=0;else{switch(K){case $:Y=(J-X)/N+(J<X?6:0);break;case J:Y=(X-$)/N+2;break;case X:Y=($-J)/N+4;break}Y/=6}return{h:Y,s:W,v:Q}}function LH($,J,X){$=e0($,360)*6,J=e0(J,100),X=e0(X,100);var K=Math.floor($),q=$-K,Y=X*(1-J),W=X*(1-q*J),Q=X*(1-(1-q)*J),N=K%6,V=[X,W,Y,Y,Q,X][N],M=[Q,X,X,W,Y,Y][N],H=[Y,Y,Q,X,X,W][N];return{r:V*255,g:M*255,b:H*255}}function _X($,J,X,K){var q=[W8(Math.round($).toString(16)),W8(Math.round(J).toString(16)),W8(Math.round(X).toString(16))];if(K&&q[0].charAt(0)==q[0].charAt(1)&&q[1].charAt(0)==q[1].charAt(1)&&q[2].charAt(0)==q[2].charAt(1))return q[0].charAt(0)+q[1].charAt(0)+q[2].charAt(0);return q.join("")}function jH($,J,X,K,q){var Y=[W8(Math.round($).toString(16)),W8(Math.round(J).toString(16)),W8(Math.round(X).toString(16)),W8(fX(K))];if(q&&Y[0].charAt(0)==Y[0].charAt(1)&&Y[1].charAt(0)==Y[1].charAt(1)&&Y[2].charAt(0)==Y[2].charAt(1)&&Y[3].charAt(0)==Y[3].charAt(1))return Y[0].charAt(0)+Y[1].charAt(0)+Y[2].charAt(0)+Y[3].charAt(0);return Y.join("")}function yX($,J,X,K){var q=[W8(fX(K)),W8(Math.round($).toString(16)),W8(Math.round(J).toString(16)),W8(Math.round(X).toString(16))];return q.join("")}B0.equals=function($,J){if(!$||!J)return!1;return B0($).toRgbString()==B0(J).toRgbString()};B0.random=function(){return B0.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function EH($,J){J=J===0?0:J||10;var X=B0($).toHsl();return X.s-=J/100,X.s=J$(X.s),B0(X)}function RH($,J){J=J===0?0:J||10;var X=B0($).toHsl();return X.s+=J/100,X.s=J$(X.s),B0(X)}function BH($){return B0($).desaturate(100)}function PH($,J){J=J===0?0:J||10;var X=B0($).toHsl();return X.l+=J/100,X.l=J$(X.l),B0(X)}function SH($,J){J=J===0?0:J||10;var X=B0($).toRgb();return X.r=Math.max(0,Math.min(255,X.r-Math.round(255*-(J/100)))),X.g=Math.max(0,Math.min(255,X.g-Math.round(255*-(J/100)))),X.b=Math.max(0,Math.min(255,X.b-Math.round(255*-(J/100)))),B0(X)}function AH($,J){J=J===0?0:J||10;var X=B0($).toHsl();return X.l-=J/100,X.l=J$(X.l),B0(X)}function FH($,J){var X=B0($).toHsl(),K=(X.h+J)%360;return X.h=K<0?360+K:K,B0(X)}function zH($){var J=B0($).toHsl();return J.h=(J.h+180)%360,B0(J)}function xX($,J){if(isNaN(J)||J<=0)throw Error("Argument to polyad must be a positive number");var X=B0($).toHsl(),K=[B0($)],q=360/J;for(var Y=1;Y<J;Y++)K.push(B0({h:(X.h+Y*q)%360,s:X.s,l:X.l}));return K}function CH($){var J=B0($).toHsl(),X=J.h;return[B0($),B0({h:(X+72)%360,s:J.s,l:J.l}),B0({h:(X+216)%360,s:J.s,l:J.l})]}function ZH($,J,X){J=J||6,X=X||30;var K=B0($).toHsl(),q=360/X,Y=[B0($)];for(K.h=(K.h-(q*J>>1)+720)%360;--J;)K.h=(K.h+q)%360,Y.push(B0(K));return Y}function vH($,J){J=J||6;var X=B0($).toHsv(),K=X.h,q=X.s,Y=X.v,W=[],Q=1/J;while(J--)W.push(B0({h:K,s:q,v:Y})),Y=(Y+Q)%1;return W}B0.mix=function($,J,X){X=X===0?0:X||50;var K=B0($).toRgb(),q=B0(J).toRgb(),Y=X/100,W={r:(q.r-K.r)*Y+K.r,g:(q.g-K.g)*Y+K.g,b:(q.b-K.b)*Y+K.b,a:(q.a-K.a)*Y+K.a};return B0(W)};B0.readability=function($,J){var X=B0($),K=B0(J);return(Math.max(X.getLuminance(),K.getLuminance())+0.05)/(Math.min(X.getLuminance(),K.getLuminance())+0.05)};B0.isReadable=function($,J,X){var K=B0.readability($,J),q,Y;switch(Y=!1,q=_H(X),q.level+q.size){case"AAsmall":case"AAAlarge":Y=K>=4.5;break;case"AAlarge":Y=K>=3;break;case"AAAsmall":Y=K>=7;break}return Y};B0.mostReadable=function($,J,X){var K=null,q=0,Y,W,Q,N;X=X||{},W=X.includeFallbackColors,Q=X.level,N=X.size;for(var V=0;V<J.length;V++)if(Y=B0.readability($,J[V]),Y>q)q=Y,K=B0(J[V]);if(B0.isReadable($,K,{level:Q,size:N})||!W)return K;else return X.includeFallbackColors=!1,B0.mostReadable($,["#fff","#000"],X)};var g7=B0.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},DH=B0.hexNames=kH(g7);function kH($){var J={};for(var X in $)if($.hasOwnProperty(X))J[$[X]]=X;return J}function gX($){if($=parseFloat($),isNaN($)||$<0||$>1)$=1;return $}function e0($,J){if(wH($))$="100%";var X=TH($);if($=Math.min(J,Math.max(0,parseFloat($))),X)$=parseInt($*J,10)/100;if(Math.abs($-J)<0.000001)return 1;return $%J/parseFloat(J)}function J$($){return Math.min(1,Math.max(0,$))}function x6($){return parseInt($,16)}function wH($){return typeof $=="string"&&$.indexOf(".")!=-1&&parseFloat($)===1}function TH($){return typeof $==="string"&&$.indexOf("%")!=-1}function W8($){return $.length==1?"0"+$:""+$}function a5($){if($<=1)$=$*100+"%";return $}function fX($){return Math.round(parseFloat($)*255).toString(16)}function hX($){return x6($)/255}var Y8=function(){var $="[-\\+]?\\d+%?",J="[-\\+]?\\d*\\.\\d+%?",X="(?:"+J+")|(?:"+$+")",K="[\\s|\\(]+("+X+")[,|\\s]+("+X+")[,|\\s]+("+X+")\\s*\\)?",q="[\\s|\\(]+("+X+")[,|\\s]+("+X+")[,|\\s]+("+X+")[,|\\s]+("+X+")\\s*\\)?";return{CSS_UNIT:new RegExp(X),rgb:new RegExp("rgb"+K),rgba:new RegExp("rgba"+q),hsl:new RegExp("hsl"+K),hsla:new RegExp("hsla"+q),hsv:new RegExp("hsv"+K),hsva:new RegExp("hsva"+q),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function m8($){return!!Y8.CSS_UNIT.exec($)}function IH($){$=$.replace(MH,"").replace(HH,"").toLowerCase();var J=!1;if(g7[$])$=g7[$],J=!0;else if($=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var X;if(X=Y8.rgb.exec($))return{r:X[1],g:X[2],b:X[3]};if(X=Y8.rgba.exec($))return{r:X[1],g:X[2],b:X[3],a:X[4]};if(X=Y8.hsl.exec($))return{h:X[1],s:X[2],l:X[3]};if(X=Y8.hsla.exec($))return{h:X[1],s:X[2],l:X[3],a:X[4]};if(X=Y8.hsv.exec($))return{h:X[1],s:X[2],v:X[3]};if(X=Y8.hsva.exec($))return{h:X[1],s:X[2],v:X[3],a:X[4]};if(X=Y8.hex8.exec($))return{r:x6(X[1]),g:x6(X[2]),b:x6(X[3]),a:hX(X[4]),format:J?"name":"hex8"};if(X=Y8.hex6.exec($))return{r:x6(X[1]),g:x6(X[2]),b:x6(X[3]),format:J?"name":"hex"};if(X=Y8.hex4.exec($))return{r:x6(X[1]+""+X[1]),g:x6(X[2]+""+X[2]),b:x6(X[3]+""+X[3]),a:hX(X[4]+""+X[4]),format:J?"name":"hex8"};if(X=Y8.hex3.exec($))return{r:x6(X[1]+""+X[1]),g:x6(X[2]+""+X[2]),b:x6(X[3]+""+X[3]),format:J?"name":"hex"};return!1}function _H($){var J,X;if($=$||{level:"AA",size:"small"},J=($.level||"AA").toUpperCase(),X=($.size||"small").toLowerCase(),J!=="AA"&&J!=="AAA")J="AA";if(X!=="small"&&X!=="large")X="small";return{level:J,size:X}}function h6($){let J={width:$.bitmap.width,height:$.bitmap.height,data:Buffer.from($.bitmap.data)};return new $.constructor(J)}function o6($,J,X,K,q,Y){let W,Q,N,V,M;if(typeof J==="function")M=J,W=0,Q=0,N=$.bitmap.width,V=$.bitmap.height;else{if(W=J,typeof X!=="number")throw Error("y must be a number");if(Q=X,typeof K!=="number")throw Error("w must be a number");if(N=K,typeof q!=="number")throw Error("h must be a number");if(V=q,typeof Y!=="function")throw Error("cb must be a function");M=Y}W=Math.round(W),Q=Math.round(Q),N=Math.round(N),V=Math.round(V);let H=M.bind($);for(let G=Q;G<Q+V;G++)for(let O=W;O<W+N;O++){let L=$.bitmap.width*G+O<<2;H(O,G,L)}return $}function*bX($,J,X,K,q){J=Math.round(J),X=Math.round(X),K=Math.round(K),q=Math.round(q);for(let Y=X;Y<X+q;Y++)for(let W=J;W<J+K;W++){let Q=$.bitmap.width*Y+W<<2;yield{x:W,y:Y,idx:Q,image:$}}}function i1($){if(typeof $!=="number")throw Error("i must be a number");let J={r:0,g:0,b:0,a:0};return J.r=Math.floor($/Math.pow(256,3)),J.g=Math.floor(($-J.r*Math.pow(256,3))/Math.pow(256,2)),J.b=Math.floor(($-J.r*Math.pow(256,3)-J.g*Math.pow(256,2))/Math.pow(256,1)),J.a=Math.floor(($-J.r*Math.pow(256,3)-J.g*Math.pow(256,2)-J.b*Math.pow(256,1))/Math.pow(256,0)),J}function t5($,J){let X=(Q)=>Math.pow(Q,2),{max:K}=Math,q=195075,Y="a"in $?$.a:255,W="a"in J?J.a:255;return(K(X($.r-J.r),X($.r-J.r-Y+W))+K(X($.g-J.g),X($.g-J.g-Y+W))+K(X($.b-J.b),X($.b-J.b-Y+W)))/195075}function $6($){return $=Math.max($,0),$=Math.min($,255),$}function mX($){if(typeof $==="number")return $;return parseInt(B0($).toHex8(),16)}function pX($,J={}){return o6({bitmap:$},0,0,$.width,$.height,function(X,K,q){let Y=$.data[q+0],W=$.data[q+1],Q=$.data[q+2],N=$.data[q+3];$.data[q+0]=N,$.data[q+1]=Q,$.data[q+2]=W,$.data[q+3]=Y}),wX({...$,...J}).data}function uX($,J){let X=kX($,J);return o6({bitmap:X},0,0,X.width,X.height,function(K,q,Y){let W=X.data[Y+1],Q=X.data[Y+2],N=X.data[Y+3];X.data[Y+0]=N,X.data[Y+1]=Q,X.data[Y+2]=W,X.data[Y+3]=255}),X}function lX(){return{mime:"image/x-ms-bmp",encode:pX,decode:uX}}function X$(){return{mime:"image/bmp",encode:pX,decode:uX}}var oK=h8(f7(),1),Y1=h8(nK(),1);function O$(){return{mime:"image/gif",encode:async($)=>{let J=new Y1.BitmapImage($);Y1.GifUtil.quantizeDekker(J,256);let X=new Y1.GifFrame($);return(await new Y1.GifCodec().encodeGif([X],{})).buffer},decode:($)=>{let J=new oK.default.GifReader($),X=Buffer.alloc(J.width*J.height*4);return J.decodeAndBlitFrameRGBA(0,X),{data:X,width:J.width,height:J.height}}}}var t7=h8($q(),1);function L$(){return{mime:"image/jpeg",encode:($,{quality:J=100}={})=>t7.default.encode($,J).data,decode:($,J)=>t7.default.decode($,J)}}var E$=h8(nq(),1);var j$;(function($){$[$.AUTO=-1]="AUTO",$[$.NONE=0]="NONE",$[$.SUB=1]="SUB",$[$.UP=2]="UP",$[$.AVERAGE=3]="AVERAGE",$[$.PATH=4]="PATH"})(j$||(j$={}));var N9;(function($){$[$.GRAYSCALE=0]="GRAYSCALE",$[$.COLOR=2]="COLOR",$[$.GRAYSCALE_ALPHA=4]="GRAYSCALE_ALPHA",$[$.COLOR_ALPHA=6]="COLOR_ALPHA"})(N9||(N9={}));function R$(){return{mime:"image/png",hasAlpha:!0,encode:($,{deflateLevel:J=9,deflateStrategy:X=3,filterType:K=j$.AUTO,colorType:q,inputHasAlpha:Y=!0,...W}={})=>{let Q=new E$.PNG({width:$.width,height:$.height});return Q.data=$.data,E$.PNG.sync.write(Q,{...W,deflateLevel:J,deflateStrategy:X,filterType:K,colorType:typeof q<"u"?q:Y?N9.COLOR_ALPHA:N9.COLOR,inputHasAlpha:Y})},decode:($,J)=>{let X=E$.PNG.sync.read($,J);return{data:X.data,width:X.width,height:X.height}}}}var F9=h8(xW(),1);function hW($){if(typeof $==="number")return $;if($ instanceof Uint8Array)return $[0];if(typeof $[0]==="string")return parseInt($[0]);return $[0]}function x$(){return{mime:"image/tiff",encode:($)=>{let J=F9.default.encodeImage($.data,$.width,$.height);return Buffer.from(J)},decode:($)=>{let J=F9.default.decode($),X=J[0];if(!X)throw Error("No page found in TIFF");if(!X.t256)throw Error("No image width found in TIFF");if(!X.t257)throw Error("No image height found in TIFF");J.forEach((q)=>{F9.default.decodeImage($,q)});let K=F9.default.toRGBA8(X);return{data:Buffer.from(K),width:hW(X.t256),height:hW(X.t257)}}}}var f={};o4(f,{void:()=>hj,util:()=>c0,unknown:()=>yj,union:()=>mj,undefined:()=>Tj,tuple:()=>lj,transformer:()=>ej,symbol:()=>wj,string:()=>dW,strictObject:()=>bj,setErrorMap:()=>Jj,set:()=>nj,record:()=>cj,quotelessJson:()=>eL,promise:()=>tj,preprocess:()=>XE,pipeline:()=>KE,ostring:()=>qE,optional:()=>$E,onumber:()=>YE,oboolean:()=>WE,objectUtil:()=>iJ,object:()=>fj,number:()=>nW,nullable:()=>JE,null:()=>Ij,never:()=>xj,nativeEnum:()=>aj,nan:()=>vj,map:()=>dj,makeIssue:()=>z9,literal:()=>ij,lazy:()=>rj,late:()=>Cj,isValid:()=>U1,isDirty:()=>g$,isAsync:()=>L5,isAborted:()=>h$,intersection:()=>uj,instanceof:()=>Zj,getParsedType:()=>w8,getErrorMap:()=>U5,function:()=>oj,enum:()=>sj,effect:()=>ej,discriminatedUnion:()=>pj,defaultErrorMap:()=>o8,datetimeRegex:()=>uW,date:()=>kj,custom:()=>cW,coerce:()=>QE,boolean:()=>oW,bigint:()=>Dj,array:()=>gj,any:()=>_j,addIssueToContext:()=>j0,ZodVoid:()=>Z9,ZodUnknown:()=>L1,ZodUnion:()=>S5,ZodUndefined:()=>B5,ZodType:()=>p0,ZodTuple:()=>I8,ZodTransformer:()=>U8,ZodSymbol:()=>C9,ZodString:()=>M8,ZodSet:()=>c1,ZodSchema:()=>p0,ZodRecord:()=>v9,ZodReadonly:()=>D5,ZodPromise:()=>d1,ZodPipeline:()=>w9,ZodParsedType:()=>G0,ZodOptional:()=>G8,ZodObject:()=>W6,ZodNumber:()=>j1,ZodNullable:()=>i8,ZodNull:()=>P5,ZodNever:()=>T8,ZodNativeEnum:()=>C5,ZodNaN:()=>k9,ZodMap:()=>D9,ZodLiteral:()=>z5,ZodLazy:()=>F5,ZodIssueCode:()=>N0,ZodIntersection:()=>A5,ZodFunction:()=>E5,ZodFirstPartyTypeKind:()=>D0,ZodError:()=>_6,ZodEnum:()=>R1,ZodEffects:()=>U8,ZodDiscriminatedUnion:()=>f$,ZodDefault:()=>Z5,ZodDate:()=>u1,ZodCatch:()=>v5,ZodBranded:()=>b$,ZodBoolean:()=>R5,ZodBigInt:()=>E1,ZodArray:()=>H8,ZodAny:()=>l1,Schema:()=>p0,ParseStatus:()=>P6,OK:()=>F6,NEVER:()=>NE,INVALID:()=>Z0,EMPTY_PATH:()=>Xj,DIRTY:()=>p1,BRAND:()=>zj});var c0;(function($){$.assertEqual=(q)=>{};function J(q){}$.assertIs=J;function X(q){throw Error()}$.assertNever=X,$.arrayToEnum=(q)=>{let Y={};for(let W of q)Y[W]=W;return Y},$.getValidEnumValues=(q)=>{let Y=$.objectKeys(q).filter((Q)=>typeof q[q[Q]]!=="number"),W={};for(let Q of Y)W[Q]=q[Q];return $.objectValues(W)},$.objectValues=(q)=>{return $.objectKeys(q).map(function(Y){return q[Y]})},$.objectKeys=typeof Object.keys==="function"?(q)=>Object.keys(q):(q)=>{let Y=[];for(let W in q)if(Object.prototype.hasOwnProperty.call(q,W))Y.push(W);return Y},$.find=(q,Y)=>{for(let W of q)if(Y(W))return W;return},$.isInteger=typeof Number.isInteger==="function"?(q)=>Number.isInteger(q):(q)=>typeof q==="number"&&Number.isFinite(q)&&Math.floor(q)===q;function K(q,Y=" | "){return q.map((W)=>typeof W==="string"?`'${W}'`:W).join(Y)}$.joinValues=K,$.jsonStringifyReplacer=(q,Y)=>{if(typeof Y==="bigint")return Y.toString();return Y}})(c0||(c0={}));var iJ;(function($){$.mergeShapes=(J,X)=>{return{...J,...X}}})(iJ||(iJ={}));var G0=c0.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),w8=($)=>{switch(typeof $){case"undefined":return G0.undefined;case"string":return G0.string;case"number":return Number.isNaN($)?G0.nan:G0.number;case"boolean":return G0.boolean;case"function":return G0.function;case"bigint":return G0.bigint;case"symbol":return G0.symbol;case"object":if(Array.isArray($))return G0.array;if($===null)return G0.null;if($.then&&typeof $.then==="function"&&$.catch&&typeof $.catch==="function")return G0.promise;if(typeof Map<"u"&&$ instanceof Map)return G0.map;if(typeof Set<"u"&&$ instanceof Set)return G0.set;if(typeof Date<"u"&&$ instanceof Date)return G0.date;return G0.object;default:return G0.unknown}};var N0=c0.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),eL=($)=>{return JSON.stringify($,null,2).replace(/"([^"]+)":/g,"$1:")};class _6 extends Error{get errors(){return this.issues}constructor($){super();this.issues=[],this.addIssue=(X)=>{this.issues=[...this.issues,X]},this.addIssues=(X=[])=>{this.issues=[...this.issues,...X]};let J=new.target.prototype;if(Object.setPrototypeOf)Object.setPrototypeOf(this,J);else this.__proto__=J;this.name="ZodError",this.issues=$}format($){let J=$||function(q){return q.message},X={_errors:[]},K=(q)=>{for(let Y of q.issues)if(Y.code==="invalid_union")Y.unionErrors.map(K);else if(Y.code==="invalid_return_type")K(Y.returnTypeError);else if(Y.code==="invalid_arguments")K(Y.argumentsError);else if(Y.path.length===0)X._errors.push(J(Y));else{let W=X,Q=0;while(Q<Y.path.length){let N=Y.path[Q];if(Q!==Y.path.length-1)W[N]=W[N]||{_errors:[]};else W[N]=W[N]||{_errors:[]},W[N]._errors.push(J(Y));W=W[N],Q++}}};return K(this),X}static assert($){if(!($ instanceof _6))throw Error(`Not a ZodError: ${$}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,c0.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten($=(J)=>J.message){let J={},X=[];for(let K of this.issues)if(K.path.length>0){let q=K.path[0];J[q]=J[q]||[],J[q].push($(K))}else X.push($(K));return{formErrors:X,fieldErrors:J}}get formErrors(){return this.flatten()}}_6.create=($)=>{return new _6($)};var $j=($,J)=>{let X;switch($.code){case N0.invalid_type:if($.received===G0.undefined)X="Required";else X=`Expected ${$.expected}, received ${$.received}`;break;case N0.invalid_literal:X=`Invalid literal value, expected ${JSON.stringify($.expected,c0.jsonStringifyReplacer)}`;break;case N0.unrecognized_keys:X=`Unrecognized key(s) in object: ${c0.joinValues($.keys,", ")}`;break;case N0.invalid_union:X="Invalid input";break;case N0.invalid_union_discriminator:X=`Invalid discriminator value. Expected ${c0.joinValues($.options)}`;break;case N0.invalid_enum_value:X=`Invalid enum value. Expected ${c0.joinValues($.options)}, received '${$.received}'`;break;case N0.invalid_arguments:X="Invalid function arguments";break;case N0.invalid_return_type:X="Invalid function return type";break;case N0.invalid_date:X="Invalid date";break;case N0.invalid_string:if(typeof $.validation==="object")if("includes"in $.validation){if(X=`Invalid input: must include "${$.validation.includes}"`,typeof $.validation.position==="number")X=`${X} at one or more positions greater than or equal to ${$.validation.position}`}else if("startsWith"in $.validation)X=`Invalid input: must start with "${$.validation.startsWith}"`;else if("endsWith"in $.validation)X=`Invalid input: must end with "${$.validation.endsWith}"`;else c0.assertNever($.validation);else if($.validation!=="regex")X=`Invalid ${$.validation}`;else X="Invalid";break;case N0.too_small:if($.type==="array")X=`Array must contain ${$.exact?"exactly":$.inclusive?"at least":"more than"} ${$.minimum} element(s)`;else if($.type==="string")X=`String must contain ${$.exact?"exactly":$.inclusive?"at least":"over"} ${$.minimum} character(s)`;else if($.type==="number")X=`Number must be ${$.exact?"exactly equal to ":$.inclusive?"greater than or equal to ":"greater than "}${$.minimum}`;else if($.type==="bigint")X=`Number must be ${$.exact?"exactly equal to ":$.inclusive?"greater than or equal to ":"greater than "}${$.minimum}`;else if($.type==="date")X=`Date must be ${$.exact?"exactly equal to ":$.inclusive?"greater than or equal to ":"greater than "}${new Date(Number($.minimum))}`;else X="Invalid input";break;case N0.too_big:if($.type==="array")X=`Array must contain ${$.exact?"exactly":$.inclusive?"at most":"less than"} ${$.maximum} element(s)`;else if($.type==="string")X=`String must contain ${$.exact?"exactly":$.inclusive?"at most":"under"} ${$.maximum} character(s)`;else if($.type==="number")X=`Number must be ${$.exact?"exactly":$.inclusive?"less than or equal to":"less than"} ${$.maximum}`;else if($.type==="bigint")X=`BigInt must be ${$.exact?"exactly":$.inclusive?"less than or equal to":"less than"} ${$.maximum}`;else if($.type==="date")X=`Date must be ${$.exact?"exactly":$.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number($.maximum))}`;else X="Invalid input";break;case N0.custom:X="Invalid input";break;case N0.invalid_intersection_types:X="Intersection results could not be merged";break;case N0.not_multiple_of:X=`Number must be a multiple of ${$.multipleOf}`;break;case N0.not_finite:X="Number must be finite";break;default:X=J.defaultError,c0.assertNever($)}return{message:X}},o8=$j;var gW=o8;function Jj($){gW=$}function U5(){return gW}var z9=($)=>{let{data:J,path:X,errorMaps:K,issueData:q}=$,Y=[...X,...q.path||[]],W={...q,path:Y};if(q.message!==void 0)return{...q,path:Y,message:q.message};let Q="",N=K.filter((V)=>!!V).slice().reverse();for(let V of N)Q=V(W,{data:J,defaultError:Q}).message;return{...q,path:Y,message:Q}},Xj=[];function j0($,J){let X=U5(),K=z9({issueData:J,data:$.data,path:$.path,errorMaps:[$.common.contextualErrorMap,$.schemaErrorMap,X,X===o8?void 0:o8].filter((q)=>!!q)});$.common.issues.push(K)}class P6{constructor(){this.value="valid"}dirty(){if(this.value==="valid")this.value="dirty"}abort(){if(this.value!=="aborted")this.value="aborted"}static mergeArray($,J){let X=[];for(let K of J){if(K.status==="aborted")return Z0;if(K.status==="dirty")$.dirty();X.push(K.value)}return{status:$.value,value:X}}static async mergeObjectAsync($,J){let X=[];for(let K of J){let q=await K.key,Y=await K.value;X.push({key:q,value:Y})}return P6.mergeObjectSync($,X)}static mergeObjectSync($,J){let X={};for(let K of J){let{key:q,value:Y}=K;if(q.status==="aborted")return Z0;if(Y.status==="aborted")return Z0;if(q.status==="dirty")$.dirty();if(Y.status==="dirty")$.dirty();if(q.value!=="__proto__"&&(typeof Y.value<"u"||K.alwaysSet))X[q.value]=Y.value}return{status:$.value,value:X}}}var Z0=Object.freeze({status:"aborted"}),p1=($)=>({status:"dirty",value:$}),F6=($)=>({status:"valid",value:$}),h$=($)=>$.status==="aborted",g$=($)=>$.status==="dirty",U1=($)=>$.status==="valid",L5=($)=>typeof Promise<"u"&&$ instanceof Promise;var P0;(function($){$.errToObj=(J)=>typeof J==="string"?{message:J}:J||{},$.toString=(J)=>typeof J==="string"?J:J?.message})(P0||(P0={}));class O8{constructor($,J,X,K){this._cachedPath=[],this.parent=$,this.data=J,this._path=X,this._key=K}get path(){if(!this._cachedPath.length)if(Array.isArray(this._key))this._cachedPath.push(...this._path,...this._key);else this._cachedPath.push(...this._path,this._key);return this._cachedPath}}var fW=($,J)=>{if(U1(J))return{success:!0,data:J.value};else{if(!$.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let X=new _6($.common.issues);return this._error=X,this._error}}}};function x0($){if(!$)return{};let{errorMap:J,invalid_type_error:X,required_error:K,description:q}=$;if(J&&(X||K))throw Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);if(J)return{errorMap:J,description:q};return{errorMap:(W,Q)=>{let{message:N}=$;if(W.code==="invalid_enum_value")return{message:N??Q.defaultError};if(typeof Q.data>"u")return{message:N??K??Q.defaultError};if(W.code!=="invalid_type")return{message:Q.defaultError};return{message:N??X??Q.defaultError}},description:q}}class p0{get description(){return this._def.description}_getType($){return w8($.data)}_getOrReturnCtx($,J){return J||{common:$.parent.common,data:$.data,parsedType:w8($.data),schemaErrorMap:this._def.errorMap,path:$.path,parent:$.parent}}_processInputParams($){return{status:new P6,ctx:{common:$.parent.common,data:$.data,parsedType:w8($.data),schemaErrorMap:this._def.errorMap,path:$.path,parent:$.parent}}}_parseSync($){let J=this._parse($);if(L5(J))throw Error("Synchronous parse encountered promise.");return J}_parseAsync($){let J=this._parse($);return Promise.resolve(J)}parse($,J){let X=this.safeParse($,J);if(X.success)return X.data;throw X.error}safeParse($,J){let X={common:{issues:[],async:J?.async??!1,contextualErrorMap:J?.errorMap},path:J?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:$,parsedType:w8($)},K=this._parseSync({data:$,path:X.path,parent:X});return fW(X,K)}"~validate"($){let J={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:$,parsedType:w8($)};if(!this["~standard"].async)try{let X=this._parseSync({data:$,path:[],parent:J});return U1(X)?{value:X.value}:{issues:J.common.issues}}catch(X){if(X?.message?.toLowerCase()?.includes("encountered"))this["~standard"].async=!0;J.common={issues:[],async:!0}}return this._parseAsync({data:$,path:[],parent:J}).then((X)=>U1(X)?{value:X.value}:{issues:J.common.issues})}async parseAsync($,J){let X=await this.safeParseAsync($,J);if(X.success)return X.data;throw X.error}async safeParseAsync($,J){let X={common:{issues:[],contextualErrorMap:J?.errorMap,async:!0},path:J?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:$,parsedType:w8($)},K=this._parse({data:$,path:X.path,parent:X}),q=await(L5(K)?K:Promise.resolve(K));return fW(X,q)}refine($,J){let X=(K)=>{if(typeof J==="string"||typeof J>"u")return{message:J};else if(typeof J==="function")return J(K);else return J};return this._refinement((K,q)=>{let Y=$(K),W=()=>q.addIssue({code:N0.custom,...X(K)});if(typeof Promise<"u"&&Y instanceof Promise)return Y.then((Q)=>{if(!Q)return W(),!1;else return!0});if(!Y)return W(),!1;else return!0})}refinement($,J){return this._refinement((X,K)=>{if(!$(X))return K.addIssue(typeof J==="function"?J(X,K):J),!1;else return!0})}_refinement($){return new U8({schema:this,typeName:D0.ZodEffects,effect:{type:"refinement",refinement:$}})}superRefine($){return this._refinement($)}constructor($){this.spa=this.safeParseAsync,this._def=$,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:(J)=>this["~validate"](J)}}optional(){return G8.create(this,this._def)}nullable(){return i8.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return H8.create(this)}promise(){return d1.create(this,this._def)}or($){return S5.create([this,$],this._def)}and($){return A5.create(this,$,this._def)}transform($){return new U8({...x0(this._def),schema:this,typeName:D0.ZodEffects,effect:{type:"transform",transform:$}})}default($){let J=typeof $==="function"?$:()=>$;return new Z5({...x0(this._def),innerType:this,defaultValue:J,typeName:D0.ZodDefault})}brand(){return new b$({typeName:D0.ZodBranded,type:this,...x0(this._def)})}catch($){let J=typeof $==="function"?$:()=>$;return new v5({...x0(this._def),innerType:this,catchValue:J,typeName:D0.ZodCatch})}describe($){return new this.constructor({...this._def,description:$})}pipe($){return w9.create(this,$)}readonly(){return D5.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}var Kj=/^c[^\s-]{8,}$/i,qj=/^[0-9a-z]+$/,Yj=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Wj=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Qj=/^[a-z0-9_-]{21}$/i,Nj=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Vj=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Mj=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Hj="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",sJ,Gj=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Oj=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Uj=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Lj=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,jj=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Ej=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,mW="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Rj=new RegExp(`^${mW}$`);function pW($){let J="[0-5]\\d";if($.precision)J=`${J}\\.\\d{${$.precision}}`;else if($.precision==null)J=`${J}(\\.\\d+)?`;let X=$.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${J})${X}`}function Bj($){return new RegExp(`^${pW($)}$`)}function uW($){let J=`${mW}T${pW($)}`,X=[];if(X.push($.local?"Z?":"Z"),$.offset)X.push("([+-]\\d{2}:?\\d{2})");return J=`${J}(${X.join("|")})`,new RegExp(`^${J}$`)}function Pj($,J){if((J==="v4"||!J)&&Gj.test($))return!0;if((J==="v6"||!J)&&Uj.test($))return!0;return!1}function Sj($,J){if(!Nj.test($))return!1;try{let[X]=$.split(".");if(!X)return!1;let K=X.replace(/-/g,"+").replace(/_/g,"/").padEnd(X.length+(4-X.length%4)%4,"="),q=JSON.parse(atob(K));if(typeof q!=="object"||q===null)return!1;if("typ"in q&&q?.typ!=="JWT")return!1;if(!q.alg)return!1;if(J&&q.alg!==J)return!1;return!0}catch{return!1}}function Aj($,J){if((J==="v4"||!J)&&Oj.test($))return!0;if((J==="v6"||!J)&&Lj.test($))return!0;return!1}class M8 extends p0{_parse($){if(this._def.coerce)$.data=String($.data);if(this._getType($)!==G0.string){let q=this._getOrReturnCtx($);return j0(q,{code:N0.invalid_type,expected:G0.string,received:q.parsedType}),Z0}let X=new P6,K=void 0;for(let q of this._def.checks)if(q.kind==="min"){if($.data.length<q.value)K=this._getOrReturnCtx($,K),j0(K,{code:N0.too_small,minimum:q.value,type:"string",inclusive:!0,exact:!1,message:q.message}),X.dirty()}else if(q.kind==="max"){if($.data.length>q.value)K=this._getOrReturnCtx($,K),j0(K,{code:N0.too_big,maximum:q.value,type:"string",inclusive:!0,exact:!1,message:q.message}),X.dirty()}else if(q.kind==="length"){let Y=$.data.length>q.value,W=$.data.length<q.value;if(Y||W){if(K=this._getOrReturnCtx($,K),Y)j0(K,{code:N0.too_big,maximum:q.value,type:"string",inclusive:!0,exact:!0,message:q.message});else if(W)j0(K,{code:N0.too_small,minimum:q.value,type:"string",inclusive:!0,exact:!0,message:q.message});X.dirty()}}else if(q.kind==="email"){if(!Mj.test($.data))K=this._getOrReturnCtx($,K),j0(K,{validation:"email",code:N0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="emoji"){if(!sJ)sJ=new RegExp(Hj,"u");if(!sJ.test($.data))K=this._getOrReturnCtx($,K),j0(K,{validation:"emoji",code:N0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="uuid"){if(!Wj.test($.data))K=this._getOrReturnCtx($,K),j0(K,{validation:"uuid",code:N0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="nanoid"){if(!Qj.test($.data))K=this._getOrReturnCtx($,K),j0(K,{validation:"nanoid",code:N0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="cuid"){if(!Kj.test($.data))K=this._getOrReturnCtx($,K),j0(K,{validation:"cuid",code:N0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="cuid2"){if(!qj.test($.data))K=this._getOrReturnCtx($,K),j0(K,{validation:"cuid2",code:N0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="ulid"){if(!Yj.test($.data))K=this._getOrReturnCtx($,K),j0(K,{validation:"ulid",code:N0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="url")try{new URL($.data)}catch{K=this._getOrReturnCtx($,K),j0(K,{validation:"url",code:N0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="regex"){if(q.regex.lastIndex=0,!q.regex.test($.data))K=this._getOrReturnCtx($,K),j0(K,{validation:"regex",code:N0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="trim")$.data=$.data.trim();else if(q.kind==="includes"){if(!$.data.includes(q.value,q.position))K=this._getOrReturnCtx($,K),j0(K,{code:N0.invalid_string,validation:{includes:q.value,position:q.position},message:q.message}),X.dirty()}else if(q.kind==="toLowerCase")$.data=$.data.toLowerCase();else if(q.kind==="toUpperCase")$.data=$.data.toUpperCase();else if(q.kind==="startsWith"){if(!$.data.startsWith(q.value))K=this._getOrReturnCtx($,K),j0(K,{code:N0.invalid_string,validation:{startsWith:q.value},message:q.message}),X.dirty()}else if(q.kind==="endsWith"){if(!$.data.endsWith(q.value))K=this._getOrReturnCtx($,K),j0(K,{code:N0.invalid_string,validation:{endsWith:q.value},message:q.message}),X.dirty()}else if(q.kind==="datetime"){if(!uW(q).test($.data))K=this._getOrReturnCtx($,K),j0(K,{code:N0.invalid_string,validation:"datetime",message:q.message}),X.dirty()}else if(q.kind==="date"){if(!Rj.test($.data))K=this._getOrReturnCtx($,K),j0(K,{code:N0.invalid_string,validation:"date",message:q.message}),X.dirty()}else if(q.kind==="time"){if(!Bj(q).test($.data))K=this._getOrReturnCtx($,K),j0(K,{code:N0.invalid_string,validation:"time",message:q.message}),X.dirty()}else if(q.kind==="duration"){if(!Vj.test($.data))K=this._getOrReturnCtx($,K),j0(K,{validation:"duration",code:N0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="ip"){if(!Pj($.data,q.version))K=this._getOrReturnCtx($,K),j0(K,{validation:"ip",code:N0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="jwt"){if(!Sj($.data,q.alg))K=this._getOrReturnCtx($,K),j0(K,{validation:"jwt",code:N0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="cidr"){if(!Aj($.data,q.version))K=this._getOrReturnCtx($,K),j0(K,{validation:"cidr",code:N0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="base64"){if(!jj.test($.data))K=this._getOrReturnCtx($,K),j0(K,{validation:"base64",code:N0.invalid_string,message:q.message}),X.dirty()}else if(q.kind==="base64url"){if(!Ej.test($.data))K=this._getOrReturnCtx($,K),j0(K,{validation:"base64url",code:N0.invalid_string,message:q.message}),X.dirty()}else c0.assertNever(q);return{status:X.value,value:$.data}}_regex($,J,X){return this.refinement((K)=>$.test(K),{validation:J,code:N0.invalid_string,...P0.errToObj(X)})}_addCheck($){return new M8({...this._def,checks:[...this._def.checks,$]})}email($){return this._addCheck({kind:"email",...P0.errToObj($)})}url($){return this._addCheck({kind:"url",...P0.errToObj($)})}emoji($){return this._addCheck({kind:"emoji",...P0.errToObj($)})}uuid($){return this._addCheck({kind:"uuid",...P0.errToObj($)})}nanoid($){return this._addCheck({kind:"nanoid",...P0.errToObj($)})}cuid($){return this._addCheck({kind:"cuid",...P0.errToObj($)})}cuid2($){return this._addCheck({kind:"cuid2",...P0.errToObj($)})}ulid($){return this._addCheck({kind:"ulid",...P0.errToObj($)})}base64($){return this._addCheck({kind:"base64",...P0.errToObj($)})}base64url($){return this._addCheck({kind:"base64url",...P0.errToObj($)})}jwt($){return this._addCheck({kind:"jwt",...P0.errToObj($)})}ip($){return this._addCheck({kind:"ip",...P0.errToObj($)})}cidr($){return this._addCheck({kind:"cidr",...P0.errToObj($)})}datetime($){if(typeof $==="string")return this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:$});return this._addCheck({kind:"datetime",precision:typeof $?.precision>"u"?null:$?.precision,offset:$?.offset??!1,local:$?.local??!1,...P0.errToObj($?.message)})}date($){return this._addCheck({kind:"date",message:$})}time($){if(typeof $==="string")return this._addCheck({kind:"time",precision:null,message:$});return this._addCheck({kind:"time",precision:typeof $?.precision>"u"?null:$?.precision,...P0.errToObj($?.message)})}duration($){return this._addCheck({kind:"duration",...P0.errToObj($)})}regex($,J){return this._addCheck({kind:"regex",regex:$,...P0.errToObj(J)})}includes($,J){return this._addCheck({kind:"includes",value:$,position:J?.position,...P0.errToObj(J?.message)})}startsWith($,J){return this._addCheck({kind:"startsWith",value:$,...P0.errToObj(J)})}endsWith($,J){return this._addCheck({kind:"endsWith",value:$,...P0.errToObj(J)})}min($,J){return this._addCheck({kind:"min",value:$,...P0.errToObj(J)})}max($,J){return this._addCheck({kind:"max",value:$,...P0.errToObj(J)})}length($,J){return this._addCheck({kind:"length",value:$,...P0.errToObj(J)})}nonempty($){return this.min(1,P0.errToObj($))}trim(){return new M8({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new M8({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new M8({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(($)=>$.kind==="datetime")}get isDate(){return!!this._def.checks.find(($)=>$.kind==="date")}get isTime(){return!!this._def.checks.find(($)=>$.kind==="time")}get isDuration(){return!!this._def.checks.find(($)=>$.kind==="duration")}get isEmail(){return!!this._def.checks.find(($)=>$.kind==="email")}get isURL(){return!!this._def.checks.find(($)=>$.kind==="url")}get isEmoji(){return!!this._def.checks.find(($)=>$.kind==="emoji")}get isUUID(){return!!this._def.checks.find(($)=>$.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(($)=>$.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(($)=>$.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(($)=>$.kind==="cuid2")}get isULID(){return!!this._def.checks.find(($)=>$.kind==="ulid")}get isIP(){return!!this._def.checks.find(($)=>$.kind==="ip")}get isCIDR(){return!!this._def.checks.find(($)=>$.kind==="cidr")}get isBase64(){return!!this._def.checks.find(($)=>$.kind==="base64")}get isBase64url(){return!!this._def.checks.find(($)=>$.kind==="base64url")}get minLength(){let $=null;for(let J of this._def.checks)if(J.kind==="min"){if($===null||J.value>$)$=J.value}return $}get maxLength(){let $=null;for(let J of this._def.checks)if(J.kind==="max"){if($===null||J.value<$)$=J.value}return $}}M8.create=($)=>{return new M8({checks:[],typeName:D0.ZodString,coerce:$?.coerce??!1,...x0($)})};function Fj($,J){let X=($.toString().split(".")[1]||"").length,K=(J.toString().split(".")[1]||"").length,q=X>K?X:K,Y=Number.parseInt($.toFixed(q).replace(".","")),W=Number.parseInt(J.toFixed(q).replace(".",""));return Y%W/10**q}class j1 extends p0{constructor(){super(...arguments);this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse($){if(this._def.coerce)$.data=Number($.data);if(this._getType($)!==G0.number){let q=this._getOrReturnCtx($);return j0(q,{code:N0.invalid_type,expected:G0.number,received:q.parsedType}),Z0}let X=void 0,K=new P6;for(let q of this._def.checks)if(q.kind==="int"){if(!c0.isInteger($.data))X=this._getOrReturnCtx($,X),j0(X,{code:N0.invalid_type,expected:"integer",received:"float",message:q.message}),K.dirty()}else if(q.kind==="min"){if(q.inclusive?$.data<q.value:$.data<=q.value)X=this._getOrReturnCtx($,X),j0(X,{code:N0.too_small,minimum:q.value,type:"number",inclusive:q.inclusive,exact:!1,message:q.message}),K.dirty()}else if(q.kind==="max"){if(q.inclusive?$.data>q.value:$.data>=q.value)X=this._getOrReturnCtx($,X),j0(X,{code:N0.too_big,maximum:q.value,type:"number",inclusive:q.inclusive,exact:!1,message:q.message}),K.dirty()}else if(q.kind==="multipleOf"){if(Fj($.data,q.value)!==0)X=this._getOrReturnCtx($,X),j0(X,{code:N0.not_multiple_of,multipleOf:q.value,message:q.message}),K.dirty()}else if(q.kind==="finite"){if(!Number.isFinite($.data))X=this._getOrReturnCtx($,X),j0(X,{code:N0.not_finite,message:q.message}),K.dirty()}else c0.assertNever(q);return{status:K.value,value:$.data}}gte($,J){return this.setLimit("min",$,!0,P0.toString(J))}gt($,J){return this.setLimit("min",$,!1,P0.toString(J))}lte($,J){return this.setLimit("max",$,!0,P0.toString(J))}lt($,J){return this.setLimit("max",$,!1,P0.toString(J))}setLimit($,J,X,K){return new j1({...this._def,checks:[...this._def.checks,{kind:$,value:J,inclusive:X,message:P0.toString(K)}]})}_addCheck($){return new j1({...this._def,checks:[...this._def.checks,$]})}int($){return this._addCheck({kind:"int",message:P0.toString($)})}positive($){return this._addCheck({kind:"min",value:0,inclusive:!1,message:P0.toString($)})}negative($){return this._addCheck({kind:"max",value:0,inclusive:!1,message:P0.toString($)})}nonpositive($){return this._addCheck({kind:"max",value:0,inclusive:!0,message:P0.toString($)})}nonnegative($){return this._addCheck({kind:"min",value:0,inclusive:!0,message:P0.toString($)})}multipleOf($,J){return this._addCheck({kind:"multipleOf",value:$,message:P0.toString(J)})}finite($){return this._addCheck({kind:"finite",message:P0.toString($)})}safe($){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:P0.toString($)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:P0.toString($)})}get minValue(){let $=null;for(let J of this._def.checks)if(J.kind==="min"){if($===null||J.value>$)$=J.value}return $}get maxValue(){let $=null;for(let J of this._def.checks)if(J.kind==="max"){if($===null||J.value<$)$=J.value}return $}get isInt(){return!!this._def.checks.find(($)=>$.kind==="int"||$.kind==="multipleOf"&&c0.isInteger($.value))}get isFinite(){let $=null,J=null;for(let X of this._def.checks)if(X.kind==="finite"||X.kind==="int"||X.kind==="multipleOf")return!0;else if(X.kind==="min"){if(J===null||X.value>J)J=X.value}else if(X.kind==="max"){if($===null||X.value<$)$=X.value}return Number.isFinite(J)&&Number.isFinite($)}}j1.create=($)=>{return new j1({checks:[],typeName:D0.ZodNumber,coerce:$?.coerce||!1,...x0($)})};class E1 extends p0{constructor(){super(...arguments);this.min=this.gte,this.max=this.lte}_parse($){if(this._def.coerce)try{$.data=BigInt($.data)}catch{return this._getInvalidInput($)}if(this._getType($)!==G0.bigint)return this._getInvalidInput($);let X=void 0,K=new P6;for(let q of this._def.checks)if(q.kind==="min"){if(q.inclusive?$.data<q.value:$.data<=q.value)X=this._getOrReturnCtx($,X),j0(X,{code:N0.too_small,type:"bigint",minimum:q.value,inclusive:q.inclusive,message:q.message}),K.dirty()}else if(q.kind==="max"){if(q.inclusive?$.data>q.value:$.data>=q.value)X=this._getOrReturnCtx($,X),j0(X,{code:N0.too_big,type:"bigint",maximum:q.value,inclusive:q.inclusive,message:q.message}),K.dirty()}else if(q.kind==="multipleOf"){if($.data%q.value!==BigInt(0))X=this._getOrReturnCtx($,X),j0(X,{code:N0.not_multiple_of,multipleOf:q.value,message:q.message}),K.dirty()}else c0.assertNever(q);return{status:K.value,value:$.data}}_getInvalidInput($){let J=this._getOrReturnCtx($);return j0(J,{code:N0.invalid_type,expected:G0.bigint,received:J.parsedType}),Z0}gte($,J){return this.setLimit("min",$,!0,P0.toString(J))}gt($,J){return this.setLimit("min",$,!1,P0.toString(J))}lte($,J){return this.setLimit("max",$,!0,P0.toString(J))}lt($,J){return this.setLimit("max",$,!1,P0.toString(J))}setLimit($,J,X,K){return new E1({...this._def,checks:[...this._def.checks,{kind:$,value:J,inclusive:X,message:P0.toString(K)}]})}_addCheck($){return new E1({...this._def,checks:[...this._def.checks,$]})}positive($){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:P0.toString($)})}negative($){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:P0.toString($)})}nonpositive($){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:P0.toString($)})}nonnegative($){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:P0.toString($)})}multipleOf($,J){return this._addCheck({kind:"multipleOf",value:$,message:P0.toString(J)})}get minValue(){let $=null;for(let J of this._def.checks)if(J.kind==="min"){if($===null||J.value>$)$=J.value}return $}get maxValue(){let $=null;for(let J of this._def.checks)if(J.kind==="max"){if($===null||J.value<$)$=J.value}return $}}E1.create=($)=>{return new E1({checks:[],typeName:D0.ZodBigInt,coerce:$?.coerce??!1,...x0($)})};class R5 extends p0{_parse($){if(this._def.coerce)$.data=Boolean($.data);if(this._getType($)!==G0.boolean){let X=this._getOrReturnCtx($);return j0(X,{code:N0.invalid_type,expected:G0.boolean,received:X.parsedType}),Z0}return F6($.data)}}R5.create=($)=>{return new R5({typeName:D0.ZodBoolean,coerce:$?.coerce||!1,...x0($)})};class u1 extends p0{_parse($){if(this._def.coerce)$.data=new Date($.data);if(this._getType($)!==G0.date){let q=this._getOrReturnCtx($);return j0(q,{code:N0.invalid_type,expected:G0.date,received:q.parsedType}),Z0}if(Number.isNaN($.data.getTime())){let q=this._getOrReturnCtx($);return j0(q,{code:N0.invalid_date}),Z0}let X=new P6,K=void 0;for(let q of this._def.checks)if(q.kind==="min"){if($.data.getTime()<q.value)K=this._getOrReturnCtx($,K),j0(K,{code:N0.too_small,message:q.message,inclusive:!0,exact:!1,minimum:q.value,type:"date"}),X.dirty()}else if(q.kind==="max"){if($.data.getTime()>q.value)K=this._getOrReturnCtx($,K),j0(K,{code:N0.too_big,message:q.message,inclusive:!0,exact:!1,maximum:q.value,type:"date"}),X.dirty()}else c0.assertNever(q);return{status:X.value,value:new Date($.data.getTime())}}_addCheck($){return new u1({...this._def,checks:[...this._def.checks,$]})}min($,J){return this._addCheck({kind:"min",value:$.getTime(),message:P0.toString(J)})}max($,J){return this._addCheck({kind:"max",value:$.getTime(),message:P0.toString(J)})}get minDate(){let $=null;for(let J of this._def.checks)if(J.kind==="min"){if($===null||J.value>$)$=J.value}return $!=null?new Date($):null}get maxDate(){let $=null;for(let J of this._def.checks)if(J.kind==="max"){if($===null||J.value<$)$=J.value}return $!=null?new Date($):null}}u1.create=($)=>{return new u1({checks:[],coerce:$?.coerce||!1,typeName:D0.ZodDate,...x0($)})};class C9 extends p0{_parse($){if(this._getType($)!==G0.symbol){let X=this._getOrReturnCtx($);return j0(X,{code:N0.invalid_type,expected:G0.symbol,received:X.parsedType}),Z0}return F6($.data)}}C9.create=($)=>{return new C9({typeName:D0.ZodSymbol,...x0($)})};class B5 extends p0{_parse($){if(this._getType($)!==G0.undefined){let X=this._getOrReturnCtx($);return j0(X,{code:N0.invalid_type,expected:G0.undefined,received:X.parsedType}),Z0}return F6($.data)}}B5.create=($)=>{return new B5({typeName:D0.ZodUndefined,...x0($)})};class P5 extends p0{_parse($){if(this._getType($)!==G0.null){let X=this._getOrReturnCtx($);return j0(X,{code:N0.invalid_type,expected:G0.null,received:X.parsedType}),Z0}return F6($.data)}}P5.create=($)=>{return new P5({typeName:D0.ZodNull,...x0($)})};class l1 extends p0{constructor(){super(...arguments);this._any=!0}_parse($){return F6($.data)}}l1.create=($)=>{return new l1({typeName:D0.ZodAny,...x0($)})};class L1 extends p0{constructor(){super(...arguments);this._unknown=!0}_parse($){return F6($.data)}}L1.create=($)=>{return new L1({typeName:D0.ZodUnknown,...x0($)})};class T8 extends p0{_parse($){let J=this._getOrReturnCtx($);return j0(J,{code:N0.invalid_type,expected:G0.never,received:J.parsedType}),Z0}}T8.create=($)=>{return new T8({typeName:D0.ZodNever,...x0($)})};class Z9 extends p0{_parse($){if(this._getType($)!==G0.undefined){let X=this._getOrReturnCtx($);return j0(X,{code:N0.invalid_type,expected:G0.void,received:X.parsedType}),Z0}return F6($.data)}}Z9.create=($)=>{return new Z9({typeName:D0.ZodVoid,...x0($)})};class H8 extends p0{_parse($){let{ctx:J,status:X}=this._processInputParams($),K=this._def;if(J.parsedType!==G0.array)return j0(J,{code:N0.invalid_type,expected:G0.array,received:J.parsedType}),Z0;if(K.exactLength!==null){let Y=J.data.length>K.exactLength.value,W=J.data.length<K.exactLength.value;if(Y||W)j0(J,{code:Y?N0.too_big:N0.too_small,minimum:W?K.exactLength.value:void 0,maximum:Y?K.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:K.exactLength.message}),X.dirty()}if(K.minLength!==null){if(J.data.length<K.minLength.value)j0(J,{code:N0.too_small,minimum:K.minLength.value,type:"array",inclusive:!0,exact:!1,message:K.minLength.message}),X.dirty()}if(K.maxLength!==null){if(J.data.length>K.maxLength.value)j0(J,{code:N0.too_big,maximum:K.maxLength.value,type:"array",inclusive:!0,exact:!1,message:K.maxLength.message}),X.dirty()}if(J.common.async)return Promise.all([...J.data].map((Y,W)=>{return K.type._parseAsync(new O8(J,Y,J.path,W))})).then((Y)=>{return P6.mergeArray(X,Y)});let q=[...J.data].map((Y,W)=>{return K.type._parseSync(new O8(J,Y,J.path,W))});return P6.mergeArray(X,q)}get element(){return this._def.type}min($,J){return new H8({...this._def,minLength:{value:$,message:P0.toString(J)}})}max($,J){return new H8({...this._def,maxLength:{value:$,message:P0.toString(J)}})}length($,J){return new H8({...this._def,exactLength:{value:$,message:P0.toString(J)}})}nonempty($){return this.min(1,$)}}H8.create=($,J)=>{return new H8({type:$,minLength:null,maxLength:null,exactLength:null,typeName:D0.ZodArray,...x0(J)})};function j5($){if($ instanceof W6){let J={};for(let X in $.shape){let K=$.shape[X];J[X]=G8.create(j5(K))}return new W6({...$._def,shape:()=>J})}else if($ instanceof H8)return new H8({...$._def,type:j5($.element)});else if($ instanceof G8)return G8.create(j5($.unwrap()));else if($ instanceof i8)return i8.create(j5($.unwrap()));else if($ instanceof I8)return I8.create($.items.map((J)=>j5(J)));else return $}class W6 extends p0{constructor(){super(...arguments);this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let $=this._def.shape(),J=c0.objectKeys($);return this._cached={shape:$,keys:J},this._cached}_parse($){if(this._getType($)!==G0.object){let N=this._getOrReturnCtx($);return j0(N,{code:N0.invalid_type,expected:G0.object,received:N.parsedType}),Z0}let{status:X,ctx:K}=this._processInputParams($),{shape:q,keys:Y}=this._getCached(),W=[];if(!(this._def.catchall instanceof T8&&this._def.unknownKeys==="strip")){for(let N in K.data)if(!Y.includes(N))W.push(N)}let Q=[];for(let N of Y){let V=q[N],M=K.data[N];Q.push({key:{status:"valid",value:N},value:V._parse(new O8(K,M,K.path,N)),alwaysSet:N in K.data})}if(this._def.catchall instanceof T8){let N=this._def.unknownKeys;if(N==="passthrough")for(let V of W)Q.push({key:{status:"valid",value:V},value:{status:"valid",value:K.data[V]}});else if(N==="strict"){if(W.length>0)j0(K,{code:N0.unrecognized_keys,keys:W}),X.dirty()}else if(N==="strip");else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let N=this._def.catchall;for(let V of W){let M=K.data[V];Q.push({key:{status:"valid",value:V},value:N._parse(new O8(K,M,K.path,V)),alwaysSet:V in K.data})}}if(K.common.async)return Promise.resolve().then(async()=>{let N=[];for(let V of Q){let M=await V.key,H=await V.value;N.push({key:M,value:H,alwaysSet:V.alwaysSet})}return N}).then((N)=>{return P6.mergeObjectSync(X,N)});else return P6.mergeObjectSync(X,Q)}get shape(){return this._def.shape()}strict($){return P0.errToObj,new W6({...this._def,unknownKeys:"strict",...$!==void 0?{errorMap:(J,X)=>{let K=this._def.errorMap?.(J,X).message??X.defaultError;if(J.code==="unrecognized_keys")return{message:P0.errToObj($).message??K};return{message:K}}}:{}})}strip(){return new W6({...this._def,unknownKeys:"strip"})}passthrough(){return new W6({...this._def,unknownKeys:"passthrough"})}extend($){return new W6({...this._def,shape:()=>({...this._def.shape(),...$})})}merge($){return new W6({unknownKeys:$._def.unknownKeys,catchall:$._def.catchall,shape:()=>({...this._def.shape(),...$._def.shape()}),typeName:D0.ZodObject})}setKey($,J){return this.augment({[$]:J})}catchall($){return new W6({...this._def,catchall:$})}pick($){let J={};for(let X of c0.objectKeys($))if($[X]&&this.shape[X])J[X]=this.shape[X];return new W6({...this._def,shape:()=>J})}omit($){let J={};for(let X of c0.objectKeys(this.shape))if(!$[X])J[X]=this.shape[X];return new W6({...this._def,shape:()=>J})}deepPartial(){return j5(this)}partial($){let J={};for(let X of c0.objectKeys(this.shape)){let K=this.shape[X];if($&&!$[X])J[X]=K;else J[X]=K.optional()}return new W6({...this._def,shape:()=>J})}required($){let J={};for(let X of c0.objectKeys(this.shape))if($&&!$[X])J[X]=this.shape[X];else{let q=this.shape[X];while(q instanceof G8)q=q._def.innerType;J[X]=q}return new W6({...this._def,shape:()=>J})}keyof(){return lW(c0.objectKeys(this.shape))}}W6.create=($,J)=>{return new W6({shape:()=>$,unknownKeys:"strip",catchall:T8.create(),typeName:D0.ZodObject,...x0(J)})};W6.strictCreate=($,J)=>{return new W6({shape:()=>$,unknownKeys:"strict",catchall:T8.create(),typeName:D0.ZodObject,...x0(J)})};W6.lazycreate=($,J)=>{return new W6({shape:$,unknownKeys:"strip",catchall:T8.create(),typeName:D0.ZodObject,...x0(J)})};class S5 extends p0{_parse($){let{ctx:J}=this._processInputParams($),X=this._def.options;function K(q){for(let W of q)if(W.result.status==="valid")return W.result;for(let W of q)if(W.result.status==="dirty")return J.common.issues.push(...W.ctx.common.issues),W.result;let Y=q.map((W)=>new _6(W.ctx.common.issues));return j0(J,{code:N0.invalid_union,unionErrors:Y}),Z0}if(J.common.async)return Promise.all(X.map(async(q)=>{let Y={...J,common:{...J.common,issues:[]},parent:null};return{result:await q._parseAsync({data:J.data,path:J.path,parent:Y}),ctx:Y}})).then(K);else{let q=void 0,Y=[];for(let Q of X){let N={...J,common:{...J.common,issues:[]},parent:null},V=Q._parseSync({data:J.data,path:J.path,parent:N});if(V.status==="valid")return V;else if(V.status==="dirty"&&!q)q={result:V,ctx:N};if(N.common.issues.length)Y.push(N.common.issues)}if(q)return J.common.issues.push(...q.ctx.common.issues),q.result;let W=Y.map((Q)=>new _6(Q));return j0(J,{code:N0.invalid_union,unionErrors:W}),Z0}}get options(){return this._def.options}}S5.create=($,J)=>{return new S5({options:$,typeName:D0.ZodUnion,...x0(J)})};var r8=($)=>{if($ instanceof F5)return r8($.schema);else if($ instanceof U8)return r8($.innerType());else if($ instanceof z5)return[$.value];else if($ instanceof R1)return $.options;else if($ instanceof C5)return c0.objectValues($.enum);else if($ instanceof Z5)return r8($._def.innerType);else if($ instanceof B5)return[void 0];else if($ instanceof P5)return[null];else if($ instanceof G8)return[void 0,...r8($.unwrap())];else if($ instanceof i8)return[null,...r8($.unwrap())];else if($ instanceof b$)return r8($.unwrap());else if($ instanceof D5)return r8($.unwrap());else if($ instanceof v5)return r8($._def.innerType);else return[]};class f$ extends p0{_parse($){let{ctx:J}=this._processInputParams($);if(J.parsedType!==G0.object)return j0(J,{code:N0.invalid_type,expected:G0.object,received:J.parsedType}),Z0;let X=this.discriminator,K=J.data[X],q=this.optionsMap.get(K);if(!q)return j0(J,{code:N0.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[X]}),Z0;if(J.common.async)return q._parseAsync({data:J.data,path:J.path,parent:J});else return q._parseSync({data:J.data,path:J.path,parent:J})}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create($,J,X){let K=new Map;for(let q of J){let Y=r8(q.shape[$]);if(!Y.length)throw Error(`A discriminator value for key \`${$}\` could not be extracted from all schema options`);for(let W of Y){if(K.has(W))throw Error(`Discriminator property ${String($)} has duplicate value ${String(W)}`);K.set(W,q)}}return new f$({typeName:D0.ZodDiscriminatedUnion,discriminator:$,options:J,optionsMap:K,...x0(X)})}}function aJ($,J){let X=w8($),K=w8(J);if($===J)return{valid:!0,data:$};else if(X===G0.object&&K===G0.object){let q=c0.objectKeys(J),Y=c0.objectKeys($).filter((Q)=>q.indexOf(Q)!==-1),W={...$,...J};for(let Q of Y){let N=aJ($[Q],J[Q]);if(!N.valid)return{valid:!1};W[Q]=N.data}return{valid:!0,data:W}}else if(X===G0.array&&K===G0.array){if($.length!==J.length)return{valid:!1};let q=[];for(let Y=0;Y<$.length;Y++){let W=$[Y],Q=J[Y],N=aJ(W,Q);if(!N.valid)return{valid:!1};q.push(N.data)}return{valid:!0,data:q}}else if(X===G0.date&&K===G0.date&&+$===+J)return{valid:!0,data:$};else return{valid:!1}}class A5 extends p0{_parse($){let{status:J,ctx:X}=this._processInputParams($),K=(q,Y)=>{if(h$(q)||h$(Y))return Z0;let W=aJ(q.value,Y.value);if(!W.valid)return j0(X,{code:N0.invalid_intersection_types}),Z0;if(g$(q)||g$(Y))J.dirty();return{status:J.value,value:W.data}};if(X.common.async)return Promise.all([this._def.left._parseAsync({data:X.data,path:X.path,parent:X}),this._def.right._parseAsync({data:X.data,path:X.path,parent:X})]).then(([q,Y])=>K(q,Y));else return K(this._def.left._parseSync({data:X.data,path:X.path,parent:X}),this._def.right._parseSync({data:X.data,path:X.path,parent:X}))}}A5.create=($,J,X)=>{return new A5({left:$,right:J,typeName:D0.ZodIntersection,...x0(X)})};class I8 extends p0{_parse($){let{status:J,ctx:X}=this._processInputParams($);if(X.parsedType!==G0.array)return j0(X,{code:N0.invalid_type,expected:G0.array,received:X.parsedType}),Z0;if(X.data.length<this._def.items.length)return j0(X,{code:N0.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Z0;if(!this._def.rest&&X.data.length>this._def.items.length)j0(X,{code:N0.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),J.dirty();let q=[...X.data].map((Y,W)=>{let Q=this._def.items[W]||this._def.rest;if(!Q)return null;return Q._parse(new O8(X,Y,X.path,W))}).filter((Y)=>!!Y);if(X.common.async)return Promise.all(q).then((Y)=>{return P6.mergeArray(J,Y)});else return P6.mergeArray(J,q)}get items(){return this._def.items}rest($){return new I8({...this._def,rest:$})}}I8.create=($,J)=>{if(!Array.isArray($))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new I8({items:$,typeName:D0.ZodTuple,rest:null,...x0(J)})};class v9 extends p0{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse($){let{status:J,ctx:X}=this._processInputParams($);if(X.parsedType!==G0.object)return j0(X,{code:N0.invalid_type,expected:G0.object,received:X.parsedType}),Z0;let K=[],q=this._def.keyType,Y=this._def.valueType;for(let W in X.data)K.push({key:q._parse(new O8(X,W,X.path,W)),value:Y._parse(new O8(X,X.data[W],X.path,W)),alwaysSet:W in X.data});if(X.common.async)return P6.mergeObjectAsync(J,K);else return P6.mergeObjectSync(J,K)}get element(){return this._def.valueType}static create($,J,X){if(J instanceof p0)return new v9({keyType:$,valueType:J,typeName:D0.ZodRecord,...x0(X)});return new v9({keyType:M8.create(),valueType:$,typeName:D0.ZodRecord,...x0(J)})}}class D9 extends p0{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse($){let{status:J,ctx:X}=this._processInputParams($);if(X.parsedType!==G0.map)return j0(X,{code:N0.invalid_type,expected:G0.map,received:X.parsedType}),Z0;let K=this._def.keyType,q=this._def.valueType,Y=[...X.data.entries()].map(([W,Q],N)=>{return{key:K._parse(new O8(X,W,X.path,[N,"key"])),value:q._parse(new O8(X,Q,X.path,[N,"value"]))}});if(X.common.async){let W=new Map;return Promise.resolve().then(async()=>{for(let Q of Y){let N=await Q.key,V=await Q.value;if(N.status==="aborted"||V.status==="aborted")return Z0;if(N.status==="dirty"||V.status==="dirty")J.dirty();W.set(N.value,V.value)}return{status:J.value,value:W}})}else{let W=new Map;for(let Q of Y){let{key:N,value:V}=Q;if(N.status==="aborted"||V.status==="aborted")return Z0;if(N.status==="dirty"||V.status==="dirty")J.dirty();W.set(N.value,V.value)}return{status:J.value,value:W}}}}D9.create=($,J,X)=>{return new D9({valueType:J,keyType:$,typeName:D0.ZodMap,...x0(X)})};class c1 extends p0{_parse($){let{status:J,ctx:X}=this._processInputParams($);if(X.parsedType!==G0.set)return j0(X,{code:N0.invalid_type,expected:G0.set,received:X.parsedType}),Z0;let K=this._def;if(K.minSize!==null){if(X.data.size<K.minSize.value)j0(X,{code:N0.too_small,minimum:K.minSize.value,type:"set",inclusive:!0,exact:!1,message:K.minSize.message}),J.dirty()}if(K.maxSize!==null){if(X.data.size>K.maxSize.value)j0(X,{code:N0.too_big,maximum:K.maxSize.value,type:"set",inclusive:!0,exact:!1,message:K.maxSize.message}),J.dirty()}let q=this._def.valueType;function Y(Q){let N=new Set;for(let V of Q){if(V.status==="aborted")return Z0;if(V.status==="dirty")J.dirty();N.add(V.value)}return{status:J.value,value:N}}let W=[...X.data.values()].map((Q,N)=>q._parse(new O8(X,Q,X.path,N)));if(X.common.async)return Promise.all(W).then((Q)=>Y(Q));else return Y(W)}min($,J){return new c1({...this._def,minSize:{value:$,message:P0.toString(J)}})}max($,J){return new c1({...this._def,maxSize:{value:$,message:P0.toString(J)}})}size($,J){return this.min($,J).max($,J)}nonempty($){return this.min(1,$)}}c1.create=($,J)=>{return new c1({valueType:$,minSize:null,maxSize:null,typeName:D0.ZodSet,...x0(J)})};class E5 extends p0{constructor(){super(...arguments);this.validate=this.implement}_parse($){let{ctx:J}=this._processInputParams($);if(J.parsedType!==G0.function)return j0(J,{code:N0.invalid_type,expected:G0.function,received:J.parsedType}),Z0;function X(W,Q){return z9({data:W,path:J.path,errorMaps:[J.common.contextualErrorMap,J.schemaErrorMap,U5(),o8].filter((N)=>!!N),issueData:{code:N0.invalid_arguments,argumentsError:Q}})}function K(W,Q){return z9({data:W,path:J.path,errorMaps:[J.common.contextualErrorMap,J.schemaErrorMap,U5(),o8].filter((N)=>!!N),issueData:{code:N0.invalid_return_type,returnTypeError:Q}})}let q={errorMap:J.common.contextualErrorMap},Y=J.data;if(this._def.returns instanceof d1){let W=this;return F6(async function(...Q){let N=new _6([]),V=await W._def.args.parseAsync(Q,q).catch((G)=>{throw N.addIssue(X(Q,G)),N}),M=await Reflect.apply(Y,this,V);return await W._def.returns._def.type.parseAsync(M,q).catch((G)=>{throw N.addIssue(K(M,G)),N})})}else{let W=this;return F6(function(...Q){let N=W._def.args.safeParse(Q,q);if(!N.success)throw new _6([X(Q,N.error)]);let V=Reflect.apply(Y,this,N.data),M=W._def.returns.safeParse(V,q);if(!M.success)throw new _6([K(V,M.error)]);return M.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...$){return new E5({...this._def,args:I8.create($).rest(L1.create())})}returns($){return new E5({...this._def,returns:$})}implement($){return this.parse($)}strictImplement($){return this.parse($)}static create($,J,X){return new E5({args:$?$:I8.create([]).rest(L1.create()),returns:J||L1.create(),typeName:D0.ZodFunction,...x0(X)})}}class F5 extends p0{get schema(){return this._def.getter()}_parse($){let{ctx:J}=this._processInputParams($);return this._def.getter()._parse({data:J.data,path:J.path,parent:J})}}F5.create=($,J)=>{return new F5({getter:$,typeName:D0.ZodLazy,...x0(J)})};class z5 extends p0{_parse($){if($.data!==this._def.value){let J=this._getOrReturnCtx($);return j0(J,{received:J.data,code:N0.invalid_literal,expected:this._def.value}),Z0}return{status:"valid",value:$.data}}get value(){return this._def.value}}z5.create=($,J)=>{return new z5({value:$,typeName:D0.ZodLiteral,...x0(J)})};function lW($,J){return new R1({values:$,typeName:D0.ZodEnum,...x0(J)})}class R1 extends p0{_parse($){if(typeof $.data!=="string"){let J=this._getOrReturnCtx($),X=this._def.values;return j0(J,{expected:c0.joinValues(X),received:J.parsedType,code:N0.invalid_type}),Z0}if(!this._cache)this._cache=new Set(this._def.values);if(!this._cache.has($.data)){let J=this._getOrReturnCtx($),X=this._def.values;return j0(J,{received:J.data,code:N0.invalid_enum_value,options:X}),Z0}return F6($.data)}get options(){return this._def.values}get enum(){let $={};for(let J of this._def.values)$[J]=J;return $}get Values(){let $={};for(let J of this._def.values)$[J]=J;return $}get Enum(){let $={};for(let J of this._def.values)$[J]=J;return $}extract($,J=this._def){return R1.create($,{...this._def,...J})}exclude($,J=this._def){return R1.create(this.options.filter((X)=>!$.includes(X)),{...this._def,...J})}}R1.create=lW;class C5 extends p0{_parse($){let J=c0.getValidEnumValues(this._def.values),X=this._getOrReturnCtx($);if(X.parsedType!==G0.string&&X.parsedType!==G0.number){let K=c0.objectValues(J);return j0(X,{expected:c0.joinValues(K),received:X.parsedType,code:N0.invalid_type}),Z0}if(!this._cache)this._cache=new Set(c0.getValidEnumValues(this._def.values));if(!this._cache.has($.data)){let K=c0.objectValues(J);return j0(X,{received:X.data,code:N0.invalid_enum_value,options:K}),Z0}return F6($.data)}get enum(){return this._def.values}}C5.create=($,J)=>{return new C5({values:$,typeName:D0.ZodNativeEnum,...x0(J)})};class d1 extends p0{unwrap(){return this._def.type}_parse($){let{ctx:J}=this._processInputParams($);if(J.parsedType!==G0.promise&&J.common.async===!1)return j0(J,{code:N0.invalid_type,expected:G0.promise,received:J.parsedType}),Z0;let X=J.parsedType===G0.promise?J.data:Promise.resolve(J.data);return F6(X.then((K)=>{return this._def.type.parseAsync(K,{path:J.path,errorMap:J.common.contextualErrorMap})}))}}d1.create=($,J)=>{return new d1({type:$,typeName:D0.ZodPromise,...x0(J)})};class U8 extends p0{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===D0.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse($){let{status:J,ctx:X}=this._processInputParams($),K=this._def.effect||null,q={addIssue:(Y)=>{if(j0(X,Y),Y.fatal)J.abort();else J.dirty()},get path(){return X.path}};if(q.addIssue=q.addIssue.bind(q),K.type==="preprocess"){let Y=K.transform(X.data,q);if(X.common.async)return Promise.resolve(Y).then(async(W)=>{if(J.value==="aborted")return Z0;let Q=await this._def.schema._parseAsync({data:W,path:X.path,parent:X});if(Q.status==="aborted")return Z0;if(Q.status==="dirty")return p1(Q.value);if(J.value==="dirty")return p1(Q.value);return Q});else{if(J.value==="aborted")return Z0;let W=this._def.schema._parseSync({data:Y,path:X.path,parent:X});if(W.status==="aborted")return Z0;if(W.status==="dirty")return p1(W.value);if(J.value==="dirty")return p1(W.value);return W}}if(K.type==="refinement"){let Y=(W)=>{let Q=K.refinement(W,q);if(X.common.async)return Promise.resolve(Q);if(Q instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return W};if(X.common.async===!1){let W=this._def.schema._parseSync({data:X.data,path:X.path,parent:X});if(W.status==="aborted")return Z0;if(W.status==="dirty")J.dirty();return Y(W.value),{status:J.value,value:W.value}}else return this._def.schema._parseAsync({data:X.data,path:X.path,parent:X}).then((W)=>{if(W.status==="aborted")return Z0;if(W.status==="dirty")J.dirty();return Y(W.value).then(()=>{return{status:J.value,value:W.value}})})}if(K.type==="transform")if(X.common.async===!1){let Y=this._def.schema._parseSync({data:X.data,path:X.path,parent:X});if(!U1(Y))return Z0;let W=K.transform(Y.value,q);if(W instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:J.value,value:W}}else return this._def.schema._parseAsync({data:X.data,path:X.path,parent:X}).then((Y)=>{if(!U1(Y))return Z0;return Promise.resolve(K.transform(Y.value,q)).then((W)=>({status:J.value,value:W}))});c0.assertNever(K)}}U8.create=($,J,X)=>{return new U8({schema:$,typeName:D0.ZodEffects,effect:J,...x0(X)})};U8.createWithPreprocess=($,J,X)=>{return new U8({schema:J,effect:{type:"preprocess",transform:$},typeName:D0.ZodEffects,...x0(X)})};class G8 extends p0{_parse($){if(this._getType($)===G0.undefined)return F6(void 0);return this._def.innerType._parse($)}unwrap(){return this._def.innerType}}G8.create=($,J)=>{return new G8({innerType:$,typeName:D0.ZodOptional,...x0(J)})};class i8 extends p0{_parse($){if(this._getType($)===G0.null)return F6(null);return this._def.innerType._parse($)}unwrap(){return this._def.innerType}}i8.create=($,J)=>{return new i8({innerType:$,typeName:D0.ZodNullable,...x0(J)})};class Z5 extends p0{_parse($){let{ctx:J}=this._processInputParams($),X=J.data;if(J.parsedType===G0.undefined)X=this._def.defaultValue();return this._def.innerType._parse({data:X,path:J.path,parent:J})}removeDefault(){return this._def.innerType}}Z5.create=($,J)=>{return new Z5({innerType:$,typeName:D0.ZodDefault,defaultValue:typeof J.default==="function"?J.default:()=>J.default,...x0(J)})};class v5 extends p0{_parse($){let{ctx:J}=this._processInputParams($),X={...J,common:{...J.common,issues:[]}},K=this._def.innerType._parse({data:X.data,path:X.path,parent:{...X}});if(L5(K))return K.then((q)=>{return{status:"valid",value:q.status==="valid"?q.value:this._def.catchValue({get error(){return new _6(X.common.issues)},input:X.data})}});else return{status:"valid",value:K.status==="valid"?K.value:this._def.catchValue({get error(){return new _6(X.common.issues)},input:X.data})}}removeCatch(){return this._def.innerType}}v5.create=($,J)=>{return new v5({innerType:$,typeName:D0.ZodCatch,catchValue:typeof J.catch==="function"?J.catch:()=>J.catch,...x0(J)})};class k9 extends p0{_parse($){if(this._getType($)!==G0.nan){let X=this._getOrReturnCtx($);return j0(X,{code:N0.invalid_type,expected:G0.nan,received:X.parsedType}),Z0}return{status:"valid",value:$.data}}}k9.create=($)=>{return new k9({typeName:D0.ZodNaN,...x0($)})};var zj=Symbol("zod_brand");class b$ extends p0{_parse($){let{ctx:J}=this._processInputParams($),X=J.data;return this._def.type._parse({data:X,path:J.path,parent:J})}unwrap(){return this._def.type}}class w9 extends p0{_parse($){let{status:J,ctx:X}=this._processInputParams($);if(X.common.async)return(async()=>{let q=await this._def.in._parseAsync({data:X.data,path:X.path,parent:X});if(q.status==="aborted")return Z0;if(q.status==="dirty")return J.dirty(),p1(q.value);else return this._def.out._parseAsync({data:q.value,path:X.path,parent:X})})();else{let K=this._def.in._parseSync({data:X.data,path:X.path,parent:X});if(K.status==="aborted")return Z0;if(K.status==="dirty")return J.dirty(),{status:"dirty",value:K.value};else return this._def.out._parseSync({data:K.value,path:X.path,parent:X})}}static create($,J){return new w9({in:$,out:J,typeName:D0.ZodPipeline})}}class D5 extends p0{_parse($){let J=this._def.innerType._parse($),X=(K)=>{if(U1(K))K.value=Object.freeze(K.value);return K};return L5(J)?J.then((K)=>X(K)):X(J)}unwrap(){return this._def.innerType}}D5.create=($,J)=>{return new D5({innerType:$,typeName:D0.ZodReadonly,...x0(J)})};function bW($,J){let X=typeof $==="function"?$(J):typeof $==="string"?{message:$}:$;return typeof X==="string"?{message:X}:X}function cW($,J={},X){if($)return l1.create().superRefine((K,q)=>{let Y=$(K);if(Y instanceof Promise)return Y.then((W)=>{if(!W){let Q=bW(J,K),N=Q.fatal??X??!0;q.addIssue({code:"custom",...Q,fatal:N})}});if(!Y){let W=bW(J,K),Q=W.fatal??X??!0;q.addIssue({code:"custom",...W,fatal:Q})}return});return l1.create()}var Cj={object:W6.lazycreate},D0;(function($){$.ZodString="ZodString",$.ZodNumber="ZodNumber",$.ZodNaN="ZodNaN",$.ZodBigInt="ZodBigInt",$.ZodBoolean="ZodBoolean",$.ZodDate="ZodDate",$.ZodSymbol="ZodSymbol",$.ZodUndefined="ZodUndefined",$.ZodNull="ZodNull",$.ZodAny="ZodAny",$.ZodUnknown="ZodUnknown",$.ZodNever="ZodNever",$.ZodVoid="ZodVoid",$.ZodArray="ZodArray",$.ZodObject="ZodObject",$.ZodUnion="ZodUnion",$.ZodDiscriminatedUnion="ZodDiscriminatedUnion",$.ZodIntersection="ZodIntersection",$.ZodTuple="ZodTuple",$.ZodRecord="ZodRecord",$.ZodMap="ZodMap",$.ZodSet="ZodSet",$.ZodFunction="ZodFunction",$.ZodLazy="ZodLazy",$.ZodLiteral="ZodLiteral",$.ZodEnum="ZodEnum",$.ZodEffects="ZodEffects",$.ZodNativeEnum="ZodNativeEnum",$.ZodOptional="ZodOptional",$.ZodNullable="ZodNullable",$.ZodDefault="ZodDefault",$.ZodCatch="ZodCatch",$.ZodPromise="ZodPromise",$.ZodBranded="ZodBranded",$.ZodPipeline="ZodPipeline",$.ZodReadonly="ZodReadonly"})(D0||(D0={}));var Zj=($,J={message:`Input not instance of ${$.name}`})=>cW((X)=>X instanceof $,J),dW=M8.create,nW=j1.create,vj=k9.create,Dj=E1.create,oW=R5.create,kj=u1.create,wj=C9.create,Tj=B5.create,Ij=P5.create,_j=l1.create,yj=L1.create,xj=T8.create,hj=Z9.create,gj=H8.create,fj=W6.create,bj=W6.strictCreate,mj=S5.create,pj=f$.create,uj=A5.create,lj=I8.create,cj=v9.create,dj=D9.create,nj=c1.create,oj=E5.create,rj=F5.create,ij=z5.create,sj=R1.create,aj=C5.create,tj=d1.create,ej=U8.create,$E=G8.create,JE=i8.create,XE=U8.createWithPreprocess,KE=w9.create,qE=()=>dW().optional(),YE=()=>nW().optional(),WE=()=>oW().optional(),QE={string:($)=>M8.create({...$,coerce:!0}),number:($)=>j1.create({...$,coerce:!0}),boolean:($)=>R5.create({...$,coerce:!0}),bigint:($)=>E1.create({...$,coerce:!0}),date:($)=>u1.create({...$,coerce:!0})};var NE=Z0;var r0=f;var L8;(function($){$[$.EXTEND=1]="EXTEND",$[$.WRAP=2]="WRAP",$[$.CROP=3]="CROP"})(L8||(L8={}));var B1=f.object({bitmap:f.object({data:f.union([f.instanceof(Buffer),f.instanceof(Uint8Array)]),width:f.number(),height:f.number()})});var VE=f.object({src:B1,x:f.number().optional(),y:f.number().optional(),srcX:f.number().optional(),srcY:f.number().optional(),srcW:f.number().optional(),srcH:f.number().optional()}),ME=f.union([B1,VE]),k5={blit($,J){let X=ME.parse(J),{src:K,x:q=0,y:Y=0,srcX:W=0,srcY:Q=0,srcW:N=K.bitmap.width,srcH:V=K.bitmap.height}="bitmap"in X?{src:X}:X;if(!("bitmap"in K))throw Error("The source must be a Jimp image");if(typeof q!=="number"||typeof Y!=="number")throw Error("x and y must be numbers");q=Math.round(q),Y=Math.round(Y),W=Math.round(W),Q=Math.round(Q),N=Math.round(N),V=Math.round(V);let M=$.bitmap.width,H=$.bitmap.height;return o6(K,W,Q,N,V,function(G,O,L){let E=q+G-W,j=Y+O-Q;if(E>=0&&j>=0&&M-E>0&&H-j>0){let B=$.getPixelIndex(E,j),S={r:K.bitmap.data[L]||0,g:K.bitmap.data[L+1]||0,b:K.bitmap.data[L+2]||0,a:K.bitmap.data[L+3]||0},A={r:$.bitmap.data[B]||0,g:$.bitmap.data[B+1]||0,b:$.bitmap.data[B+2]||0,a:$.bitmap.data[B+3]||0};$.bitmap.data[B]=(S.a*(S.r-A.r)-A.r+255>>8)+A.r,$.bitmap.data[B+1]=(S.a*(S.g-A.g)-A.g+255>>8)+A.g,$.bitmap.data[B+2]=(S.a*(S.b-A.b)-A.b+255>>8)+A.b,$.bitmap.data[B+3]=$6(A.a+S.a)}}),$}};var rW=[1,57,41,21,203,34,97,73,227,91,149,62,105,45,39,137,241,107,3,173,39,71,65,238,219,101,187,87,81,151,141,133,249,117,221,209,197,187,177,169,5,153,73,139,133,127,243,233,223,107,103,99,191,23,177,171,165,159,77,149,9,139,135,131,253,245,119,231,224,109,211,103,25,195,189,23,45,175,171,83,81,79,155,151,147,9,141,137,67,131,129,251,123,30,235,115,113,221,217,53,13,51,50,49,193,189,185,91,179,175,43,169,83,163,5,79,155,19,75,147,145,143,35,69,17,67,33,65,255,251,247,243,239,59,29,229,113,111,219,27,213,105,207,51,201,199,49,193,191,47,93,183,181,179,11,87,43,85,167,165,163,161,159,157,155,77,19,75,37,73,145,143,141,35,138,137,135,67,33,131,129,255,63,250,247,61,121,239,237,117,29,229,227,225,111,55,109,216,213,211,209,207,205,203,201,199,197,195,193,48,190,47,93,185,183,181,179,178,176,175,173,171,85,21,167,165,41,163,161,5,79,157,78,154,153,19,75,149,74,147,73,144,143,71,141,140,139,137,17,135,134,133,66,131,65,129,1],iW=[0,9,10,10,14,12,14,14,16,15,16,15,16,15,15,17,18,17,12,18,16,17,17,19,19,18,19,18,18,19,19,19,20,19,20,20,20,20,20,20,15,20,19,20,20,20,21,21,21,20,20,20,21,18,21,21,21,21,20,21,17,21,21,21,22,22,21,22,22,21,22,21,19,22,22,19,20,22,22,21,21,21,22,22,22,18,22,22,21,22,22,23,22,20,23,22,22,23,23,21,19,21,21,21,23,23,23,22,23,23,21,23,22,23,18,22,23,20,22,23,23,23,21,22,20,22,21,22,24,24,24,24,24,22,21,24,23,23,24,21,24,23,24,22,24,24,22,24,24,22,23,24,24,24,20,23,22,23,24,24,24,24,24,24,24,23,21,23,22,23,24,24,24,22,24,24,24,23,22,24,24,25,23,25,25,23,24,25,25,24,22,25,25,25,24,23,24,25,25,25,25,25,25,25,25,25,25,25,25,23,25,23,24,25,25,25,25,25,25,25,25,25,24,22,25,25,23,25,25,20,24,25,24,25,25,22,24,25,24,25,24,25,25,24,25,25,25,25,22,25,25,25,24,25,24,25,18];var sW={blur($,J){if(typeof J!=="number")throw Error("r must be a number");if(J<1)throw Error("r must be greater than 0");let X,K,q,Y,W,Q,N,V,M,H,G,O,L,E=$.bitmap.width-1,j=$.bitmap.height-1,B=J+1,S=rW[J],A=iW[J],z=[],P=[],R=[],U=[],Z=[],w=[],h=2;while(h-- >0){O=0,L=0;for(Q=0;Q<$.bitmap.height;Q++){X=$.bitmap.data[L]*B,K=$.bitmap.data[L+1]*B,q=$.bitmap.data[L+2]*B,Y=$.bitmap.data[L+3]*B;for(N=1;N<=J;N++)V=L+((N>E?E:N)<<2),X+=$.bitmap.data[V++],K+=$.bitmap.data[V++],q+=$.bitmap.data[V++],Y+=$.bitmap.data[V];for(W=0;W<$.bitmap.width;W++){if(z[O]=X,P[O]=K,R[O]=q,U[O]=Y,Q===0)Z[W]=((V=W+B)<E?V:E)<<2,w[W]=(V=W-J)>0?V<<2:0;M=L+Z[W],H=L+w[W],X+=$.bitmap.data[M++]-$.bitmap.data[H++],K+=$.bitmap.data[M++]-$.bitmap.data[H++],q+=$.bitmap.data[M++]-$.bitmap.data[H++],Y+=$.bitmap.data[M]-$.bitmap.data[H++],O++}L+=$.bitmap.width<<2}for(W=0;W<$.bitmap.width;W++){G=W,X=z[G]*B,K=P[G]*B,q=R[G]*B,Y=U[G]*B;for(N=1;N<=J;N++)G+=N>j?0:$.bitmap.width,X+=z[G],K+=P[G],q+=R[G],Y+=U[G];O=W<<2;for(Q=0;Q<$.bitmap.height;Q++){if($.bitmap.data[O]=$6(X*S>>>A),$.bitmap.data[O+1]=$6(K*S>>>A),$.bitmap.data[O+2]=$6(q*S>>>A),$.bitmap.data[O+3]=$6(Y*S>>>A),W===0)Z[Q]=((V=Q+B)<j?V:j)*$.bitmap.width,w[Q]=(V=Q-J)>0?V*$.bitmap.width:0;M=W+Z[Q],H=W+w[Q],X+=z[M]-z[H],K+=P[M]-P[H],q+=R[M]-R[H],Y+=U[M]-U[H],O+=$.bitmap.width<<2}}}return $},gaussian($,J){if(typeof J!=="number")throw Error("r must be a number");if(J<1)throw Error("r must be greater than 0");let X=Math.ceil(J*2.57),K=X*2+1,q=J*J*2,Y=q*Math.PI,W=[];for(let Q=0;Q<K;Q++){let N=[];for(let V=0;V<K;V++){let M=(V-X)**2+(Q-X)**2;N[V]=Math.exp(-M/q)/Y}W.push(N)}for(let Q=0;Q<$.bitmap.height;Q++)for(let N=0;N<$.bitmap.width;N++){let V=0,M=0,H=0,G=0,O=0;for(let L=0;L<K;L++){for(let j=0;j<K;j++){let B=Math.min($.bitmap.width-1,Math.max(0,j+N-X)),S=Math.min($.bitmap.height-1,Math.max(0,L+Q-X)),A=W[L][j],z=S*$.bitmap.width+B<<2;V+=$.bitmap.data[z]*A,M+=$.bitmap.data[z+1]*A,H+=$.bitmap.data[z+2]*A,G+=$.bitmap.data[z+3]*A,O+=A}let E=Q*$.bitmap.width+N<<2;$.bitmap.data[E]=Math.round(V/O),$.bitmap.data[E+1]=Math.round(M/O),$.bitmap.data[E+2]=Math.round(H/O),$.bitmap.data[E+3]=Math.round(G/O)}}return $}};var OE=f.object({x:f.number().optional(),y:f.number().optional(),radius:f.number().min(0).optional()}),aW={circle($,J={}){let X=OE.parse(J),K=X.radius||($.bitmap.width>$.bitmap.height?$.bitmap.height:$.bitmap.width)/2,q={x:typeof X.x==="number"?X.x:$.bitmap.width/2,y:typeof X.y==="number"?X.y:$.bitmap.height/2};return $.scan((Y,W,Q)=>{let N=Math.sqrt(Math.pow(Y-q.x,2)+Math.pow(W-q.y,2));if(K-N<=0)$.bitmap.data[Q+3]=0;else if(K-N<1)$.bitmap.data[Q+3]=255*(K-N)}),$}};var m$=f.array(f.number()).min(1).array(),LE=f.object({kernel:m$,edgeHandling:f.nativeEnum(L8).optional()}),jE=f.union([m$,LE]),EE=f.object({kernel:m$,x:f.number().optional(),y:f.number().optional(),w:f.number().optional(),h:f.number().optional()}),RE=f.union([m$,EE]),eW=f.number().min(1).max(1/0),BE=f.object({size:eW,x:f.number().optional(),y:f.number().optional(),w:f.number().optional(),h:f.number().optional()}),PE=f.union([eW,BE]);function tW($,J,X,K){let q=[0,0,0,0],Y=(J.length-1)/2;for(let W=0;W<J.length;W+=1)for(let Q=0;Q<J[W].length;Q+=1){let N=$.getPixelIndex(X+W-Y,K+Q-Y);q[0]+=$.bitmap.data[N]*J[W][Q],q[1]+=$.bitmap.data[N+1]*J[W][Q],q[2]+=$.bitmap.data[N+2]*J[W][Q],q[3]+=$.bitmap.data[N+3]*J[W][Q]}return q}function tJ($,J,X=50){return{r:(J.r-$.r)*(X/100)+$.r,g:(J.g-$.g)*(X/100)+$.g,b:(J.b-$.b)*(X/100)+$.b}}var SE=f.object({apply:f.literal("hue"),params:f.tuple([f.number().min(-360).max(360)])}),AE=f.object({apply:f.literal("spin"),params:f.tuple([f.number().min(-360).max(360)])}),FE=f.object({apply:f.literal("lighten"),params:f.tuple([f.number().min(0).max(100)]).optional()}),J4=f.object({r:f.number().min(0).max(255),g:f.number().min(0).max(255),b:f.number().min(0).max(255)}),zE=f.object({apply:f.literal("mix"),params:f.union([f.tuple([J4]),f.tuple([J4,f.number().min(0).max(100)])])}),CE=f.object({apply:f.literal("tint"),params:f.tuple([f.number().min(0).max(100)]).optional()}),ZE=f.object({apply:f.literal("shade"),params:f.tuple([f.number().min(0).max(100)]).optional()}),vE=f.object({apply:f.literal("xor"),params:f.tuple([J4])}),DE=f.object({apply:f.literal("red"),params:f.tuple([f.number().min(-255).max(255)])}),kE=f.object({apply:f.literal("green"),params:f.tuple([f.number().min(-255).max(255)])}),wE=f.object({apply:f.literal("blue"),params:f.tuple([f.number().min(-255).max(255)])}),TE=f.object({apply:f.literal("brighten"),params:f.tuple([f.number().min(0).max(100)]).optional()}),IE=f.object({apply:f.literal("darken"),params:f.tuple([f.number().min(0).max(100)]).optional()}),_E=f.object({apply:f.literal("desaturate"),params:f.tuple([f.number().min(0).max(100)]).optional()}),yE=f.object({apply:f.literal("saturate"),params:f.tuple([f.number().min(0).max(100)]).optional()}),xE=f.object({apply:f.literal("greyscale"),params:f.tuple([]).optional()}),hE=f.union([SE,AE,FE,zE,CE,ZE,vE,DE,kE,wE,TE,IE,_E,yE,xE]),Fz=Object.freeze({LIGHTEN:"lighten",BRIGHTEN:"brighten",DARKEN:"darken",DESATURATE:"desaturate",SATURATE:"saturate",GREYSCALE:"greyscale",SPIN:"spin",HUE:"hue",MIX:"mix",TINT:"tint",SHADE:"shade",XOR:"xor",RED:"red",GREEN:"green",BLUE:"blue"});function gE($){let J={r:Array(256).fill(0),g:Array(256).fill(0),b:Array(256).fill(0)};return $.scan((X,K,q)=>{J.r[$.bitmap.data[q+0]]++,J.g[$.bitmap.data[q+1]]++,J.b[$.bitmap.data[q+2]]++}),J}var eJ=function($,J,X){return($-J)*255/(X-J)},$4=function($){return[$.findIndex((J)=>J>0),255-$.slice().reverse().findIndex((J)=>J>0)]},w5={normalize($){let J=gE($),X={r:$4(J.r),g:$4(J.g),b:$4(J.b)};return $.scan((K,q,Y)=>{let W=$.bitmap.data[Y+0],Q=$.bitmap.data[Y+1],N=$.bitmap.data[Y+2];$.bitmap.data[Y+0]=eJ(W,X.r[0],X.r[1]),$.bitmap.data[Y+1]=eJ(Q,X.g[0],X.g[1]),$.bitmap.data[Y+2]=eJ(N,X.b[0],X.b[1])}),$},invert($){return $.scan((J,X,K)=>{$.bitmap.data[K]=255-$.bitmap.data[K],$.bitmap.data[K+1]=255-$.bitmap.data[K+1],$.bitmap.data[K+2]=255-$.bitmap.data[K+2]}),$},brightness($,J){if(typeof J!=="number")throw Error("val must be numbers");return $.scan((X,K,q)=>{$.bitmap.data[q]=$6($.bitmap.data[q]*J),$.bitmap.data[q+1]=$6($.bitmap.data[q+1]*J),$.bitmap.data[q+2]=$6($.bitmap.data[q+2]*J)}),$},contrast($,J){if(typeof J!=="number")throw Error("val must be numbers");if(J<-1||J>1)throw Error("val must be a number between -1 and +1");let X=(J+1)/(1-J);function K(q){return q=Math.floor(X*(q-127)+127),q<0?0:q>255?255:q}return $.scan((q,Y,W)=>{$.bitmap.data[W]=K($.bitmap.data[W]),$.bitmap.data[W+1]=K($.bitmap.data[W+1]),$.bitmap.data[W+2]=K($.bitmap.data[W+2])}),$},posterize($,J){if(typeof J!=="number")throw Error("n must be numbers");if(J<2)J=2;return $.scan((X,K,q)=>{let Y=$.bitmap.data[q],W=$.bitmap.data[q+1],Q=$.bitmap.data[q+2];$.bitmap.data[q]=Math.floor(Y/255*(J-1))/(J-1)*255,$.bitmap.data[q+1]=Math.floor(W/255*(J-1))/(J-1)*255,$.bitmap.data[q+2]=Math.floor(Q/255*(J-1))/(J-1)*255}),$},greyscale($){return $.scan((J,X,K)=>{let q=0.2126*$.bitmap.data[K]+0.7152*$.bitmap.data[K+1]+0.0722*$.bitmap.data[K+2];$.bitmap.data[K]=q,$.bitmap.data[K+1]=q,$.bitmap.data[K+2]=q}),$},opacity($,J){if(typeof J!=="number")throw Error("f must be a number");if(J<0||J>1)throw Error("f must be a number from 0 to 1");return $.scan((X,K,q)=>{let Y=$.bitmap.data[q+3]*J;$.bitmap.data[q+3]=Y}),$},sepia($){return $.scan((J,X,K)=>{let q=$.bitmap.data[K],Y=$.bitmap.data[K+1],W=$.bitmap.data[K+2];q=q*0.393+Y*0.769+W*0.189,Y=q*0.349+Y*0.686+W*0.168,W=q*0.272+Y*0.534+W*0.131,$.bitmap.data[K]=q<255?q:255,$.bitmap.data[K+1]=Y<255?Y:255,$.bitmap.data[K+2]=W<255?W:255}),$},fade($,J){if(typeof J!=="number")throw Error("f must be a number");if(J<0||J>1)throw Error("f must be a number from 0 to 1");return this.opacity($,1-J)},convolution($,J){let X=jE.parse(J),{kernel:K,edgeHandling:q=L8.EXTEND}="kernel"in X?X:{kernel:X,edgeHandling:void 0};if(!K[0])throw Error("kernel must be a matrix");let Y=Buffer.from($.bitmap.data),W=K.length,Q=K[0].length,N=Math.floor(W/2),V=Math.floor(Q/2),M=-N,H=-V,G,O,L,E,j,B,S,A,z,P;return $.scan((R,U,Z)=>{E=0,L=0,O=0;for(let w=M;w<=N;w++)for(let h=H;h<=V;h++){if(A=R+h,z=U+w,G=K[w+N][h+V],P=$.getPixelIndex(A,z,q),P===-1)S=0,B=0,j=0;else j=$.bitmap.data[P+0],B=$.bitmap.data[P+1],S=$.bitmap.data[P+2];O+=G*j,L+=G*B,E+=G*S}if(O<0)O=0;if(L<0)L=0;if(E<0)E=0;if(O>255)O=255;if(L>255)L=255;if(E>255)E=255;Y[Z+0]=O,Y[Z+1]=L,Y[Z+2]=E}),$.bitmap.data=Y,$},opaque($){return $.scan((J,X,K)=>{$.bitmap.data[K+3]=255}),$},pixelate($,J){let X=PE.parse(J),{size:K,x:q=0,y:Y=0,w:W=$.bitmap.width-q,h:Q=$.bitmap.height-Y}=typeof X==="number"?{size:X}:X,N=[[0.0625,0.125,0.0625],[0.125,0.25,0.125],[0.0625,0.125,0.0625]],V=h6($);return o6(V,q,Y,W,Q,(M,H,G)=>{M=K*Math.floor(M/K),H=K*Math.floor(H/K);let O=tW(V,N,M,H);$.bitmap.data[G]=O[0],$.bitmap.data[G+1]=O[1],$.bitmap.data[G+2]=O[2],$.bitmap.data[G+3]=O[3]}),$},convolute($,J){let X=RE.parse(J),{kernel:K,x:q=0,y:Y=0,w:W=$.bitmap.width-q,h:Q=$.bitmap.height-Y}="kernel"in X?X:{kernel:X},N=h6($);return o6(N,q,Y,W,Q,(V,M,H)=>{let G=tW(N,K,V,M);$.bitmap.data[H]=$6(G[0]),$.bitmap.data[H+1]=$6(G[1]),$.bitmap.data[H+2]=$6(G[2]),$.bitmap.data[H+3]=$6(G[3])}),$},color($,J){if(!J||!Array.isArray(J))throw Error("actions must be an array");return J.forEach((X)=>hE.parse(X)),J=J.map((X)=>{if(X.apply==="xor"||X.apply==="mix")X.params[0]=B0(X.params[0]).toRgb();return X}),$.scan((X,K,q)=>{let Y={r:$.bitmap.data[q],g:$.bitmap.data[q+1],b:$.bitmap.data[q+2]},W=(Q,N)=>$6(Y[Q]+N);J.forEach((Q)=>{if(Q.apply==="mix")Y=tJ(Y,Q.params[0],Q.params[1]);else if(Q.apply==="tint")Y=tJ(Y,{r:255,g:255,b:255},Q.params?.[0]);else if(Q.apply==="shade")Y=tJ(Y,{r:0,g:0,b:0},Q.params?.[0]);else if(Q.apply==="xor")Y={r:Y.r^Q.params[0].r,g:Y.g^Q.params[0].g,b:Y.b^Q.params[0].b};else if(Q.apply==="red")Y.r=W("r",Q.params[0]);else if(Q.apply==="green")Y.g=W("g",Q.params[0]);else if(Q.apply==="blue")Y.b=W("b",Q.params[0]);else{if(Q.apply==="hue")Q.apply="spin";let N=B0(Y),V=N[Q.apply].bind(N);if(!V)throw Error("action "+Q.apply+" not supported");Y=V(...Q.params||[]).toRgb()}}),$.bitmap.data[q]=Y.r,$.bitmap.data[q+1]=Y.g,$.bitmap.data[q+2]=Y.b}),$}};var hN=h8(pQ(),1);function Q4($,J){return $.then(function(X){return[null,X]}).catch(function(X){if(J)Object.assign(X,J);return[X,void 0]})}import{promises as uQ}from"fs";import{existsSync as dQ}from"fs";var lQ=uQ.readFile,cQ=uQ.writeFile;var gN=h8(aQ(),1);var e6;(function($){$[$.LEFT=1]="LEFT",$[$.CENTER=2]="CENTER",$[$.RIGHT=4]="RIGHT"})(e6||(e6={}));var $8;(function($){$[$.TOP=8]="TOP",$[$.MIDDLE=16]="MIDDLE",$[$.BOTTOM=32]="BOTTOM"})($8||($8={}));var r$;(function($){$.SRC_OVER="srcOver",$.DST_OVER="dstOver",$.MULTIPLY="multiply",$.ADD="add",$.SCREEN="screen",$.OVERLAY="overlay",$.DARKEN="darken",$.LIGHTEN="lighten",$.HARD_LIGHT="hardLight",$.DIFFERENCE="difference",$.EXCLUSION="exclusion"})(r$||(r$={}));var N4={};o4(N4,{srcOver:()=>tQ,screen:()=>XN,overlay:()=>KN,names:()=>lR,multiply:()=>$N,lighten:()=>YN,hardLight:()=>WN,exclusion:()=>NN,dstOver:()=>eQ,difference:()=>QN,darken:()=>qN,add:()=>JN});function tQ($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=($.r*$.a+J.r*J.a*(1-$.a))/K,Y=($.g*$.a+J.g*J.a*(1-$.a))/K,W=($.b*$.a+J.b*J.a*(1-$.a))/K;return{r:q,g:Y,b:W,a:K}}function eQ($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=(J.r*J.a+$.r*$.a*(1-J.a))/K,Y=(J.g*J.a+$.g*$.a*(1-J.a))/K,W=(J.b*J.a+$.b*$.a*(1-J.a))/K;return{r:q,g:Y,b:W,a:K}}function $N($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=$.r*$.a,Y=$.g*$.a,W=$.b*$.a,Q=J.r*J.a,N=J.g*J.a,V=J.b*J.a,M=(q*Q+q*(1-J.a)+Q*(1-$.a))/K,H=(Y*N+Y*(1-J.a)+N*(1-$.a))/K,G=(W*V+W*(1-J.a)+V*(1-$.a))/K;return{r:M,g:H,b:G,a:K}}function JN($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=$.r*$.a,Y=$.g*$.a,W=$.b*$.a,Q=J.r*J.a,N=J.g*J.a,V=J.b*J.a,M=(q+Q)/K,H=(Y+N)/K,G=(W+V)/K;return{r:M,g:H,b:G,a:K}}function XN($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=$.r*$.a,Y=$.g*$.a,W=$.b*$.a,Q=J.r*J.a,N=J.g*J.a,V=J.b*J.a,M=(q*J.a+Q*$.a-q*Q+q*(1-J.a)+Q*(1-$.a))/K,H=(Y*J.a+N*$.a-Y*N+Y*(1-J.a)+N*(1-$.a))/K,G=(W*J.a+V*$.a-W*V+W*(1-J.a)+V*(1-$.a))/K;return{r:M,g:H,b:G,a:K}}function KN($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=$.r*$.a,Y=$.g*$.a,W=$.b*$.a,Q=J.r*J.a,N=J.g*J.a,V=J.b*J.a,M=(2*Q<=J.a?2*q*Q+q*(1-J.a)+Q*(1-$.a):q*(1+J.a)+Q*(1+$.a)-2*Q*q-J.a*$.a)/K,H=(2*N<=J.a?2*Y*N+Y*(1-J.a)+N*(1-$.a):Y*(1+J.a)+N*(1+$.a)-2*N*Y-J.a*$.a)/K,G=(2*V<=J.a?2*W*V+W*(1-J.a)+V*(1-$.a):W*(1+J.a)+V*(1+$.a)-2*V*W-J.a*$.a)/K;return{r:M,g:H,b:G,a:K}}function qN($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=$.r*$.a,Y=$.g*$.a,W=$.b*$.a,Q=J.r*J.a,N=J.g*J.a,V=J.b*J.a,M=(Math.min(q*J.a,Q*$.a)+q*(1-J.a)+Q*(1-$.a))/K,H=(Math.min(Y*J.a,N*$.a)+Y*(1-J.a)+N*(1-$.a))/K,G=(Math.min(W*J.a,V*$.a)+W*(1-J.a)+V*(1-$.a))/K;return{r:M,g:H,b:G,a:K}}function YN($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=$.r*$.a,Y=$.g*$.a,W=$.b*$.a,Q=J.r*J.a,N=J.g*J.a,V=J.b*J.a,M=(Math.max(q*J.a,Q*$.a)+q*(1-J.a)+Q*(1-$.a))/K,H=(Math.max(Y*J.a,N*$.a)+Y*(1-J.a)+N*(1-$.a))/K,G=(Math.max(W*J.a,V*$.a)+W*(1-J.a)+V*(1-$.a))/K;return{r:M,g:H,b:G,a:K}}function WN($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=$.r*$.a,Y=$.g*$.a,W=$.b*$.a,Q=J.r*J.a,N=J.g*J.a,V=J.b*J.a,M=(2*q<=$.a?2*q*Q+q*(1-J.a)+Q*(1-$.a):q*(1+J.a)+Q*(1+$.a)-2*Q*q-J.a*$.a)/K,H=(2*Y<=$.a?2*Y*N+Y*(1-J.a)+N*(1-$.a):Y*(1+J.a)+N*(1+$.a)-2*N*Y-J.a*$.a)/K,G=(2*W<=$.a?2*W*V+W*(1-J.a)+V*(1-$.a):W*(1+J.a)+V*(1+$.a)-2*V*W-J.a*$.a)/K;return{r:M,g:H,b:G,a:K}}function QN($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=$.r*$.a,Y=$.g*$.a,W=$.b*$.a,Q=J.r*J.a,N=J.g*J.a,V=J.b*J.a,M=(q+Q-2*Math.min(q*J.a,Q*$.a))/K,H=(Y+N-2*Math.min(Y*J.a,N*$.a))/K,G=(W+V-2*Math.min(W*J.a,V*$.a))/K;return{r:M,g:H,b:G,a:K}}function NN($,J,X=1){$.a*=X;let K=J.a+$.a-J.a*$.a,q=$.r*$.a,Y=$.g*$.a,W=$.b*$.a,Q=J.r*J.a,N=J.g*J.a,V=J.b*J.a,M=(q*J.a+Q*$.a-2*q*Q+q*(1-J.a)+Q*(1-$.a))/K,H=(Y*J.a+N*$.a-2*Y*N+Y*(1-J.a)+N*(1-$.a))/K,G=(W*J.a+V*$.a-2*W*V+W*(1-J.a)+V*(1-$.a))/K;return{r:M,g:H,b:G,a:K}}var lR=[tQ,eQ,$N,JN,XN,KN,qN,YN,WN,QN,NN];function T5($,J,X=0,K=0,q={}){if(!(J instanceof $.constructor))throw Error("The source must be a Jimp image");if(typeof X!=="number"||typeof K!=="number")throw Error("x and y must be numbers");let{mode:Y=r$.SRC_OVER}=q,{opacitySource:W=1,opacityDest:Q=1}=q;if(typeof W!=="number"||W<0||W>1)W=1;if(typeof Q!=="number"||Q<0||Q>1)Q=1;let N=N4[Y];if(X=Math.round(X),K=Math.round(K),Q!==1)$.scan((V,M,H)=>{let G=$.bitmap.data[H+3]*Q;$.bitmap.data[H+3]=G});return J.scan((V,M,H)=>{let G=$.getPixelIndex(X+V,K+M,L8.CROP);if(G===-1)return;let O=N({r:J.bitmap.data[H+0]/255,g:J.bitmap.data[H+1]/255,b:J.bitmap.data[H+2]/255,a:J.bitmap.data[H+3]/255},{r:$.bitmap.data[G+0]/255,g:$.bitmap.data[G+1]/255,b:$.bitmap.data[G+2]/255,a:$.bitmap.data[G+3]/255},W);$.bitmap.data[G+0]=$6(O.r*255),$.bitmap.data[G+1]=$6(O.g*255),$.bitmap.data[G+2]=$6(O.b*255),$.bitmap.data[G+3]=$6(O.a*255)}),$}var _N=h8(IN(),1);function G4($){let J=$._exif;return J&&J.tags&&J.tags.Orientation||1}function JB($){let J=$.bitmap.width,X=$.bitmap.height;switch(G4($)){case 1:return null;case 2:return function(K,q){return[J-K-1,q]};case 3:return function(K,q){return[J-K-1,X-q-1]};case 4:return function(K,q){return[K,X-q-1]};case 5:return function(K,q){return[q,K]};case 6:return function(K,q){return[q,X-K-1]};case 7:return function(K,q){return[J-q-1,X-K-1]};case 8:return function(K,q){return[J-q-1,K]};default:return null}}function XB($,J,X,K){let q=$.bitmap.data,Y=$.bitmap.width,W=Buffer.alloc(q.length);for(let Q=0;Q<J;Q++)for(let N=0;N<X;N++){let[V,M]=K(Q,N),H=J*N+Q<<2,G=Y*M+V<<2,O=q.readUInt32BE(G);W.writeUInt32BE(O,H)}$.bitmap.data=W,$.bitmap.width=J,$.bitmap.height=X,$._exif.tags.Orientation=1}function KB($){if(G4($)<2)return;let J=JB($),X=G4($)>4,K=X?$.bitmap.height:$.bitmap.width,q=X?$.bitmap.width:$.bitmap.height;if(J)XB($,K,q,J)}async function yN($,J){try{$._exif=_N.default.create(J).parse(),KB($)}catch{}}var O4={data:Buffer.alloc(0),width:0,height:0};function xN($){let J=Buffer.alloc($.byteLength),X=new Uint8Array($);for(let K=0;K<J.length;++K)J[K]=X[K];return J}function fN({plugins:$,formats:J}={}){let X=$||[],K=(J||[]).map((Y)=>Y()),q=class{bitmap=O4;background=0;formats=[];mime;constructor(W=O4){if(this.formats=K,"data"in W)this.bitmap=W;else if(this.bitmap={data:Buffer.alloc(W.width*W.height*4),width:W.width,height:W.height},W.color){this.background=typeof W.color==="string"?mX(W.color):W.color;for(let Q=0;Q<this.bitmap.data.length;Q+=4)this.bitmap.data.writeUInt32BE(this.background,Q)}for(let Q of X)for(let N in Q)this[N]=(...V)=>{let M=Q[N]?.(this,...V);if(typeof M==="object"&&"bitmap"in M)return this.bitmap=M.bitmap,this;return M}}static async read(W,Q){if(Buffer.isBuffer(W)||W instanceof ArrayBuffer)return this.fromBuffer(W);if(dQ(W))return this.fromBuffer(await lQ(W));let[N,V]=await Q4(fetch(W));if(N)throw Error(`Could not load Buffer from URL: ${W}`);if(!V.ok)throw Error(`HTTP Status ${V.status} for url ${W}`);let[M,H]=await Q4(V.arrayBuffer());if(M)throw Error(`Could not load Buffer from ${W}`);let G=xN(H);return this.fromBuffer(G,Q)}static fromBitmap(W){let Q;if(W.data instanceof Buffer)Q=Buffer.from(W.data);if(W.data instanceof Uint8Array||W.data instanceof Uint8ClampedArray)Q=Buffer.from(W.data.buffer);if(Array.isArray(W.data))Q=Buffer.concat(W.data.map((N)=>Buffer.from(N.toString(16).padStart(8,"0"),"hex")));if(!Q)throw Error("data must be a Buffer");if(typeof W.height!=="number"||typeof W.width!=="number")throw Error("bitmap must have width and height");return new q({height:W.height,width:W.width,data:Q})}static async fromBuffer(W,Q){let N=W instanceof ArrayBuffer?xN(W):W,V=await hN.default.fromBuffer(N);if(!V||!V.mime)throw Error("Could not find MIME for Buffer");let M=K.find((G)=>G.mime===V.mime);if(!M||!M.decode)throw Error(`Mime type ${V.mime} does not support decoding`);let H=new q(await M.decode(N,Q?.[M.mime]));return H.mime=V.mime,yN(H,N),H}inspect(){return"<Jimp "+(this.bitmap===O4?"pending...":this.bitmap.width+"x"+this.bitmap.height)+">"}toString(){return"[object Jimp]"}get width(){return this.bitmap.width}get height(){return this.bitmap.height}async getBuffer(W,Q){let N=this.formats.find((M)=>M.mime===W);if(!N||!N.encode)throw Error(`Unsupported MIME type: ${W}`);let V;if(N.hasAlpha)V=this;else V=new q({width:this.bitmap.width,height:this.bitmap.height,color:this.background}),T5(V,this);return N.encode(V.bitmap,Q)}async getBase64(W,Q){let N=await this.getBuffer(W,Q);return"data:"+W+";base64,"+N.toString("base64")}async write(W,Q){let N=gN.default.getType(W);await cQ(W,await this.getBuffer(N,Q))}clone(){return new q({...this.bitmap,data:Buffer.from(this.bitmap.data)})}getPixelIndex(W,Q,N){let V,M;if(!N)N=L8.EXTEND;if(typeof W!=="number"||typeof Q!=="number")throw Error("x and y must be numbers");if(W=Math.round(W),Q=Math.round(Q),V=W,M=Q,N===L8.EXTEND){if(W<0)V=0;if(W>=this.bitmap.width)V=this.bitmap.width-1;if(Q<0)M=0;if(Q>=this.bitmap.height)M=this.bitmap.height-1}if(N===L8.WRAP){if(W<0)V=this.bitmap.width+W;if(W>=this.bitmap.width)V=W%this.bitmap.width;if(Q<0)M=this.bitmap.height+Q;if(Q>=this.bitmap.height)M=Q%this.bitmap.height}let H=this.bitmap.width*M+V<<2;if(V<0||V>=this.bitmap.width)H=-1;if(M<0||M>=this.bitmap.height)H=-1;return H}getPixelColor(W,Q){if(typeof W!=="number"||typeof Q!=="number")throw Error("x and y must be numbers");let N=this.getPixelIndex(W,Q);return this.bitmap.data.readUInt32BE(N)}setPixelColor(W,Q,N){if(typeof W!=="number"||typeof Q!=="number"||typeof N!=="number")throw Error("hex, x and y must be numbers");let V=this.getPixelIndex(Q,N);return this.bitmap.data.writeUInt32BE(W,V),this}hasAlpha(){let{width:W,height:Q,data:N}=this.bitmap,V=W*Q<<2;for(let M=3;M<V;M+=4)if(N[M]!==255)return!0;return!1}composite(W,Q=0,N=0,V={}){return T5(this,W,Q,N,V)}scan(W,Q,N,V,M){return o6(this,W,Q,N,V,M)}scanIterator(W=0,Q=0,N=this.bitmap.width,V=this.bitmap.height){if(typeof W!=="number"||typeof Q!=="number")throw Error("x and y must be numbers");if(typeof N!=="number"||typeof V!=="number")throw Error("w and h must be numbers");return bX(this,W,Q,N,V)}};return q}var p6;(function($){$.NEAREST_NEIGHBOR="nearestNeighbor",$.BILINEAR="bilinearInterpolation",$.BICUBIC="bicubicInterpolation",$.HERMITE="hermiteInterpolation",$.BEZIER="bezierInterpolation"})(p6||(p6={}));function M6($,J,X,K,q,Y,W){this.widthOriginal=Math.abs(Math.floor($)||0),this.heightOriginal=Math.abs(Math.floor(J)||0),this.targetWidth=Math.abs(Math.floor(X)||0),this.targetHeight=Math.abs(Math.floor(K)||0),this.colorChannels=q?4:3,this.interpolationPass=Boolean(Y),this.resizeCallback=typeof W==="function"?W:function(){},this.targetWidthMultipliedByChannels=this.targetWidth*this.colorChannels,this.originalWidthMultipliedByChannels=this.widthOriginal*this.colorChannels,this.originalHeightMultipliedByChannels=this.heightOriginal*this.colorChannels,this.widthPassResultSize=this.targetWidthMultipliedByChannels*this.heightOriginal,this.finalResultSize=this.targetWidthMultipliedByChannels*this.targetHeight,this.initialize()}M6.prototype.initialize=function(){if(this.widthOriginal>0&&this.heightOriginal>0&&this.targetWidth>0&&this.targetHeight>0)this.configurePasses();else throw console.log(this),Error("Invalid settings specified for the resizer.")};M6.prototype.configurePasses=function(){if(this.widthOriginal===this.targetWidth)this.resizeWidth=this.bypassResizer;else if(this.ratioWeightWidthPass=this.widthOriginal/this.targetWidth,this.ratioWeightWidthPass<1&&this.interpolationPass)this.initializeFirstPassBuffers(!0),this.resizeWidth=this.colorChannels===4?this.resizeWidthInterpolatedRGBA:this.resizeWidthInterpolatedRGB;else this.initializeFirstPassBuffers(!1),this.resizeWidth=this.colorChannels===4?this.resizeWidthRGBA:this.resizeWidthRGB;if(this.heightOriginal===this.targetHeight)this.resizeHeight=this.bypassResizer;else if(this.ratioWeightHeightPass=this.heightOriginal/this.targetHeight,this.ratioWeightHeightPass<1&&this.interpolationPass)this.initializeSecondPassBuffers(!0),this.resizeHeight=this.resizeHeightInterpolated;else this.initializeSecondPassBuffers(!1),this.resizeHeight=this.colorChannels===4?this.resizeHeightRGBA:this.resizeHeightRGB};M6.prototype._resizeWidthInterpolatedRGBChannels=function($,J){let X=J?4:3,K=this.ratioWeightWidthPass,q=this.widthBuffer,Y=0,W=0,Q=0,N=0,V=0,M;for(M=0;Y<0.3333333333333333;M+=X,Y+=K)for(W=M,Q=0;W<this.widthPassResultSize;Q+=this.originalWidthMultipliedByChannels,W+=this.targetWidthMultipliedByChannels)if(q[W]=$[Q],q[W+1]=$[Q+1],q[W+2]=$[Q+2],J)q[W+3]=$[Q+3];Y-=0.3333333333333333;let H;for(H=this.widthOriginal-1;Y<H;M+=X,Y+=K){V=Y%1,N=1-V;for(W=M,Q=Math.floor(Y)*X;W<this.widthPassResultSize;Q+=this.originalWidthMultipliedByChannels,W+=this.targetWidthMultipliedByChannels)if(q[W+0]=$[Q+0]*N+$[Q+X+0]*V,q[W+1]=$[Q+1]*N+$[Q+X+1]*V,q[W+2]=$[Q+2]*N+$[Q+X+2]*V,J)q[W+3]=$[Q+3]*N+$[Q+X+3]*V}for(H=this.originalWidthMultipliedByChannels-X;M<this.targetWidthMultipliedByChannels;M+=X)for(W=M,Q=H;W<this.widthPassResultSize;Q+=this.originalWidthMultipliedByChannels,W+=this.targetWidthMultipliedByChannels)if(q[W]=$[Q],q[W+1]=$[Q+1],q[W+2]=$[Q+2],J)q[W+3]=$[Q+3];return q};M6.prototype._resizeWidthRGBChannels=function($,J){let X=J?4:3,K=this.ratioWeightWidthPass,q=1/K,Y=this.originalWidthMultipliedByChannels-X+1,W=this.targetWidthMultipliedByChannels-X+1,Q=this.outputWidthWorkBench,N=this.widthBuffer,V=this.outputWidthWorkBenchOpaquePixelsCount,M=0,H=0,G=0,O=0,L=0,E=0,j=0,B=1,S=0,A=0,z=0,P=0;do{for(L=0;L<this.originalHeightMultipliedByChannels;)if(Q[L++]=0,Q[L++]=0,Q[L++]=0,J)Q[L++]=0,V[L/X-1]=0;M=K;do{H=1+G-O,B=Math.min(M,H);for(L=0,E=G;L<this.originalHeightMultipliedByChannels;E+=Y)if(S=$[E],A=$[++E],z=$[++E],P=J?$[++E]:255,Q[L++]+=(P?S:0)*B,Q[L++]+=(P?A:0)*B,Q[L++]+=(P?z:0)*B,J)Q[L++]+=P*B,V[L/X-1]+=P?B:0;if(M>=H)G+=X,O=G,M-=H;else{O+=M;break}}while(M>0&&G<this.originalWidthMultipliedByChannels);for(L=0,E=j;L<this.originalHeightMultipliedByChannels;E+=W)if(M=J?V[L/X]:1,B=J?M?1/M:0:q,N[E]=Q[L++]*B,N[++E]=Q[L++]*B,N[++E]=Q[L++]*B,J)N[++E]=Q[L++]*q;j+=X}while(j<this.targetWidthMultipliedByChannels);return N};M6.prototype._resizeHeightRGBChannels=function($,J){let X=this.ratioWeightHeightPass,K=1/X,q=this.outputHeightWorkBench,Y=this.heightBuffer,W=this.outputHeightWorkBenchOpaquePixelsCount,Q=0,N=0,V=0,M=0,H=0,G=0,O=0,L=1,E=0,j=0,B=0,S=0;do{for(H=0;H<this.targetWidthMultipliedByChannels;)if(q[H++]=0,q[H++]=0,q[H++]=0,J)q[H++]=0,W[H/4-1]=0;Q=X;do{N=1+V-M,L=Math.min(Q,N),O=V;for(H=0;H<this.targetWidthMultipliedByChannels;)if(E=$[O++],j=$[O++],B=$[O++],S=J?$[O++]:255,q[H++]+=(S?E:0)*L,q[H++]+=(S?j:0)*L,q[H++]+=(S?B:0)*L,J)q[H++]+=S*L,W[H/4-1]+=S?L:0;if(Q>=N)V=O,M=V,Q-=N;else{M+=Q;break}}while(Q>0&&V<this.widthPassResultSize);for(H=0;H<this.targetWidthMultipliedByChannels;)if(Q=J?W[H/4]:1,L=J?Q?1/Q:0:K,Y[G++]=Math.round(q[H++]*L),Y[G++]=Math.round(q[H++]*L),Y[G++]=Math.round(q[H++]*L),J)Y[G++]=Math.round(q[H++]*K)}while(G<this.finalResultSize);return Y};M6.prototype.resizeWidthInterpolatedRGB=function($){return this._resizeWidthInterpolatedRGBChannels($,!1)};M6.prototype.resizeWidthInterpolatedRGBA=function($){return this._resizeWidthInterpolatedRGBChannels($,!0)};M6.prototype.resizeWidthRGB=function($){return this._resizeWidthRGBChannels($,!1)};M6.prototype.resizeWidthRGBA=function($){return this._resizeWidthRGBChannels($,!0)};M6.prototype.resizeHeightInterpolated=function($){let J=this.ratioWeightHeightPass,X=this.heightBuffer,K=0,q=0,Y=0,W=0,Q=0,N=0,V=0,M;for(;K<0.3333333333333333;K+=J)for(Y=0;Y<this.targetWidthMultipliedByChannels;)X[q++]=Math.round($[Y++]);K-=0.3333333333333333;for(M=this.heightOriginal-1;K<M;K+=J){V=K%1,N=1-V,W=Math.floor(K)*this.targetWidthMultipliedByChannels,Q=W+this.targetWidthMultipliedByChannels;for(Y=0;Y<this.targetWidthMultipliedByChannels;++Y)X[q++]=Math.round($[W++]*N+$[Q++]*V)}while(q<this.finalResultSize)for(Y=0,W=M*this.targetWidthMultipliedByChannels;Y<this.targetWidthMultipliedByChannels;++Y)X[q++]=Math.round($[W++]);return X};M6.prototype.resizeHeightRGB=function($){return this._resizeHeightRGBChannels($,!1)};M6.prototype.resizeHeightRGBA=function($){return this._resizeHeightRGBChannels($,!0)};M6.prototype.resize=function($){this.resizeCallback(this.resizeHeight(this.resizeWidth($)))};M6.prototype.bypassResizer=function($){return $};M6.prototype.initializeFirstPassBuffers=function($){if(this.widthBuffer=this.generateFloatBuffer(this.widthPassResultSize),!$){if(this.outputWidthWorkBench=this.generateFloatBuffer(this.originalHeightMultipliedByChannels),this.colorChannels>3)this.outputWidthWorkBenchOpaquePixelsCount=this.generateFloat64Buffer(this.heightOriginal)}};M6.prototype.initializeSecondPassBuffers=function($){if(this.heightBuffer=this.generateUint8Buffer(this.finalResultSize),!$){if(this.outputHeightWorkBench=this.generateFloatBuffer(this.targetWidthMultipliedByChannels),this.colorChannels>3)this.outputHeightWorkBenchOpaquePixelsCount=this.generateFloat64Buffer(this.targetWidth)}};M6.prototype.generateFloatBuffer=function($){try{return new Float32Array($)}catch(J){return console.error(J),[]}};M6.prototype.generateFloat64Buffer=function($){try{return new Float64Array($)}catch(J){return console.error(J),[]}};M6.prototype.generateUint8Buffer=function($){try{return new Uint8Array($)}catch(J){return console.error(J),[]}};var bN=M6;var U4={nearestNeighbor($,J){let{width:X,height:K}=$,q=J.width,Y=J.height,W=$.data,Q=J.data;for(let N=0;N<Y;N++)for(let V=0;V<q;V++){let M=(N*q+V)*4,H=Math.floor(N*K/Y),G=Math.floor(V*X/q),O=(H*X+G)*4;Q[M++]=W[O++],Q[M++]=W[O++],Q[M++]=W[O++],Q[M++]=W[O++]}},bilinearInterpolation($,J){let{width:X,height:K}=$,q=J.width,Y=J.height,W=$.data,Q=J.data,N=function(M,H,G,O,L){if(H===O)return G;return Math.round((M-H)*L+(O-M)*G)},V=function(M,H,G,O,L,E,j,B){let S=(j*X+O)*4+H,A=(j*X+L)*4+H,z=N(G,O,W[S],L,W[A]);if(B===j)Q[M+H]=z;else{S=(B*X+O)*4+H,A=(B*X+L)*4+H;let P=N(G,O,W[S],L,W[A]);Q[M+H]=N(E,j,z,B,P)}};for(let M=0;M<Y;M++)for(let H=0;H<q;H++){let G=(M*q+H)*4,O=H*X/q,L=Math.floor(O),E=Math.min(Math.ceil(O),X-1),j=M*K/Y,B=Math.floor(j),S=Math.min(Math.ceil(j),K-1);V(G,0,O,L,E,j,B,S),V(G,1,O,L,E,j,B,S),V(G,2,O,L,E,j,B,S),V(G,3,O,L,E,j,B,S)}},_interpolate2D($,J,X,K){let q=$.data,Y=J.data,W=$.width,Q=$.height,N=J.width,V=J.height,M=Math.max(1,Math.floor(W/N)),H=N*M,G=Math.max(1,Math.floor(Q/V)),O=V*G,L=Buffer.alloc(H*Q*4);for(let B=0;B<Q;B++)for(let S=0;S<H;S++){let A=S*(W-1)/H,z=Math.floor(A),P=A-z,R=(B*W+z)*4,U=(B*H+S)*4;for(let Z=0;Z<4;Z++){let w=R+Z,h=z>0?q[w-4]:2*q[w]-q[w+4],F=q[w],C=q[w+4],D=z<W-2?q[w+8]:2*q[w+4]-q[w];L[U+Z]=K(h,F,C,D,P)}}let E=Buffer.alloc(H*O*4);for(let B=0;B<O;B++)for(let S=0;S<H;S++){let A=B*(Q-1)/O,z=Math.floor(A),P=A-z,R=(z*H+S)*4,U=(B*H+S)*4;for(let Z=0;Z<4;Z++){let w=R+Z,h=z>0?L[w-H*4]:2*L[w]-L[w+H*4],F=L[w],C=L[w+H*4],D=z<Q-2?L[w+H*8]:2*L[w+H*4]-L[w];E[U+Z]=K(h,F,C,D,P)}}let j=M*G;if(j>1)for(let B=0;B<V;B++)for(let S=0;S<N;S++){let A=0,z=0,P=0,R=0,U=0;for(let w=0;w<G;w++){let h=B*G+w;for(let F=0;F<M;F++){let C=S*M+F,D=(h*H+C)*4,T=E[D+3];if(T)A+=E[D],z+=E[D+1],P+=E[D+2],U++;R+=T}}let Z=(B*N+S)*4;Y[Z]=U?Math.round(A/U):0,Y[Z+1]=U?Math.round(z/U):0,Y[Z+2]=U?Math.round(P/U):0,Y[Z+3]=Math.round(R/j)}else J.data=E},bicubicInterpolation($,J,X){let K=function(q,Y,W,Q,N){let V=Q-W-q+Y,M=q-Y-V,H=W-q,G=Y;return Math.max(0,Math.min(255,V*(N*N*N)+M*(N*N)+H*N+G))};return this._interpolate2D($,J,X,K)},hermiteInterpolation($,J,X){let K=function(q,Y,W,Q,N){let V=Y,M=0.5*(W-q),H=q-2.5*Y+2*W-0.5*Q,G=0.5*(Q-q)+1.5*(Y-W);return Math.max(0,Math.min(255,Math.round(((G*N+H)*N+M)*N+V)))};return this._interpolate2D($,J,X,K)},bezierInterpolation($,J,X){let K=function(q,Y,W,Q,N){let V=Y+(W-q)/4,M=W-(Q-Y)/4,H=1-N,G=Y*H*H*H,O=3*V*H*H*N,L=3*M*H*N*N,E=W*N*N*N;return Math.max(0,Math.min(255,Math.round(G+O+L+E)))};return this._interpolate2D($,J,X,K)}};var qB=f.union([f.object({w:f.number().min(0),h:f.number().min(0).optional(),mode:f.nativeEnum(p6).optional()}),f.object({w:f.number().min(0).optional(),h:f.number().min(0),mode:f.nativeEnum(p6).optional()})]),YB=f.object({w:f.number().min(0),h:f.number().min(0),mode:f.nativeEnum(p6).optional()}),WB=f.object({f:f.number().min(0),mode:f.nativeEnum(p6).optional()}),j8={resize($,J){let{mode:X}=qB.parse(J),K,q;if(typeof J.w==="number")K=J.w,q=J.h??$.bitmap.height*(K/$.bitmap.width);else if(typeof J.h==="number")q=J.h,K=J.w??$.bitmap.width*(q/$.bitmap.height);else throw Error("w must be a number");if(K=Math.round(K)||1,q=Math.round(q)||1,X&&typeof U4[X]==="function"){let Y={data:Buffer.alloc(K*q*4),width:K,height:q};U4[X]($.bitmap,Y),$.bitmap=Y}else new bN($.bitmap.width,$.bitmap.height,K,q,!0,!0,(W)=>{$.bitmap.data=Buffer.from(W),$.bitmap.width=K,$.bitmap.height=q}).resize($.bitmap.data);return $},scale($,J){let{f:X,mode:K}=typeof J==="number"?{f:J}:WB.parse(J),q=$.bitmap.width*X,Y=$.bitmap.height*X;return this.resize($,{w:q,h:Y,mode:K})},scaleToFit($,J){let{h:X,w:K,mode:q}=YB.parse(J),Y=K/X>$.bitmap.width/$.bitmap.height?X/$.bitmap.height:K/$.bitmap.width;return this.scale($,{f:Y,mode:q})}};var NB=f.object({w:f.number(),h:f.number(),align:f.number().optional(),mode:f.nativeEnum(p6).optional()}),mN={contain($,J){let{w:X,h:K,align:q=e6.CENTER|$8.MIDDLE,mode:Y}=NB.parse(J),W=q&7,Q=q>>3;if(!(W!==0&&!(W&W-1)||Q!==0&&!(Q&Q-1)))throw Error("only use one flag per alignment direction");let N=W>>1,V=Q>>1,M=X/K>$.bitmap.width/$.bitmap.height?K/$.bitmap.height:X/$.bitmap.width,H=j8.scale(h6($),{f:M,mode:Y});return $=j8.resize($,{w:X,h:K,mode:Y}),$.scan((G,O,L)=>{$.bitmap.data.writeUInt32BE($.background,L)}),$=k5.blit($,{src:H,x:($.bitmap.width-H.bitmap.width)/2*N,y:($.bitmap.height-H.bitmap.height)/2*V}),$}};var MB=f.object({x:f.number(),y:f.number(),w:f.number(),h:f.number()}),HB=f.object({tolerance:f.number().min(0).max(1).optional(),cropOnlyFrames:f.boolean().optional(),cropSymmetric:f.boolean().optional(),leaveBorder:f.number().optional(),ignoreSides:f.object({north:f.boolean().optional(),south:f.boolean().optional(),east:f.boolean().optional(),west:f.boolean().optional()}).optional()}),y5={crop($,J){let{x:X,y:K,w:q,h:Y}=MB.parse(J);if(X=Math.round(X),K=Math.round(K),q=Math.round(q),Y=Math.round(Y),X===0&&q===$.bitmap.width){let W=q*K+X<<2,Q=W+(Y*q<<2);$.bitmap.data=$.bitmap.data.slice(W,Q)}else{let W=Buffer.allocUnsafe(q*Y*4),Q=0;o6($,X,K,q,Y,function(N,V,M){let H=$.bitmap.data.readUInt32BE(M);W.writeUInt32BE(H,Q),Q+=4}),$.bitmap.data=W}return $.bitmap.width=q,$.bitmap.height=Y,$},autocrop($,J={}){let{tolerance:X=0.0002,cropOnlyFrames:K=!0,cropSymmetric:q=!1,leaveBorder:Y=0,ignoreSides:W}=typeof J==="number"?{tolerance:J}:HB.parse(J),Q=$.bitmap.width,N=$.bitmap.height,V=1,M={north:!1,south:!1,east:!1,west:!1,...W},H=$.getPixelColor(0,0),G=i1(H),O=0,L=0,E=0,j=0;if(H=$.getPixelColor(0,0),!M.north)$:for(let z=0;z<N-1;z++){for(let P=0;P<Q;P++){let R=$.getPixelColor(P,z),U=i1(R);if(t5(G,U)>X)break $}O++}if(H=$.getPixelColor(Q,0),!M.west)$:for(let z=0;z<Q-1;z++){for(let P=0+O;P<N;P++){let R=$.getPixelColor(z,P),U=i1(R);if(t5(G,U)>X)break $}j++}if(H=$.getPixelColor(0,N),!M.south)$:for(let z=N-1;z>=O+1;z--){for(let P=Q-L-1;P>=0;P--){let R=$.getPixelColor(P,z),U=i1(R);if(t5(G,U)>X)break $}E++}if(H=$.getPixelColor(Q,N),!M.east)$:for(let z=Q-1;z>=0+j+1;z--){for(let P=N-1;P>=0+O;P--){let R=$.getPixelColor(z,P),U=i1(R);if(t5(G,U)>X)break $}L++}let B=!1;if(j-=Y,L-=Y,O-=Y,E-=Y,q){let z=Math.min(L,j),P=Math.min(O,E);j=z,L=z,O=P,E=P}j=j>=0?j:0,L=L>=0?L:0,O=O>=0?O:0,E=E>=0?E:0;let S=Q-(j+L),A=N-(E+O);if(K)B=L!==0&&O!==0&&j!==0&&E!==0;else B=L!==0||O!==0||j!==0||E!==0;if(B)this.crop($,{x:j,y:O,w:S,h:A});return $}};var OB=f.object({w:f.number(),h:f.number(),align:f.number().optional(),mode:f.nativeEnum(p6).optional()}),pN={cover($,J){let{w:X,h:K,align:q=e6.CENTER|$8.MIDDLE,mode:Y}=OB.parse(J),W=q&7,Q=q>>3;if(!(W!==0&&!(W&W-1)||Q!==0&&!(Q&Q-1)))throw Error("only use one flag per alignment direction");let N=W>>1,V=Q>>1,M=X/K>$.bitmap.width/$.bitmap.height?X/$.bitmap.width:K/$.bitmap.height;return $=j8.scale($,{f:M,mode:Y}),$=y5.crop($,{x:($.bitmap.width-X)/2*N,y:($.bitmap.height-K)/2*V,w:X,h:K}),$}};var LB=f.object({map:B1,offset:f.number()}),uN={displace($,J){let{map:X,offset:K}=LB.parse(J),q=h6($);return $.scan((Y,W,Q)=>{let N=X.bitmap.data[Q]/256*K;N=Math.round(N);let V=$.getPixelIndex(Y+N,W);$.bitmap.data[V]=q.bitmap.data[Q],$.bitmap.data[V+1]=q.bitmap.data[Q+1],$.bitmap.data[V+2]=q.bitmap.data[Q+2]}),$}};var lN={dither($){let J=[1,9,3,11,13,5,15,7,4,12,2,10,16,8,14,6];return $.scan((X,K,q)=>{let Y=((K&3)<<2)+X%4,W=J[Y];$.bitmap.data[q]=Math.min($.bitmap.data[q]+W,255),$.bitmap.data[q+1]=Math.min($.bitmap.data[q+1]+W,255),$.bitmap.data[q+2]=Math.min($.bitmap.data[q+2]+W,255)}),$}};var RB=f.object({radius:f.number().min(0).optional()}),cN={fisheye($,J={}){let{radius:X=2.5}=RB.parse(J),K=h6($),{width:q,height:Y}=K.bitmap;return K.scan((W,Q)=>{let N=W/q,V=Q/Y,M=Math.sqrt(Math.pow(N-0.5,2)+Math.pow(V-0.5,2)),H=2*Math.pow(M,X),G=(N-0.5)/M,O=(V-0.5)/M,L=Math.round((H*G+0.5)*q),E=Math.round((H*O+0.5)*Y),j=K.getPixelColor(L,E);$.setPixelColor(j,W,Q)}),$.setPixelColor(K.getPixelColor(q/2,Y/2),q/2,Y/2),$}};var PB=f.object({horizontal:f.boolean().optional(),vertical:f.boolean().optional()}),dN={flip($,J){let{horizontal:X,vertical:K}=PB.parse(J),q=Buffer.alloc($.bitmap.data.length);return $.scan((Y,W,Q)=>{let N=X?$.bitmap.width-1-Y:Y,V=K?$.bitmap.height-1-W:W,M=$.bitmap.width*V+N<<2,H=$.bitmap.data.readUInt32BE(Q);q.writeUInt32BE(H,M)}),$.bitmap.data=Buffer.from(q),$}};var y9=h8(iN(),1);class sN{size;smallerSize;constructor($,J){this.size=$||32,this.smallerSize=J||8,zB(this.size)}distance($,J){let X=0;for(let K=0;K<$.length;K++)if($[K]!==J[K])X++;return X/$.length}getHash($){$=j8.resize(h6($),{w:this.size,h:this.size}),$=w5.greyscale($);let J=[];for(let W=0;W<$.bitmap.width;W++){let Q=[];for(let N=0;N<$.bitmap.height;N++)Q[N]=FB($.getPixelColor(W,N)).b;J[W]=Q}let X=CB(J,this.size),K=0;for(let W=0;W<this.smallerSize;W++)for(let Q=0;Q<this.smallerSize;Q++)K+=X[W][Q];let q=K/(this.smallerSize*this.smallerSize),Y="";for(let W=0;W<this.smallerSize;W++)for(let Q=0;Q<this.smallerSize;Q++)Y+=X[W][Q]>q?"1":"0";return Y}}function FB($){let J=$&255;$>>>=8;let X=$&255;$>>>=8;let K=$&255;return $>>>=8,{r:$&255,g:K,b:X,a:J}}var a$=[];function zB($){for(let J=1;J<$;J++)a$[J]=1;a$[0]=1/Math.sqrt(2)}function CB($,J){let X=J,K=[];for(let q=0;q<X;q++){let Y=[];for(let W=0;W<X;W++){let Q=0;for(let N=0;N<X;N++)for(let V=0;V<X;V++)Q+=Math.cos((2*N+1)/(2*X)*q*Math.PI)*Math.cos((2*V+1)/(2*X)*W*Math.PI)*$[N][V];Q*=a$[q]*a$[W]/4,Y[W]=Q,K[q]=Y}}return K}var j4=sN;var aN="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",tN=[NaN,NaN];for(let $=2;$<65;$++){let J=y9.default(y9.default.BIN,aN.slice(0,$))(Array(65).join("1"));tN.push(J.length)}var eN={pHash($){return new j4().getHash($)},hash($,J=64){if(J<2||J>64)throw Error("base must be a number between 2 and 64");let X=aN.slice(0,J),K=this.pHash($),q=tN[J];return y9.default(y9.default.BIN,X)(K).padStart(q,"0")},distanceFromHash($,J){let X=new j4,K=X.getHash($);return X.distance(K,J)}};var vB=f.object({src:B1,x:f.number().optional(),y:f.number().optional()}),DB=f.union([B1,vB]),$V={mask($,J){DB.parse(J);let X,K,q;if("bitmap"in J)X=J,K=0,q=0;else X=J.src,K=J.x??0,q=J.y??0;K=Math.round(K),q=Math.round(q);let Y=$.bitmap.width,W=$.bitmap.height;return X.scan(function(Q,N,V){let M=K+Q,H=q+N;if(M>=0&&H>=0&&M<Y&&H<W){let G=$.getPixelIndex(M,H),{data:O}=X.bitmap,L=(O[V+0]+O[V+1]+O[V+2])/3;$.bitmap.data[G+3]*=L/255}}),$}};function x5($,J){let X=0;for(let K=0;K<J.length;K++){let q=J[K],Y=$.chars[q];if(Y){let W=$.kernings[q],Q=J[K+1],N=W&&Q&&W[Q]?W[Q]||0:0;X+=(Y.xadvance||0)+N}}return X}function E4($,J,X){let K=J.replace(/[\r\n]+/g,` 
`).split(" "),q=[],Y=[],W=0;return K.forEach((Q)=>{if(x5($,Q+(K.length>1?" ":""))>X){let H=Q[Symbol.iterator](),G="";for(let O of H){let L=[...Y,G+O].join(" "),E=x5($,L);if(E<X)G+=O;else if(E>X)q.push([...Y,G]),Y=[],G=O;else q.push([...Y,G+O]),Y=[],G=""}return}let V=[...Y,Q].join(" "),M=x5($,V);if(M<=X&&!Q.includes(`
`)){if(M>W)W=M;Y.push(Q)}else q.push(Y),Y=[Q.replace(`
`,"")]}),q.push(Y),{lines:q,longestLine:W}}function R4($,J,X){let{lines:K}=E4($,J,X);return K.length*$.common.lineHeight}var wB=f.object({x:f.number(),y:f.number(),text:f.union([f.union([f.string(),f.number()]),f.object({text:f.union([f.string(),f.number()]),alignmentX:f.nativeEnum(e6).optional(),alignmentY:f.nativeEnum($8).optional()})]),maxWidth:f.number().optional(),maxHeight:f.number().optional(),cb:f.function(f.tuple([f.object({x:f.number(),y:f.number()})])).optional()});function TB($,J,X,K){if(K===e6.LEFT)return 0;if(K===e6.CENTER)return(X-x5($,J))/2;return X-x5($,J)}function IB($,J,X,K,q){if(q.width>0&&q.height>0){let Y=J.pages[q.page];if(Y)$=k5.blit($,{src:Y,x:X+q.xoffset,y:K+q.yoffset,srcX:q.x,srcY:q.y,srcW:q.width,srcH:q.height})}return $}function _B($,J,X,K,q,Y){for(let W=0;W<q.length;W++){let Q=q[W],N;if(J.chars[Q])N=Q;else if(/\s/.test(Q))N="";else N="?";let V=J.chars[N]||{xadvance:void 0},M=J.kernings[N];if(V)IB($,J,X,K,V);let H=q[W+1],G=M&&H&&M[H]?M[H]||0:0;X+=G+(V.xadvance||Y)}}var JV={print($,{font:J,...X}){let{x:K,y:q,text:Y,maxWidth:W=1/0,maxHeight:Q=1/0,cb:N=()=>{}}=wB.parse(X),V,M;if(typeof Y==="object"&&Y.text!==null&&Y.text!==void 0)V=Y.alignmentX||e6.LEFT,M=Y.alignmentY||$8.TOP,{text:Y}=Y;else V=e6.LEFT,M=$8.TOP,Y=Y.toString();if(typeof Y==="number")Y=Y.toString();if(Q!==1/0&&M===$8.BOTTOM)q+=Q-R4(J,Y,W);else if(Q!==1/0&&M===$8.MIDDLE)q+=Q/2-R4(J,Y,W)/2;let H=Object.entries(J.chars).find((L)=>L[1].xadvance)?.[1].xadvance;if(typeof H!=="number")throw Error("Could not find default character width");let{lines:G,longestLine:O}=E4(J,Y,W);return G.forEach((L)=>{let E=L.join(" "),j=TB(J,E,W,V);_B($,J,K+j,q,E,H),q+=J.common.lineHeight}),N.bind($)({x:K+O,y:q}),$}};var xB=f.union([f.number(),f.object({deg:f.number(),mode:f.union([f.boolean(),f.nativeEnum(p6)]).optional()})]);function XV($){return function(J,X){return X*$+J<<2}}function hB($,J){if(Math.abs(J)%90!==0)throw Error("Unsupported matrix rotation degree");let X=$.bitmap.width,K=$.bitmap.height,q;switch(J){case 90:case-270:q=90;break;case 180:case-180:q=180;break;case 270:case-90:q=-90;break;default:throw Error("Unsupported matrix rotation degree")}let Y=q===180?X:K,W=q===180?K:X,Q=Buffer.alloc($.bitmap.data.length),N=XV(X),V=XV(Y);for(let M=0;M<X;M++)for(let H=0;H<K;H++){let G=N(M,H),O=$.bitmap.data.readUInt32BE(G),L;switch(q){case 90:L=V(H,X-M-1);break;case-90:L=V(K-H-1,M);break;case 180:L=V(X-M-1,K-H-1);break;default:throw Error("Unsupported matrix rotation angle")}Q.writeUInt32BE(O,L)}$.bitmap.data=Q,$.bitmap.width=Y,$.bitmap.height=W}function KV($,J){return function(X,K){return{x:X+$,y:K+J}}}function gB($,J,X){let K=J*Math.PI/180,q=Math.cos(K),Y=Math.sin(K),W=$.bitmap.width,Q=$.bitmap.height;if(X===!0||typeof X==="string"){if(W=Math.ceil(Math.abs($.bitmap.width*q)+Math.abs($.bitmap.height*Y))+1,Q=Math.ceil(Math.abs($.bitmap.width*Y)+Math.abs($.bitmap.height*q))+1,W%2!==0)W++;if(Q%2!==0)Q++;let O=h6($);$.scan((E,j,B)=>{$.bitmap.data.writeUInt32BE($.background,B)});let L=Math.max(W,Q,$.bitmap.width,$.bitmap.height);$=j8.resize($,{h:L,w:L,mode:X===!0?void 0:X}),$=T5($,O,$.bitmap.width/2-O.bitmap.width/2,$.bitmap.height/2-O.bitmap.height/2)}let N=$.bitmap.width,V=$.bitmap.height,M=Buffer.alloc($.bitmap.data.length),H=KV(-(N/2),-(V/2)),G=KV(N/2+0.5,V/2+0.5);for(let O=1;O<=V;O++)for(let L=1;L<=N;L++){let E=H(L,O),j=G(q*E.x-Y*E.y,q*E.y+Y*E.x),B=N*(O-1)+L-1<<2;if(j.x>=0&&j.x<N&&j.y>=0&&j.y<V){let S=(N*(j.y|0)+j.x|0)<<2,A=$.bitmap.data.readUInt32BE(S);M.writeUInt32BE(A,B)}else M.writeUInt32BE($.background,B)}if($.bitmap.data=M,X===!0||typeof X==="string"){let O=Math.max(N/2-W/2,0),L=Math.max(V/2-Q/2,0);$=y5.crop($,{x:O,y:L,w:W,h:Q})}}var qV={rotate($,J){let X=xB.parse(J),K=typeof X==="number"?{deg:X}:X,{mode:q=!0}=K,{deg:Y}=K;if(Y%=360,Y%360===0)return $;if(Y%90===0&&(q||$.bitmap.width===$.bitmap.height||Y%180===0))hB($,Y);else gB($,Y,q);return $}};var bB=f.object({max:f.number().min(0).max(255),replace:f.number().min(0).max(255).optional(),autoGreyscale:f.boolean().optional()}),YV={threshold($,J){let{max:X,replace:K=255,autoGreyscale:q=!0}=bB.parse(J);if(X=$6(X),K=$6(K),q)w5.greyscale($);return $.scan((Y,W,Q)=>{let N=$.bitmap.data[Q]<X?$.bitmap.data[Q]:K;$.bitmap.data[Q]=N,$.bitmap.data[Q+1]=N,$.bitmap.data[Q+2]=N}),$}};var VV=Object.defineProperty,pB=($,J,X)=>(J in $)?VV($,J,{enumerable:!0,configurable:!0,writable:!0,value:X}):$[J]=X,t8=($,J)=>{for(var X in J)VV($,X,{get:J[X],enumerable:!0})},n=($,J,X)=>{return pB($,typeof J!=="symbol"?J+"":J,X),X},uB={};t8(uB,{bt709:()=>MV});var MV={};t8(MV,{Y:()=>HV,x:()=>GV,y:()=>OV});var HV=(($)=>{return $[$.RED=0.2126]="RED",$[$.GREEN=0.7152]="GREEN",$[$.BLUE=0.0722]="BLUE",$[$.WHITE=1]="WHITE",$})(HV||{}),GV=(($)=>{return $[$.RED=0.64]="RED",$[$.GREEN=0.3]="GREEN",$[$.BLUE=0.15]="BLUE",$[$.WHITE=0.3127]="WHITE",$})(GV||{}),OV=(($)=>{return $[$.RED=0.33]="RED",$[$.GREEN=0.6]="GREEN",$[$.BLUE=0.06]="BLUE",$[$.WHITE=0.329]="WHITE",$})(OV||{}),lB={};t8(lB,{lab2rgb:()=>aB,lab2xyz:()=>BV,rgb2hsl:()=>t$,rgb2lab:()=>h9,rgb2xyz:()=>UV,xyz2lab:()=>RV,xyz2rgb:()=>PV});function B4($){return $>0.04045?(($+0.055)/1.055)**2.4:$/12.92}function UV($,J,X){return $=B4($/255),J=B4(J/255),X=B4(X/255),{x:$*0.4124+J*0.3576+X*0.1805,y:$*0.2126+J*0.7152+X*0.0722,z:$*0.0193+J*0.1192+X*0.9505}}var LV={};t8(LV,{degrees2radians:()=>A1,inRange0to255:()=>l6,inRange0to255Rounded:()=>J8,intInRange:()=>cB,max3:()=>jV,min3:()=>EV,stableSort:()=>z4});function A1($){return $*(Math.PI/180)}function jV($,J,X){let K=$;if(K<J)K=J;if(K<X)K=X;return K}function EV($,J,X){let K=$;if(K>J)K=J;if(K>X)K=X;return K}function cB($,J,X){if($>X)$=X;if($<J)$=J;return $|0}function J8($){if($=Math.round($),$>255)$=255;else if($<0)$=0;return $}function l6($){if($>255)$=255;else if($<0)$=0;return $}function z4($,J){let X=typeof $[0],K;if(X==="number"||X==="string"){let q=Object.create(null);for(let Y=0,W=$.length;Y<W;Y++){let Q=$[Y];if(q[Q]||q[Q]===0)continue;q[Q]=Y}K=$.sort((Y,W)=>J(Y,W)||q[Y]-q[W])}else{let q=$.slice(0);K=$.sort((Y,W)=>J(Y,W)||q.indexOf(Y)-q.indexOf(W))}return K}function t$($,J,X){let K=EV($,J,X),q=jV($,J,X),Y=q-K,W=(K+q)/510,Q=0;if(W>0&&W<1)Q=Y/(W<0.5?q+K:510-q-K);let N=0;if(Y>0){if(q===$)N=(J-X)/Y;else if(q===J)N=2+(X-$)/Y;else N=4+($-J)/Y;if(N*=60,N<0)N+=360}return{h:N,s:Q,l:W}}var dB=0.95047,nB=1,oB=1.08883;function P4($){return $>0.008856?$**0.3333333333333333:7.787*$+0.13793103448275862}function RV($,J,X){if($=P4($/dB),J=P4(J/nB),X=P4(X/oB),116*J-16<0)throw Error("xxx");return{L:Math.max(0,116*J-16),a:500*($-J),b:200*(J-X)}}function h9($,J,X){let K=UV($,J,X);return RV(K.x,K.y,K.z)}var rB=0.95047,iB=1,sB=1.08883;function S4($){return $>0.206893034?$**3:($-0.13793103448275862)/7.787}function BV($,J,X){let K=($+16)/116,q=J/500+K,Y=K-X/200;return{x:rB*S4(q),y:iB*S4(K),z:sB*S4(Y)}}function A4($){return $>0.0031308?1.055*$**0.4166666666666667-0.055:12.92*$}function PV($,J,X){let K=A4($*3.2406+J*-1.5372+X*-0.4986),q=A4($*-0.9689+J*1.8758+X*0.0415),Y=A4($*0.0557+J*-0.204+X*1.057);return{r:J8(K*255),g:J8(q*255),b:J8(Y*255)}}function aB($,J,X){let K=BV($,J,X);return PV(K.x,K.y,K.z)}var tB={};t8(tB,{AbstractDistanceCalculator:()=>n1,AbstractEuclidean:()=>e$,AbstractManhattan:()=>$7,CIE94GraphicArts:()=>FV,CIE94Textiles:()=>AV,CIEDE2000:()=>E8,CMetric:()=>zV,Euclidean:()=>CV,EuclideanBT709:()=>ZV,EuclideanBT709NoAlpha:()=>vV,Manhattan:()=>DV,ManhattanBT709:()=>wV,ManhattanNommyde:()=>kV,PNGQuant:()=>TV});var n1=class{constructor(){n(this,"_maxDistance"),n(this,"_whitePoint"),this._setDefaults(),this.setWhitePoint(255,255,255,255)}setWhitePoint($,J,X,K){this._whitePoint={r:$>0?255/$:0,g:J>0?255/J:0,b:X>0?255/X:0,a:K>0?255/K:0},this._maxDistance=this.calculateRaw($,J,X,K,0,0,0,0)}calculateNormalized($,J){return this.calculateRaw($.r,$.g,$.b,$.a,J.r,J.g,J.b,J.a)/this._maxDistance}},SV=class extends n1{calculateRaw($,J,X,K,q,Y,W,Q){let N=h9(l6($*this._whitePoint.r),l6(J*this._whitePoint.g),l6(X*this._whitePoint.b)),V=h9(l6(q*this._whitePoint.r),l6(Y*this._whitePoint.g),l6(W*this._whitePoint.b)),M=N.L-V.L,H=N.a-V.a,G=N.b-V.b,O=Math.sqrt(N.a*N.a+N.b*N.b),L=Math.sqrt(V.a*V.a+V.b*V.b),E=O-L,j=H*H+G*G-E*E;j=j<0?0:Math.sqrt(j);let B=(Q-K)*this._whitePoint.a*this._kA;return Math.sqrt((M/this._Kl)**2+(E/(1+this._K1*O))**2+(j/(1+this._K2*O))**2+B**2)}},AV=class extends SV{_setDefaults(){this._Kl=2,this._K1=0.048,this._K2=0.014,this._kA=0.049019607843137254}},FV=class extends SV{_setDefaults(){this._Kl=1,this._K1=0.045,this._K2=0.015,this._kA=0.09803921568627451}},K6=class extends n1{_setDefaults(){}static _calculatehp($,J){let X=Math.atan2($,J);if(X>=0)return X;return X+K6._deg360InRad}static _calculateRT($,J){let X=J**7,K=2*Math.sqrt(X/(X+K6._pow25to7)),q=K6._deg30InRad*Math.exp(-((($-K6._deg275InRad)/K6._deg25InRad)**2));return-Math.sin(2*q)*K}static _calculateT($){return 1-0.17*Math.cos($-K6._deg30InRad)+0.24*Math.cos($*2)+0.32*Math.cos($*3+K6._deg6InRad)-0.2*Math.cos($*4-K6._deg63InRad)}static _calculate_ahp($,J,X,K){let q=X+K;if($===0)return q;if(J<=K6._deg180InRad)return q/2;if(q<K6._deg360InRad)return(q+K6._deg360InRad)/2;return(q-K6._deg360InRad)/2}static _calculate_dHp($,J,X,K){let q;if($===0)q=0;else if(J<=K6._deg180InRad)q=X-K;else if(X<=K)q=X-K+K6._deg360InRad;else q=X-K-K6._deg360InRad;return 2*Math.sqrt($)*Math.sin(q/2)}calculateRaw($,J,X,K,q,Y,W,Q){let N=h9(l6($*this._whitePoint.r),l6(J*this._whitePoint.g),l6(X*this._whitePoint.b)),V=h9(l6(q*this._whitePoint.r),l6(Y*this._whitePoint.g),l6(W*this._whitePoint.b)),M=(Q-K)*this._whitePoint.a*K6._kA,H=this.calculateRawInLab(N,V);return Math.sqrt(H+M*M)}calculateRawInLab($,J){let{L:X,a:K,b:q}=$,Y=J.L,W=J.a,Q=J.b,N=Math.sqrt(K*K+q*q),V=Math.sqrt(W*W+Q*Q),M=((N+V)/2)**7,H=0.5*(1-Math.sqrt(M/(M+K6._pow25to7))),G=(1+H)*K,O=(1+H)*W,L=Math.sqrt(G*G+q*q),E=Math.sqrt(O*O+Q*Q),j=L*E,B=K6._calculatehp(q,G),S=K6._calculatehp(Q,O),A=Math.abs(B-S),z=Y-X,P=E-L,R=K6._calculate_dHp(j,A,S,B),U=K6._calculate_ahp(j,A,B,S),Z=K6._calculateT(U),w=(L+E)/2,h=((X+Y)/2-50)**2,F=1+0.015*h/Math.sqrt(20+h),C=1+0.045*w,D=1+0.015*Z*w,T=K6._calculateRT(U,w),x=z/F,y=P/C,b=R/D;return x**2+y**2+b**2+T*y*b}},E8=K6;n(E8,"_kA",0.09803921568627451);n(E8,"_pow25to7",6103515625);n(E8,"_deg360InRad",A1(360));n(E8,"_deg180InRad",A1(180));n(E8,"_deg30InRad",A1(30));n(E8,"_deg6InRad",A1(6));n(E8,"_deg63InRad",A1(63));n(E8,"_deg275InRad",A1(275));n(E8,"_deg25InRad",A1(25));var zV=class extends n1{calculateRaw($,J,X,K,q,Y,W,Q){let N=($+q)/2*this._whitePoint.r,V=($-q)*this._whitePoint.r,M=(J-Y)*this._whitePoint.g,H=(X-W)*this._whitePoint.b,G=((512+N)*V*V>>8)+4*M*M+((767-N)*H*H>>8),O=(Q-K)*this._whitePoint.a;return Math.sqrt(G+O*O)}_setDefaults(){}},e$=class extends n1{calculateRaw($,J,X,K,q,Y,W,Q){let N=q-$,V=Y-J,M=W-X,H=Q-K;return Math.sqrt(this._kR*N*N+this._kG*V*V+this._kB*M*M+this._kA*H*H)}},CV=class extends e${_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},ZV=class extends e${_setDefaults(){this._kR=0.2126,this._kG=0.7152,this._kB=0.0722,this._kA=1}},vV=class extends e${_setDefaults(){this._kR=0.2126,this._kG=0.7152,this._kB=0.0722,this._kA=0}},$7=class extends n1{calculateRaw($,J,X,K,q,Y,W,Q){let N=q-$,V=Y-J,M=W-X,H=Q-K;if(N<0)N=0-N;if(V<0)V=0-V;if(M<0)M=0-M;if(H<0)H=0-H;return this._kR*N+this._kG*V+this._kB*M+this._kA*H}},DV=class extends $7{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},kV=class extends $7{_setDefaults(){this._kR=0.4984,this._kG=0.8625,this._kB=0.2979,this._kA=1}},wV=class extends $7{_setDefaults(){this._kR=0.2126,this._kG=0.7152,this._kB=0.0722,this._kA=1}},TV=class extends n1{calculateRaw($,J,X,K,q,Y,W,Q){let N=(Q-K)*this._whitePoint.a;return this._colordifferenceCh($*this._whitePoint.r,q*this._whitePoint.r,N)+this._colordifferenceCh(J*this._whitePoint.g,Y*this._whitePoint.g,N)+this._colordifferenceCh(X*this._whitePoint.b,W*this._whitePoint.b,N)}_colordifferenceCh($,J,X){let K=$-J,q=K+X;return K*K+q*q}_setDefaults(){}},eB={};t8(eB,{AbstractPaletteQuantizer:()=>g9,ColorHistogram:()=>b9,NeuQuant:()=>Q6,NeuQuantFloat:()=>N6,RGBQuant:()=>yV,WuColorCube:()=>xV,WuQuant:()=>p5});var g9=class{quantizeSync(){for(let $ of this.quantize())if($.palette)return $.palette;throw Error("unreachable")}},c6=class{constructor(){n(this,"r"),n(this,"g"),n(this,"b"),n(this,"a"),n(this,"uint32"),n(this,"rgba"),this.uint32=4294967295,this.r=this.g=this.b=this.a=0,this.rgba=[,,,,],this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}static createByQuadruplet($){let J=new c6;return J.r=$[0]|0,J.g=$[1]|0,J.b=$[2]|0,J.a=$[3]|0,J._loadUINT32(),J._loadQuadruplet(),J}static createByRGBA($,J,X,K){let q=new c6;return q.r=$|0,q.g=J|0,q.b=X|0,q.a=K|0,q._loadUINT32(),q._loadQuadruplet(),q}static createByUint32($){let J=new c6;return J.uint32=$>>>0,J._loadRGBA(),J._loadQuadruplet(),J}from($){this.r=$.r,this.g=$.g,this.b=$.b,this.a=$.a,this.uint32=$.uint32,this.rgba[0]=$.r,this.rgba[1]=$.g,this.rgba[2]=$.b,this.rgba[3]=$.a}getLuminosity($){let J=this.r,X=this.g,K=this.b;if($)J=Math.min(255,255-this.a+this.a*J/255),X=Math.min(255,255-this.a+this.a*X/255),K=Math.min(255,255-this.a+this.a*K/255);return J*0.2126+X*0.7152+K*0.0722}_loadUINT32(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0}_loadRGBA(){this.r=this.uint32&255,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255}_loadQuadruplet(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a}},a8=class{constructor(){n(this,"_pointArray"),n(this,"_width"),n(this,"_height"),this._width=0,this._height=0,this._pointArray=[]}getWidth(){return this._width}getHeight(){return this._height}setWidth($){this._width=$}setHeight($){this._height=$}getPointArray(){return this._pointArray}clone(){let $=new a8;$._width=this._width,$._height=this._height;for(let J=0,X=this._pointArray.length;J<X;J++)$._pointArray[J]=c6.createByUint32(this._pointArray[J].uint32|0);return $}toUint32Array(){let $=this._pointArray.length,J=new Uint32Array($);for(let X=0;X<$;X++)J[X]=this._pointArray[X].uint32;return J}toUint8Array(){return new Uint8Array(this.toUint32Array().buffer)}static fromHTMLImageElement($){let{naturalWidth:J,naturalHeight:X}=$,K=document.createElement("canvas");return K.width=J,K.height=X,K.getContext("2d").drawImage($,0,0,J,X,0,0,J,X),a8.fromHTMLCanvasElement(K)}static fromHTMLCanvasElement($){let{width:J,height:X}=$,q=$.getContext("2d").getImageData(0,0,J,X);return a8.fromImageData(q)}static fromImageData($){let{width:J,height:X}=$;return a8.fromUint8Array($.data,J,X)}static fromUint8Array($,J,X){switch(Object.prototype.toString.call($)){case"[object Uint8ClampedArray]":case"[object Uint8Array]":break;default:$=new Uint8Array($)}let K=new Uint32Array($.buffer);return a8.fromUint32Array(K,J,X)}static fromUint32Array($,J,X){let K=new a8;K._width=J,K._height=X;for(let q=0,Y=$.length;q<Y;q++)K._pointArray[q]=c6.createByUint32($[q]|0);return K}static fromBuffer($,J,X){let K=new Uint32Array($.buffer,$.byteOffset,$.byteLength/Uint32Array.BYTES_PER_ELEMENT);return a8.fromUint32Array(K,J,X)}},WV=10;function F4($,J){let K=360/J,q=K/2;for(let Y=1,W=K-q;Y<J;Y++,W+=K)if($>=W&&$<W+K)return Y;return 0}var f9=class{constructor(){n(this,"_pointContainer"),n(this,"_pointArray",[]),n(this,"_i32idx",{}),this._pointContainer=new a8,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}add($){this._pointArray.push($),this._pointContainer.setWidth(this._pointArray.length)}has($){for(let J=this._pointArray.length-1;J>=0;J--)if($.uint32===this._pointArray[J].uint32)return!0;return!1}getNearestColor($,J){return this._pointArray[this._getNearestIndex($,J)|0]}getPointContainer(){return this._pointContainer}_nearestPointFromCache($){return typeof this._i32idx[$]==="number"?this._i32idx[$]:-1}_getNearestIndex($,J){let X=this._nearestPointFromCache(""+J.uint32);if(X>=0)return X;let K=Number.MAX_VALUE;X=0;for(let q=0,Y=this._pointArray.length;q<Y;q++){let W=this._pointArray[q],Q=$.calculateRaw(J.r,J.g,J.b,J.a,W.r,W.g,W.b,W.a);if(Q<K)K=Q,X=q}return this._i32idx[J.uint32]=X,X}sort(){this._i32idx={},this._pointArray.sort(($,J)=>{let X=t$($.r,$.g,$.b),K=t$(J.r,J.g,J.b),q=$.r===$.g&&$.g===$.b?0:1+F4(X.h,WV),W=(J.r===J.g&&J.g===J.b?0:1+F4(K.h,WV))-q;if(W)return-W;let Q=$.getLuminosity(!0),N=J.getLuminosity(!0);if(N-Q!==0)return N-Q;let V=(K.s*100|0)-(X.s*100|0);if(V)return-V;return 0})}},C4={};t8(C4,{HueStatistics:()=>IV,Palette:()=>f9,Point:()=>c6,PointContainer:()=>a8,ProgressTracker:()=>e8,arithmetic:()=>LV});var $P=class{constructor(){n(this,"num",0),n(this,"cols",[])}},IV=class{constructor($,J){n(this,"_numGroups"),n(this,"_minCols"),n(this,"_stats"),n(this,"_groupsFull"),this._numGroups=$,this._minCols=J,this._stats=[];for(let X=0;X<=$;X++)this._stats[X]=new $P;this._groupsFull=0}check($){if(this._groupsFull===this._numGroups+1)this.check=()=>{};let J=$&255,X=$>>>8&255,K=$>>>16&255,q=J===X&&X===K?0:1+F4(t$(J,X,K).h,this._numGroups),Y=this._stats[q],W=this._minCols;if(Y.num++,Y.num>W)return;if(Y.num===W)this._groupsFull++;if(Y.num<=W)this._stats[q].cols.push($)}injectIntoDictionary($){for(let J=0;J<=this._numGroups;J++)if(this._stats[J].num<=this._minCols)this._stats[J].cols.forEach((X)=>{if(!$[X])$[X]=1;else $[X]++})}injectIntoArray($){for(let J=0;J<=this._numGroups;J++)if(this._stats[J].num<=this._minCols)this._stats[J].cols.forEach((X)=>{if($.indexOf(X)===-1)$.push(X)})}},_V=class{constructor($,J){n(this,"progress"),n(this,"_step"),n(this,"_range"),n(this,"_last"),n(this,"_progressRange"),this._range=$,this._progressRange=J,this._step=Math.max(1,this._range/(_V.steps+1)|0),this._last=-this._step,this.progress=0}shouldNotify($){if($-this._last>=this._step)return this._last=$,this.progress=Math.min(this._progressRange*this._last/this._range,this._progressRange),!0;return!1}},e8=_V;n(e8,"steps",100);var k6=3,JP=class{constructor($){n(this,"r"),n(this,"g"),n(this,"b"),n(this,"a"),this.r=this.g=this.b=this.a=$}toPoint(){return c6.createByRGBA(this.r>>k6,this.g>>k6,this.b>>k6,this.a>>k6)}subtract($,J,X,K){this.r-=$|0,this.g-=J|0,this.b-=X|0,this.a-=K|0}},u0=class extends g9{constructor($,J=256){super();n(this,"_pointArray"),n(this,"_networkSize"),n(this,"_network"),n(this,"_sampleFactor"),n(this,"_radPower"),n(this,"_freq"),n(this,"_bias"),n(this,"_distance"),this._distance=$,this._pointArray=[],this._sampleFactor=1,this._networkSize=J,this._distance.setWhitePoint(255<<k6,255<<k6,255<<k6,255<<k6)}sample($){this._pointArray=this._pointArray.concat($.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let $=0;$<this._networkSize;$++)this._network[$]=new JP(($<<k6+8)/this._networkSize|0),this._freq[$]=u0._initialBias/this._networkSize|0,this._bias[$]=0}*_learn(){let $=this._sampleFactor,J=this._pointArray.length;if(J<u0._minpicturebytes)$=1;let X=30+($-1)/3|0,K=J/$|0,q=K/u0._nCycles|0,Y=u0._initAlpha,W=(this._networkSize>>3)*u0._radiusBias,Q=W>>u0._radiusBiasShift;if(Q<=1)Q=0;for(let M=0;M<Q;M++)this._radPower[M]=Y*((Q*Q-M*M)*u0._radBias/(Q*Q))>>>0;let N;if(J<u0._minpicturebytes)N=1;else if(J%u0._prime1!==0)N=u0._prime1;else if(J%u0._prime2!==0)N=u0._prime2;else if(J%u0._prime3!==0)N=u0._prime3;else N=u0._prime4;let V=new e8(K,99);for(let M=0,H=0;M<K;){if(V.shouldNotify(M))yield{progress:V.progress};let G=this._pointArray[H],O=G.b<<k6,L=G.g<<k6,E=G.r<<k6,j=G.a<<k6,B=this._contest(O,L,E,j);if(this._alterSingle(Y,B,O,L,E,j),Q!==0)this._alterNeighbour(Q,B,O,L,E,j);if(H+=N,H>=J)H-=J;if(M++,q===0)q=1;if(M%q===0){if(Y-=Y/X|0,W-=W/u0._radiusDecrease|0,Q=W>>u0._radiusBiasShift,Q<=1)Q=0;for(let S=0;S<Q;S++)this._radPower[S]=Y*((Q*Q-S*S)*u0._radBias/(Q*Q))>>>0}}}_buildPalette(){let $=new f9;return this._network.forEach((J)=>{$.add(J.toPoint())}),$.sort(),$}_alterNeighbour($,J,X,K,q,Y){let W=J-$;if(W<-1)W=-1;let Q=J+$;if(Q>this._networkSize)Q=this._networkSize;let N=J+1,V=J-1,M=1;while(N<Q||V>W){let H=this._radPower[M++]/u0._alphaRadBias;if(N<Q){let G=this._network[N++];G.subtract(H*(G.r-q),H*(G.g-K),H*(G.b-X),H*(G.a-Y))}if(V>W){let G=this._network[V--];G.subtract(H*(G.r-q),H*(G.g-K),H*(G.b-X),H*(G.a-Y))}}}_alterSingle($,J,X,K,q,Y){$/=u0._initAlpha;let W=this._network[J];W.subtract($*(W.r-q),$*(W.g-K),$*(W.b-X),$*(W.a-Y))}_contest($,J,X,K){let q=1020<<k6,Y=2147483647,W=Y,Q=-1,N=Q;for(let V=0;V<this._networkSize;V++){let M=this._network[V],H=this._distance.calculateNormalized(M,{r:X,g:J,b:$,a:K})*q|0;if(H<Y)Y=H,Q=V;let G=H-(this._bias[V]>>u0._initialBiasShift-k6);if(G<W)W=G,N=V;let O=this._freq[V]>>u0._betaShift;this._freq[V]-=O,this._bias[V]+=O<<u0._gammaShift}return this._freq[Q]+=u0._beta,this._bias[Q]-=u0._betaGamma,N}},Q6=u0;n(Q6,"_prime1",499);n(Q6,"_prime2",491);n(Q6,"_prime3",487);n(Q6,"_prime4",503);n(Q6,"_minpicturebytes",u0._prime4);n(Q6,"_nCycles",100);n(Q6,"_initialBiasShift",16);n(Q6,"_initialBias",1<<u0._initialBiasShift);n(Q6,"_gammaShift",10);n(Q6,"_betaShift",10);n(Q6,"_beta",u0._initialBias>>u0._betaShift);n(Q6,"_betaGamma",u0._initialBias<<u0._gammaShift-u0._betaShift);n(Q6,"_radiusBiasShift",6);n(Q6,"_radiusBias",1<<u0._radiusBiasShift);n(Q6,"_radiusDecrease",30);n(Q6,"_alphaBiasShift",10);n(Q6,"_initAlpha",1<<u0._alphaBiasShift);n(Q6,"_radBiasShift",8);n(Q6,"_radBias",1<<u0._radBiasShift);n(Q6,"_alphaRadBiasShift",u0._alphaBiasShift+u0._radBiasShift);n(Q6,"_alphaRadBias",1<<u0._alphaRadBiasShift);var w6=3,XP=class{constructor($){n(this,"r"),n(this,"g"),n(this,"b"),n(this,"a"),this.r=this.g=this.b=this.a=$}toPoint(){return c6.createByRGBA(this.r>>w6,this.g>>w6,this.b>>w6,this.a>>w6)}subtract($,J,X,K){this.r-=$,this.g-=J,this.b-=X,this.a-=K}},l0=class extends g9{constructor($,J=256){super();n(this,"_pointArray"),n(this,"_networkSize"),n(this,"_network"),n(this,"_sampleFactor"),n(this,"_radPower"),n(this,"_freq"),n(this,"_bias"),n(this,"_distance"),this._distance=$,this._pointArray=[],this._sampleFactor=1,this._networkSize=J,this._distance.setWhitePoint(255<<w6,255<<w6,255<<w6,255<<w6)}sample($){this._pointArray=this._pointArray.concat($.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let $=0;$<this._networkSize;$++)this._network[$]=new XP(($<<w6+8)/this._networkSize),this._freq[$]=l0._initialBias/this._networkSize,this._bias[$]=0}*_learn(){let $=this._sampleFactor,J=this._pointArray.length;if(J<l0._minpicturebytes)$=1;let X=30+($-1)/3,K=J/$,q=K/l0._nCycles|0,Y=l0._initAlpha,W=(this._networkSize>>3)*l0._radiusBias,Q=W>>l0._radiusBiasShift;if(Q<=1)Q=0;for(let M=0;M<Q;M++)this._radPower[M]=Y*((Q*Q-M*M)*l0._radBias/(Q*Q));let N;if(J<l0._minpicturebytes)N=1;else if(J%l0._prime1!==0)N=l0._prime1;else if(J%l0._prime2!==0)N=l0._prime2;else if(J%l0._prime3!==0)N=l0._prime3;else N=l0._prime4;let V=new e8(K,99);for(let M=0,H=0;M<K;){if(V.shouldNotify(M))yield{progress:V.progress};let G=this._pointArray[H],O=G.b<<w6,L=G.g<<w6,E=G.r<<w6,j=G.a<<w6,B=this._contest(O,L,E,j);if(this._alterSingle(Y,B,O,L,E,j),Q!==0)this._alterNeighbour(Q,B,O,L,E,j);if(H+=N,H>=J)H-=J;if(M++,q===0)q=1;if(M%q===0){if(Y-=Y/X,W-=W/l0._radiusDecrease,Q=W>>l0._radiusBiasShift,Q<=1)Q=0;for(let S=0;S<Q;S++)this._radPower[S]=Y*((Q*Q-S*S)*l0._radBias/(Q*Q))}}}_buildPalette(){let $=new f9;return this._network.forEach((J)=>{$.add(J.toPoint())}),$.sort(),$}_alterNeighbour($,J,X,K,q,Y){let W=J-$;if(W<-1)W=-1;let Q=J+$;if(Q>this._networkSize)Q=this._networkSize;let N=J+1,V=J-1,M=1;while(N<Q||V>W){let H=this._radPower[M++]/l0._alphaRadBias;if(N<Q){let G=this._network[N++];G.subtract(H*(G.r-q),H*(G.g-K),H*(G.b-X),H*(G.a-Y))}if(V>W){let G=this._network[V--];G.subtract(H*(G.r-q),H*(G.g-K),H*(G.b-X),H*(G.a-Y))}}}_alterSingle($,J,X,K,q,Y){$/=l0._initAlpha;let W=this._network[J];W.subtract($*(W.r-q),$*(W.g-K),$*(W.b-X),$*(W.a-Y))}_contest($,J,X,K){let q=1020<<w6,Y=2147483647,W=Y,Q=-1,N=Q;for(let V=0;V<this._networkSize;V++){let M=this._network[V],H=this._distance.calculateNormalized(M,{r:X,g:J,b:$,a:K})*q;if(H<Y)Y=H,Q=V;let G=H-(this._bias[V]>>l0._initialBiasShift-w6);if(G<W)W=G,N=V;let O=this._freq[V]>>l0._betaShift;this._freq[V]-=O,this._bias[V]+=O<<l0._gammaShift}return this._freq[Q]+=l0._beta,this._bias[Q]-=l0._betaGamma,N}},N6=l0;n(N6,"_prime1",499);n(N6,"_prime2",491);n(N6,"_prime3",487);n(N6,"_prime4",503);n(N6,"_minpicturebytes",l0._prime4);n(N6,"_nCycles",100);n(N6,"_initialBiasShift",16);n(N6,"_initialBias",1<<l0._initialBiasShift);n(N6,"_gammaShift",10);n(N6,"_betaShift",10);n(N6,"_beta",l0._initialBias>>l0._betaShift);n(N6,"_betaGamma",l0._initialBias<<l0._gammaShift-l0._betaShift);n(N6,"_radiusBiasShift",6);n(N6,"_radiusBias",1<<l0._radiusBiasShift);n(N6,"_radiusDecrease",30);n(N6,"_alphaBiasShift",10);n(N6,"_initAlpha",1<<l0._alphaBiasShift);n(N6,"_radBiasShift",8);n(N6,"_radBias",1<<l0._radBiasShift);n(N6,"_alphaRadBiasShift",l0._alphaBiasShift+l0._radBiasShift);n(N6,"_alphaRadBias",1<<l0._alphaRadBiasShift);var x9=class{constructor($,J){n(this,"_method"),n(this,"_hueStats"),n(this,"_histogram"),n(this,"_initColors"),n(this,"_minHueCols"),this._method=$,this._minHueCols=J<<2,this._initColors=J<<2,this._hueStats=new IV(x9._hueGroups,this._minHueCols),this._histogram=Object.create(null)}sample($){switch(this._method){case 1:this._colorStats1D($);break;case 2:this._colorStats2D($);break}}getImportanceSortedColorsIDXI32(){let $=z4(Object.keys(this._histogram),(X,K)=>this._histogram[K]-this._histogram[X]);if($.length===0)return[];let J;switch(this._method){case 1:let X=Math.min($.length,this._initColors),K=$[X-1],q=this._histogram[K];J=$.slice(0,X);let Y=X,W=$.length;while(Y<W&&this._histogram[$[Y]]===q)J.push($[Y++]);this._hueStats.injectIntoArray(J);break;case 2:J=$;break;default:throw Error("Incorrect method")}return J.map((X)=>+X)}_colorStats1D($){let J=this._histogram,X=$.getPointArray(),K=X.length;for(let q=0;q<K;q++){let Y=X[q].uint32;if(this._hueStats.check(Y),Y in J)J[Y]++;else J[Y]=1}}_colorStats2D($){let J=$.getWidth(),X=$.getHeight(),K=$.getPointArray(),q=x9._boxSize[0],Y=x9._boxSize[1],W=q*Y,Q=this._makeBoxes(J,X,q,Y),N=this._histogram;Q.forEach((V)=>{let M=Math.round(V.w*V.h/W)*x9._boxPixels;if(M<2)M=2;let H={};this._iterateBox(V,J,(G)=>{let O=K[G].uint32;if(this._hueStats.check(O),O in N)N[O]++;else if(O in H){if(++H[O]>=M)N[O]=H[O]}else H[O]=1})}),this._hueStats.injectIntoDictionary(N)}_iterateBox($,J,X){let K=$,q=K.y*J+K.x,Y=(K.y+K.h-1)*J+(K.x+K.w-1),W=J-K.w+1,Q=0,N=q;do X.call(this,N),N+=++Q%K.w===0?W:1;while(N<=Y)}_makeBoxes($,J,X,K){let q=$%X,Y=J%K,W=$-q,Q=J-Y,N=[];for(let V=0;V<J;V+=K)for(let M=0;M<$;M+=X)N.push({x:M,y:V,w:M===W?q:X,h:V===Q?Y:K});return N}},b9=x9;n(b9,"_boxSize",[64,64]);n(b9,"_boxPixels",2);n(b9,"_hueGroups",10);var KP=class{constructor($,J,X){n(this,"index"),n(this,"color"),n(this,"distance"),this.index=$,this.color=J,this.distance=X}},yV=class extends g9{constructor($,J=256,X=2){super();n(this,"_colors"),n(this,"_initialDistance"),n(this,"_distanceIncrement"),n(this,"_histogram"),n(this,"_distance"),this._distance=$,this._colors=J,this._histogram=new b9(X,J),this._initialDistance=0.01,this._distanceIncrement=0.005}sample($){this._histogram.sample($)}*quantize(){let $=this._histogram.getImportanceSortedColorsIDXI32();if($.length===0)throw Error("No colors in image");yield*this._buildPalette($)}*_buildPalette($){let J=new f9,X=J.getPointContainer().getPointArray(),K=Array($.length);for(let M=0;M<$.length;M++)X.push(c6.createByUint32($[M])),K[M]=1;let q=X.length,Y=[],W=q,Q=this._initialDistance,N=new e8(W-this._colors,99);while(W>this._colors){Y.length=0;for(let M=0;M<q;M++){if(N.shouldNotify(q-W))yield{progress:N.progress};if(K[M]===0)continue;let H=X[M];for(let G=M+1;G<q;G++){if(K[G]===0)continue;let O=X[G],L=this._distance.calculateNormalized(H,O);if(L<Q)Y.push(new KP(G,O,L)),K[G]=0,W--}}Q+=W>this._colors*3?this._initialDistance:this._distanceIncrement}if(W<this._colors){z4(Y,(H,G)=>G.distance-H.distance);let M=0;while(W<this._colors&&M<Y.length){let H=Y[M];K[H.index]=1,W++,M++}}let V=X.length;for(let M=V-1;M>=0;M--)if(K[M]===0){if(M!==V-1)X[M]=X[V-1];--V}X.length=V,J.sort(),yield{palette:J,progress:100}}};function h5($){let J=[];for(let X=0;X<$;X++)J[X]=0;return J}function g5($,J,X,K){let q=Array($);for(let Y=0;Y<$;Y++){q[Y]=Array(J);for(let W=0;W<J;W++){q[Y][W]=Array(X);for(let Q=0;Q<X;Q++){q[Y][W][Q]=Array(K);for(let N=0;N<K;N++)q[Y][W][Q][N]=0}}}return q}function f5($,J,X){let K=Array($);for(let q=0;q<$;q++){K[q]=Array(J);for(let Y=0;Y<J;Y++){K[q][Y]=Array(X);for(let W=0;W<X;W++)K[q][Y][W]=0}}return K}function b5($,J,X,K,q){for(let Y=0;Y<J;Y++){$[Y]=[];for(let W=0;W<X;W++){$[Y][W]=[];for(let Q=0;Q<K;Q++)$[Y][W][Q]=q}}}function m5($,J,X){for(let K=0;K<J;K++)$[K]=X}var xV=class{constructor(){n(this,"redMinimum"),n(this,"redMaximum"),n(this,"greenMinimum"),n(this,"greenMaximum"),n(this,"blueMinimum"),n(this,"blueMaximum"),n(this,"volume"),n(this,"alphaMinimum"),n(this,"alphaMaximum")}},w0=class extends g9{constructor($,J=256,X=5){super();n(this,"_reds"),n(this,"_greens"),n(this,"_blues"),n(this,"_alphas"),n(this,"_sums"),n(this,"_weights"),n(this,"_momentsRed"),n(this,"_momentsGreen"),n(this,"_momentsBlue"),n(this,"_momentsAlpha"),n(this,"_moments"),n(this,"_table"),n(this,"_pixels"),n(this,"_cubes"),n(this,"_colors"),n(this,"_significantBitsPerChannel"),n(this,"_maxSideIndex"),n(this,"_alphaMaxSideIndex"),n(this,"_sideSize"),n(this,"_alphaSideSize"),n(this,"_distance"),this._distance=$,this._setQuality(X),this._initialize(J)}sample($){let J=$.getPointArray();for(let X=0,K=J.length;X<K;X++)this._addColor(J[X]);this._pixels=this._pixels.concat(J)}*quantize(){yield*this._preparePalette();let $=new f9;for(let J=0;J<this._colors;J++)if(this._sums[J]>0){let X=this._sums[J],K=this._reds[J]/X,q=this._greens[J]/X,Y=this._blues[J]/X,W=this._alphas[J]/X,Q=c6.createByRGBA(K|0,q|0,Y|0,W|0);$.add(Q)}$.sort(),yield{palette:$,progress:100}}*_preparePalette(){yield*this._calculateMoments();let $=0,J=h5(this._colors);for(let W=1;W<this._colors;++W){if(this._cut(this._cubes[$],this._cubes[W]))J[$]=this._cubes[$].volume>1?this._calculateVariance(this._cubes[$]):0,J[W]=this._cubes[W].volume>1?this._calculateVariance(this._cubes[W]):0;else J[$]=0,W--;$=0;let Q=J[0];for(let N=1;N<=W;++N)if(J[N]>Q)Q=J[N],$=N;if(Q<=0){this._colors=W+1;break}}let X=[],K=[],q=[],Y=[];for(let W=0;W<this._colors;++W){let Q=w0._volume(this._cubes[W],this._weights);if(Q>0)X[W]=w0._volume(this._cubes[W],this._momentsRed)/Q|0,K[W]=w0._volume(this._cubes[W],this._momentsGreen)/Q|0,q[W]=w0._volume(this._cubes[W],this._momentsBlue)/Q|0,Y[W]=w0._volume(this._cubes[W],this._momentsAlpha)/Q|0;else X[W]=0,K[W]=0,q[W]=0,Y[W]=0}this._reds=h5(this._colors+1),this._greens=h5(this._colors+1),this._blues=h5(this._colors+1),this._alphas=h5(this._colors+1),this._sums=h5(this._colors+1);for(let W=0,Q=this._pixels.length;W<Q;W++){let N=this._pixels[W],V=-1,M=-1,H=Number.MAX_VALUE;for(let G=0;G<this._colors;G++){let O=X[G],L=K[G],E=q[G],j=Y[G],B=this._distance.calculateRaw(O,L,E,j,N.r,N.g,N.b,N.a);if(B<H)H=B,M=G}this._reds[M]+=N.r,this._greens[M]+=N.g,this._blues[M]+=N.b,this._alphas[M]+=N.a,this._sums[M]++}}_addColor($){let J=8-this._significantBitsPerChannel,X=($.r>>J)+1,K=($.g>>J)+1,q=($.b>>J)+1,Y=($.a>>J)+1;this._weights[Y][X][K][q]++,this._momentsRed[Y][X][K][q]+=$.r,this._momentsGreen[Y][X][K][q]+=$.g,this._momentsBlue[Y][X][K][q]+=$.b,this._momentsAlpha[Y][X][K][q]+=$.a,this._moments[Y][X][K][q]+=this._table[$.r]+this._table[$.g]+this._table[$.b]+this._table[$.a]}*_calculateMoments(){let $=[],J=[],X=[],K=[],q=[],Y=[],W=f5(this._sideSize,this._sideSize,this._sideSize),Q=f5(this._sideSize,this._sideSize,this._sideSize),N=f5(this._sideSize,this._sideSize,this._sideSize),V=f5(this._sideSize,this._sideSize,this._sideSize),M=f5(this._sideSize,this._sideSize,this._sideSize),H=f5(this._sideSize,this._sideSize,this._sideSize),G=0,O=new e8(this._alphaMaxSideIndex*this._maxSideIndex,99);for(let L=1;L<=this._alphaMaxSideIndex;++L){b5(W,this._sideSize,this._sideSize,this._sideSize,0),b5(Q,this._sideSize,this._sideSize,this._sideSize,0),b5(N,this._sideSize,this._sideSize,this._sideSize,0),b5(V,this._sideSize,this._sideSize,this._sideSize,0),b5(M,this._sideSize,this._sideSize,this._sideSize,0),b5(H,this._sideSize,this._sideSize,this._sideSize,0);for(let E=1;E<=this._maxSideIndex;++E,++G){if(O.shouldNotify(G))yield{progress:O.progress};m5($,this._sideSize,0),m5(J,this._sideSize,0),m5(X,this._sideSize,0),m5(K,this._sideSize,0),m5(q,this._sideSize,0),m5(Y,this._sideSize,0);for(let j=1;j<=this._maxSideIndex;++j){let B=0,S=0,A=0,z=0,P=0,R=0;for(let U=1;U<=this._maxSideIndex;++U)B+=this._weights[L][E][j][U],S+=this._momentsRed[L][E][j][U],A+=this._momentsGreen[L][E][j][U],z+=this._momentsBlue[L][E][j][U],P+=this._momentsAlpha[L][E][j][U],R+=this._moments[L][E][j][U],$[U]+=B,J[U]+=S,X[U]+=A,K[U]+=z,q[U]+=P,Y[U]+=R,W[E][j][U]=W[E-1][j][U]+$[U],Q[E][j][U]=Q[E-1][j][U]+J[U],N[E][j][U]=N[E-1][j][U]+X[U],V[E][j][U]=V[E-1][j][U]+K[U],M[E][j][U]=M[E-1][j][U]+q[U],H[E][j][U]=H[E-1][j][U]+Y[U],this._weights[L][E][j][U]=this._weights[L-1][E][j][U]+W[E][j][U],this._momentsRed[L][E][j][U]=this._momentsRed[L-1][E][j][U]+Q[E][j][U],this._momentsGreen[L][E][j][U]=this._momentsGreen[L-1][E][j][U]+N[E][j][U],this._momentsBlue[L][E][j][U]=this._momentsBlue[L-1][E][j][U]+V[E][j][U],this._momentsAlpha[L][E][j][U]=this._momentsAlpha[L-1][E][j][U]+M[E][j][U],this._moments[L][E][j][U]=this._moments[L-1][E][j][U]+H[E][j][U]}}}}static _volumeFloat($,J){return J[$.alphaMaximum][$.redMaximum][$.greenMaximum][$.blueMaximum]-J[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMaximum]-J[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMaximum]+J[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMaximum]-J[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMaximum]+J[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMaximum]+J[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMaximum]-J[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMaximum]-(J[$.alphaMaximum][$.redMaximum][$.greenMaximum][$.blueMinimum]-J[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMinimum]-J[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMinimum]+J[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMinimum]-J[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMinimum]+J[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMinimum]+J[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMinimum]-J[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum])}static _volume($,J){return w0._volumeFloat($,J)|0}static _top($,J,X,K){let q;switch(J){case w0._alpha:q=K[X][$.redMaximum][$.greenMaximum][$.blueMaximum]-K[X][$.redMaximum][$.greenMinimum][$.blueMaximum]-K[X][$.redMinimum][$.greenMaximum][$.blueMaximum]+K[X][$.redMinimum][$.greenMinimum][$.blueMaximum]-(K[X][$.redMaximum][$.greenMaximum][$.blueMinimum]-K[X][$.redMaximum][$.greenMinimum][$.blueMinimum]-K[X][$.redMinimum][$.greenMaximum][$.blueMinimum]+K[X][$.redMinimum][$.greenMinimum][$.blueMinimum]);break;case w0._red:q=K[$.alphaMaximum][X][$.greenMaximum][$.blueMaximum]-K[$.alphaMaximum][X][$.greenMinimum][$.blueMaximum]-K[$.alphaMinimum][X][$.greenMaximum][$.blueMaximum]+K[$.alphaMinimum][X][$.greenMinimum][$.blueMaximum]-(K[$.alphaMaximum][X][$.greenMaximum][$.blueMinimum]-K[$.alphaMaximum][X][$.greenMinimum][$.blueMinimum]-K[$.alphaMinimum][X][$.greenMaximum][$.blueMinimum]+K[$.alphaMinimum][X][$.greenMinimum][$.blueMinimum]);break;case w0._green:q=K[$.alphaMaximum][$.redMaximum][X][$.blueMaximum]-K[$.alphaMaximum][$.redMinimum][X][$.blueMaximum]-K[$.alphaMinimum][$.redMaximum][X][$.blueMaximum]+K[$.alphaMinimum][$.redMinimum][X][$.blueMaximum]-(K[$.alphaMaximum][$.redMaximum][X][$.blueMinimum]-K[$.alphaMaximum][$.redMinimum][X][$.blueMinimum]-K[$.alphaMinimum][$.redMaximum][X][$.blueMinimum]+K[$.alphaMinimum][$.redMinimum][X][$.blueMinimum]);break;case w0._blue:q=K[$.alphaMaximum][$.redMaximum][$.greenMaximum][X]-K[$.alphaMaximum][$.redMaximum][$.greenMinimum][X]-K[$.alphaMaximum][$.redMinimum][$.greenMaximum][X]+K[$.alphaMaximum][$.redMinimum][$.greenMinimum][X]-(K[$.alphaMinimum][$.redMaximum][$.greenMaximum][X]-K[$.alphaMinimum][$.redMaximum][$.greenMinimum][X]-K[$.alphaMinimum][$.redMinimum][$.greenMaximum][X]+K[$.alphaMinimum][$.redMinimum][$.greenMinimum][X]);break;default:throw Error("impossible")}return q|0}static _bottom($,J,X){switch(J){case w0._alpha:return-X[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMaximum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMaximum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMaximum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMaximum]-(-X[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMinimum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMinimum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMinimum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum]);case w0._red:return-X[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMaximum]+X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMaximum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMaximum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMaximum]-(-X[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMinimum]+X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMinimum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMinimum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum]);case w0._green:return-X[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMaximum]+X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMaximum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMaximum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMaximum]-(-X[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMinimum]+X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMinimum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMinimum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum]);case w0._blue:return-X[$.alphaMaximum][$.redMaximum][$.greenMaximum][$.blueMinimum]+X[$.alphaMaximum][$.redMaximum][$.greenMinimum][$.blueMinimum]+X[$.alphaMaximum][$.redMinimum][$.greenMaximum][$.blueMinimum]-X[$.alphaMaximum][$.redMinimum][$.greenMinimum][$.blueMinimum]-(-X[$.alphaMinimum][$.redMaximum][$.greenMaximum][$.blueMinimum]+X[$.alphaMinimum][$.redMaximum][$.greenMinimum][$.blueMinimum]+X[$.alphaMinimum][$.redMinimum][$.greenMaximum][$.blueMinimum]-X[$.alphaMinimum][$.redMinimum][$.greenMinimum][$.blueMinimum]);default:return 0}}_calculateVariance($){let J=w0._volume($,this._momentsRed),X=w0._volume($,this._momentsGreen),K=w0._volume($,this._momentsBlue),q=w0._volume($,this._momentsAlpha),Y=w0._volumeFloat($,this._moments),W=w0._volume($,this._weights),Q=J*J+X*X+K*K+q*q;return Y-Q/W}_maximize($,J,X,K,q,Y,W,Q,N){let V=w0._bottom($,J,this._momentsRed)|0,M=w0._bottom($,J,this._momentsGreen)|0,H=w0._bottom($,J,this._momentsBlue)|0,G=w0._bottom($,J,this._momentsAlpha)|0,O=w0._bottom($,J,this._weights)|0,L=0,E=-1;for(let j=X;j<K;++j){let B=V+w0._top($,J,j,this._momentsRed),S=M+w0._top($,J,j,this._momentsGreen),A=H+w0._top($,J,j,this._momentsBlue),z=G+w0._top($,J,j,this._momentsAlpha),P=O+w0._top($,J,j,this._weights);if(P!==0){let R=B*B+S*S+A*A+z*z,U=R/P;if(B=q-B,S=Y-S,A=W-A,z=Q-z,P=N-P,P!==0){if(R=B*B+S*S+A*A+z*z,U+=R/P,U>L)L=U,E=j}}}return{max:L,position:E}}_cut($,J){let X,K=w0._volume($,this._momentsRed),q=w0._volume($,this._momentsGreen),Y=w0._volume($,this._momentsBlue),W=w0._volume($,this._momentsAlpha),Q=w0._volume($,this._weights),N=this._maximize($,w0._red,$.redMinimum+1,$.redMaximum,K,q,Y,W,Q),V=this._maximize($,w0._green,$.greenMinimum+1,$.greenMaximum,K,q,Y,W,Q),M=this._maximize($,w0._blue,$.blueMinimum+1,$.blueMaximum,K,q,Y,W,Q),H=this._maximize($,w0._alpha,$.alphaMinimum+1,$.alphaMaximum,K,q,Y,W,Q);if(H.max>=N.max&&H.max>=V.max&&H.max>=M.max){if(X=w0._alpha,H.position<0)return!1}else if(N.max>=H.max&&N.max>=V.max&&N.max>=M.max)X=w0._red;else if(V.max>=H.max&&V.max>=N.max&&V.max>=M.max)X=w0._green;else X=w0._blue;switch(J.redMaximum=$.redMaximum,J.greenMaximum=$.greenMaximum,J.blueMaximum=$.blueMaximum,J.alphaMaximum=$.alphaMaximum,X){case w0._red:J.redMinimum=$.redMaximum=N.position,J.greenMinimum=$.greenMinimum,J.blueMinimum=$.blueMinimum,J.alphaMinimum=$.alphaMinimum;break;case w0._green:J.greenMinimum=$.greenMaximum=V.position,J.redMinimum=$.redMinimum,J.blueMinimum=$.blueMinimum,J.alphaMinimum=$.alphaMinimum;break;case w0._blue:J.blueMinimum=$.blueMaximum=M.position,J.redMinimum=$.redMinimum,J.greenMinimum=$.greenMinimum,J.alphaMinimum=$.alphaMinimum;break;case w0._alpha:J.alphaMinimum=$.alphaMaximum=H.position,J.blueMinimum=$.blueMinimum,J.redMinimum=$.redMinimum,J.greenMinimum=$.greenMinimum;break}return $.volume=($.redMaximum-$.redMinimum)*($.greenMaximum-$.greenMinimum)*($.blueMaximum-$.blueMinimum)*($.alphaMaximum-$.alphaMinimum),J.volume=(J.redMaximum-J.redMinimum)*(J.greenMaximum-J.greenMinimum)*(J.blueMaximum-J.blueMinimum)*(J.alphaMaximum-J.alphaMinimum),!0}_initialize($){this._colors=$,this._cubes=[];for(let J=0;J<$;J++)this._cubes[J]=new xV;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=g5(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=g5(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=g5(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=g5(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=g5(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=g5(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(let J=0;J<256;++J)this._table[J]=J*J;this._pixels=[]}_setQuality($=5){this._significantBitsPerChannel=$,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1}},p5=w0;n(p5,"_alpha",3);n(p5,"_red",2);n(p5,"_green",1);n(p5,"_blue",0);var qP={};t8(qP,{AbstractImageQuantizer:()=>J7,ErrorDiffusionArray:()=>y8,ErrorDiffusionArrayKernel:()=>gV,ErrorDiffusionRiemersma:()=>Z4,NearestColor:()=>hV});var J7=class{quantizeSync($,J){for(let X of this.quantize($,J))if(X.pointContainer)return X.pointContainer;throw Error("unreachable")}},hV=class extends J7{constructor($){super();n(this,"_distance"),this._distance=$}*quantize($,J){let X=$.getPointArray(),K=$.getWidth(),q=$.getHeight(),Y=new e8(q,99);for(let W=0;W<q;W++){if(Y.shouldNotify(W))yield{progress:Y.progress};for(let Q=0,N=W*K;Q<K;Q++,N++){let V=X[N];V.from(J.getNearestColor(this._distance,V))}}yield{pointContainer:$,progress:100}}},gV=(($)=>{return $[$.FloydSteinberg=0]="FloydSteinberg",$[$.FalseFloydSteinberg=1]="FalseFloydSteinberg",$[$.Stucki=2]="Stucki",$[$.Atkinson=3]="Atkinson",$[$.Jarvis=4]="Jarvis",$[$.Burkes=5]="Burkes",$[$.Sierra=6]="Sierra",$[$.TwoSierra=7]="TwoSierra",$[$.SierraLite=8]="SierraLite",$})(gV||{}),y8=class extends J7{constructor($,J,X=!0,K=0,q=!1){super();n(this,"_minColorDistance"),n(this,"_serpentine"),n(this,"_kernel"),n(this,"_calculateErrorLikeGIMP"),n(this,"_distance"),this._setKernel(J),this._distance=$,this._minColorDistance=K,this._serpentine=X,this._calculateErrorLikeGIMP=q}*quantize($,J){let X=$.getPointArray(),K=new c6,q=$.getWidth(),Y=$.getHeight(),W=[],Q=1,N=1;for(let M of this._kernel){let H=M[2]+1;if(N<H)N=H}for(let M=0;M<N;M++)this._fillErrorLine(W[M]=[],q);let V=new e8(Y,99);for(let M=0;M<Y;M++){if(V.shouldNotify(M))yield{progress:V.progress};if(this._serpentine)Q*=-1;let H=M*q,G=Q===1?0:q-1,O=Q===1?q:-1;this._fillErrorLine(W[0],q),W.push(W.shift());let L=W[0];for(let E=G,j=H+G;E!==O;E+=Q,j+=Q){let B=X[j],S=L[E];K.from(B);let A=c6.createByRGBA(J8(B.r+S[0]),J8(B.g+S[1]),J8(B.b+S[2]),J8(B.a+S[3])),z=J.getNearestColor(this._distance,A);if(B.from(z),this._minColorDistance){if(this._distance.calculateNormalized(K,z)<this._minColorDistance)continue}let P,R,U,Z;if(this._calculateErrorLikeGIMP)P=A.r-z.r,R=A.g-z.g,U=A.b-z.b,Z=A.a-z.a;else P=K.r-z.r,R=K.g-z.g,U=K.b-z.b,Z=K.a-z.a;let w=Q===1?0:this._kernel.length-1,h=Q===1?this._kernel.length:-1;for(let F=w;F!==h;F+=Q){let C=this._kernel[F][1]*Q,D=this._kernel[F][2];if(C+E>=0&&C+E<q&&D+M>=0&&D+M<Y){let T=this._kernel[F][0],x=W[D][C+E];x[0]+=P*T,x[1]+=R*T,x[2]+=U*T,x[3]+=Z*T}}}}yield{pointContainer:$,progress:100}}_fillErrorLine($,J){if($.length>J)$.length=J;let X=$.length;for(let K=0;K<X;K++){let q=$[K];q[0]=q[1]=q[2]=q[3]=0}for(let K=X;K<J;K++)$[K]=[0,0,0,0]}_setKernel($){switch($){case 0:this._kernel=[[0.4375,1,0],[0.1875,-1,1],[0.3125,0,1],[0.0625,1,1]];break;case 1:this._kernel=[[0.375,1,0],[0.375,0,1],[0.25,1,1]];break;case 2:this._kernel=[[0.19047619047619047,1,0],[0.09523809523809523,2,0],[0.047619047619047616,-2,1],[0.09523809523809523,-1,1],[0.19047619047619047,0,1],[0.09523809523809523,1,1],[0.047619047619047616,2,1],[0.023809523809523808,-2,2],[0.047619047619047616,-1,2],[0.09523809523809523,0,2],[0.047619047619047616,1,2],[0.023809523809523808,2,2]];break;case 3:this._kernel=[[0.125,1,0],[0.125,2,0],[0.125,-1,1],[0.125,0,1],[0.125,1,1],[0.125,0,2]];break;case 4:this._kernel=[[0.14583333333333334,1,0],[0.10416666666666667,2,0],[0.0625,-2,1],[0.10416666666666667,-1,1],[0.14583333333333334,0,1],[0.10416666666666667,1,1],[0.0625,2,1],[0.020833333333333332,-2,2],[0.0625,-1,2],[0.10416666666666667,0,2],[0.0625,1,2],[0.020833333333333332,2,2]];break;case 5:this._kernel=[[0.25,1,0],[0.125,2,0],[0.0625,-2,1],[0.125,-1,1],[0.25,0,1],[0.125,1,1],[0.0625,2,1]];break;case 6:this._kernel=[[0.15625,1,0],[0.09375,2,0],[0.0625,-2,1],[0.125,-1,1],[0.15625,0,1],[0.125,1,1],[0.0625,2,1],[0.0625,-1,2],[0.09375,0,2],[0.0625,1,2]];break;case 7:this._kernel=[[0.25,1,0],[0.1875,2,0],[0.0625,-2,1],[0.125,-1,1],[0.1875,0,1],[0.125,1,1],[0.0625,2,1]];break;case 8:this._kernel=[[0.5,1,0],[0.25,-1,1],[0.25,0,1]];break;default:throw Error(`ErrorDiffusionArray: unknown kernel = ${$}`)}}};function*YP($,J,X){let K=Math.max($,J),q=Math.floor(Math.log(K)/Math.log(2)+1),Y=new e8($*J,99),W={width:$,height:J,level:q,callback:X,tracker:Y,index:0,x:0,y:0};yield*S6(W,1),u6(W,0)}function*S6($,J){if($.level<1)return;if($.tracker.shouldNotify($.index))yield{progress:$.tracker.progress};switch($.level--,J){case 2:yield*S6($,1),u6($,3),yield*S6($,2),u6($,4),yield*S6($,2),u6($,2),yield*S6($,4);break;case 3:yield*S6($,4),u6($,2),yield*S6($,3),u6($,1),yield*S6($,3),u6($,3),yield*S6($,1);break;case 1:yield*S6($,2),u6($,4),yield*S6($,1),u6($,3),yield*S6($,1),u6($,1),yield*S6($,3);break;case 4:yield*S6($,3),u6($,1),yield*S6($,4),u6($,2),yield*S6($,4),u6($,4),yield*S6($,2);break;default:break}$.level++}function u6($,J){if($.x>=0&&$.x<$.width&&$.y>=0&&$.y<$.height)$.callback($.x,$.y),$.index++;switch(J){case 2:$.x--;break;case 3:$.x++;break;case 1:$.y--;break;case 4:$.y++;break}}var Z4=class extends J7{constructor($,J=16,X=1){super();n(this,"_distance"),n(this,"_weights"),n(this,"_errorQueueSize"),this._distance=$,this._errorQueueSize=J,this._weights=Z4._createWeights(X,J)}*quantize($,J){let X=$.getPointArray(),K=$.getWidth(),q=$.getHeight(),Y=[],W=0;for(let Q=0;Q<this._errorQueueSize;Q++)Y[Q]={r:0,g:0,b:0,a:0};yield*YP(K,q,(Q,N)=>{let V=X[Q+N*K],{r:M,g:H,b:G,a:O}=V;for(let B=0;B<this._errorQueueSize;B++){let S=this._weights[B],A=Y[(B+W)%this._errorQueueSize];M+=A.r*S,H+=A.g*S,G+=A.b*S,O+=A.a*S}let L=c6.createByRGBA(J8(M),J8(H),J8(G),J8(O)),E=J.getNearestColor(this._distance,L);W=(W+1)%this._errorQueueSize;let j=(W+this._errorQueueSize-1)%this._errorQueueSize;Y[j].r=V.r-E.r,Y[j].g=V.g-E.g,Y[j].b=V.b-E.b,Y[j].a=V.a-E.a,V.from(E)}),yield{pointContainer:$,progress:100}}static _createWeights($,J){let X=[],K=Math.exp(Math.log(J)/(J-1));for(let q=0,Y=1;q<J;q++)X[q]=(Y+0.5|0)/J*$,Y*=K;return X}},WP={};t8(WP,{ssim:()=>VP});var QP=0.01,NP=0.03;function VP($,J){if($.getHeight()!==J.getHeight()||$.getWidth()!==J.getWidth())throw Error("Images have different sizes!");let K=255,q=(QP*K)**2,Y=(NP*K)**2,W=0,Q=0;return MP($,J,(N,V,M,H)=>{let G=0,O=0,L=0;for(let A=0;A<N.length;A++)O+=(N[A]-M)**2,L+=(V[A]-H)**2,G+=(N[A]-M)*(V[A]-H);let E=N.length-1;O/=E,L/=E,G/=E;let j=(2*M*H+q)*(2*G+Y),B=(M**2+H**2+q)*(O+L+Y),S=j/B;Q+=S,W++}),Q/W}function MP($,J,X){let q=$.getWidth(),Y=$.getHeight();for(let W=0;W<Y;W+=8)for(let Q=0;Q<q;Q+=8){let N=Math.min(8,q-Q),V=Math.min(8,Y-W),M=QV($,Q,W,N,V),H=QV(J,Q,W,N,V),G=NV(M),O=NV(H);X(M,H,G,O)}}function QV($,J,X,K,q){let Y=$.getPointArray(),W=[],Q=0;for(let N=X;N<X+q;N++){let V=N*$.getWidth();for(let M=J;M<J+K;M++){let H=Y[V+M];W[Q]=H.r*0.2126+H.g*0.7152+H.b*0.0722,Q++}}return W}function NV($){let J=0;for(let X of $)J+=X;return J/$.length}var HZ=typeof setImmediate==="function"?setImmediate:typeof process<"u"&&typeof(process==null?void 0:process.nextTick)==="function"?($)=>process.nextTick($):($)=>setTimeout($,0);function fV($,{colorDistanceFormula:J,paletteQuantization:X,colors:K}={}){let q=mV(J),Y=GP(q,X,K);return $.forEach((W)=>Y.sample(W)),Y.quantizeSync()}function bV($,J,{colorDistanceFormula:X,imageQuantization:K}={}){let q=mV(X);return HP(q,K).quantizeSync($,J)}function mV($="euclidean-bt709"){switch($){case"cie94-graphic-arts":return new FV;case"cie94-textiles":return new AV;case"ciede2000":return new E8;case"color-metric":return new zV;case"euclidean":return new CV;case"euclidean-bt709":return new ZV;case"euclidean-bt709-noalpha":return new vV;case"manhattan":return new DV;case"manhattan-bt709":return new wV;case"manhattan-nommyde":return new kV;case"pngquant":return new TV;default:throw Error(`Unknown colorDistanceFormula ${$}`)}}function HP($,J="floyd-steinberg"){switch(J){case"nearest":return new hV($);case"riemersma":return new Z4($);case"floyd-steinberg":return new y8($,0);case"false-floyd-steinberg":return new y8($,1);case"stucki":return new y8($,2);case"atkinson":return new y8($,3);case"jarvis":return new y8($,4);case"burkes":return new y8($,5);case"sierra":return new y8($,6);case"two-sierra":return new y8($,7);case"sierra-lite":return new y8($,8);default:throw Error(`Unknown imageQuantization ${J}`)}}function GP($,J="wuquant",X=256){switch(J){case"neuquant":return new Q6($,X);case"rgbquant":return new yV($,X);case"wuquant":return new p5($,X);case"neuquant-float":return new N6($,X);default:throw Error(`Unknown paletteQuantization ${J}`)}}var OP=r0.object({colors:r0.number().optional(),colorDistanceFormula:r0.union([r0.literal("cie94-textiles"),r0.literal("cie94-graphic-arts"),r0.literal("ciede2000"),r0.literal("color-metric"),r0.literal("euclidean"),r0.literal("euclidean-bt709-noalpha"),r0.literal("euclidean-bt709"),r0.literal("manhattan"),r0.literal("manhattan-bt709"),r0.literal("manhattan-nommyde"),r0.literal("pngquant")]).optional(),paletteQuantization:r0.union([r0.literal("neuquant"),r0.literal("neuquant-float"),r0.literal("rgbquant"),r0.literal("wuquant")]).optional(),imageQuantization:r0.union([r0.literal("nearest"),r0.literal("riemersma"),r0.literal("floyd-steinberg"),r0.literal("false-floyd-steinberg"),r0.literal("stucki"),r0.literal("atkinson"),r0.literal("jarvis"),r0.literal("burkes"),r0.literal("sierra"),r0.literal("two-sierra"),r0.literal("sierra-lite")]).optional()}),pV={quantize($,J){let{colors:X,colorDistanceFormula:K,paletteQuantization:q,imageQuantization:Y}=OP.parse(J),W=C4.PointContainer.fromUint8Array($.bitmap.data,$.bitmap.width,$.bitmap.height),Q=fV([W],{colors:X,colorDistanceFormula:K,paletteQuantization:q}),N=bV(W,Q,{colorDistanceFormula:K,imageQuantization:Y});return $.bitmap.data=Buffer.from(N.toUint8Array()),$}};var LP=[k5,sW,aW,w5,mN,pN,y5,uN,lN,cN,dN,eN,$V,JV,j8,qV,YV,pV],jP=[X$,lX,O$,L$,R$,x$],Xv={bmp:X$().mime,gif:O$().mime,jpeg:L$().mime,png:R$().mime,tiff:x$().mime},uV=fN({formats:jP,plugins:LP});import{ptr as cV}from"bun:ffi";function v4($){let J=(X)=>X.toString(16).padStart(2,"0");return`#${J($.r)}${J($.g)}${J($.b)}`.toUpperCase()}function D4($){let J=$.replace("#","");return{r:parseInt(J.substring(0,2),16),g:parseInt(J.substring(2,4),16),b:parseInt(J.substring(4,6),16)}}function lV($,J){return Math.sqrt(Math.pow($.r-J.r,2)+Math.pow($.g-J.g,2)+Math.pow($.b-J.b,2))}function k4($,J,X){return lV($,J)<=X}function EP($,J){return $.x>=J.left&&$.x<=J.right&&$.y>=J.top&&$.y<=J.bottom}var RP={rgbToHex:v4,hexToRgb:D4,colorDistance:lV,isColorSimilar:k4,pointInRect:EP};var u5=null,dV=0;function BP(){if(u5&&Date.now()-dV<1000)return u5;if(u5)W0.symbols.ReleaseDC(null,u5);return u5=W0.symbols.GetDC(null),dV=Date.now(),u5}function l5(){return{width:W0.symbols.GetSystemMetrics(0),height:W0.symbols.GetSystemMetrics(1)}}function m9($,J){let X=BP();if(!X)return null;let K=E6.symbols.GetPixel(X,$,J);return{r:K&255,g:K>>8&255,b:K>>16&255}}function nV($,J){let X=m9($,J);if(!X)return null;return v4(X)}function p9($,J,X,K=0){let q=m9($,J);if(!q)return!1;return k4(q,X,K)}function oV($,J,X,K=0,q){return new Promise((Y)=>{let W=0,Q=setInterval(()=>{if(p9($,J,X,K)){clearInterval(Q),Y(!0);return}if(q&&(W+=50)>=q)clearInterval(Q),Y(!1)},50)})}function rV($){return $.map((J)=>m9(J.x,J.y))}function iV($){return $.every((J)=>p9(J.x,J.y,J.target,J.tolerance??0))}function sV($,J){return new Promise((X)=>{let K=0,q=setInterval(()=>{for(let Y=0;Y<$.length;Y++){let W=$[Y];if(p9(W.x,W.y,W.target,W.tolerance??0)){clearInterval(q),X(Y);return}}if(J&&(K+=50)>=J)clearInterval(q),X(-1)},50)})}function aV($,J,X,K,q,Y=0){let W=Math.min($,X),Q=Math.min(J,K),N=Math.max($,X),V=Math.max(J,K),M=N-W+1,H=V-Q+1,G=X7(W,Q,M,H);if(!G)return null;let O;if(typeof q==="string")O=D4(q);else if(typeof q==="number")O={r:q>>16&255,g:q>>8&255,b:q&255};else O=q;for(let L=0;L<H;L++)for(let E=0;E<M;E++){let j=(L*M+E)*4,B=G[j],S=G[j+1],A=G[j+2];if(Y===0){if(A===O.r&&S===O.g&&B===O.b)return{x:W+E,y:Q+L}}else if(Math.abs(A-O.r)<=Y&&Math.abs(S-O.g)<=Y&&Math.abs(B-O.b)<=Y)return{x:W+E,y:Q+L}}return null}async function PP($){try{let J=await uV.read($),X=J.bitmap.width,K=J.bitmap.height,q=J.bitmap.data,Y=X*K*4,W=new Uint8Array(Y);for(let Q=0;Q<Y;Q+=4)W[Q]=q[Q+2],W[Q+1]=q[Q+1],W[Q+2]=q[Q],W[Q+3]=q[Q+3];return{width:X,height:K,data:W}}catch(J){return console.error(`Failed to load image: ${$}`,J),null}}async function tV($,J,X,K,q,Y=0){let W=await PP(q);if(!W)return null;let Q=Math.min($,X),N=Math.min(J,K),V=Math.max($,X),M=Math.max(J,K),H=V-Q+1,G=M-N+1,O=X7(Q,N,H,G);if(!O)return null;let{width:L,height:E}=W,j=H,B=G;if(L>j||E>B)return null;let S=(A,z,P,R,U,Z)=>{if(Y===0)return A===R&&z===U&&P===Z;return Math.abs(A-R)<=Y&&Math.abs(z-U)<=Y&&Math.abs(P-Z)<=Y};for(let A=0;A<=B-E;A++)for(let z=0;z<=j-L;z++){let P=(A*j+z)*4,R=0;if(!S(O[P+2],O[P+1],O[P],W.data[R+2],W.data[R+1],W.data[R]))continue;let U=!0;for(let Z=0;Z<E;Z++){for(let w=0;w<L;w++){if(Z===0&&w===0)continue;if(P=((A+Z)*j+(z+w))*4,R=(Z*L+w)*4,!S(O[P+2],O[P+1],O[P],W.data[R+2],W.data[R+1],W.data[R])){U=!1;break}}if(!U)break}if(U)return{x:Q+z,y:N+A}}return null}function X7($=0,J=0,X,K){let q=X||W0.symbols.GetSystemMetrics(0),Y=K||W0.symbols.GetSystemMetrics(1),W=W0.symbols.GetDC(null);if(!W)return null;let Q=E6.symbols.CreateCompatibleDC(W);if(!Q)return W0.symbols.ReleaseDC(null,W),null;let N=E6.symbols.CreateCompatibleBitmap(W,q,Y);if(!N)return W0.symbols.ReleaseDC(null,W),E6.symbols.DeleteDC(Q),null;let V=E6.symbols.SelectObject(Q,N),M=E6.symbols.BitBlt(Q,0,0,q,Y,W,$,J,13369376),H=null;if(M){let G=q*Y*4;H=new Uint8Array(G);let O=new Uint8Array(40),L=new DataView(O.buffer);if(L.setInt32(0,40,!0),L.setInt32(4,q,!0),L.setInt32(8,-Y,!0),L.setInt16(12,1,!0),L.setInt16(14,32,!0),L.setInt32(16,0,!0),E6.symbols.GetDIBits(Q,N,0,Y,cV(H),cV(O),0)===0)H=null}if(V)E6.symbols.SelectObject(Q,V);return E6.symbols.DeleteObject(N),E6.symbols.DeleteDC(Q),W0.symbols.ReleaseDC(null,W),H}function eV(){let $=W0.symbols.GetSystemMetrics(78),J=W0.symbols.GetSystemMetrics(79),X=W0.symbols.GetSystemMetrics(76),K=W0.symbols.GetSystemMetrics(77);return[{rect:{left:X,top:K,right:X+$,bottom:K+J},isPrimary:!0}]}var $M=6,AP=1,FP=0,zP=1,CP=4,ZP=256,vP=4096,DP=3,kP=9,wP=0,TP=5,IP=16,T4=-16,K7=-20,_P=524288;var yP=2,xP=-1,hP=-2,I4=2,_4=1;var Y7=new TextDecoder("utf-16le"),JM=new TextDecoder("ascii");function u9(){let $=W0.symbols.GetForegroundWindow();if(!$)return null;let J=new Uint16Array(256),X=W0.symbols.GetWindowTextW($,L6(J),256),K=X>0?Y7.decode(J.subarray(0,X)):"",q=new Int32Array(4);if(!W0.symbols.GetWindowRect($,L6(q)))return null;let Y={left:q[0],top:q[1],right:q[2],bottom:q[3]},W=l5(),Q=Y.left===0&&Y.top===0&&Y.right-Y.left===W.width&&Y.bottom-Y.top===W.height&&(W0.symbols.GetWindowLongW($,-16)&12845056)===0;return{hwnd:$,title:K,rect:Y,isFullscreen:Q}}function q7($){let J=$!==void 0?BigInt($):W0.symbols.GetForegroundWindow();if(!J)return"";let X=new Uint16Array(256),K=W0.symbols.GetWindowTextW(J,L6(X),256);return K>0?Y7.decode(X.subarray(0,K)):""}function W7($){let J=new Int32Array(4);if(!W0.symbols.GetWindowRect(BigInt($),L6(J)))return null;return{left:J[0],top:J[1],right:J[2],bottom:J[3]}}function XM($){return W0.symbols.IsWindowVisible(BigInt($))}function Q7($){return W0.symbols.SetForegroundWindow(BigInt($))}function y4($){let J=new TextEncoder().encode($+"\x00"),X=W0.symbols.FindWindowA(null,L6(J));return X?X:null}function KM($,J){return new Promise((X)=>{let K=0,q=setInterval(()=>{let Y=y4($);if(Y){clearInterval(q),X(Y);return}if(J&&(K+=100)>=J)clearInterval(q),X(null)},100)})}function N7($){let J=new Uint32Array(1);return W0.symbols.GetWindowThreadProcessId(BigInt($),L6(J)),J[0]}function qM($){let J=new Uint8Array(256),X=W0.symbols.GetClassNameA(BigInt($),L6(J),256);return X>0?JM.decode(J.subarray(0,X)):""}function x4($){return W0.symbols.IsIconic(BigInt($))}function YM($){return W0.symbols.IsZoomed(BigInt($))}function WM($){return W0.symbols.ShowWindow(BigInt($),$M)}function QM($){return W0.symbols.ShowWindow(BigInt($),DP)}function h4($){return W0.symbols.ShowWindow(BigInt($),kP)}function NM($){return W0.symbols.ShowWindow(BigInt($),TP)}function VM($){return W0.symbols.ShowWindow(BigInt($),wP)}function MM($){return W0.symbols.PostMessageA(BigInt($),IP,null,null)}function g4($,J,X,K,q,Y=!0){return W0.symbols.MoveWindow(BigInt($),J,X,K,q,Y)}function HM($){let J=W7($);if(!J)return!1;let X=J.right-J.left,K=J.bottom-J.top,q=l5(),Y=Math.floor((q.width-X)/2),W=Math.floor((q.height-K)/2);return g4($,Y,W,X,K,!0)}function f4($){let J=new Int32Array(4);if(!W0.symbols.GetClientRect(BigInt($),L6(J)))return null;return{left:J[0],top:J[1],right:J[2],bottom:J[3]}}function GM($){let J=W7($);if(!J)return null;return{width:J.right-J.left,height:J.bottom-J.top}}function OM($){let J=f4($);if(!J)return null;return{width:J.right-J.left,height:J.bottom-J.top}}function V7($){return W0.symbols.IsWindow(BigInt($))}function b4($){if(!V7($))return null;let J=BigInt($),X=new Uint16Array(256),K=W0.symbols.GetWindowTextW(J,L6(X),256),q=K>0?Y7.decode(X.subarray(0,K)):"",Y=new Int32Array(4);if(!W0.symbols.GetWindowRect(J,L6(Y)))return null;let W={left:Y[0],top:Y[1],right:Y[2],bottom:Y[3]},Q=l5(),N=W.left===0&&W.top===0&&W.right-W.left===Q.width&&W.bottom-W.top===Q.height&&(W0.symbols.GetWindowLongW(J,T4)&12845056)===0,V=new Uint32Array(1);W0.symbols.GetWindowThreadProcessId(J,L6(V));let M=new Uint8Array(256),H=W0.symbols.GetClassNameA(J,L6(M),256),G=H>0?JM.decode(M.subarray(0,H)):"";return{hwnd:J,title:q,rect:W,isFullscreen:N,processId:V[0],isVisible:W0.symbols.IsWindowVisible(J),isMinimized:W0.symbols.IsIconic(J),isMaximized:W0.symbols.IsZoomed(J),className:G}}function UM($,J){return new Promise((X)=>{let K=0,q=setInterval(()=>{if(!V7($)){clearInterval(q),X(!0);return}if(J&&(K+=100)>=J)clearInterval(q),X(!1)},100)})}async function LM($,J=1000){Q7($);let X=0;while(X<J){let K=u9();if(K&&K.hwnd===BigInt($))return!0;await Bun.sleep(50),X+=50}return!1}function jM(){let $=[],J=new w4((X,K)=>{let q=b4(X);if(q&&q.isVisible&&q.title)$.push(q);return!0},{args:["u64","i64"],returns:"bool"});return W0.symbols.EnumWindows(J.ptr,0),J.close(),$}function m4($){let J=[],X=new w4((K,q)=>{return J.push(K),!0},{args:["u64","i64"],returns:"bool"});return W0.symbols.EnumChildWindows(BigInt($),X.ptr,0),X.close(),J}function EM($,J=!0){return W0.symbols.FlashWindow(BigInt($),J)}function RM($,J){let X=BigInt($),K=W0.symbols.GetWindowLongW(X,K7);W0.symbols.SetWindowLongW(X,K7,K|_P);let q=Math.max(0,Math.min(255,Math.floor(J*255)));return W0.symbols.SetLayeredWindowAttributes(X,0,q,yP)}function BM($,J){return W0.symbols.SetWindowPos(BigInt($),BigInt(J?xP:hP),0,0,0,0,I4|_4)}function PM($,J){let X=new Uint16Array(J.length+1),K=new TextEncoder().encodeInto(J,new Uint8Array(X.buffer)),q=Buffer.from(J+"\x00","utf16le");return W0.symbols.SetWindowTextW(BigInt($),L6(q))}function SM($,J){return W0.symbols.EnableWindow(BigInt($),J)}function AM($){return W0.symbols.RedrawWindow(BigInt($),null,0n,zP|CP|ZP)}function FM($){return W0.symbols.SetWindowPos(BigInt($),BigInt(AP),0,0,0,0,I4|_4)}function zM($){return W0.symbols.SetWindowPos(BigInt($),BigInt(FP),0,0,0,0,I4|_4)}function p4($){let J=N7($);if(!J)return"";let X=v1.symbols.OpenProcess(vP,!1,J);if(!X)return"";try{let K=new Uint16Array(1024),q=new Uint32Array([1024]);if(v1.symbols.QueryFullProcessImageNameW(X,0,L6(K),L6(q)))return Y7.decode(K.subarray(0,q[0]));return""}finally{v1.symbols.CloseHandle(X)}}function CM($,J,X){let K=new Int32Array([J,X]);if(W0.symbols.ClientToScreen(BigInt($),L6(K)))return{x:K[0],y:K[1]};return null}function ZM($,J,X){let K=new Int32Array([J,X]);if(W0.symbols.ScreenToClient(BigInt($),L6(K)))return{x:K[0],y:K[1]};return null}function vM($){let J=BigInt($);if(x4(J))h4(J);return Q7(J)}async function DM($,J){let X=BigInt($);return new Promise((K)=>{let q=0,Y=setInterval(()=>{let W=u9();if(W&&W.hwnd===X){clearInterval(Y),K(!0);return}if(J&&(q+=100)>=J)clearInterval(Y),K(!1)},100)})}async function kM($,J){let X=BigInt($);return new Promise((K)=>{let q=0,Y=setInterval(()=>{let W=u9();if(!W||W.hwnd!==X){clearInterval(Y),K(!0);return}if(J&&(q+=100)>=J)clearInterval(Y),K(!1)},100)})}function wM($){let J=BigInt($),X=N7(J);if(!X)return!1;let K=1,q=v1.symbols.OpenProcess(K,!1,X);if(!q)return!1;try{return v1.symbols.TerminateProcess(q,1)}finally{v1.symbols.CloseHandle(q)}}var gP={WS_OVERLAPPED:0,WS_POPUP:2147483648,WS_CHILD:1073741824,WS_MINIMIZE:536870912,WS_VISIBLE:268435456,WS_DISABLED:134217728,WS_CLIPSIBLINGS:67108864,WS_CLIPCHILDREN:33554432,WS_MAXIMIZE:16777216,WS_CAPTION:12582912,WS_BORDER:8388608,WS_DLGFRAME:4194304,WS_VSCROLL:2097152,WS_HSCROLL:1048576,WS_SYSMENU:524288,WS_THICKFRAME:262144,WS_GROUP:131072,WS_TABSTOP:65536,WS_MINIMIZEBOX:131072,WS_MAXIMIZEBOX:65536};function TM($){return W0.symbols.GetWindowLongW(BigInt($),T4)}function IM($,J){return W0.symbols.SetWindowLongW(BigInt($),T4,gP[J])}var fP={WS_EX_DLGMODALFRAME:1,WS_EX_NOPARENTNOTIFY:4,WS_EX_TOPMOST:8,WS_EX_ACCEPTFILES:16,WS_EX_TRANSPARENT:32,WS_EX_MDICHILD:64,WS_EX_TOOLWINDOW:128,WS_EX_WINDOWEDGE:256,WS_EX_CLIENTEDGE:512,WS_EX_CONTEXTHELP:1024,WS_EX_RIGHT:4096,WS_EX_LEFT:0,WS_EX_RTLREADING:8192,WS_EX_LTRREADING:0,WS_EX_LEFTSCROLLBAR:16384,WS_EX_RIGHTSCROLLBAR:0,WS_EX_CONTROLPARENT:65536,WS_EX_STATICEDGE:131072,WS_EX_APPWINDOW:262144,WS_EX_LAYERED:524288,WS_EX_NOINHERITLAYOUT:1048576,WS_EX_NOREDIRECTIONBITMAP:2097152,WS_EX_LAYOUTRTL:4194304,WS_EX_COMPOSITED:33554432,WS_EX_NOACTIVATE:134217728};function _M($){return W0.symbols.GetWindowLongW(BigInt($),K7)}function yM($,J){return W0.symbols.SetWindowLongW(BigInt($),K7,fP[J])}function xM($){let J=BigInt($);if(W0.symbols.IsIconic(J))return-1;if(W0.symbols.IsZoomed(J))return 1;return 0}function M7(){let $=[],J=new w4((X,K)=>{if(W0.symbols.IsWindowVisible(X))$.push(X);return!0},{args:["u64","i64"],returns:"bool"});return W0.symbols.EnumWindows(J.ptr,0),J.close(),$}function hM(){return M7().length}function gM(){let $=M7();for(let J of $)W0.symbols.ShowWindow(J,$M)}function fM($){let J=p4($);if(!J)return"";let X=J.split("\\");return X[X.length-1]}function bM($){let J=q7($),X=m4($);for(let K of X){let q=q7(K);if(q)J+=`\r
`+q}return J}function mM($,J,X,K,q,Y=!0){let W=E6.symbols.CreateRectRgn(J,X,J+K,X+q);if(!W)return!1;return W0.symbols.SetWindowRgn(BigInt($),W,Y)!==0}function pM($,J,X,K,q,Y=!0){let W=E6.symbols.CreateEllipticRgn(J,X,J+K,X+q);if(!W)return!1;return W0.symbols.SetWindowRgn(BigInt($),W,Y)!==0}function uM($,J,X,K,q,Y,W,Q=!0){let N=E6.symbols.CreateRoundRectRgn(J,X,J+K,X+q,Y,W);if(!N)return!1;return W0.symbols.SetWindowRgn(BigInt($),N,Q)!==0}function lM($,J,X=1,K=!0){let q=new Int32Array(J.length*2);for(let W=0;W<J.length;W++)q[W*2]=J[W].x,q[W*2+1]=J[W].y;let Y=E6.symbols.CreatePolygonRgn(L6(q),J.length,X);if(!Y)return!1;return W0.symbols.SetWindowRgn(BigInt($),Y,K)!==0}function cM($,J=!0){return W0.symbols.SetWindowRgn(BigInt($),0,J)!==0}class dM{getActiveWindow=u9;getWindowTitle=q7;getWindowRect=W7;getClientRect=f4;getWindowSize=GM;getClientSize=OM;isWindowVisible=XM;isWindowMinimized=x4;isWindowMaximized=YM;isWindow=V7;setForeground=Q7;focusWindow=LM;findWindow=y4;waitForWindow=KM;waitForWindowClose=UM;getWindowProcessId=N7;getClassName=qM;getExtendedWindowInfo=b4;minimizeWindow=WM;maximizeWindow=QM;restoreWindow=h4;showWindow=NM;hideWindow=VM;closeWindow=MM;moveWindow=g4;enumWindows=jM;enumChildWindows=m4;flashWindow=EM;setOpacity=RM;setTopmost=BM;center=HM;setTitle=PM;setEnabled=SM;redraw=AM;moveToBottom=FM;moveToTop=zM;getProcessPath=p4;clientToScreen=CM;screenToClient=ZM;activate=vM;waitActive=DM;waitNotActive=kM;kill=wM;getStyle=TM;setStyle=IM;getExStyle=_M;setExStyle=yM;getMinMax=xM;getList=M7;getCount=hM;minimizeAll=gM;getProcessName=fM;getText=bM;setRegion={rect:mM,ellipse:pM,round:uM,polygon:lM,reset:cM}}var Gv=new dM;class nM{getScreenSize=l5;getMonitors=eV;capture=X7;getPixel=m9;getPixelHex=nV;checkPixel=p9;waitForPixel=oV;getMultiplePixels=rV;checkMultiplePixels=iV;waitForAnyPixel=sV;pixelSearch=aV;imageSearch=tV}var jv=new nM;export{Gv as window,RP as utils,jv as screen,d6 as mouse,S8 as keyboard,a0 as config};
