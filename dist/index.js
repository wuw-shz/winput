// @bun
var g={FAILSAFE:!1,FAILSAFE_POINTS:[[0,0]],PAUSE:!0,PAUSE_DELAY:0};import{dlopen as nt,FFIType as n,suffix as or}from"bun:ffi";var i=nt(`user32.${or}`,{SendInput:{args:[n.u32,n.ptr,n.i32],returns:n.u32},MapVirtualKeyW:{args:[n.u32,n.u32],returns:n.u32},GetCursorPos:{args:[n.ptr],returns:n.bool},GetKeyState:{args:[n.i32],returns:n.i16},GetAsyncKeyState:{args:[n.i32],returns:n.i16},SetWindowsHookExW:{args:[n.i32,n.ptr,n.ptr,n.u32],returns:n.ptr},UnhookWindowsHookEx:{args:[n.ptr],returns:n.bool},CallNextHookEx:{args:[n.ptr,n.i32,n.ptr,n.ptr],returns:n.ptr},GetDC:{args:[n.ptr],returns:n.u64},ReleaseDC:{args:[n.u64,n.u64],returns:n.int},GetDesktopWindow:{args:[],returns:n.ptr},GetForegroundWindow:{args:[],returns:n.u64},GetWindowTextW:{args:[n.u64,n.ptr,n.int],returns:n.int},GetWindowRect:{args:[n.u64,n.ptr],returns:n.bool},GetSystemMetrics:{args:[n.int],returns:n.int},SetLayeredWindowAttributes:{args:[n.u64,n.uint32_t,n.int8_t,n.uint32_t],returns:n.bool},UpdateLayeredWindow:{args:[n.ptr,n.ptr,n.ptr,n.ptr,n.ptr,n.ptr,n.uint32_t,n.ptr,n.uint32_t],returns:n.bool},GetWindowLongW:{args:[n.u64,n.int],returns:n.int},SetWindowLongW:{args:[n.u64,n.int,n.int],returns:n.int},CreateWindowExW:{args:[n.uint32_t,n.ptr,n.ptr,n.uint32_t,n.int,n.int,n.int,n.int,n.ptr,n.ptr,n.ptr,n.ptr],returns:n.ptr},ShowWindow:{args:[n.u64,n.int],returns:n.bool},UpdateWindow:{args:[n.u64],returns:n.bool},SetWindowPos:{args:[n.u64,n.u64,n.int,n.int,n.int,n.int,n.uint32_t],returns:n.bool},FindWindowA:{args:[n.ptr,n.ptr],returns:n.u64},FillRect:{args:[n.ptr,n.ptr,n.ptr],returns:n.int},IsWindow:{args:[n.u64],returns:n.bool},SetForegroundWindow:{args:[n.u64],returns:n.bool},IsWindowVisible:{args:[n.u64],returns:n.bool},GetWindowThreadProcessId:{args:[n.u64,n.ptr],returns:n.u32},MoveWindow:{args:[n.u64,n.int,n.int,n.int,n.int,n.bool],returns:n.bool},GetClientRect:{args:[n.u64,n.ptr],returns:n.bool},PostMessageA:{args:[n.u64,n.u32,n.u64,n.u64],returns:n.bool},GetClassNameA:{args:[n.u64,n.ptr,n.int],returns:n.int},SetWindowTextW:{args:[n.u64,n.ptr],returns:n.bool},EnableWindow:{args:[n.u64,n.bool],returns:n.bool},RedrawWindow:{args:[n.u64,n.ptr,n.u64,n.u32],returns:n.bool},ClientToScreen:{args:[n.u64,n.ptr],returns:n.bool},ScreenToClient:{args:[n.u64,n.ptr],returns:n.bool},SendMessageA:{args:[n.u64,n.u32,n.u64,n.u64],returns:n.ptr},IsIconic:{args:[n.u64],returns:n.bool},IsZoomed:{args:[n.u64],returns:n.bool},EnumWindows:{args:[n.function,n.i64],returns:n.bool},EnumChildWindows:{args:[n.u64,n.function,n.i64],returns:n.bool},FlashWindow:{args:[n.u64,n.bool],returns:n.bool},PrintWindow:{args:[n.u64,n.u64,n.u32],returns:n.bool},GetWindowDC:{args:[n.u64],returns:n.u64},LoadImageW:{args:[n.u64,n.ptr,n.uint32_t,n.int,n.int,n.uint32_t],returns:n.u64},SetWindowRgn:{args:[n.u64,n.u64,n.bool],returns:n.int}}),y=nt("gdi32.dll",{GetPixel:{args:[n.u64,n.int,n.int],returns:n.uint32_t},CreatePen:{args:[n.int,n.int,n.uint32_t],returns:n.u64},SelectObject:{args:[n.u64,n.u64],returns:n.u64},MoveToEx:{args:[n.u64,n.int,n.int,n.ptr],returns:n.bool},LineTo:{args:[n.u64,n.int,n.int],returns:n.bool},DeleteObject:{args:[n.u64],returns:n.bool},CreateCompatibleDC:{args:[n.u64],returns:n.u64},CreateDIBSection:{args:[n.ptr,n.ptr,n.uint32_t,n.ptr,n.ptr,n.uint32_t],returns:n.ptr},DeleteDC:{args:[n.u64],returns:n.bool},CreateSolidBrush:{args:[n.uint32_t],returns:n.u64},CreateCompatibleBitmap:{args:[n.u64,n.int,n.int],returns:n.u64},BitBlt:{args:[n.u64,n.int,n.int,n.int,n.int,n.u64,n.int,n.int,n.uint32_t],returns:n.bool},GetDIBits:{args:[n.u64,n.u64,n.u32,n.u32,n.ptr,n.ptr,n.u32],returns:n.int},GetObjectA:{args:[n.ptr,n.int,n.ptr],returns:n.int},CreateRectRgn:{args:[n.int,n.int,n.int,n.int],returns:n.u64},CreateEllipticRgn:{args:[n.int,n.int,n.int,n.int],returns:n.u64},CreateRoundRectRgn:{args:[n.int,n.int,n.int,n.int,n.int,n.int],returns:n.u64},CreatePolygonRgn:{args:[n.ptr,n.int,n.int],returns:n.u64}}),V=nt(`kernel32.${or}`,{GetLastError:{args:[],returns:n.u32},OpenProcess:{args:[n.u32,n.bool,n.u32],returns:n.u64},CloseHandle:{args:[n.u64],returns:n.bool},QueryFullProcessImageNameW:{args:[n.u64,n.u32,n.ptr,n.ptr],returns:n.bool},TerminateProcess:{args:[n.u64,n.u32],returns:n.bool},RtlMoveMemory:{args:[n.ptr,n.u64,n.u64],returns:n.void}}),O=nt("gdiplus.dll",{GdiplusStartup:{args:[n.ptr,n.ptr,n.ptr],returns:n.int},GdiplusShutdown:{args:[n.u64],returns:n.void},GdipCreateBitmapFromFile:{args:[n.ptr,n.ptr],returns:n.int},GdipGetImageWidth:{args:[n.u64,n.ptr],returns:n.int},GdipGetImageHeight:{args:[n.u64,n.ptr],returns:n.int},GdipBitmapLockBits:{args:[n.u64,n.ptr,n.uint32_t,n.int,n.ptr],returns:n.int},GdipBitmapUnlockBits:{args:[n.u64,n.ptr],returns:n.int},GdipDisposeImage:{args:[n.u64],returns:n.int},GdipCreateBitmapFromScan0:{args:[n.int,n.int,n.int,n.int,n.ptr,n.ptr],returns:n.int},GdipSaveImageToFile:{args:[n.u64,n.ptr,n.ptr,n.ptr],returns:n.int},GdipGetImageEncodersSize:{args:[n.ptr,n.ptr],returns:n.int},GdipGetImageEncoders:{args:[n.u32,n.u32,n.ptr],returns:n.int}});var Z=process.arch==="x64"||process.arch==="arm64";class bt extends Error{constructor(t){super(t);this.name="FailSafeException"}}var sr=Z?8:4;function ur(t=0,r=0,e=0,o=0,s=0,u=0n){let a=20+sr,f=Buffer.alloc(a);if(f.writeInt32LE(t,0),f.writeInt32LE(r,4),f.writeUInt32LE(e>>>0,8),f.writeUInt32LE(o>>>0,12),f.writeUInt32LE(s>>>0,16),Z)f.writeBigUInt64LE(BigInt(u),20);else f.writeUInt32LE(Number(u)>>>0,20);return f}function ar(t=0,r=0,e=0,o=0,s=0n){let u=12+sr,a=Buffer.alloc(u);if(a.writeUInt16LE(t&65535,0),a.writeUInt16LE(r&65535,2),a.writeUInt32LE(e>>>0,4),a.writeUInt32LE(o>>>0,8),Z)a.writeBigUInt64LE(BigInt(s),12);else a.writeUInt32LE(Number(s)>>>0,12);return Z?Buffer.concat([a,Buffer.alloc(32-a.length)]):a}function et(t,r){let e=Z?40:36,o=Buffer.alloc(e);return o.writeUInt32LE(t>>>0,0),r.copy(o,8,0,Math.min(32,r.length)),o}import{ptr as ne}from"bun:ffi";function R(){if(g.FAILSAFE){let t=_();for(let r of g.FAILSAFE_POINTS)if(t[0]===r[0]&&t[1]===r[1])throw new bt("fail-safe triggered from mouse moving to a corner of the screen. To disable this fail-safe, set config.FAILSAFE to false. DISABLING FAIL-SAFE IS NOT RECOMMENDED.")}}function F(t){if(t&&g.PAUSE_DELAY>0)Bun.sleepSync(g.PAUSE_DELAY*1000)}function fr(t=0,r=0){let[e,o]=[i.symbols.GetSystemMetrics(0),i.symbols.GetSystemMetrics(1)],s=Math.round(t*65535/(e-1)),u=Math.round(r*65535/(o-1)),a=Math.max(0,Math.min(65535,s)),f=Math.max(0,Math.min(65535,u));return[a,f]}function _(t,r){let e=new ArrayBuffer(8),o=new DataView(e);i.symbols.GetCursorPos(ne(e));let s=o.getInt32(0,!0),u=o.getInt32(4,!0);return[t??s,r??u]}var X={a:{scan:30},b:{scan:48},c:{scan:46},d:{scan:32},e:{scan:18},f:{scan:33},g:{scan:34},h:{scan:35},i:{scan:23},j:{scan:36},k:{scan:37},l:{scan:38},m:{scan:50},n:{scan:49},o:{scan:24},p:{scan:25},q:{scan:16},r:{scan:19},s:{scan:31},t:{scan:20},u:{scan:22},v:{scan:47},w:{scan:17},x:{scan:45},y:{scan:21},z:{scan:44},"0":{scan:11},"1":{scan:2},"2":{scan:3},"3":{scan:4},"4":{scan:5},"5":{scan:6},"6":{scan:7},"7":{scan:8},"8":{scan:9},"9":{scan:10},f1:{scan:59},f2:{scan:60},f3:{scan:61},f4:{scan:62},f5:{scan:63},f6:{scan:64},f7:{scan:65},f8:{scan:66},f9:{scan:67},f10:{scan:68},f11:{scan:87},f12:{scan:88},f13:{scan:100},f14:{scan:101},f15:{scan:102},f16:{scan:103},f17:{scan:104},f18:{scan:105},f19:{scan:106},f20:{scan:107},f21:{scan:108},f22:{scan:109},f23:{scan:110},f24:{scan:118},"-":{scan:12},minus:{scan:12},"=":{scan:13},equal:{scan:13},equals:{scan:13},"[":{scan:26},bracketleft:{scan:26},"]":{scan:27},bracketright:{scan:27},"\\":{scan:43},backslash:{scan:43},";":{scan:39},semicolon:{scan:39},"'":{scan:40},quote:{scan:40},apostrophe:{scan:40},"`":{scan:41},grave:{scan:41},backtick:{scan:41},",":{scan:51},comma:{scan:51},".":{scan:52},period:{scan:52},dot:{scan:52},"/":{scan:53},slash:{scan:53},forwardslash:{scan:53},space:{scan:57},enter:{scan:28},return:{scan:28},tab:{scan:15},backspace:{scan:14},escape:{scan:1},esc:{scan:1},shift:{scan:42},shiftleft:{scan:42},shiftright:{scan:54},ctrl:{scan:29},control:{scan:29},ctrlleft:{scan:29},controlleft:{scan:29},ctrlright:{scan:29,extended:!0},controlright:{scan:29,extended:!0},rctrl:{scan:29,extended:!0},alt:{scan:56},altleft:{scan:56},altright:{scan:56,extended:!0},ralt:{scan:56,extended:!0},altgr:{scan:56,extended:!0},win:{scan:91,extended:!0},winleft:{scan:91,extended:!0},windows:{scan:91,extended:!0},winright:{scan:92,extended:!0},windowsright:{scan:92,extended:!0},apps:{scan:93,extended:!0},menu:{scan:93,extended:!0},contextmenu:{scan:93,extended:!0},capslock:{scan:58},numlock:{scan:69},scrolllock:{scan:70},up:{scan:72,extended:!0},down:{scan:80,extended:!0},left:{scan:75,extended:!0},right:{scan:77,extended:!0},home:{scan:71,extended:!0},end:{scan:79,extended:!0},pageup:{scan:73,extended:!0},pagedown:{scan:81,extended:!0},insert:{scan:82,extended:!0},delete:{scan:83,extended:!0},del:{scan:83,extended:!0},numpad0:{scan:82},numpad1:{scan:79},numpad2:{scan:80},numpad3:{scan:81},numpad4:{scan:75},numpad5:{scan:76},numpad6:{scan:77},numpad7:{scan:71},numpad8:{scan:72},numpad9:{scan:73},numpaddecimal:{scan:83},numpadperiod:{scan:83},numpaddivide:{scan:53,extended:!0},numpadmultiply:{scan:55},numpadsubtract:{scan:74},numpadadd:{scan:78},numpadenter:{scan:28,extended:!0},volumeup:{scan:48,extended:!0},volumedown:{scan:46,extended:!0},volumemute:{scan:32,extended:!0},mute:{scan:32,extended:!0},playpause:{scan:34,extended:!0},stop:{scan:36,extended:!0},nexttrack:{scan:25,extended:!0},previoustrack:{scan:16,extended:!0},medianext:{scan:25,extended:!0},mediaprevious:{scan:16,extended:!0},mediaplaypause:{scan:34,extended:!0},mediastop:{scan:36,extended:!0},browserhome:{scan:50,extended:!0},browserback:{scan:106,extended:!0},browserforward:{scan:105,extended:!0},browserrefresh:{scan:103,extended:!0},browserstop:{scan:104,extended:!0},browsersearch:{scan:101,extended:!0},browserfavorites:{scan:102,extended:!0},mail:{scan:108,extended:!0},calculator:{scan:33,extended:!0},mycomputer:{scan:107,extended:!0},computer:{scan:107,extended:!0},printscreen:{scan:55,extended:!0},prtsc:{scan:55,extended:!0},pause:{scan:69,extended:!0},break:{scan:70},intl1:{scan:115},intl2:{scan:112},intl3:{scan:125},intl4:{scan:121},intl5:{scan:123},intl6:{scan:92},lang1:{scan:114},lang2:{scan:113},power:{scan:94,extended:!0},sleep:{scan:95,extended:!0},wake:{scan:99,extended:!0},help:{scan:59,extended:!0},undo:{scan:8,extended:!0},redo:{scan:7,extended:!0},cut:{scan:45,extended:!0},copy:{scan:46,extended:!0},paste:{scan:47,extended:!0},find:{scan:33,extended:!0},select:{scan:41,extended:!0},clear:{scan:76},num0:{scan:82},num1:{scan:79},num2:{scan:80},num3:{scan:81},num4:{scan:75},num5:{scan:76},num6:{scan:77},num7:{scan:71},num8:{scan:72},num9:{scan:73}},At=new Map([["!","1"],["@","2"],["#","3"],["$","4"],["%","5"],["^","6"],["&","7"],["*","8"],["(","9"],[")","0"],["_","-"],["+","="],["{","["],["}","]"],["|","\\"],[":",";"],['"',"'"],["<",","],[">","."],["?","/"],["~","`"]]);var Bt=1,ir=32768,yt=2,Pt=4;var Gt=8,St=16;var Ft=32,Nt=64;var Ot=128,Kt=256,pr=1,lr=2,cr=1,xr=2,Tt=8;function Er(t,r,e,o=0){let s=e|(r?cr:0),u=ar(0,t,s,o,0n),a=et(1,u);i.symbols.SendInput(1,a,40)}function Y(t,r=g.PAUSE){let{scan:e,extended:o}=X[t];if(Er(e,!!o,Tt),r)F(r);return D}function L(t,r=g.PAUSE){let{scan:e,extended:o}=X[t],s=Tt|xr;if(Er(e,!!o,s),r)F(r);return D}function H(t,r=g.PAUSE){return Y(t,r),L(t,r),D}function mr(t,r=1,e=0,o=g.PAUSE){for(let s=0;s<r;s++)if(Y(t,o),L(t,o),e>0)Bun.sleepSync(e);return D}function Ir(t,r=0,e=g.PAUSE){for(let o of t){if(o>="A"&&o<="Z"){let s=o.toLowerCase();Y("shift",e),H(s,e),L("shift",e)}else if(At.has(o)){let s=At.get(o);Y("shift",e),H(s,e),L("shift",e)}else H(o,e);if(r>0)Bun.sleepSync(r)}return D}function $(t){let{scan:r}=X[t],e;if(r>1024){let s=r-1024;e=i.symbols.MapVirtualKeyW(s,1)}else e=i.symbols.MapVirtualKeyW(r,1);return(i.symbols.GetAsyncKeyState(e)&32768)!==0}function Mr(t){return t.some((r)=>$(r))}function Ur(t){return t.every((r)=>$(r))}function gr(t,r=g.PAUSE){for(let e of t)Y(e,r);for(let e=t.length-1;e>=0;e--)L(t[e],r);return D}function br(t,r,e=g.PAUSE){if(Y(t,!1),Bun.sleepSync(r),L(t,!1),e)F(e);return D}function Ar(t,r){return new Promise((e)=>{let s=0,u=setInterval(()=>{if($(t)){clearInterval(u),e(!0);return}if(r){if(s+=8,s>=r)clearInterval(u),e(!1)}},8)})}function Br(t,r){return new Promise((e)=>{let s=0,u=setInterval(()=>{if(!$(t)){clearInterval(u),e(!0);return}if(r){if(s+=8,s>=r)clearInterval(u),e(!1)}},8)})}function yr(t,r=g.PAUSE){return H(t,r),D}function Pr(t){let{scan:r}=X[t],e;if(r>1024){let u=r-1024;e=i.symbols.MapVirtualKeyW(u,1)}else e=i.symbols.MapVirtualKeyW(r,1);let o=i.symbols.GetAsyncKeyState(e),s=i.symbols.GetKeyState(e);return{isPressed:(o&32768)!==0,isToggled:(s&1)!==0}}function Gr(t=g.PAUSE){let r=["shift","shiftleft","shiftright","ctrl","ctrlleft","ctrlright","alt","altleft","altright","win","winleft","winright"],e="abcdefghijklmnopqrstuvwxyz".split("");r.push(...e);for(let o of r)if($(o))L(o,t);return D}class z{listeners=new Map;isRunning=!1;startPromise=null;on(t,r){if(!this.listeners.has(t))this.listeners.set(t,new Set);this.listeners.get(t).add(r)}off(t,r){this.listeners.get(t)?.delete(r)}once(t,r){let e=(o)=>{try{r(o)}finally{this.off(t,e)}};this.on(t,e)}_emit(t,r){this.listeners.get(t)?.forEach((e)=>{try{e(r)}catch(o){console.error(`Listener error [${String(t)}]:`,o)}})}async start(t=8){if(this.isRunning)return console.warn("Listener already running"),this.startPromise??Promise.resolve();return this.isRunning=!0,this.startPromise=(async()=>{try{await this.run(t)}catch(r){console.error("Listener run error:",r)}finally{this.isRunning=!1,this.startPromise=null}})(),this.startPromise}async stop(){if(this.isRunning=!1,this.startPromise)await this.startPromise}}var Sr={};for(let[t,r]of Object.entries(X))Sr[r.scan&4095]=t;var oe=new Set([1,2,4,5,6]),se={112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",13:"enter",16:"shift",17:"ctrl",18:"alt",9:"tab",20:"capslock",27:"escape",32:"space"};class kt extends z{async run(t=8){console.log("Keyboard listener started.");let r=Array(256).fill(!1),e=Array.from({length:256},(o,s)=>s);while(this.isRunning){for(let o of e){if(oe.has(o))continue;let s=i.symbols.GetAsyncKeyState(o),u=(s&32768)!==0,a=(s&1)!==0,f=se[o];if(!f){let p=i.symbols.MapVirtualKeyW(o,0);f=Sr[p]}if(!f)if(o>=48&&o<=57)f=String.fromCharCode(o);else if(o>=65&&o<=90)f=String.fromCharCode(o).toLowerCase();else continue;if(u!==r[o]){r[o]=u;let p={event:u?"down":"up",name:f,vk_code:o,isKeyDown:u};this._emit(u?"down":"up",p)}else if(!u&&a&&!r[o]){let p={event:"down",name:f,vk_code:o,isKeyDown:!0},l={event:"up",name:f,vk_code:o,isKeyDown:!1};this._emit("down",p),this._emit("up",l)}}await Bun.sleep(t)}console.log("Keyboard listener stopped.")}}class Fr{press=Y;release=L;tap=H;repeatTap=mr;write=Ir;isPressed=$;hotkey=gr;hold=br;isAnyPressed=Mr;areAllPressed=Ur;waitForPress=Ar;waitForRelease=Br;toggleKey=yr;getKeyState=Pr;releaseAll=Gr;listener=new kt}var D=new Fr;var K="left",ot="right",J="middle",Vt="x1",_t="x2";var ue=2048,ae=4096,fe=120,ie={[K]:{down:yt,up:Pt,data:0},[J]:{down:Ft,up:Nt,data:0},[ot]:{down:Gt,up:St,data:0},[Vt]:{down:Ot,up:Kt,data:pr},[_t]:{down:Ot,up:Kt,data:lr}};function Nr(t,r){let e=ie[t];if(!e)throw Error(`Invalid button: ${t}`);return{event:e[r],mouseData:e.data}}function pe(t,r){if(t!==void 0){if(!Number.isFinite(t))throw Error(`Invalid x coordinate: ${t}`);if(t<0)throw Error(`x coordinate must be non-negative: ${t}`)}if(r!==void 0){if(!Number.isFinite(r))throw Error(`Invalid y coordinate: ${r}`);if(r<0)throw Error(`y coordinate must be non-negative: ${r}`)}}function j(t,r,e,o,s=0){let u=ur(t,r,e,o,s,0n),a=et(0,u);i.symbols.SendInput(1,a,40)}function st(t=K,r=g.PAUSE){try{let{event:e,mouseData:o}=Nr(t,"down");if(j(0,0,o,e,0),r)F(r);return N}catch(e){throw console.error("[Mouse Press Error]",e),e}}function ut(t=K,r=g.PAUSE){try{let{event:e,mouseData:o}=Nr(t,"up");if(j(0,0,o,e,0),r)F(r);return N}catch(e){throw console.error("[Mouse Release Error]",e),e}}function Dt(t=K,r=1,e=0,o=g.PAUSE){if([K,J,ot].includes(t)){let s=0,u=0;if(t===K)s=yt,u=Pt;else if(t===J)s=Ft,u=Nt;else s=Gt,u=St;for(let a=0;a<r;a++)if(R(),j(0,0,0,s,0),j(0,0,0,u,0),e>0)Bun.sleepSync(Math.round(e*1000))}if(o)F(o);return N}function C(t,r,e=!1,o=g.PAUSE){try{if(R(),pe(t,r),!e){let[s,u]=_(t,r),[a,f]=fr(s,u);if(j(a,f,0,Bt|ir,0),o)F(o)}else Rt(t??0,r??0,!0,o);return N}catch(s){throw console.error("[Mouse MoveTo Error]",s),s}}function Rt(t=0,r=0,e=!1,o=g.PAUSE){if(R(),!e){let[s,u]=_();C(s+t,u+r,!1,o)}else if(j(t,r,0,Bt,0),o)F(o);return N}function at(t){let r;if(t===K)r=1;else if(t===ot)r=2;else if(t===J)r=4;else if(t===Vt)r=5;else if(t===_t)r=6;else throw Error(`Invalid button: ${t}`);return(i.symbols.GetAsyncKeyState(r)&32768)!==0}function Lt(t,r,e=K,o=0.5,s=g.PAUSE){R();let[u,a]=_();if(st(e,s),o<=0)C(t,r,!1,s);else{let f=Math.max(10,Math.floor(o*100)),p=o/f;for(let l=1;l<=f;l++){let c=l/f,E=Math.round(u+(t-u)*c),m=Math.round(a+(r-a)*c);C(E,m,!1,!1),Bun.sleepSync(Math.round(p*1000))}}return ut(e,s),N}function Or(t,r,e=K,o=0.5,s=g.PAUSE){let[u,a]=_();return Lt(u+t,a+r,e,o,s)}function Kr(t,r="vertical",e=g.PAUSE){R();let o=t*fe;if(j(0,0,o,r==="vertical"?ue:ae,0),e)F(e);return N}var le={linear:(t)=>t,easeInQuad:(t)=>t*t,easeOutQuad:(t)=>t*(2-t),easeInOutQuad:(t)=>t<0.5?2*t*t:-1+(4-2*t)*t,easeInCubic:(t)=>t*t*t,easeOutCubic:(t)=>--t*t*t+1,easeInOutCubic:(t)=>t<0.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1};async function Tr(t,r,e=0.5,o="easeOutQuad",s=g.PAUSE){R();let[u,a]=_(),f=le[o];if(e<=0)return C(t,r,!1,s),N;let p=Math.max(10,Math.floor(e*100)),l=e/p;for(let c=1;c<=p;c++){let E=c/p,m=f(E),x=Math.round(u+(t-u)*m),I=Math.round(a+(r-a)*m);C(x,I,!1,!1),Bun.sleepSync(Math.round(l*1000))}if(s)F(s);return N}function kr(t,r,e=g.PAUSE){if(R(),st(t,!1),Bun.sleepSync(Math.round(r*1000)),ut(t,!1),e)F(e);return N}function Vr(t,r,e=K,o=g.PAUSE){return R(),C(t,r,!1,o),Dt(e,1,0,o),N}function vt(t,r,e=0){let[o,s]=_(),u=Math.abs(o-t),a=Math.abs(s-r);return u<=e&&a<=e}function _r(t,r,e,o=0){return new Promise((s)=>{let a=0,f=setInterval(()=>{if(vt(t,r,o)){clearInterval(f),s(!0);return}if(e!==void 0){if(a+=8,a>=e)clearInterval(f),s(!1)}},8)})}async function Dr(t,r){return new Promise((e)=>{let s=0,u=setInterval(()=>{if(at(t)){clearInterval(u),e(!0);return}if(r!==void 0){if(s+=8,s>=r)clearInterval(u),e(!1)}},8)})}async function Rr(t,r){return new Promise((e)=>{let s=0,u=setInterval(()=>{if(!at(t)){clearInterval(u),e(!0);return}if(r!==void 0){if(s+=8,s>=r)clearInterval(u),e(!1)}},8)})}import{ptr as xe}from"bun:ffi";class Yt extends z{async run(t=8){console.log("Mouse listener started.");let r=new ArrayBuffer(8),e=new DataView(r),o={x:0,y:0},s={left:!1,right:!1,middle:!1,x1:!1,x2:!1};while(this.isRunning){i.symbols.GetCursorPos(xe(r));let u=e.getInt32(0,!0),a=e.getInt32(4,!0);if(u!==o.x||a!==o.y){let l={event:"move",x:u,y:a,lastX:o.x,lastY:o.y,deltaX:u-o.x,deltaY:a-o.y};this._emit("move",l),o.x=u,o.y=a}let f={left:i.symbols.GetAsyncKeyState(1),right:i.symbols.GetAsyncKeyState(2),middle:i.symbols.GetAsyncKeyState(4),x1:i.symbols.GetAsyncKeyState(5),x2:i.symbols.GetAsyncKeyState(6)},p=Object.fromEntries(Object.entries(f).map(([l,c])=>[l,(c&32768)!==0]));for(let l of Object.keys(s))if(p[l]!==s[l]){s[l]=p[l];let c={event:p[l]?"down":"up",button:l,x:o.x,y:o.y};this._emit(p[l]?"down":"up",c)}await Bun.sleep(t)}console.log("Mouse listener stopped.")}}class Lr{get position(){let t=_();return{x:t[0],y:t[1]}}press=st;release=ut;click=Dt;moveTo=C;moveRel=Rt;isPressed=at;dragTo=Lt;dragRel=Or;scroll=Kr;smoothMoveTo=Tr;hold=kr;clickAt=Vr;isAtPosition=vt;waitForPosition=_r;waitForPress=Dr;waitForRelease=Rr;listener=new Yt}var N=new Lr;import{ptr as P}from"bun:ffi";import{extname as vr}from"path";var Yr=null;function Cr(){if(Yr)return;let t=new Uint8Array(24);new DataView(t.buffer).setUint32(0,1,!0);let e=new BigUint64Array(1),o=O.symbols.GdiplusStartup(P(e),P(t),null);if(o!==0)throw Error(`GdiplusStartup failed: ${o}`);Yr=e[0]}async function ft(t){try{Cr();let r=Buffer.from(t+"\x00","utf16le"),e=new BigUint64Array(1),o=O.symbols.GdipCreateBitmapFromFile(P(r),P(e));if(o!==0)return console.error(`GdipCreateBitmapFromFile failed: ${o} for ${t}`),null;let s=e[0];try{let u=new Uint32Array(1),a=new Uint32Array(1);O.symbols.GdipGetImageWidth(s,P(u)),O.symbols.GdipGetImageHeight(s,P(a));let f=u[0],p=a[0],l=2498570,c=new Uint32Array([0,0,f,p]),E=new Uint8Array(40),m=O.symbols.GdipBitmapLockBits(s,P(c),1,l,P(E));if(m!==0)return console.error(`GdipBitmapLockBits failed: ${m}`),null;try{let x=new DataView(E.buffer),I=x.getBigUint64(16,!0),M=x.getInt32(8,!0),U=f*p*4,b=new Uint8Array(U);if(M===f*4)V.symbols.RtlMoveMemory(P(b),I,BigInt(U));else for(let S=0;S<p;S++){let A=I+BigInt(S*M),G=P(b)+S*f*4;V.symbols.RtlMoveMemory(G,A,BigInt(f*4))}return new w({path:t,width:f,height:p,data:b})}finally{O.symbols.GdipBitmapUnlockBits(s,P(E))}}finally{O.symbols.GdipDisposeImage(s)}}catch(r){return console.error(`GDI Load Image Error: ${r}`),null}}function Ee(t){let r=new Uint8Array(16),e=new DataView(r.buffer);switch(t){case"png":e.setUint32(0,1434252294,!0),e.setUint16(4,6660,!0),e.setUint16(6,4563,!0),r.set([154,115,0,0,248,30,243,46],8);break;case"jpg":e.setUint32(0,1434252289,!0),e.setUint16(4,6660,!0),e.setUint16(6,4563,!0),r.set([154,115,0,0,248,30,243,46],8);break;case"jpeg":e.setUint32(0,1434252289,!0),e.setUint16(4,6660,!0),e.setUint16(6,4563,!0),r.set([154,115,0,0,248,30,243,46],8);break;case"bmp":e.setUint32(0,1434252288,!0),e.setUint16(4,6660,!0),e.setUint16(6,4563,!0),r.set([154,115,0,0,248,30,243,46],8);break;case"webp":e.setUint32(0,1434252290,!0),e.setUint16(4,6660,!0),e.setUint16(6,4563,!0),r.set([154,115,0,0,248,30,243,46],8);break;case"gif":e.setUint32(0,1434252291,!0),e.setUint16(4,6660,!0),e.setUint16(6,4563,!0),r.set([154,115,0,0,248,30,243,46],8);break;case"tiff":e.setUint32(0,1434252292,!0),e.setUint16(4,6660,!0),e.setUint16(6,4563,!0),r.set([154,115,0,0,248,30,243,46],8);break;case"ico":e.setUint32(0,1434252293,!0),e.setUint16(4,6660,!0),e.setUint16(6,4563,!0),r.set([154,115,0,0,248,30,243,46],8);break;case"heic":e.setUint32(0,1434252294,!0),e.setUint16(4,6660,!0),e.setUint16(6,4563,!0),r.set([154,115,0,0,248,30,243,46],8);break;case"heif":e.setUint32(0,1434252295,!0),e.setUint16(4,6660,!0),e.setUint16(6,4563,!0),r.set([154,115,0,0,248,30,243,46],8);break;case"avif":e.setUint32(0,1434252296,!0),e.setUint16(4,6660,!0),e.setUint16(6,4563,!0),r.set([154,115,0,0,248,30,243,46],8);break;case"svg":e.setUint32(0,1434252297,!0),e.setUint16(4,6660,!0),e.setUint16(6,4563,!0),r.set([154,115,0,0,248,30,243,46],8);break;case"raw":e.setUint32(0,1434252298,!0),e.setUint16(4,6660,!0),e.setUint16(6,4563,!0),r.set([154,115,0,0,248,30,243,46],8);break;default:throw Error(`Unsupported format: ${t}`)}return r}async function Ct(t,r){try{Cr();let{width:e,height:o,data:s}=t,u=e*4,a=2498570,f=new BigUint64Array(1),p=O.symbols.GdipCreateBitmapFromScan0(e,o,u,a,P(s),P(f));if(p!==0)return console.error(`GdipCreateBitmapFromScan0 failed: ${p}`),!1;let l=f[0];try{let c=r||t.path;if(!vr(c))return console.error(`Invalid path: "${c}" required file extension: png, jpg, jpeg, bmp, webp, gif, tiff, ico, heic, heif, avif, svg, raw`),!1;let E=Ee(vr(c).replace(".","")),m=Buffer.from(c+"\x00","utf16le"),x=O.symbols.GdipSaveImageToFile(l,P(m),P(E),null);if(x!==0)return console.error(`GdipSaveImageToFile failed: ${x}`),!1;return!0}finally{O.symbols.GdipDisposeImage(l)}}catch(e){return console.error(`GDI Save Image Error: ${e}`),!1}}function Xr(t){return{path:t.path,width:t.width,height:t.height,data:new Uint8Array(t.data)}}function $t(t){let{path:r,width:e,height:o,data:s}=t,u=new Uint8Array(s.length);for(let a=0;a<s.length;a+=4){let f=s[a],p=s[a+1],l=s[a+2],c=s[a+3],E=0.2126*l+0.7152*p+0.0722*f,m=Math.min(255,Math.max(0,E));u[a]=m,u[a+1]=m,u[a+2]=m,u[a+3]=c}return{path:r,width:e,height:o,data:u}}function $r(t,r){let{path:e,width:o,height:s,data:u}=t,a=new Uint8Array(u.length),f=r*255;for(let p=0;p<u.length;p+=4){for(let l=0;l<3;l++)a[p+l]=Math.min(255,Math.max(0,u[p+l]+f));a[p+3]=u[p+3]}return{path:e,width:o,height:s,data:a}}function jr(t,r){let{path:e,width:o,height:s,data:u}=t,a=new Uint8Array(u.length);for(let f=0;f<u.length;f+=4){for(let p=0;p<3;p++){let l=u[f+p],c=r*(l-128)+128;a[f+p]=Math.min(255,Math.max(0,c))}a[f+3]=u[f+3]}return{path:e,width:o,height:s,data:a}}function Xt(t,r,e){let{path:o,width:s,height:u,data:a}=t,f=new Uint8Array(a.length),p=Math.floor(e/2);for(let l=0;l<u;l++)for(let c=0;c<s;c++){let E=0,m=0,x=0;for(let M=0;M<e;M++)for(let U=0;U<e;U++){let b=Math.min(s-1,Math.max(0,c+U-p)),A=(Math.min(u-1,Math.max(0,l+M-p))*s+b)*4,G=r[M*e+U];x+=a[A]*G,m+=a[A+1]*G,E+=a[A+2]*G}let I=(l*s+c)*4;f[I]=Math.min(255,Math.max(0,x)),f[I+1]=Math.min(255,Math.max(0,m)),f[I+2]=Math.min(255,Math.max(0,E)),f[I+3]=a[I+3]}return{path:o,width:s,height:u,data:f}}function Wr(t,r=1){if(r===1)return Xt(t,[0.0625,0.125,0.0625,0.125,0.25,0.125,0.0625,0.125,0.0625],3);let e=[1,4,7,4,1,4,16,26,16,4,7,26,41,26,7,4,16,26,16,4,1,4,7,4,1].map((o)=>o/273);return Xt(t,e,5)}function Hr(t){return Xt(t,[0,-1,0,-1,5,-1,0,-1,0],3)}function dr(t){let r=$t(t),{path:e,width:o,height:s,data:u}=r,a=new Uint8Array(u.length),f=[-1,0,1,-2,0,2,-1,0,1],p=[-1,-2,-1,0,0,0,1,2,1];for(let l=1;l<s-1;l++)for(let c=1;c<o-1;c++){let E=0,m=0;for(let U=-1;U<=1;U++)for(let b=-1;b<=1;b++){let S=((l+U)*o+(c+b))*4,A=u[S+1];E+=A*f[(U+1)*3+(b+1)],m+=A*p[(U+1)*3+(b+1)]}let x=Math.sqrt(E*E+m*m),I=Math.min(255,Math.max(0,x)),M=(l*o+c)*4;a[M]=I,a[M+1]=I,a[M+2]=I,a[M+3]=255}return{path:e,width:o,height:s,data:a}}function it(t,r=1){let{path:e,width:o,height:s,data:u}=t,a=new Uint8Array(u.length);for(let f=3;f<u.length;f+=4)a[f]=u[f];for(let f=0;f<s;f++)for(let p=0;p<o;p++){let l=0,c=0,E=0;for(let x=-r;x<=r;x++)for(let I=-r;I<=r;I++){let M=f+x,U=p+I;if(M>=0&&M<s&&U>=0&&U<o){let b=(M*o+U)*4;E=Math.max(E,u[b]),c=Math.max(c,u[b+1]),l=Math.max(l,u[b+2])}}let m=(f*o+p)*4;a[m]=E,a[m+1]=c,a[m+2]=l}return{path:e,width:o,height:s,data:a}}function pt(t,r=1){let{path:e,width:o,height:s,data:u}=t,a=new Uint8Array(u.length);for(let f=3;f<u.length;f+=4)a[f]=u[f];for(let f=0;f<s;f++)for(let p=0;p<o;p++){let l=255,c=255,E=255;for(let x=-r;x<=r;x++)for(let I=-r;I<=r;I++){let M=f+x,U=p+I;if(M>=0&&M<s&&U>=0&&U<o){let b=(M*o+U)*4;E=Math.min(E,u[b]),c=Math.min(c,u[b+1]),l=Math.min(l,u[b+2])}}let m=(f*o+p)*4;a[m]=E,a[m+1]=c,a[m+2]=l}return{path:e,width:o,height:s,data:a}}function Qr(t,r=1){return it(pt(t,r),r)}function qr(t,r=1){return pt(it(t,r),r)}function Zr(t){let{data:r}=t,e=[];for(let o=0;o<r.length;o+=4)e.push([r[o+2],r[o+1],r[o],r[o+3]]);return e}class w{img;width;height;data;path;constructor(t){this.img=t;this.path=t.path,this.width=t.width,this.height=t.height,this.data=t.data}clone(){return new w(Xr(this.img))}grayscale(){return this.img=$t(this.img),this}brightness(t){return this.img=$r(this.img,t),this}contrast(t){return this.img=jr(this.img,t),this}blur(t=1){return this.img=Wr(this.img,t),this}sharpen(){return this.img=Hr(this.img),this}edges(){return this.img=dr(this.img),this}dilate(t=1){return this.img=it(this.img,t),this}erode(t=1){return this.img=pt(this.img,t),this}open(t=1){return this.img=Qr(this.img,t),this}close(t=1){return this.img=qr(this.img,t),this}async save(t){return Ct(this.img,t)}toPixels(){return Zr(this.img)}}class zr{load=ft;save=Ct;process(t){return new w(t)}}var _o=new zr;import{ptr as B,JSCallback as dt}from"bun:ffi";import{ptr as wr}from"bun:ffi";function jt(t){let r=(e)=>e.toString(16).padStart(2,"0");return`#${r(t.r)}${r(t.g)}${r(t.b)}`.toUpperCase()}function Wt(t){let r=t.replace("#","");return{r:parseInt(r.substring(0,2),16),g:parseInt(r.substring(2,4),16),b:parseInt(r.substring(4,6),16)}}function Jr(t,r){return Math.sqrt(Math.pow(t.r-r.r,2)+Math.pow(t.g-r.g,2)+Math.pow(t.b-r.b,2))}function Ht(t,r,e){return Jr(t,r)<=e}function Me(t,r){return t.x>=r.left&&t.x<=r.right&&t.y>=r.top&&t.y<=r.bottom}var Ue={rgbToHex:jt,hexToRgb:Wt,colorDistance:Jr,isColorSimilar:Ht,pointInRect:Me};var d=null,hr=0;function ge(){if(d&&Date.now()-hr<1000)return d;if(d)i.symbols.ReleaseDC(null,d);return d=i.symbols.GetDC(null),hr=Date.now(),d}function Q(){return{width:i.symbols.GetSystemMetrics(0),height:i.symbols.GetSystemMetrics(1)}}function h(t,r){let e=ge();if(!e)return null;let o=y.symbols.GetPixel(e,t,r);return{r:o&255,g:o>>8&255,b:o>>16&255}}function tn(t,r){let e=h(t,r);if(!e)return null;return jt(e)}function tt(t,r,e,o=0){let s=h(t,r);if(!s)return!1;return Ht(s,e,o)}function rn(t,r,e,o=0,s){return new Promise((u)=>{let a=0,f=setInterval(()=>{if(tt(t,r,e,o)){clearInterval(f),u(!0);return}if(s&&(a+=50)>=s)clearInterval(f),u(!1)},50)})}function nn(t){return t.map((r)=>h(r.x,r.y))}function en(t){return t.every((r)=>tt(r.x,r.y,r.target,r.tolerance??0))}function on(t,r){return new Promise((e)=>{let o=0,s=setInterval(()=>{for(let u=0;u<t.length;u++){let a=t[u];if(tt(a.x,a.y,a.target,a.tolerance??0)){clearInterval(s),e(u);return}}if(r&&(o+=50)>=r)clearInterval(s),e(-1)},50)})}function sn(t,r,e,o,s,u=0){let a=Math.min(t,e),f=Math.min(r,o),p=Math.max(t,e),l=Math.max(r,o),c=p-a+1,E=l-f+1,m=lt(a,f,c,E);if(!m)return null;let x;if(typeof s==="string")x=Wt(s);else if(typeof s==="number")x={r:s>>16&255,g:s>>8&255,b:s&255};else x=s;for(let I=0;I<E;I++)for(let M=0;M<c;M++){let U=(I*c+M)*4,b=m[U],S=m[U+1],A=m[U+2];if(u===0){if(A===x.r&&S===x.g&&b===x.b)return{x:a+M,y:f+I}}else if(Math.abs(A-x.r)<=u&&Math.abs(S-x.g)<=u&&Math.abs(b-x.b)<=u)return{x:a+M,y:f+I}}return null}async function un(t,r,e,o,s,u=0){let a=await ft(s);if(!a)return null;let f=Math.min(t,e),p=Math.min(r,o),l=Math.max(t,e),c=Math.max(r,o),E=l-f+1,m=c-p+1,x=lt(f,p,E,m);if(!x)return null;let{width:I,height:M}=a,U=E,b=m;if(I>U||M>b)return null;let S=(A,G,T,k,W,v)=>{if(u===0)return A===k&&G===W&&T===v;return Math.abs(A-k)<=u&&Math.abs(G-W)<=u&&Math.abs(T-v)<=u};for(let A=0;A<=b-M;A++)for(let G=0;G<=U-I;G++){let T=(A*U+G)*4,k=0;if(!S(x[T+2],x[T+1],x[T],a.data[k+2],a.data[k+1],a.data[k]))continue;let W=!0;for(let v=0;v<M;v++){for(let q=0;q<I;q++){if(v===0&&q===0)continue;if(T=((A+v)*U+(G+q))*4,k=(v*I+q)*4,!S(x[T+2],x[T+1],x[T],a.data[k+2],a.data[k+1],a.data[k])){W=!1;break}}if(!W)break}if(W)return{x:f+G,y:p+A}}return null}function lt(t=0,r=0,e,o){let s=e||i.symbols.GetSystemMetrics(0),u=o||i.symbols.GetSystemMetrics(1),a=i.symbols.GetDC(null);if(!a)return null;let f=y.symbols.CreateCompatibleDC(a);if(!f)return i.symbols.ReleaseDC(null,a),null;let p=y.symbols.CreateCompatibleBitmap(a,s,u);if(!p)return i.symbols.ReleaseDC(null,a),y.symbols.DeleteDC(f),null;let l=y.symbols.SelectObject(f,p),c=y.symbols.BitBlt(f,0,0,s,u,a,t,r,13369376),E=null;if(c){let m=s*u*4;E=new Uint8Array(m);let x=new Uint8Array(40),I=new DataView(x.buffer);if(I.setInt32(0,40,!0),I.setInt32(4,s,!0),I.setInt32(8,-u,!0),I.setInt16(12,1,!0),I.setInt16(14,32,!0),I.setInt32(16,0,!0),y.symbols.GetDIBits(f,p,0,u,wr(E),wr(x),0)===0)E=null}if(l)y.symbols.SelectObject(f,l);return y.symbols.DeleteObject(p),y.symbols.DeleteDC(f),i.symbols.ReleaseDC(null,a),E}function an(){let t=i.symbols.GetSystemMetrics(78),r=i.symbols.GetSystemMetrics(79),e=i.symbols.GetSystemMetrics(76),o=i.symbols.GetSystemMetrics(77);return[{rect:{left:e,top:o,right:e+t,bottom:o+r},isPrimary:!0}]}var fn=6,Ae=1,Be=0,ye=1,Pe=4,Ge=256,Se=4096,Fe=3,Ne=9,Oe=0,Ke=5,Te=16,Qt=-16,ct=-20,ke=524288;var Ve=2,_e=-1,De=-2,qt=2,Zt=1;var Et=new TextDecoder("utf-16le"),pn=new TextDecoder("ascii");function rt(){let t=i.symbols.GetForegroundWindow();if(!t)return null;let r=new Uint16Array(256),e=i.symbols.GetWindowTextW(t,B(r),256),o=e>0?Et.decode(r.subarray(0,e)):"",s=new Int32Array(4);if(!i.symbols.GetWindowRect(t,B(s)))return null;let u={left:s[0],top:s[1],right:s[2],bottom:s[3]},a=Q(),f=u.left===0&&u.top===0&&u.right-u.left===a.width&&u.bottom-u.top===a.height&&(i.symbols.GetWindowLongW(t,-16)&12845056)===0;return{hwnd:t,title:o,rect:u,isFullscreen:f}}function xt(t){let r=t!==void 0?BigInt(t):i.symbols.GetForegroundWindow();if(!r)return"";let e=new Uint16Array(256),o=i.symbols.GetWindowTextW(r,B(e),256);return o>0?Et.decode(e.subarray(0,o)):""}function mt(t){let r=new Int32Array(4);if(!i.symbols.GetWindowRect(BigInt(t),B(r)))return null;return{left:r[0],top:r[1],right:r[2],bottom:r[3]}}function ln(t){return i.symbols.IsWindowVisible(BigInt(t))}function It(t){return i.symbols.SetForegroundWindow(BigInt(t))}function zt(t){let r=new TextEncoder().encode(t+"\x00"),e=i.symbols.FindWindowA(null,B(r));return e?e:null}function cn(t,r){return new Promise((e)=>{let o=0,s=setInterval(()=>{let u=zt(t);if(u){clearInterval(s),e(u);return}if(r&&(o+=100)>=r)clearInterval(s),e(null)},100)})}function Mt(t){let r=new Uint32Array(1);return i.symbols.GetWindowThreadProcessId(BigInt(t),B(r)),r[0]}function xn(t){let r=new Uint8Array(256),e=i.symbols.GetClassNameA(BigInt(t),B(r),256);return e>0?pn.decode(r.subarray(0,e)):""}function Jt(t){return i.symbols.IsIconic(BigInt(t))}function En(t){return i.symbols.IsZoomed(BigInt(t))}function mn(t){return i.symbols.ShowWindow(BigInt(t),fn)}function In(t){return i.symbols.ShowWindow(BigInt(t),Fe)}function wt(t){return i.symbols.ShowWindow(BigInt(t),Ne)}function Mn(t){return i.symbols.ShowWindow(BigInt(t),Ke)}function Un(t){return i.symbols.ShowWindow(BigInt(t),Oe)}function gn(t){return i.symbols.PostMessageA(BigInt(t),Te,null,null)}function ht(t,r,e,o,s,u=!0){return i.symbols.MoveWindow(BigInt(t),r,e,o,s,u)}function bn(t){let r=mt(t);if(!r)return!1;let e=r.right-r.left,o=r.bottom-r.top,s=Q(),u=Math.floor((s.width-e)/2),a=Math.floor((s.height-o)/2);return ht(t,u,a,e,o,!0)}function tr(t){let r=new Int32Array(4);if(!i.symbols.GetClientRect(BigInt(t),B(r)))return null;return{left:r[0],top:r[1],right:r[2],bottom:r[3]}}function An(t){let r=mt(t);if(!r)return null;return{width:r.right-r.left,height:r.bottom-r.top}}function Bn(t){let r=tr(t);if(!r)return null;return{width:r.right-r.left,height:r.bottom-r.top}}function Ut(t){return i.symbols.IsWindow(BigInt(t))}function rr(t){if(!Ut(t))return null;let r=BigInt(t),e=new Uint16Array(256),o=i.symbols.GetWindowTextW(r,B(e),256),s=o>0?Et.decode(e.subarray(0,o)):"",u=new Int32Array(4);if(!i.symbols.GetWindowRect(r,B(u)))return null;let a={left:u[0],top:u[1],right:u[2],bottom:u[3]},f=Q(),p=a.left===0&&a.top===0&&a.right-a.left===f.width&&a.bottom-a.top===f.height&&(i.symbols.GetWindowLongW(r,Qt)&12845056)===0,l=new Uint32Array(1);i.symbols.GetWindowThreadProcessId(r,B(l));let c=new Uint8Array(256),E=i.symbols.GetClassNameA(r,B(c),256),m=E>0?pn.decode(c.subarray(0,E)):"";return{hwnd:r,title:s,rect:a,isFullscreen:p,processId:l[0],isVisible:i.symbols.IsWindowVisible(r),isMinimized:i.symbols.IsIconic(r),isMaximized:i.symbols.IsZoomed(r),className:m}}function yn(t,r){return new Promise((e)=>{let o=0,s=setInterval(()=>{if(!Ut(t)){clearInterval(s),e(!0);return}if(r&&(o+=100)>=r)clearInterval(s),e(!1)},100)})}async function Pn(t,r=1000){It(t);let e=0;while(e<r){let o=rt();if(o&&o.hwnd===BigInt(t))return!0;await Bun.sleep(50),e+=50}return!1}function Gn(){let t=[],r=new dt((e,o)=>{let s=rr(e);if(s&&s.isVisible&&s.title)t.push(s);return!0},{args:["u64","i64"],returns:"bool"});return i.symbols.EnumWindows(r.ptr,0),r.close(),t}function nr(t){let r=[],e=new dt((o,s)=>{return r.push(o),!0},{args:["u64","i64"],returns:"bool"});return i.symbols.EnumChildWindows(BigInt(t),e.ptr,0),e.close(),r}function Sn(t,r=!0){return i.symbols.FlashWindow(BigInt(t),r)}function Fn(t,r){let e=BigInt(t),o=i.symbols.GetWindowLongW(e,ct);i.symbols.SetWindowLongW(e,ct,o|ke);let s=Math.max(0,Math.min(255,Math.floor(r*255)));return i.symbols.SetLayeredWindowAttributes(e,0,s,Ve)}function Nn(t,r){return i.symbols.SetWindowPos(BigInt(t),BigInt(r?_e:De),0,0,0,0,qt|Zt)}function On(t,r){let e=new Uint16Array(r.length+1),o=new TextEncoder().encodeInto(r,new Uint8Array(e.buffer)),s=Buffer.from(r+"\x00","utf16le");return i.symbols.SetWindowTextW(BigInt(t),B(s))}function Kn(t,r){return i.symbols.EnableWindow(BigInt(t),r)}function Tn(t){return i.symbols.RedrawWindow(BigInt(t),null,0n,ye|Pe|Ge)}function kn(t){return i.symbols.SetWindowPos(BigInt(t),BigInt(Ae),0,0,0,0,qt|Zt)}function Vn(t){return i.symbols.SetWindowPos(BigInt(t),BigInt(Be),0,0,0,0,qt|Zt)}function er(t){let r=Mt(t);if(!r)return"";let e=V.symbols.OpenProcess(Se,!1,r);if(!e)return"";try{let o=new Uint16Array(1024),s=new Uint32Array([1024]);if(V.symbols.QueryFullProcessImageNameW(e,0,B(o),B(s)))return Et.decode(o.subarray(0,s[0]));return""}finally{V.symbols.CloseHandle(e)}}function _n(t,r,e){let o=new Int32Array([r,e]);if(i.symbols.ClientToScreen(BigInt(t),B(o)))return{x:o[0],y:o[1]};return null}function Dn(t,r,e){let o=new Int32Array([r,e]);if(i.symbols.ScreenToClient(BigInt(t),B(o)))return{x:o[0],y:o[1]};return null}function Rn(t){let r=BigInt(t);if(Jt(r))wt(r);return It(r)}async function Ln(t,r){let e=BigInt(t);return new Promise((o)=>{let s=0,u=setInterval(()=>{let a=rt();if(a&&a.hwnd===e){clearInterval(u),o(!0);return}if(r&&(s+=100)>=r)clearInterval(u),o(!1)},100)})}async function vn(t,r){let e=BigInt(t);return new Promise((o)=>{let s=0,u=setInterval(()=>{let a=rt();if(!a||a.hwnd!==e){clearInterval(u),o(!0);return}if(r&&(s+=100)>=r)clearInterval(u),o(!1)},100)})}function Yn(t){let r=BigInt(t),e=Mt(r);if(!e)return!1;let o=1,s=V.symbols.OpenProcess(o,!1,e);if(!s)return!1;try{return V.symbols.TerminateProcess(s,1)}finally{V.symbols.CloseHandle(s)}}var Re={WS_OVERLAPPED:0,WS_POPUP:2147483648,WS_CHILD:1073741824,WS_MINIMIZE:536870912,WS_VISIBLE:268435456,WS_DISABLED:134217728,WS_CLIPSIBLINGS:67108864,WS_CLIPCHILDREN:33554432,WS_MAXIMIZE:16777216,WS_CAPTION:12582912,WS_BORDER:8388608,WS_DLGFRAME:4194304,WS_VSCROLL:2097152,WS_HSCROLL:1048576,WS_SYSMENU:524288,WS_THICKFRAME:262144,WS_GROUP:131072,WS_TABSTOP:65536,WS_MINIMIZEBOX:131072,WS_MAXIMIZEBOX:65536};function Cn(t){return i.symbols.GetWindowLongW(BigInt(t),Qt)}function Xn(t,r){return i.symbols.SetWindowLongW(BigInt(t),Qt,Re[r])}var Le={WS_EX_DLGMODALFRAME:1,WS_EX_NOPARENTNOTIFY:4,WS_EX_TOPMOST:8,WS_EX_ACCEPTFILES:16,WS_EX_TRANSPARENT:32,WS_EX_MDICHILD:64,WS_EX_TOOLWINDOW:128,WS_EX_WINDOWEDGE:256,WS_EX_CLIENTEDGE:512,WS_EX_CONTEXTHELP:1024,WS_EX_RIGHT:4096,WS_EX_LEFT:0,WS_EX_RTLREADING:8192,WS_EX_LTRREADING:0,WS_EX_LEFTSCROLLBAR:16384,WS_EX_RIGHTSCROLLBAR:0,WS_EX_CONTROLPARENT:65536,WS_EX_STATICEDGE:131072,WS_EX_APPWINDOW:262144,WS_EX_LAYERED:524288,WS_EX_NOINHERITLAYOUT:1048576,WS_EX_NOREDIRECTIONBITMAP:2097152,WS_EX_LAYOUTRTL:4194304,WS_EX_COMPOSITED:33554432,WS_EX_NOACTIVATE:134217728};function $n(t){return i.symbols.GetWindowLongW(BigInt(t),ct)}function jn(t,r){return i.symbols.SetWindowLongW(BigInt(t),ct,Le[r])}function Wn(t){let r=BigInt(t);if(i.symbols.IsIconic(r))return-1;if(i.symbols.IsZoomed(r))return 1;return 0}function gt(){let t=[],r=new dt((e,o)=>{if(i.symbols.IsWindowVisible(e))t.push(e);return!0},{args:["u64","i64"],returns:"bool"});return i.symbols.EnumWindows(r.ptr,0),r.close(),t}function Hn(){return gt().length}function dn(){let t=gt();for(let r of t)i.symbols.ShowWindow(r,fn)}function Qn(t){let r=er(t);if(!r)return"";let e=r.split("\\");return e[e.length-1]}function qn(t){let r=xt(t),e=nr(t);for(let o of e){let s=xt(o);if(s)r+=`\r
`+s}return r}function Zn(t,r,e,o,s,u=!0){let a=y.symbols.CreateRectRgn(r,e,r+o,e+s);if(!a)return!1;return i.symbols.SetWindowRgn(BigInt(t),a,u)!==0}function zn(t,r,e,o,s,u=!0){let a=y.symbols.CreateEllipticRgn(r,e,r+o,e+s);if(!a)return!1;return i.symbols.SetWindowRgn(BigInt(t),a,u)!==0}function Jn(t,r,e,o,s,u,a,f=!0){let p=y.symbols.CreateRoundRectRgn(r,e,r+o,e+s,u,a);if(!p)return!1;return i.symbols.SetWindowRgn(BigInt(t),p,f)!==0}function wn(t,r,e=1,o=!0){let s=new Int32Array(r.length*2);for(let a=0;a<r.length;a++)s[a*2]=r[a].x,s[a*2+1]=r[a].y;let u=y.symbols.CreatePolygonRgn(B(s),r.length,e);if(!u)return!1;return i.symbols.SetWindowRgn(BigInt(t),u,o)!==0}function hn(t,r=!0){return i.symbols.SetWindowRgn(BigInt(t),0,r)!==0}class te{getActiveWindow=rt;getWindowTitle=xt;getWindowRect=mt;getClientRect=tr;getWindowSize=An;getClientSize=Bn;isWindowVisible=ln;isWindowMinimized=Jt;isWindowMaximized=En;isWindow=Ut;setForeground=It;focusWindow=Pn;findWindow=zt;waitForWindow=cn;waitForWindowClose=yn;getWindowProcessId=Mt;getClassName=xn;getExtendedWindowInfo=rr;minimizeWindow=mn;maximizeWindow=In;restoreWindow=wt;showWindow=Mn;hideWindow=Un;closeWindow=gn;moveWindow=ht;enumWindows=Gn;enumChildWindows=nr;flashWindow=Sn;setOpacity=Fn;setTopmost=Nn;center=bn;setTitle=On;setEnabled=Kn;redraw=Tn;moveToBottom=kn;moveToTop=Vn;getProcessPath=er;clientToScreen=_n;screenToClient=Dn;activate=Rn;waitActive=Ln;waitNotActive=vn;kill=Yn;getStyle=Cn;setStyle=Xn;getExStyle=$n;setExStyle=jn;getMinMax=Wn;getList=gt;getCount=Hn;minimizeAll=dn;getProcessName=Qn;getText=qn;setRegion={rect:Zn,ellipse:zn,round:Jn,polygon:wn,reset:hn}}var Qo=new te;class re{getScreenSize=Q;getMonitors=an;capture=lt;getPixel=h;getPixelHex=tn;checkPixel=tt;waitForPixel=rn;getMultiplePixels=nn;checkMultiplePixels=en;waitForAnyPixel=on;pixelSearch=sn;imageSearch=un}var Jo=new re;export{Qo as window,Ue as utils,Jo as screen,N as mouse,D as keyboard,_o as image,g as config,w as ImageProcessor};
