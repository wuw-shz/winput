import { user32 } from '../core/ffi-loader'
import { MAPVK_VK_TO_VSC } from '../core/constants'

export const KEYBOARD_MAPPING = {
  // Function keys
  escape: 0x01,
  esc: 0x01,
  f1: 0x3b,
  f2: 0x3c,
  f3: 0x3d,
  f4: 0x3e,
  f5: 0x3f,
  f6: 0x40,
  f7: 0x41,
  f8: 0x42,
  f9: 0x43,
  f10: 0x44,
  f11: 0x57,
  f12: 0x58,

  // System keys
  printscreen: 0xb7,
  prntscrn: 0xb7,
  prtsc: 0xb7,
  prtscr: 0xb7,
  scrolllock: 0x46,
  pause: 0xc5,

  // Number row
  '`': 0x29,
  '1': 0x02,
  '2': 0x03,
  '3': 0x04,
  '4': 0x05,
  '5': 0x06,
  '6': 0x07,
  '7': 0x08,
  '8': 0x09,
  '9': 0x0a,
  '0': 0x0b,
  '-': 0x0c,
  '=': 0x0d,
  backspace: 0x0e,

  // Navigation cluster
  insert: 0xd2 + 1024,
  home: 0xc7 + 1024,
  pageup: 0xc9 + 1024,
  pagedown: 0xd1 + 1024,
  del: 0xd3 + 1024,
  delete: 0xd3 + 1024,
  end: 0xcf + 1024,

  // Numpad
  numlock: 0x45,
  divide: 0xb5 + 1024,
  multiply: 0x37,
  subtract: 0x4a,
  add: 0x4e,
  decimal: 0x53,
  numpad0: 0x52,
  numpad1: 0x4f,
  numpad2: 0x50,
  numpad3: 0x51,
  numpad4: 0x4b,
  numpad5: 0x4c,
  numpad6: 0x4d,
  numpad7: 0x47,
  numpad8: 0x48,
  numpad9: 0x49,
  numpadenter: 0x9c + 1024,

  // Top row (QWERTY)
  tab: 0x0f,
  q: 0x10,
  w: 0x11,
  e: 0x12,
  r: 0x13,
  t: 0x14,
  y: 0x15,
  u: 0x16,
  i: 0x17,
  o: 0x18,
  p: 0x19,
  '[': 0x1a,
  ']': 0x1b,
  '\\': 0x2b,

  // Home row (ASDF)
  capslock: 0x3a,
  a: 0x1e,
  s: 0x1f,
  d: 0x20,
  f: 0x21,
  g: 0x22,
  h: 0x23,
  j: 0x24,
  k: 0x25,
  l: 0x26,
  ';': 0x27,
  "'": 0x28,
  enter: 0x1c,
  return: 0x1c,

  // Bottom row (ZXCV)
  shift: 0x2a,
  shiftleft: 0x2a,
  z: 0x2c,
  x: 0x2d,
  c: 0x2e,
  v: 0x2f,
  b: 0x30,
  n: 0x31,
  m: 0x32,
  ',': 0x33,
  '.': 0x34,
  '/': 0x35,
  shiftright: 0x36,

  // Modifier keys
  ctrl: 0x1d,
  ctrlleft: 0x1d,
  win: 0xdb + 1024,
  winleft: 0xdb + 1024,
  alt: 0x38,
  altleft: 0x38,
  ' ': 0x39,
  space: 0x39,
  altright: 0xb8 + 1024,
  winright: 0xdc + 1024,
  apps: 0xdd + 1024,
  ctrlright: 0x9d + 1024,

  // Arrow keys
  up: user32.symbols.MapVirtualKeyW(0x26, MAPVK_VK_TO_VSC),
  left: user32.symbols.MapVirtualKeyW(0x25, MAPVK_VK_TO_VSC),
  down: user32.symbols.MapVirtualKeyW(0x28, MAPVK_VK_TO_VSC),
  right: user32.symbols.MapVirtualKeyW(0x27, MAPVK_VK_TO_VSC),
}

export const SHIFT_KEYS = new Map<string, string>([
  ['!', '1'],
  ['@', '2'],
  ['#', '3'],
  ['$', '4'],
  ['%', '5'],
  ['^', '6'],
  ['&', '7'],
  ['*', '8'],
  ['(', '9'],
  [')', '0'],
  ['_', '-'],
  ['+', '='],
  ['{', '['],
  ['}', ']'],
  ['|', '\\'],
  [':', ';'],
  ['"', "'"],
  ['<', ','],
  ['>', '.'],
  ['?', '/'],
  ['~', '`'],
])
